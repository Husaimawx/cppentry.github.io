---
layout:     post
title:      hive和hbase整合、sqoop数据迁移工具
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p><strong><span style="font-size:32px;">hive<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">整合</span></span></strong></p><p>总结：</p><p>hive<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">hbase </span><span style="font-family:'宋体';">底层都依赖</span><span style="font-family:Calibri;">HDFS</span></p><p>hive<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">他们是一对优缺点互补的组合</span></p><p>    <span style="color:rgb(0,0,255);">hive<span style="font-family:'宋体';">：统计分析</span></span></p><p><span style="color:rgb(0,0,255);">    hbase<span style="font-family:'宋体';">：实时增删改查</span></span></p><p> <span style="font-family:'宋体';">以上可以看做</span>   mysql<span style="font-family:'宋体';">的增强版，没有解决查询延时的问题 </span></p><p> <span style="font-family:'宋体';">整合步骤：</span></p><p> 1<span style="font-family:'宋体';">、创建了一张</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">表插入数据</span></p><p> 2<span style="font-family:'宋体';">、创建一张</span><span style="font-family:Calibri;">hive</span><span style="font-family:'宋体';">表，</span><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">基于这个</span>hbase<span style="font-family:'宋体';">表的</span></span></p><p>    <span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">第一个是</span>hbase<span style="font-family:'宋体';">依赖的</span><span style="font-family:Calibri;">zookeeper</span><span style="font-family:'宋体';">的地址</span></span></p><p><span style="color:rgb(0,0,255);">    <span style="font-family:'宋体';">第二个是</span>hbase<span style="font-family:'宋体';">的数据存储在</span><span style="font-family:Calibri;">hdfs</span><span style="font-family:'宋体';">上的根目录  </span><span style="font-family:Calibri;">/hbase</span></span></p><p><span style="color:rgb(0,0,255);">    <span style="font-family:'宋体';">第三个添加一个整合</span>hive<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">jar</span><span style="font-family:'宋体';">到</span><span style="font-family:Calibri;">hive</span><span style="font-family:'宋体';">的客户端  </span><span style="font-family:Calibri;">add jar</span></span></p><p> 3<span style="font-family:'宋体';">、在创建</span><span style="font-family:Calibri;">hive</span><span style="font-family:'宋体';">表的时候，要指定</span><span style="font-family:Calibri;">hive</span><span style="font-family:'宋体';">表和</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">表的对应关系</span></p><p>    <span style="font-family:'宋体';">表名</span></p><p>    <span style="font-family:'宋体';">字段的定义（</span>HBASE<span style="font-family:'宋体';">中的哪些</span><span style="font-family:Calibri;">key</span><span style="font-family:'宋体';">对应到</span><span style="font-family:Calibri;">hive</span><span style="font-family:'宋体';">表的哪些列）</span></p><p>    key   rowkey</p><p>    key1  cf1:name</p><p>    key2  cf2:age</p><p> 4<span style="font-family:'宋体';">、查询验证</span></p><p>    <span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">可以利用</span>hive<span style="font-family:'宋体';">从</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">表中进行查询分析</span></span></p><p><span style="color:rgb(0,0,255);">    <span style="font-family:'宋体';">可以利用</span>hive<span style="font-family:'宋体';">往</span><span style="font-family:Calibri;">hbase</span><span style="font-family:'宋体';">表中插入数据</span></span></p><p>    hbase&gt;scan  'mingxing'</p><p>    hive&gt;show tables;</p><p>    desc mingxing;</p><p>    insert into table mingxing values("rk007","hadoop","xinjiang");</p><p> </p><p><strong><span style="font-size:32px;">sqoop<span style="font-family:'宋体';">数据迁移工具</span></span></strong></p><p>sqoop</p><p>基础理论</p><p>1<span style="font-family:'宋体';">、迁移的方向，迁入迁出</span></p><p>2<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">sqoop</span><span style="font-family:'宋体';">的本质：其实就是把</span><span style="font-family:Calibri;">sqoop</span><span style="font-family:'宋体';">的命令转换成</span><span style="font-family:Calibri;">mapreduce</span><span style="font-family:'宋体';">程序，被改写了</span><span style="font-family:Calibri;">inputformat</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">outputformat</span></p><p>3<span style="font-family:'宋体';">、架构</span></p><p>    RDBMS----&gt;  import    hadoop</p><p>     RDBMS &lt;-----   export   hadoop </p><p>开发环境搭建：</p><p>    hbase  hive hadoop sqoop zookeeper  <span style="font-family:'宋体';">等各种组件的安装目录</span></p><p>    <span style="font-family:'宋体';">关系型数据库的配置信息不需要写死在配置文件找中</span></p><p>    <span style="font-family:'宋体';">常用的命令</span></p><p>        import</p><p>        export</p><p>        list-databases</p><p>        list-tables</p><p>        create-hive-table</p><p>        <span style="font-family:'宋体';">各种的常用参数的含义</span></p><p>        sqoop import --query 'select * from myhive.student where \$CONDITIONS'</p><p><span style="color:rgb(0,0,255);background:rgb(255,255,0);"><span style="font-family:'宋体';">重点注意：</span></span></p><p><span style="color:rgb(0,0,255);background:rgb(255,255,0);"><span style="font-family:'宋体';">全量导入</span></span><span style="color:rgb(0,0,255);background:rgb(255,255,0);"> </span><span style="color:rgb(0,0,255);">则不包含以下三个参数</span></p><p><span style="color:rgb(0,0,255);background:rgb(255,255,0);"><span style="font-family:'宋体';">增量导入</span></span><span style="color:rgb(0,0,255);">会包含以下参数</span></p><p><span style="color:rgb(0,0,255);">       </span><span style="color:rgb(0,0,255);background:rgb(255,255,0);"> --check-column</span><span style="color:rgb(0,0,255);">   </span><span style="color:rgb(0,0,255);">（</span><span style="color:rgb(0,0,255);">col</span><span style="color:rgb(0,0,255);">）</span><span style="color:rgb(0,0,255);">  <span style="font-family:'宋体';">按照哪个字段</span></span><span style="color:rgb(0,0,255);">  <span style="font-family:'宋体';">指定一个标识列用于判断增量导入的数据范围</span></span></p><p><span style="color:rgb(0,0,255);">        </span><span style="color:rgb(0,0,255);background:rgb(255,255,0);">--incremental</span><span style="color:rgb(0,0,255);"> </span><span style="color:rgb(0,0,255);">（</span><span style="color:rgb(0,0,255);">mode</span><span style="color:rgb(0,0,255);">）</span><span style="color:rgb(0,0,255);"> </span><span style="color:rgb(0,0,255);">指定增量模式</span><span style="color:rgb(0,0,255);">  <span style="font-family:'宋体';">包含</span> </span><span style="color:rgb(0,0,255);">“</span><span style="color:rgb(0,0,255);">追加模式</span><span style="color:rgb(0,0,255);">”</span><span style="color:rgb(0,0,255);"> append <span style="font-family:'宋体';">和 </span></span><span style="color:rgb(0,0,255);">“</span><span style="color:rgb(0,0,255);">最后修改模式</span><span style="color:rgb(0,0,255);">”</span><span style="color:rgb(0,0,255);"> lastmodified</span></p><p><span style="color:rgb(0,0,255);">        </span><span style="color:rgb(0,0,255);background:rgb(255,255,0);">--last-value</span><span style="color:rgb(0,0,255);"> </span><span style="color:rgb(0,0,255);">     (value)</span><span style="color:rgb(0,0,255);">  <span style="font-family:'宋体';">导入的最后一个字段的值</span></span><span style="color:rgb(0,0,255);">  <span style="font-family:'宋体';">也就是标识列上次导入的上界</span>  <span style="font-family:'宋体';">如果标识列</span> <span style="font-family:'宋体';">是最后修改时间</span>  <span style="font-family:'宋体';">则</span>-last-value <span style="font-family:'宋体';">为上次执行导入脚本的时间</span></span></p><p><span style="color:rgb(0,0,255);"><span style="font-family:'宋体';">增量导入</span>append<span style="font-family:'宋体';">模式示例：—— 代表按需填入的值</span></span></p><p><span style="color:rgb(0,0,255);">Sqoop import -connect <span style="font-family:'宋体';">—— </span></span></p><p><span style="color:rgb(0,0,255);">-username <span style="font-family:'宋体';">—— </span></span></p><p><span style="color:rgb(0,0,255);">-password <span style="font-family:'宋体';">—— </span></span></p><p><span style="color:rgb(0,0,255);">-table <span style="font-family:'宋体';">—— </span></span></p><p><span style="color:rgb(0,0,255);">-num-mappers 10 </span></p><p><span style="color:rgb(0,0,255);">-hive-import </span></p><p><span style="color:rgb(0,0,255);">-hive-database <span style="font-family:'宋体';">—— </span></span></p><p><span style="color:rgb(0,0,255);">-hive-table <span style="font-family:'宋体';">—— </span></span></p><p><span style="color:rgb(0,0,255);">-incremental append </span></p><p><span style="color:rgb(0,0,255);">-check-column ID</span></p><p><span style="color:rgb(0,0,255);"> -last-value 3</span></p><p><span style="color:rgb(0,0,255);"> </span></p><p> </p><p>azkaban <span style="font-family:'宋体';">工作流调度引擎</span></p><p>    azkaban:<span style="font-family:'宋体';">结合</span><span style="font-family:Calibri;">oozie</span><span style="font-family:'宋体';">做了一个比较  </span></p><p>    <span style="font-family:'宋体';">若没有这命令则需要先安装该应用</span></p>            </div>
                </div>