---
layout:     post
title:      spark on hive原理与环境搭建    spark研习第三季
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/refuil/article/details/52327632				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
SparkSQL前身是Shark，Shark强烈依赖于Hive。Spark原来没有做SQL多维度数据查询工具，后来开发了Shark，Shark依赖于Hive的解释引擎，部分在Spark中运行，还有一部分在Hadoop中运行。所以讲SparkSQL必须讲Hive。</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h2 id="一spark-on-hive原理与搭建" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:40px;color:rgb(44,62,80);font-size:26px;background-color:rgb(249,249,245);">
一、spark on hive原理与搭建</h2>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h3 id="1-hive的本质" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:40px;color:rgb(44,62,80);font-size:21px;background-color:rgb(249,249,245);">
1. hive的本质</h3>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
1）Hive是分布式数据仓库，同时又是查询引擎，所以SparkSQL取代的只是Hives的查询引擎，在企业实际生产环境下，Hive+SparkSQL是目前最为经典的数据分析组合。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
2）Hive本身就是一个简单单机版本的软件，主要负责：</p>
<pre style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;">A） 把HQL翻译成Mapper(s)-Reducer-Mapper(s)的代码，并且可能产生很多MapReduce的JOB。
B）把生成的MapReduce代码及相关资源打包成jar并发布到Hadoop集群中运行（这一切都是自动的）
</code></pre>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
3）Hive本身的架构如下所示： <br><a href="https://img-blog.csdn.net/20160326185148566?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">hive架构</a></p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
可以通过CLI（命令终端）、JDBC/ODBC、Web GUI访问Hive。 <br>
JavaEE或.net程序可以通过Hive处理，再把处理的结果展示给用户。 <br>
也可以直接通过Web页面操作Hive。 <br>
※ Hive本身只是一个单机版本的的软件，怎么访问HDFS的呢？ <br>
=&gt; 在Hive用Table的方式插入数据、检索数据等，这就需要知道数据放在HDFS的什么地方以及什么地方属于什么数据，Metastore就是保存这些元数据信息的。Hive通过访问元数据信息再去访问HDFS上的数据。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
可以看出HDFS不是一个真实的文件系统，是虚拟的，是逻辑上的，HDFS只是一套软件而已，它是管理不同机器上的数据的，所以需要NameNode去管理元数据。DataNode去管理数据。 <br>
Hive通过Metastore和NameNode打交道。</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h3 id="2-hive安装和配置实战" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:40px;color:rgb(44,62,80);font-size:21px;background-color:rgb(249,249,245);">
2. Hive安装和配置实战</h3>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
Spark1.6.1中SparkSQL可以指定具体的Hive的版本。 <br>
1） 从apache官网下载hive-1.2.1，并解压到/home/richard目录。 <br><a href="http://mirrors.cnnic.cn/apache/hive/hive-1.2.1/" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://mirrors.cnnic.cn/apache/hive/hive-1.2.1/</a> <br>
2） 配置.bashrc，追加以下内容，或者/etc/profile:</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">export</span><span class="pln" style="color:rgb(0,0,0);"> HIVE_HOME</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">/home/</span><span class="pln" style="color:rgb(0,0,0);">richard</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">1</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">export</span><span class="pln" style="color:rgb(0,0,0);"> HIVE_CONF_DIR</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">/$HIVE_HOME/</span><span class="pln" style="color:rgb(0,0,0);">conf</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">export</span><span class="pln" style="color:rgb(0,0,0);"> PATH</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);">$PATH</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);">$HIVE_HOME</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">bin</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
3）进入/home/richard/hive-1.2.1/conf目录，生成hive-env.sh:</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">cp hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="kwd" style="color:rgb(0,0,136);">default</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">xml</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">template</span><span class="pln" style="color:rgb(0,0,0);"> hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">site</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">xml</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
配置：</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">export</span><span class="pln" style="color:rgb(0,0,0);"> HADOOP_HOME</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">/opt/</span><span class="pln" style="color:rgb(0,0,0);">hadoop</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">2.6</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">0</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">export</span><span class="pln" style="color:rgb(0,0,0);"> HIVE_HOME</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">/opt/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">/</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">export</span><span class="pln" style="color:rgb(0,0,0);"> HIVE_CONF_DIR</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">/opt/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">conf</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
Hive默认情况下放元数据的数据库是Derby，遗憾的是Derby是单用户，所以在生产环境下一般会采用支持多用户的数据库来进行MetaStore，且进行Master-Slaves主从读写分离和备份（一般Master节点负责写数据，Slaves节点负责读数据）。最常用的是MySQL。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
cp hive-env.sh.template hive-env.sh <br>
再生成hive-site.xml，并配置如下：</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;configuration&gt;</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">  </span><span class="com" style="color:rgb(136,0,0);">&lt;!-- WARNING!!! This file is auto generated for documentation purposes ONLY! --&gt;</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">  </span><span class="com" style="color:rgb(136,0,0);">&lt;!-- WARNING!!! Any changes you make to this file will be ignored by Hive.   --&gt;</span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">  </span><span class="com" style="color:rgb(136,0,0);">&lt;!-- WARNING!!! You must make your changes in hive-site.xml instead.         --&gt;</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">  </span><span class="com" style="color:rgb(136,0,0);">&lt;!-- Hive Execution Parameters --&gt;</span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;property&gt;</span></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0);">javax.jdo.option.ConnectionURL</span><span class="tag" style="color:rgb(0,0,136);">&lt;/name&gt;</span></code></li><li class="L7"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0);">jdbc:mysql://master:3306/hive?createDatabaseIfNotExist=true</span><span class="tag" style="color:rgb(0,0,136);">&lt;/value&gt;</span></code></li><li class="L8"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0);">JDBC connect string for a JDBC metastore</span><span class="tag" style="color:rgb(0,0,136);">&lt;/description&gt;</span></code></li><li class="L9"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;/property&gt;</span></code></li><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;property&gt;</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0);">javax.jdo.option.ConnectionDriverName</span><span class="tag" style="color:rgb(0,0,136);">&lt;/name&gt;</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0);">com.mysql.jdbc.Driver</span><span class="tag" style="color:rgb(0,0,136);">&lt;/value&gt;</span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0);">Driver class name for a JDBC metastore</span><span class="tag" style="color:rgb(0,0,136);">&lt;/description&gt;</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;/property&gt;</span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;property&gt;</span></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0);">javax.jdo.option.ConnectionUserName</span><span class="tag" style="color:rgb(0,0,136);">&lt;/name&gt;</span></code></li><li class="L7"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0);">root</span><span class="tag" style="color:rgb(0,0,136);">&lt;/value&gt;</span></code></li><li class="L8"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0);">username to use against metastore database</span><span class="tag" style="color:rgb(0,0,136);">&lt;/description&gt;</span></code></li><li class="L9"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;/property&gt;</span></code></li><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;property&gt;</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0);">javax.jdo.option.ConnectionPassword</span><span class="tag" style="color:rgb(0,0,136);">&lt;/name&gt;</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0);">778899..</span><span class="tag" style="color:rgb(0,0,136);">&lt;/value&gt;</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0);">password to use against metastore database</span><span class="tag" style="color:rgb(0,0,136);">&lt;/description&gt;</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;/property&gt;</span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;property&gt;</span></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0);">hive.metastore.warehouse.dir</span><span class="tag" style="color:rgb(0,0,136);">&lt;/name&gt;</span></code></li><li class="L7"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0);">/user/hive/warehouse</span><span class="tag" style="color:rgb(0,0,136);">&lt;/value&gt;</span></code></li><li class="L8"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="tag" style="color:rgb(0,0,136);">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0);">location of default database for the warehouse</span><span class="tag" style="color:rgb(0,0,136);">&lt;/description&gt;</span></code></li><li class="L9"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="tag" style="color:rgb(0,0,136);">&lt;/property&gt;</span></code></li><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;/configuration&gt;</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
Hive中的DataBase和表其实就是HDFS上的目录和简单的文本文件。简单的文本文件中有几列数据，每列数据的类型无法直接从文本文件中得知。但当数据放入Hive中，Hive就把元数据放入Mysql中了，这样就可以基于数据的表进行查询了。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
4) MYSQL的安装和配置 <br>
root用户下执行yum -y install mysql-server即可自动安装 <br>
执行rpm -qa mysql-server可以查看是否安装成功及安装的mysql版本。 <br>
参考redhat4.4.7如何安装mysql（非yum 安装） <br><a href="http://blog.csdn.net/choice_jj/article/details/8827649" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://blog.csdn.net/choice_jj/article/details/8827649</a> <br><a href="http://jingyan.baidu.com/article/1974b289acebd0f4b0f77469.html" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://jingyan.baidu.com/article/1974b289acebd0f4b0f77469.html</a> <br>
设置密码问题： <br><a href="http://blog.csdn.net/rogerzhanglijie/article/details/9182125" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://blog.csdn.net/rogerzhanglijie/article/details/9182125</a></p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
hive打开错误参考：</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pun" style="color:rgb(102,102,0);">主要是按照《</span><span class="pln" style="color:rgb(0,0,0);">DT</span><span class="pun" style="color:rgb(102,102,0);">-大数据</span><span class="pln" style="color:rgb(0,0,0);"> hive1</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">2.1</span><span class="pun" style="color:rgb(102,102,0);">用</span><span class="pln" style="color:rgb(0,0,0);">mysql</span><span class="pun" style="color:rgb(102,102,0);">作为元数据库搭建》文档</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
<a href="http://www.aboutyun.com/thread-11131-1-1.html" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://www.aboutyun.com/thread-11131-1-1.html</a></p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
另外还需要下载驱动包(mysql-connector-java-5.1.35.tar.gz)将.jar文件放到这个目录下：</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">cd </span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">usr</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="kwd" style="color:rgb(0,0,136);">local</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">lib</span><span class="pun" style="color:rgb(102,102,0);">/</span></code></li></ol>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h4 id="启动hive报错" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:20px;color:rgb(44,62,80);font-size:18px;background-color:rgb(249,249,245);">
启动hive报错</h4>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="typ" style="color:rgb(102,0,102);">Logging</span><span class="pln" style="color:rgb(0,0,0);"> initialized </span><span class="kwd" style="color:rgb(0,0,136);">using</span><span class="pln" style="color:rgb(0,0,0);"> configuration </span><span class="kwd" style="color:rgb(0,0,136);">in</span><span class="pln" style="color:rgb(0,0,0);"> jar</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);">file</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="str" style="color:rgb(0,136,0);">/opt/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">lib</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">common</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">1.jar</span><span class="pun" style="color:rgb(102,102,0);">!/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">log4j</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">properties</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="typ" style="color:rgb(102,0,102);">Exception</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">in</span><span class="pln" style="color:rgb(0,0,0);"> thread </span><span class="str" style="color:rgb(0,136,0);">"main"</span><span class="pln" style="color:rgb(0,0,0);"> java</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">lang</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">RuntimeException</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> java</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">lang</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">RuntimeException</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Unable</span><span class="pln" style="color:rgb(0,0,0);"> to instantiate org</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hadoop</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">ql</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">metadata</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">SessionHiveMetaStoreClient</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="typ" style="color:rgb(102,0,102);">Caused</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">by</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> java</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">lang</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">RuntimeException</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Unable</span><span class="pln" style="color:rgb(0,0,0);"> to instantiate org</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hadoop</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">ql</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">metadata</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">SessionHiveMetaStoreClient</span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="typ" style="color:rgb(102,0,102);">Caused</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">by</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> java</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">lang</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">reflect</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">InvocationTargetException</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="typ" style="color:rgb(102,0,102);">Caused</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">by</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> javax</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">jdo</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">JDOFatalDataStoreException</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Unable</span><span class="pln" style="color:rgb(0,0,0);"> to open a test connection to the given database</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);"> JDBC url </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> jdbc</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);">mysql</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="com" style="color:rgb(136,0,0);">//master:3306/hive?createDatabaseIfNotExist=true, username = hive. Terminating connection pool (set lazyInit to true if you expect to start your database after </span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pun" style="color:rgb(102,102,0);">...</span></code></li></ol>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">root@master</span><span class="pun" style="color:rgb(102,102,0);">:/</span><span class="pln" style="color:rgb(0,0,0);">opt</span><span class="com" style="color:rgb(136,0,0);"># netstat -tnlp | grep 3306</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">tcp        </span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pln" style="color:rgb(0,0,0);">      </span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">127.0</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">0.1</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="lit" style="color:rgb(0,102,102);">3306</span><span class="pln" style="color:rgb(0,0,0);">          </span><span class="lit" style="color:rgb(0,102,102);">0.0</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">0.0</span><span class="pun" style="color:rgb(102,102,0);">:*</span><span class="pln" style="color:rgb(0,0,0);">               LISTEN      </span><span class="lit" style="color:rgb(0,102,102);">5090</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">mysqld   </span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="com" style="color:rgb(136,0,0);">//mysql的监听IP应该是0.0.0.0 </span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="com" style="color:rgb(136,0,0);">//在vi /etc/mysql/my.cnf   中修改</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">killall mysqld  </span><span class="pun" style="color:rgb(102,102,0);">后守护进程还会启动</span><span class="pln" style="color:rgb(0,0,0);">mysql</span><span class="pun" style="color:rgb(102,102,0);">，等于重启</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
另外报错：</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">SLF4J</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">See</span><span class="pln" style="color:rgb(0,0,0);"> http</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="com" style="color:rgb(136,0,0);">//www.slf4j.org/codes.html#multiple_bindings for an explanation.</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">SLF4J</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Actual</span><span class="pln" style="color:rgb(0,0,0);"> binding </span><span class="kwd" style="color:rgb(0,0,136);">is</span><span class="pln" style="color:rgb(0,0,0);"> of type </span><span class="pun" style="color:rgb(102,102,0);">[</span><span class="pln" style="color:rgb(0,0,0);">org</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">slf4j</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">impl</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">Log4jLoggerFactory</span><span class="pun" style="color:rgb(102,102,0);">]</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pun" style="color:rgb(102,102,0);">[</span><span class="pln" style="color:rgb(0,0,0);">ERROR</span><span class="pun" style="color:rgb(102,102,0);">]</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Terminal</span><span class="pln" style="color:rgb(0,0,0);"> initialization failed</span><span class="pun" style="color:rgb(102,102,0);">;</span><span class="pln" style="color:rgb(0,0,0);"> falling back to unsupported</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
原因是hadoop目录下存在老版本jline： <br>
/hadoop-2.5.2/share/hadoop/yarn/lib： <br>
-rw-r--r-- 1 root root 87325 Mar 10 18:10 jline-0.9.94.jar</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
解决方法是：</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pun" style="color:rgb(102,102,0);">将</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">下的新版本</span><span class="pln" style="color:rgb(0,0,0);">jline</span><span class="pun" style="color:rgb(102,102,0);">的</span><span class="pln" style="color:rgb(0,0,0);">JAR</span><span class="pun" style="color:rgb(102,102,0);">包拷贝到</span><span class="pln" style="color:rgb(0,0,0);">hadoop</span><span class="pun" style="color:rgb(102,102,0);">下：</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">cp </span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">1.1</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">bin</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">lib</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">jline</span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="lit" style="color:rgb(0,102,102);">2.12</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">jar </span><span class="pun" style="color:rgb(102,102,0);">./</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
5) Hive的表有两种基本类型：一种是内部表（这种表数据属于Hive本身，即如果原来的数据在HDFS的其他地方，此时数据会通过HDFS移动到Hive所在目录，如果删除Hive中的该表的话数据和元数据均会被删除），一种是外部表（这种表数据不属于Hive数据仓库，元数据中会表达具体数据在哪里，使用时和内部表的使用一样，只是如果通过Hive去删除的话，删除的只是元数据，并没有删除数据本身）</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
6）Hive扩展（Hive的数据存储-转载）</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
Hive是基于Hadoop分布式文件系统的，它的数据存储在Hadoop分布式文件系统中。Hive本身是没有专门的数据存储格式，也没有为数据建立索引，只需要在创建表的时候告诉Hive数据中的列分隔符和行分隔符，Hive就可以解析数据。所以往Hive表里面导入数据只是简单的将数据移动到表所在的目录中(如果数据是在HDFS上;但如果数据是在本地文件系统中，那么是将数据复制到表所在的目录中)。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
Hive中主要包含以下几种数据模型：Table(表)，External Table(外部表)，Partition(分区)，Bucket(桶)(本博客会专门写几篇博文来介绍分区和桶)。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
1、表：Hive中的表和关系型数据库中的表在概念上很类似，每个表在HDFS中都有相应的目录用来存储表的数据，这个目录可以通过${HIVE_HOME}/conf/hive-site.xml配置文件中的 hive.metastore.warehouse.dir属性来配置，这个属性默认的值是/user/hive/warehouse(这个目录在 HDFS上)，我们可以根据实际的情况来修改这个配置。如果我有一个表wyp，那么在HDFS中会创建/user/hive/warehouse/wyp 目录(这里假定hive.metastore.warehouse.dir配置为/user/hive/warehouse);wyp表所有的数据都存放在这个目录中。这个例外是外部表。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
2、外部表：外部表指向已经在HDFS中存在的数据，可以创建Partition。它和内部表在元数据的组织上是相同的，而实际数据的存储则有较大的差异。内部表的创建过程和数据加载过程这两个过程可以分别独立完成，也可以在同一个语句中完成，在加载数据的过程中，实际数据会被移动到数据仓库目录中；之后对数据对访问将会直接在数据仓库目录中完成。删除表时，表中的数据和元数据将会被同时删除。而外部表只有一个过程，加载数据和创建表同时完成（CREATE EXTERNAL TABLE ……LOCATION），实际数据是存储在LOCATION后面指定的
 HDFS 路径中，并不会移动到数据仓库目录中。当删除一个External Table时，仅删除该链接。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
3、分区：在Hive中，表的每一个分区对应表下的相应目录，所有分区的数据都是存储在对应的目录中。比如wyp 表有dt和city两个分区，则对应dt=20131218,city=BJ对应表的目录为/user/hive/warehouse /dt=20131218/city=BJ，所有属于这个分区的数据都存放在这个目录中。</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
4、桶：对指定的列计算其hash，根据hash值切分数据，目的是为了并行，每一个桶对应一个文件(注意和分区的区别)。比如将wyp表id列分散至16个桶中，首先对id列的值计算hash，对应hash值为0和16的数据存储的HDFS目录为：/user /hive/warehouse/wyp/part-00000;而hash值为2的数据存储的HDFS 目录为：/user/hive/warehouse/wyp/part-00002。如果想应用很多的Map任务这样是不错的选择。 <br><a href="http://ww4.sinaimg.cn/large/b79117d3gw1f1vkr2sce2j208x05gdgb.jpg" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">Hive数据抽象结构图</a></p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h3 id="3-使用hive分析搜索数据" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:40px;color:rgb(44,62,80);font-size:21px;background-color:rgb(249,249,245);">
3. 使用Hive分析搜索数据</h3>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
参考： <br><a href="http://lqding.blog.51cto.com/9123978/1751030" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://lqding.blog.51cto.com/9123978/1751030</a></p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
启动HDFS/Yarn。注意如果要使用Hive进行查询就需要启动Yarn。 <br>
启动Hive。 <br>
通过show databases;可以查看数据库。默认database只有default。 <br>
选取搜狗实验的三个数据源：<a href="http://download.labs.sogou.com/dl/q.html" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;">http://download.labs.sogou.com/dl/q.html</a></p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hadoop dfs </span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">mkdir </span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">library</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">sogou</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hadoop dfs </span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">put </span><span class="pun" style="color:rgb(102,102,0);">./</span><span class="typ" style="color:rgb(102,0,102);">SogouQ1</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">txt </span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">library</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">sogou</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hadoop dfs </span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">put </span><span class="pun" style="color:rgb(102,102,0);">./</span><span class="typ" style="color:rgb(102,0,102);">SogouQ2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">txt </span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">library</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">sogou</span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hadoop dfs </span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">put </span><span class="pun" style="color:rgb(102,102,0);">./</span><span class="typ" style="color:rgb(102,0,102);">SogouQ3</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">txt </span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">library</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">sogou</span></code></li></ol>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">create table </span><span class="typ" style="color:rgb(102,0,102);">SogouQ3</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">ID STRING</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> WEBSESSION STRING</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> WORD STRING</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> S_SEQ INT</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> C_SEQ INT</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> WEBSITE STRING</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> ROW FORMAT DELIMITED FIELDS TERMINATED BY </span><span class="str" style="color:rgb(0,136,0);">'\t'</span><span class="pln" style="color:rgb(0,0,0);"> LINES TERMINATED BY </span><span class="str" style="color:rgb(0,136,0);">'\n'</span><span class="pun" style="color:rgb(102,102,0);">;</span><span class="pln" style="color:rgb(0,0,0);">     </span><span class="com" style="color:rgb(136,0,0);">//建表</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">LOAD DATA INPATH </span><span class="str" style="color:rgb(0,136,0);">'/library/sogou/SogouQ3.txt'</span><span class="pln" style="color:rgb(0,0,0);"> OVERWRITE INTO TABLE </span><span class="typ" style="color:rgb(102,0,102);">SogouQ3</span><span class="pun" style="color:rgb(102,102,0);">;</span><span class="pln" style="color:rgb(0,0,0);">   </span><span class="com" style="color:rgb(136,0,0);">//加载数据</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
查询搜索排名第一，点击排名为第一的结果： <br>
select count(*) from sogouq1 where S_SEQ=1 and C_SEQ=1;</p>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
搜索日志中，关注排名前五的内容，并且给出分别为多少次： <br>
select WORD, count(WORD) as COUNTWord from SogouQ1 group by WORD order by COUNTWord desc limit 5</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h2 id="55课-查询例子mysql" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:40px;color:rgb(44,62,80);font-size:26px;background-color:rgb(249,249,245);">
查询例子mysql</h2>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
mysql -u root -p</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">creeate database hive</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">use</span><span class="pln" style="color:rgb(0,0,0);"> hive</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">create table person</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">name </span><span class="typ" style="color:rgb(102,0,102);">String</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);">age </span><span class="kwd" style="color:rgb(0,0,136);">int</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">insert </span><span class="kwd" style="color:rgb(0,0,136);">into</span><span class="pln" style="color:rgb(0,0,0);"> person values</span><span class="pun" style="color:rgb(102,102,0);">(‘</span><span class="pln" style="color:rgb(0,0,0);">richard</span><span class="pun" style="color:rgb(102,102,0);">’,’</span><span class="lit" style="color:rgb(0,102,102);">34</span><span class="pun" style="color:rgb(102,102,0);">’);</span></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"></code></li><li class="L7"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="kwd" style="color:rgb(0,0,136);">select</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">*</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">from</span><span class="pln" style="color:rgb(0,0,0);"> person</span><span class="pun" style="color:rgb(102,102,0);">;即可查询。</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
到此不需要启动spark，只需要启动HDFS。</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h3 id="4-spark-sql-on-hive配置及实战" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:40px;color:rgb(44,62,80);font-size:21px;background-color:rgb(249,249,245);">
4. Spark SQL on Hive配置及实战</h3>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h4 id="1spark-on-hive-配置" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:20px;color:rgb(44,62,80);font-size:18px;background-color:rgb(249,249,245);">
1）spark on hive 配置</h4>
<ol style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);"><li style="line-height:27px;">切换到spar的conf目录下使用vi hive-site.xml创建hive-site.xml.并填写如下内容</li></ol><div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;configuration&gt;</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;property&gt;</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0);">hive.metastore.uris</span><span class="tag" style="color:rgb(0,0,136);">&lt;/name&gt;</span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0);">thrift://master:9083</span><span class="tag" style="color:rgb(0,0,136);">&lt;/value&gt;</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0);">thrift URI for the remote metastore.Used by metastore client to connect to remote metastore. </span><span class="tag" style="color:rgb(0,0,136);">&lt;/description&gt;</span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;/property&gt;</span></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="tag" style="color:rgb(0,0,136);">&lt;/configuration&gt;</span></code></li></ol>
<p style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
因为用sparksql操作hive实际上是把hive 当做数据仓库。数据仓库肯定有元数据和数据本身。要访问真正的数据就要访问他的元数据。所以只需要配置hive.metastore.uris即可。（不需在每台机器上配置）</p>
<div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h4 id="2启动集群" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:20px;color:rgb(44,62,80);font-size:18px;background-color:rgb(249,249,245);">
2）启动集群</h4>
<ol style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);"><li style="line-height:27px;">启动dfs 服务start-dfs.sh</li><li style="line-height:27px;">启动hive 数据仓库服务 hive --service metastore &gt;metastore.log 2&gt;&amp; 1&amp;</li><li style="line-height:27px;">启动spark服务start-all.sh</li><li style="line-height:27px;">启动sparkshell ./spark-shell –master spark://master:7077</li></ol><div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<h4 id="3案例实战" style="font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-weight:500;line-height:20px;color:rgb(44,62,80);font-size:18px;background-color:rgb(249,249,245);">
3）案例实战</h4>
<ol style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);"><li style="line-height:27px;">Spark on hive 实战在spark-shell 模式下</li></ol><div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">val hiveContext</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">new</span><span class="pln" style="color:rgb(0,0,0);"> org</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">spark</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">HiveContext</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">sc</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hiveContext</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="str" style="color:rgb(0,136,0);">"use hive"</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="com" style="color:rgb(136,0,0);">//使用hive 数据库</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hiveContext</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="str" style="color:rgb(0,136,0);">"show tables"</span><span class="pun" style="color:rgb(102,102,0);">).</span><span class="pln" style="color:rgb(0,0,0);">collect</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">foreach</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">println</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="com" style="color:rgb(136,0,0);">// 查询数据库中的表</span></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hiveContext</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="str" style="color:rgb(0,136,0);">"select count(*) from  sogouq1"</span><span class="pun" style="color:rgb(102,102,0);">).</span><span class="pln" style="color:rgb(0,0,0);">collect</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">foreach</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">println</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="com" style="color:rgb(136,0,0);">//(注意此时使用的是spark的引擎)</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hiveContext</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">(“</span><span class="kwd" style="color:rgb(0,0,136);">select</span><span class="pln" style="color:rgb(0,0,0);"> count</span><span class="pun" style="color:rgb(102,102,0);">(*)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">from</span><span class="pln" style="color:rgb(0,0,0);"> sogouq2 </span><span class="kwd" style="color:rgb(0,0,136);">where</span><span class="pln" style="color:rgb(0,0,0);"> website like </span><span class="str" style="color:rgb(0,136,0);">'%baidu%'</span><span class="pun" style="color:rgb(102,102,0);">”).</span><span class="pln" style="color:rgb(0,0,0);">collect</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">foreach</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">println</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">hiveContext</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">(“</span><span class="kwd" style="color:rgb(0,0,136);">select</span><span class="pln" style="color:rgb(0,0,0);"> count</span><span class="pun" style="color:rgb(102,102,0);">(*)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">from</span><span class="pln" style="color:rgb(0,0,0);"> sogouq2 </span><span class="kwd" style="color:rgb(0,0,136);">where</span><span class="pln" style="color:rgb(0,0,0);"> s_seq</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">and</span><span class="pln" style="color:rgb(0,0,0);"> c_seq</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">and</span><span class="pln" style="color:rgb(0,0,0);">  website like </span><span class="str" style="color:rgb(0,136,0);">'%baidu%'</span><span class="pun" style="color:rgb(102,102,0);">”).</span><span class="pln" style="color:rgb(0,0,0);">collect</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">foreach</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">println</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li></ol>
<ol style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);"><li style="line-height:27px;">不基于hive 的实战代码，在spark-shell 模式下</li></ol><div class="md-section-divider" style="color:rgb(44,62,80);font-family:'PingFang SC', 'Hiragino Sans GB', 'Helvetica Neue', 'Microsoft Yahei', 'WenQuanYi Micro Hei', sans-serif;font-size:14px;line-height:24px;background-color:rgb(249,249,245);">
</div>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(51,51,51);line-height:20px;"></pre><ol class="linenums"><li class="L0"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">scala</span><span class="pun" style="color:rgb(102,102,0);">&gt;</span><span class="pln" style="color:rgb(0,0,0);"> sqlContext</span></code></li><li class="L1"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">res8</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);"> org</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">spark</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">SQLContext</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> org</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">apache</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">spark</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="typ" style="color:rgb(102,0,102);">HiveContext@35920655</span><span class="pun" style="color:rgb(102,102,0);">（可以创建很多</span><span class="pln" style="color:rgb(0,0,0);">hiveContext</span><span class="pun" style="color:rgb(102,102,0);">，</span><span class="pln" style="color:rgb(0,0,0);">hivecongtext</span><span class="pun" style="color:rgb(102,102,0);">连接的是数据仓库，程序本身（</span><span class="pln" style="color:rgb(0,0,0);">spark</span><span class="pun" style="color:rgb(102,102,0);">中的</span><span class="pln" style="color:rgb(0,0,0);">job</span><span class="pun" style="color:rgb(102,102,0);">），</span><span class="pln" style="color:rgb(0,0,0);">job</span><span class="pun" style="color:rgb(102,102,0);">在程序中并行运行，如果都</span><span class="pln" style="color:rgb(0,0,0);">hive</span><span class="pun" style="color:rgb(102,102,0);">的数据，如果用句柄，对句柄的占用比较麻烦，所有用多个实例。从查询的角度来说，有多个实例也很正常）</span></code></li><li class="L2"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"></code></li><li class="L3"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">val df </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);">sqlcontext</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">read</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">json</span><span class="pun" style="color:rgb(102,102,0);">(“</span><span class="pln" style="color:rgb(0,0,0);">library</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">examples</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">src</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">main</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">resources</span><span class="pun" style="color:rgb(102,102,0);">/</span><span class="pln" style="color:rgb(0,0,0);">people</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">json</span><span class="pun" style="color:rgb(102,102,0);">”)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="com" style="color:rgb(136,0,0);">//读取json 数据</span></code></li><li class="L4"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">df</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">show</span><span class="pun" style="color:rgb(102,102,0);">()</span></code></li><li class="L5"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">df</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">printSchema</span></code></li><li class="L6"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">df</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">select</span><span class="pun" style="color:rgb(102,102,0);">(“</span><span class="pln" style="color:rgb(0,0,0);">name</span><span class="pun" style="color:rgb(102,102,0);">”).</span><span class="pln" style="color:rgb(0,0,0);">show</span><span class="pun" style="color:rgb(102,102,0);">()</span></code></li><li class="L7"><code style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;color:inherit;border:0px;background-color:transparent;"><span class="pln" style="color:rgb(0,0,0);">df</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="kwd" style="color:rgb(0,0,136);">select</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">df</span><span class="pun" style="color:rgb(102,102,0);">(“</span><span class="pln" style="color:rgb(0,0,0);">name</span><span class="pun" style="color:rgb(102,102,0);">”),</span><span class="pln" style="color:rgb(0,0,0);">df</span><span class="pun" style="color:rgb(102,102,0);">(“</span><span class="pln" style="color:rgb(0,0,0);">age</span><span class="pun" style="color:rgb(102,102,0);">”)+</span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pun" style="color:rgb(102,102,0);">).</span><span class="pln" style="color:rgb(0,0,0);">show</span><span class="pun" style="color:rgb(102,102,0);">()</span></code></li></ol>
            </div>
                </div>