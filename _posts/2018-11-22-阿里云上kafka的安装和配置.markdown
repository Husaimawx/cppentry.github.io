---
layout:     post
title:      阿里云上kafka的安装和配置
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p>下载kafka的地址：</p><p>https://www.apache.org/dyn/closer.cgi?path=/kafka/1.1.0/kafka_2.11-1.1.0.tgz</p><p>镜像下载kafka</p><p><span style="background-color:rgb(255,255,255);color:rgb(88,90,194);font-family:'Droid Serif', Georgia, 'Times New Roman', Times, serif;font-size:14px;font-weight:700;">wget <a href="http://mirrors.hust.edu.cn/apache/kafka/1.1.0/kafka_2.11-1.1.0.tgz" rel="nofollow" style="background-color:rgb(255,255,255);color:rgb(88,90,194);font-family:'Droid Serif', Georgia, 'Times New Roman', Times, serif;font-size:14px;">http://mirrors.hust.edu.cn/apache/kafka/1.1.0/kafka_2.11-1.1.0.tgz</a></span><br></p><p>然后解压</p><p>tar -zxvf <a href="http://mirrors.hust.edu.cn/apache/kafka/1.1.0/kafka_2.11-1.1.0.tgz" rel="nofollow" style="color:rgb(88,90,194);font-family:'Droid Serif', Georgia, 'Times New Roman', Times, serif;font-size:14px;font-weight:bold;background-color:rgb(255,255,255);">kafka_2.11-1.1.0.tgz</a><br></p><p>进入到kafka目录下：</p><p>kafka是基于zookeeper的，但是，kafka是自带zookeeper；然后进入到/bin目录下</p><p><img src="https://img-blog.csdn.net/20180423173502422?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3kzMTU0OTUxNDY=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>启动 </p><p><img src="https://img-blog.csdn.net/20180423173735330?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3kzMTU0OTUxNDY=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>看一下启动情况</p><p> vim nohup.out <br></p><p>启动kafka</p><p>./bin/kafka-server-start.sh config/server.properties <br></p><p>启动报错：</p><p>Java HotSpot(TM) Server VM warning: INFO: os::commit_memory(0xa6e00000, 1073741824, 0) failed; error='Cannot allocate memory' (errno=12)<br></p><p>处理方案：</p><p>修改启动文件</p><p>修改 kafka-server-start.sh 将<span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);">export KAFKA_HEAP_OPTS="-Xmx1G -Xms1G"  </span></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);">改为<span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);">export KAFKA_HEAP_OPTS="-Xmx256M -Xms128M" </span></span><br></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);">继续启动报错：</span></span></p><p><span style="color:rgb(63,63,63);font-family:'Microsoft YaHei';font-size:14px;text-align:left;background-color:rgb(255,255,255);">Caused by: java.net.UnknownHostException: iZuf68tztea6l5ccdz7wemZ: iZuf68tztea6l5ccdz7wemZ: Name or service not known</span><br></p><p><span style="color:rgb(63,63,63);font-family:'Microsoft YaHei';font-size:14px;text-align:left;background-color:rgb(255,255,255);">处理方案：</span></p><p><span style="color:rgb(63,63,63);font-family:'Microsoft YaHei';font-size:14px;text-align:left;background-color:rgb(255,255,255);"></span></p><pre class="prettyprint" style="font-family:Consolas, Monaco, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace;padding:.5em;background-color:rgb(246,246,246);border-width:0px 0px 0px 3px;border-left-style:solid;border-left-color:rgb(204,204,204);white-space:pre-wrap;font-size:13.2px;margin-top:1em;margin-bottom:1em;table-layout:fixed;color:rgb(63,63,63);text-align:left;max-width:680px;"><code class="hljs nginx" style="font-family:'Microsoft YaHei';max-width:680px;"><span class="hljs-title" style="padding:0px;max-width:680px;"><span class="pln" style="padding:0px;color:rgb(0,0,0);max-width:680px;">vi </span><span class="pun" style="padding:0px;color:rgb(102,102,0);max-width:680px;">/</span><span class="pln" style="padding:0px;color:rgb(0,0,0);max-width:680px;">etc</span><span class="pun" style="padding:0px;color:rgb(102,102,0);max-width:680px;">/</span><span class="pln" style="padding:0px;color:rgb(0,0,0);max-width:680px;">hosts
</span><span class="hljs-number" style="padding:0px;max-width:680px;"><span class="lit" style="padding:0px;max-width:680px;">127.0</span><span class="pun" style="padding:0px;color:rgb(102,102,0);max-width:680px;">.</span><span class="lit" style="padding:0px;max-width:680px;">0.1</span><span class="pln" style="padding:0px;color:rgb(0,0,0);max-width:680px;"> izwz920j4zsv1qvh2kt0efz</span></span></span></code></pre><p><span style="color:rgb(63,63,63);font-family:'Microsoft YaHei';font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,0,0);font-family:'Microsoft YaHei';font-size:14px;text-align:left;white-space:pre;background-color:rgb(246,248,250);">izwz920j4zsv1qvh2kt0efz为自己的主机名</span></span></p><p>然后启动成功</p><p>配置外网访问</p><p>vim config/server.properties <br></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;background-color:rgb(246,248,250);"># The id of the broker. This must be </span><span class="hljs-operator" style="margin:0px;padding:0px;color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;"><span class="hljs-keyword" style="margin:0px;padding:0px;">set</span> <span class="hljs-keyword" style="margin:0px;padding:0px;">to</span> a <span class="hljs-keyword" style="margin:0px;padding:0px;">unique</span> <span class="hljs-keyword" style="margin:0px;padding:0px;">integer</span> <span class="hljs-keyword" style="margin:0px;padding:0px;">for</span> <span class="hljs-keyword" style="margin:0px;padding:0px;">each</span> </span></span></span><span style="color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;background-color:rgb(255,255,255);">broker.</span></p><p><span style="color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;background-color:rgb(255,255,255);">broker.id=</span><span class="hljs-number" style="font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;background-color:rgb(255,255,255);margin:0px;padding:0px;">0</span></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span class="hljs-operator" style="margin:0px;padding:0px;color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;">port=<span class="hljs-number" style="margin:0px;padding:0px;">9092</span></span></span></span></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span class="hljs-operator" style="margin:0px;padding:0px;color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;">host.name=阿里云内网地址</span></span></span></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span class="hljs-operator" style="margin:0px;padding:0px;color:rgb(0,0,0);font-family:Consolas, Inconsolata, Courier, monospace;font-size:14px;white-space:pre;">advertised.host.name=阿里云外网映射地址</span><br></span></span></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);">后台启动kafka</span></span></p><p><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"><span style="font-family:'Microsoft YaHei';font-size:18px;background-color:rgb(255,255,255);"> nohup ./bin/kafka-server-start.sh config/server.properties &amp;<br></span></span></p><p><br></p>            </div>
                </div>