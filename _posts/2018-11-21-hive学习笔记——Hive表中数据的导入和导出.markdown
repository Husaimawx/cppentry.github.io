---
layout:     post
title:      hive学习笔记——Hive表中数据的导入和导出
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/google19890102/article/details/47278007				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p><span style="font-family:'KaiTi_GB2312';font-size:18px;">    在创建</span><span style="font-size:18px;"><span style="font-family:'KaiTi_GB2312';">数据表的</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">过程中，</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表创建完成后，需要将一些数据导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中，或是将</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中的数据导出。</span></p>
<h1><span style="font-family:'KaiTi_GB2312';font-size:18px;">一、将数据导入</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表</span></h1>
<p><span style="font-family:'KaiTi_GB2312';font-size:18px;">    </span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表的数据导入主要有三种方式：</span></p>
<p></p>
<ol><li><span style="font-family:'KaiTi_GB2312';font-size:18px;">从本地文件系统中导入数据到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></li><li><span style="font-family:'KaiTi_GB2312';font-size:18px;">从</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">HDFS</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">上导入数据到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></li><li><span style="font-family:'KaiTi_GB2312';font-size:18px;">从别的表中查询出相应的数据导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></li><li><span style="font-family:'KaiTi_GB2312';font-size:18px;">在创建</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表时通过从别的表中查询并插入的方式将数据导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></li></ol><h2><span style="font-family:'KaiTi_GB2312';font-size:18px;">1、从本地文件系统中导入数据到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></h2>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">格式：</span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;"></span><pre><code class="language-sql">LOAD DATA LOCAL INPATH "path" [OVERWRITE] INTO TABLE tablename;</code></pre><br></div>
<div><br><span style="font-family:'KaiTi_GB2312';font-size:18px;">假设此时有一个文本文件存储在本地，地址为：“</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">/home/training/zzy_scripts/studentno_data.txt</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">”，需要将这个本地文件导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">studentno</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">中。</span></div>
<div style="text-align:center;"><span style="font-family:'KaiTi_GB2312';font-size:18px;"><img src="https://img-blog.csdn.net/20150804220607182?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">查询数据库中的文件</span></div>
<div style="text-align:center;"><span style="font-family:'KaiTi_GB2312';font-size:18px;"><img src="https://img-blog.csdn.net/20150804220750017?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">已经将制定的文件导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中。</span></div>
<h2><span style="font-family:'KaiTi_GB2312';font-size:18px;">2、从</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">HDFS</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">上导入数据到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></h2>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">   从</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">HDFS</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">导入数据的格式与从本地导入数据的格式差不多，其格式为：</span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;"></span><pre><code class="language-sql">LOAD DATA INPATH "path" OVERWRITE INTO TABLE tablename;</code></pre><br><span style="font-size:18px;font-family:'KaiTi_GB2312';">所不同的是少一个</span><span style="font-size:18px;font-family:'Times New Roman';">LOCAL</span><span style="font-size:18px;font-family:'KaiTi_GB2312';">。</span></div>
<h2><span style="font-family:'KaiTi_GB2312';font-size:18px;">3、从别的表中查询出相应的数据导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></h2>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">   从别的表中查询出相应的数据导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中的格式为：</span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;"></span><pre><code class="language-sql">INSERT OVERWRITE TABLE tablename_1 PATITION() SELECT ... FROM tablename_2 WHERE ...</code></pre><br><span style="font-size:18px;"><span style="font-family:'KaiTi_GB2312';">其中，</span><span style="font-family:'Times New Roman';">PATITION</span><span style="font-family:'KaiTi_GB2312';">指的是指定分区，</span><span style="font-family:'Times New Roman';">WHERE</span><span style="font-family:'KaiTi_GB2312';">是查询的条件，如下面的例子：</span></span></div>
<div style="text-align:center;"><span style="font-family:'KaiTi_GB2312';font-size:18px;"><img src="https://img-blog.csdn.net/20150804222005393?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></div>
<div><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表将查询的工作转换成</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">MapReduce</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">程序执行，执行完成后返回成功的标志。我们查询表</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">studentnotmp</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">：</span></div>
<div style="text-align:center;"><span style="font-family:'KaiTi_GB2312';font-size:18px;"><img src="https://img-blog.csdn.net/20150804222152124?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></div>
<h2><span style="font-family:'KaiTi_GB2312';font-size:18px;">4、在创建</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表时通过从别的表中查询并插入的方式将数据导入到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中</span></h2>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">格式</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">(CTAS)</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">：</span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;"></span><pre><code class="language-sql">CREATE TABLE IF NOT EXISTS tablename1...AS SELECT ...</code></pre><br><span style="font-family:'KaiTi_GB2312';"><span style="font-size:18px;">如下面的例子：</span></span></div>
<div style="text-align:center;"><span style="font-family:'KaiTi_GB2312';font-size:18px;"><img src="https://img-blog.csdn.net/20150804223041924?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">注意：</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">studentnotmp1</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">不能指定列。</span></div>
<h1><span style="font-family:'KaiTi_GB2312';font-size:18px;">二、从</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中将数据导出</span></h1>
<p><span style="font-family:'KaiTi_GB2312';font-size:18px;">   对于</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中的数据，有时需要将其导出，或是导出到本地，或是导出到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">HDFS</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">，再其次便是将其导入到另一张</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-family:'KaiTi_GB2312';font-size:18px;">表中。</span></p>
<h2><span style="font-family:'KaiTi_GB2312';font-size:18px;">1、导出到本地文件系统</span></h2>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;">格式：</span></div>
<div><span style="font-family:'KaiTi_GB2312';font-size:18px;"></span><pre><code class="language-sql">INSERT OVERWRITE LOCAL DIRECTORY ... SELECT * FROM ...;</code></pre>
<div><span style="font-size:18px;"><br></span></div>
<span style="font-size:18px;">例如：</span></div>
<div><span style="font-size:18px;"><img src="https://img-blog.csdn.net/20150804230043934?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span>
<h2><span style="font-size:18px;font-family:'KaiTi_GB2312';">2、导出到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">HDFS</span></span></h2>
</div>
<div><span style="font-size:18px;"><span style="font-family:'Times New Roman';">格式：</span></span></div>
<div><span style="font-size:18px;"><span style="font-family:'Times New Roman';"></span></span><pre><code class="language-sql">INSERT OVERWRITE DIRECTORY ... SELECT * FROM ...;</code></pre><br><h2><span style="font-size:18px;font-family:'KaiTi_GB2312';">3、导出到</span><span style="font-size:18px;"><span style="font-family:'Times New Roman';">Hive</span></span><span style="font-size:18px;font-family:'KaiTi_GB2312';">的另一张表中</span></h2>
</div>
<div><span style="font-size:18px;font-family:'KaiTi_GB2312';">与从别的表中查询出相应的结果插入到表中类似，其</span><span style="font-family:'KaiTi_GB2312';font-size:18px;">格式为：</span></div>
<div><pre><code class="language-sql">INSERT INTO ...</code></pre><br><br></div>
<div><br><br></div>
            </div>
                </div>