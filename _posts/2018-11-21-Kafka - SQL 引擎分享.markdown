---
layout:     post
title:      Kafka - SQL 引擎分享
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<table cellspacing="0" cellpadding="0" style="color:rgb(51,51,51);font-family:Arial;font-size:14px;line-height:26px;"><tbody><tr><td id="postmessage_174060" class="t_f" style="font-size:14px;">
<div align="left"><span style="font-weight:700;">问题导读：</span></div>
<br><div align="left"><span style="color:rgb(255,0,0);"><span style="font-weight:700;">1.在Kafka中使用SQL的流程是什么？</span></span></div>
<div align="left"><span style="color:rgb(255,0,0);"><span style="font-weight:700;">2.怎样配置Kafka，使得在Kafka中使用SQL？</span></span></div>
<span style="color:rgb(255,0,0);"><span style="font-weight:700;">3.在Kafka中使用SQL有哪些注意事项？</span></span><br><div align="left"><br><img id="aimg_ScXx0" class="zoom" border="0" alt="" src="http://www.aboutyun.com/static/image/hrline/4.gif" width="500" height="35" style="border:none;"></div>
<br><br><br><br><span style="font-weight:700;"><span style="font-size:24px;">1.概述</span></span>
<div align="left">　　大多数情况下，我们使用 Kafka 只是作为消息处理。在有些情况下，我们需要多次读取 Kafka 集群中的数据。当然，我们可以通过调用 Kafka 的 API 来完成，但是针对不同的业务需求，我们需要去编写不同的接口，在经过编译，打包，发布等一系列流程。最后才能看到我们预想的结果。那么，我们能不能有一种 简便的方式去实现这一部分功能，通过编写 SQL 的方式，来可视化我们的结果。今天，笔者给大家分享一些心得，通过使用
 SQL 的形式来完成这些需求。</div>
<br><span style="font-weight:700;"><span style="font-size:24px;">2.内容</span></span><br><div align="left">　　实现这些功能，其架构和思路并不复杂。这里笔者将整个实现流程，通过一个原理图来呈现。如下图所示：</div>
<br><div align="left"><img id="aimg_25076" class="zoom" src="http://www.aboutyun.com/data/attachment/forum/201606/11/145004nh2yma8dtihbncse.png" width="600" alt="" style="border:none;"></div>
<br><div align="left">　　这里笔者给大家详述一下上图的含义，消息数据源存放与 Kafka 集群当中，开启低阶和高阶两个消费线程，将消费的结果以 RPC 的方式共享出去（即：请求者）。数据共享出去后，回流经到 SQL 引擎处，将内存中的数据翻译成 SQL Tree，这里使用到了 Apache 的 Calcite 项目来承担这一部分工作。然后，我们通过 Thrift 协议来响应 Web Console 的 SQL 请求，最后将结果返回给前端，让其以图表的实行可视化。</div>
<br><span style="font-weight:700;"><span style="font-size:24px;">3.插件配置</span></span><br><div align="left">　　这里，我们需要遵循 Calcite 的 JSON Models，比如，针对 Kafka 集群，我们需要配置一下内容：<br></div>
<br><div>
<div style="font-size:12px;">[Plain Text] <span class="viewsource" style="color:rgb(51,102,153) !important;">纯文本查看</span> <span class="copycode" style="color:rgb(51,102,153) !important;">复制代码</span></div>
<div>
<div id="highlighter_348483" class="syntaxhighlighter notranslate text" style="font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;font-size:12px !important;">
<div class="toolbar" style="border:medium none;z-index:10 !important;line-height:1.1em !important;min-height:auto !important;color:#FFFFFF !important;font-size:10px !important;vertical-align:baseline !important;overflow:visible !important;background:rgb(108,226,108);">
<span><a class="toolbar_item command_help help" href="http://www.aboutyun.com/#" rel="nofollow" style="border:0px;color:#FFFFFF !important;text-decoration:none !important;text-align:center !important;line-height:1.1em !important;min-height:auto !important;display:block !important;font-size:12px !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">?</a></span></div>
<table border="0" cellspacing="0" cellpadding="0" style="border:0px;border-collapse:collapse;table-layout:fixed;line-height:1.1em !important;min-height:auto !important;font-size:12px !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;"><tbody style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;"><tr style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;"><td class="gutter" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:rgb(175,175,175) !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">
<div class="line number1 index0 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
01</div>
<div class="line number2 index1 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
02</div>
<div class="line number3 index2 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
03</div>
<div class="line number4 index3 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
04</div>
<div class="line number5 index4 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
05</div>
<div class="line number6 index5 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
06</div>
<div class="line number7 index6 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
07</div>
<div class="line number8 index7 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
08</div>
<div class="line number9 index8 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
09</div>
<div class="line number10 index9 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
10</div>
<div class="line number11 index10 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
11</div>
<div class="line number12 index11 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
12</div>
<div class="line number13 index12 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
13</div>
<div class="line number14 index13 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
14</div>
</td>
<td class="code" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">
<div style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">
<div class="line number1 index0 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">{</code></div>
<div class="line number2 index1 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">    </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">version:
 '1.0',</code></div>
<div class="line number3 index2 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">    </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">defaultSchema:
 'kafka',  </code></div>
<div class="line number4 index3 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">    </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">schemas:
 [  </code></div>
<div class="line number5 index4 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">        </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">{</code></div>
<div class="line number6 index5 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">name:
 'kafka',  </code></div>
<div class="line number7 index6 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">type:
 'custom',</code></div>
<div class="line number8 index7 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">factory:
 'cn.smartloli.kafka.visual.engine.KafkaMemorySchemaFactory',  </code></div>
<div class="line number9 index8 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">operand:
 {</code></div>
<div class="line number10 index9 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">                </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">database:
 'kafka_db'</code></div>
<div class="line number11 index10 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">} </code></div>
<div class="line number12 index11 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">        </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">}</code></div>
<div class="line number13 index12 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">    </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">]</code></div>
<div class="line number14 index13 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">}</code></div>
</div>
</td>
</tr></tbody></table></div>
</div>
</div>
<br><br><div align="left">　　另外，这里最好对表也做一个表述，配置内容如下所示：<br></div>
<br><div>
<div style="font-size:12px;">[Plain Text] <span class="viewsource" style="color:rgb(51,102,153) !important;">纯文本查看</span> <span class="copycode" style="color:rgb(51,102,153) !important;">复制代码</span></div>
<div>
<div id="highlighter_783858" class="syntaxhighlighter notranslate text" style="font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;font-size:12px !important;">
<div class="toolbar" style="border:medium none;z-index:10 !important;line-height:1.1em !important;min-height:auto !important;color:#FFFFFF !important;font-size:10px !important;vertical-align:baseline !important;overflow:visible !important;background:rgb(108,226,108);">
<span><a class="toolbar_item command_help help" href="http://www.aboutyun.com/#" rel="nofollow" style="border:0px;color:#FFFFFF !important;text-decoration:none !important;text-align:center !important;line-height:1.1em !important;min-height:auto !important;display:block !important;font-size:12px !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">?</a></span></div>
<table border="0" cellspacing="0" cellpadding="0" style="border:0px;border-collapse:collapse;table-layout:fixed;line-height:1.1em !important;min-height:auto !important;font-size:12px !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;"><tbody style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;"><tr style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;"><td class="gutter" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;color:rgb(175,175,175) !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">
<div class="line number1 index0 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
01</div>
<div class="line number2 index1 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
02</div>
<div class="line number3 index2 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
03</div>
<div class="line number4 index3 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
04</div>
<div class="line number5 index4 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
05</div>
<div class="line number6 index5 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
06</div>
<div class="line number7 index6 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
07</div>
<div class="line number8 index7 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
08</div>
<div class="line number9 index8 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
09</div>
<div class="line number10 index9 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
10</div>
<div class="line number11 index10 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
11</div>
<div class="line number12 index11 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
12</div>
<div class="line number13 index12 alt2" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
13</div>
<div class="line number14 index13 alt1" style="border-right-width:3px;border-right-style:solid;border-right-color:rgb(108,226,108);text-align:right !important;line-height:1.1em !important;min-height:auto !important;border-top-width:0px !important;border-bottom-width:0px !important;vertical-align:baseline !important;overflow:visible !important;border-left-width:0px !important;">
14</div>
</td>
<td class="code" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">
<div style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">
<div class="line number1 index0 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">[</code></div>
<div class="line number2 index1 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">    </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">{</code></div>
<div class="line number3 index2 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">        </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"table":"Kafka",</code></div>
<div class="line number4 index3 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">        </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"schemas":{</code></div>
<div class="line number5 index4 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"_plat":"varchar",</code></div>
<div class="line number6 index5 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"_uid":"varchar",</code></div>
<div class="line number7 index6 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"_tm":"varchar",</code></div>
<div class="line number8 index7 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"ip":"varchar",</code></div>
<div class="line number9 index8 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"country":"varchar",</code></div>
<div class="line number10 index9 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"city":"varchar",</code></div>
<div class="line number11 index10 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">            </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">"location":"jsonarray"</code></div>
<div class="line number12 index11 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">        </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">}</code></div>
<div class="line number13 index12 alt2" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text spaces" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">    </code><code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">}</code></div>
<div class="line number14 index13 alt1" style="border:0px;line-height:1.1em !important;min-height:auto !important;vertical-align:baseline !important;overflow:visible !important;">
<code class="text plain" style="border:0px;line-height:1.1em !important;min-height:auto !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;vertical-align:baseline !important;overflow:visible !important;background:transparent none repeat scroll 0% 0%;">]</code></div>
</div>
</td>
</tr></tbody></table></div>
</div>
</div>
<br><br><span style="font-weight:700;"><span style="font-size:24px;">4.操作</span></span><br><div align="left">　　下面，笔者给大家演示通过 SQL 来操作相关内容。相关截图如下所示：</div>
<br><div align="left"><img id="aimg_25077" class="zoom" src="http://www.aboutyun.com/data/attachment/forum/201606/11/145225emb9jwovgvl10bw5.png" width="600" alt="" style="border:none;"></div>
<br><div align="left">　　在查询处，填写相关 SQL 查询语句。点击 Table 按钮，得到如下所示结果：</div>
<br><img id="aimg_25078" class="zoom" src="http://www.aboutyun.com/data/attachment/forum/201606/11/145256weu8a4b4gobgqro8.png" width="600" alt="" style="border:none;"> <br><br><div align="left">　　我们，可以将获取的结果以报表的形式进行导出。</div>
<br><img id="aimg_25079" class="zoom" src="http://www.aboutyun.com/data/attachment/forum/201606/11/145317gbbpzijj0iu1ui1h.png" width="600" alt="" style="border:none;"> <br><br><div align="left">　　当然，我们可以在 Profile 模块下，浏览查询历史记录和当前正在运行的查询任务。至于其他模块，都属于辅助功能（展示集群信息，Topic 的 Partition 信息等）这里就不多赘述了。</div>
<br><span style="font-weight:700;"><span style="font-size:24px;">5.总结</span></span><br><div align="left">　　分析下来，整体架构和实现的思路都不算太复杂，也不存在太大的难点，需要注意一些实现上的细节，比如消费 API 针对集群消息参数的调整，特别是低阶消费 API，尤为需要注意，其 fetch_size 的大小，以及 offset 是需要我们自己维护的。在使用 Calcite 作为 SQL 树时，我们要遵循其 JSON Model 和标准的 SQL 语法来操作数据源。</div>
<div><br></div>
</td>
</tr></tbody></table>            </div>
                </div>