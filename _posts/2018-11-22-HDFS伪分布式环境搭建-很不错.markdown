---
layout:     post
title:      HDFS伪分布式环境搭建-很不错
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <h1 class="artical-title" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;line-height:1.5;font-weight:normal;color:rgb(51,51,51);text-align:left;">HDFS伪分布式环境搭建</h1><div class="artical-title-list" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;border-bottom:1px solid rgb(204,204,204);color:rgb(51,51,51);font-size:14px;text-align:left;"><a class="tab original fl" style="color:rgb(249,111,133);line-height:18px;font-size:12px;border:1px solid rgb(249,111,133);">原创</a><a href="http://blog.51cto.com/zero01" rel="nofollow" class="name fl" style="color:rgb(66,133,244);line-height:18px;">ZeroOne01</a><span class="fl" style="width:4px;background:rgb(153,153,153);vertical-align:middle;"></span><a class="time fl" style="color:rgb(153,153,153);line-height:18px;">2018-03-24 19:51:20</a><span class="fl" style="width:4px;background:rgb(153,153,153);vertical-align:middle;"></span><a href="http://blog.51cto.com/zero01/2090716#comment" rel="nofollow" class="comment fl" style="color:rgb(153,153,153);line-height:18px;">评论(0)</a><a class="read fr" style="color:rgb(153,153,153);line-height:18px;">655人阅读</a><div class="clear" style="clear:both;width:0px;"></div></div><div class="artical-content-bak main-content" style="font-family:'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;color:rgb(51,51,51);line-height:1.5;text-align:left;"><div class="con artical-content editor-preview-side" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;"><h3 style="color:rgb(61,70,77);">HDFS概述及设计目标</h3><p style="color:rgb(61,70,77);line-height:1.8;">什么是HDFS：</p><ul><li style="margin-left:0px;">是Hadoop实现的一个分布式文件系统（Hadoop Distributed File System），简称HDFS</li><li style="margin-left:0px;">源自于Google的GFS论文</li><li style="margin-left:0px;">论文发表于2003年，HDFS是GFS的克隆版</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">HDFS的设计目标：</p><ul><li style="margin-left:0px;">非常巨大的分布式文件系统</li><li style="margin-left:0px;">运行在普通廉价的硬件上</li><li style="margin-left:0px;">易扩展、为用户×××能不错的文件存储服务，也就是容错性</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">HDFS官方文档地址如下：</p><blockquote style="color:rgb(129,145,152);border-left:solid rgb(66,133,244);background:rgb(242,245,249);"><p style="color:rgb(61,70,77);line-height:1.8;"><a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html" rel="nofollow" style="color:rgb(66,133,244);">https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html</a></p></blockquote><hr style="background-color:rgb(239,240,241);border-width:0px;"><h3 style="color:rgb(61,70,77);">HDFS架构</h3><p style="color:rgb(61,70,77);line-height:1.8;">HDFS是主/从式的架构。一个HDFS集群会有一个NameNode（简称NN），也就是命名节点，该节点作为主服务器存在（master server）。NameNode用于管理文件系统的命名空间以及调节客户访问文件。此外，还会有多个DataNode（简称DN），也就是数据节点，数据节点作为从节点存在（slave server）。通常每一个集群中的DataNode，都会被NameNode所管理，DataNode用于存储数据。</p><p style="color:rgb(61,70,77);line-height:1.8;">HDFS公开了文件系统名称空间，允许用户将数据存储在文件中，就好比我们平时使用操作系统中的文件系统一样，用户无需关心底层是如何存储数据的。而在底层，一个文件会被分成一个或多个数据块，这些数据库块会被存储在一组数据节点中。在CDH中数据块的默认大小是128M，这个大小我们可以通过配置文件进行调节。在NameNode上我们可以执行文件系统的命名空间操作，如打开，关闭，重命名文件等。这也决定了数据块到数据节点的映射。</p><p style="color:rgb(61,70,77);line-height:1.8;">我们可以来看看HDFS的架构图：<br><img src="http://i2.51cto.com/images/blog/201803/24/d925720258a15e4cd4dfcf497b5b1f52.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">HDFS被设计为可以运行在普通的廉价机器上，而这些机器通常运行着一个Linux操作系统。HDFS是使用java语言编写的，任何支持java的机器都可以运行HDFS。使用高度可移植的java语言编写的HDFS，意味着可以部署在广泛的机器上。一个典型的HDFS集群部署会有一个专门的机器只能运行NameNode，而其他集群中的机器各自运行一个DataNode实例。虽然一台机器上也可以运行多个节点，但是并不建议这么做，除非是学习环境。</p><p style="color:rgb(61,70,77);line-height:1.8;">总结：</p><ul><li style="margin-left:0px;">HDFS是主/从式的架构，一个HDFS集群会有一个NameNode以及多个DataNode</li><li style="margin-left:0px;">一个文件会被拆分为多个数据块进行存储，默认数据块大小是128M</li><li style="margin-left:0px;">即便一个数据块大小为130M，也会被拆分为2个Block，一个大小为128M，一个大小为2M</li><li style="margin-left:0px;">HDFS是使用Java编写的，使得其可以运行在安装了JDK的操作系统之上</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">NN：</p><ul><li style="margin-left:0px;">负责客户端请求的响应</li><li style="margin-left:0px;">负责元数据（文件的名称、副本系数、Block存放的DN）的管理</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">DN：</p><ul><li style="margin-left:0px;">存储用户的文件对应的数据块（Block）</li><li style="margin-left:0px;">会定期向NN发送心跳信息，汇报本身及其所有的block信息和健康状况</li></ul><hr style="background-color:rgb(239,240,241);border-width:0px;"><h3 style="color:rgb(61,70,77);">HDFS副本机制</h3><p style="color:rgb(61,70,77);line-height:1.8;">在HDFS中，一个文件会被拆分为一个或多个数据块。默认情况下，每个数据块都会有三个副本。每个副本都会被存放在不同的机器上，而且每一个副本都有自己唯一的编号。</p><p style="color:rgb(61,70,77);line-height:1.8;">如下图：<br><img src="http://i2.51cto.com/images/blog/201803/24/7e142940a0feb4c119be2d8df7fad13c.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><hr style="background-color:rgb(239,240,241);border-width:0px;"><h3 style="color:rgb(61,70,77);">HDFS副本存放策略</h3><p style="color:rgb(61,70,77);line-height:1.8;">NameNode节点选择一个DataNode节点去存储block副本得过程就叫做副本存放，这个过程的策略其实就是在可靠性和读写带宽间得权衡。</p><p style="color:rgb(61,70,77);line-height:1.8;">《Hadoop权威指南》中的默认方式：</p><ul><li style="margin-left:0px;">第一个副本会随机选择，但是不会选择存储过满的节点。</li><li style="margin-left:0px;">第二个副本放在和第一个副本不同且随机选择的机架上。</li><li style="margin-left:0px;">第三个和第二个放在同一个机架上的不同节点上。</li><li style="margin-left:0px;">剩余的副本就完全随机节点了。</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">如下图：<br><img src="http://i2.51cto.com/images/blog/201803/24/41a1749eb547c89dbb14d5c9dae4353e.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">可以看出这个方案比较合理：</p><ol><li>可靠性：block存储在两个机架上</li><li>写带宽：写操作仅仅穿过一个网络交换机</li><li>读操作：选择其中得一个机架去读</li><li>block分布在整个集群上。</li></ol><hr style="background-color:rgb(239,240,241);border-width:0px;"><h3 style="color:rgb(61,70,77);">HDFS伪分布式环境搭建</h3><p style="color:rgb(61,70,77);line-height:1.8;">官方安装文档地址如下：</p><blockquote style="color:rgb(129,145,152);border-left:solid rgb(66,133,244);background:rgb(242,245,249);"><p style="color:rgb(61,70,77);line-height:1.8;"><a href="http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.7.0/hadoop-project-dist/hadoop-common/SingleCluster.html" rel="nofollow" style="color:rgb(66,133,244);">http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.7.0/hadoop-project-dist/hadoop-common/SingleCluster.html</a></p></blockquote><p style="color:rgb(61,70,77);line-height:1.8;">环境描述：</p><ul><li style="margin-left:0px;">CentOS7.3</li><li style="margin-left:0px;">JDK1.8</li><li style="margin-left:0px;">Hadoop 2.6.0-cdh5.7.0</li><li style="margin-left:0px;">ssh</li><li style="margin-left:0px;">rsync</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">下载Hadoop 2.6.0-cdh5.7.0的tar.gz包并解压：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># cd /usr/local/src/</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/src]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># wget http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.7.0.tar.gz</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/src]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># tar -zxvf hadoop-2.6.0-cdh5.7.0.tar.gz -C /usr/local/</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">注：如果在Linux上下载得很慢的话，可以在windows的迅雷上使用这个链接进行下载。然后再上传到Linux中，这样就会快一些。</p><p style="color:rgb(61,70,77);line-height:1.8;">解压完后，进入到解压后的目录下，可以看到hadoop的目录结构如下：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/src]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># cd /usr/local/hadoop-2.6.0-cdh5.7.0/</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># ls</span>
bin             cloudera  examples             include  libexec      NOTICE.txt  sbin   src
bin-mapreduce1  etc       examples-mapreduce1  lib      LICENSE.txt  README.txt  share
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;">#</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">简单说明一下其中几个目录存放的东西：</p><ul><li style="margin-left:0px;">bin目录存放可执行文件</li><li style="margin-left:0px;">etc目录存放配置文件</li><li style="margin-left:0px;">sbin目录下存放服务的启动命令</li><li style="margin-left:0px;">share目录下存放jar包与文档</li></ul><p style="color:rgb(61,70,77);line-height:1.8;">以上就算是把hadoop给安装好了，接下来就是编辑配置文件，把JAVA_HOME配置一下：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># cd etc/</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/etc]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># cd hadoop</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/etc/hadoop]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># vim hadoop-env.sh</span>
<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">export</span> JAVA_HOME=/usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/jdk1.8/  <span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># 根据你的环境变量进行修改</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">由于我们要进行的是单节点伪分布式环境的搭建，所以还需要配置两个配置文件，分别是core-site.xml以及hdfs-site.xml，如下：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/etc/hadoop]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># vim core-site.xml  # 增加如下内容</span>
&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;fs.defaultFS&lt;/name&gt;
        &lt;value&gt;hdfs://192.168.77.130:8020&lt;/value&gt;  <span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># 指定默认的访问地址以及端口号</span>
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;  <span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># 指定临时文件所存放的目录</span>
        &lt;value&gt;/data/tmp/&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/etc/hadoop]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># mkdir /data/tmp/</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/etc/hadoop]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># vim hdfs-site.xml  # 增加如下内容</span>
&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;dfs.replication&lt;/name&gt;  <span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># 指定只产生一个副本</span>
        &lt;value&gt;1&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;</code></pre><p style="color:rgb(61,70,77);line-height:1.8;">然后配置一下密钥对，设置本地免密登录，搭建伪分布式的话这一步是必须的：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="hljs ruby" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa</span>
Generating public/private dsa key pair.
Your identification has been saved <span class="hljs-keyword" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(51,51,51);font-weight:bold;">in</span> /root/.ssh/id_dsa.
Your public key has been saved <span class="hljs-keyword" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(51,51,51);font-weight:bold;">in</span> /root/.ssh/id_dsa.pub.
The key fingerprint <span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">is:</span>
<span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">c2:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">41</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">89</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">65</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:bd</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">04</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">9</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">e:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">3</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">e:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">3</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">f:</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">f9:</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">a7:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">51</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:cd</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:e9</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:cf</span><span class="hljs-symbol" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,0,115);">:</span><span class="hljs-number" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">1</span>e root@localhost
The key<span class="hljs-string" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(221,17,68);">'s randomart image is:
+--[ DSA 1024]----+
|     o=+         |
|    .+..o        |
|      +. .       |
|     o ..    o . |
|      = S   . +  |
|       + . . .   |
|        + .   .E |
|         o ..  o.|
|          oo   .+|
+-----------------+
[root@localhost ~]# cat ~/.ssh/id_dsa.pub &gt;&gt; ~/.ssh/authorized_keys
[root@localhost ~]# ssh localhost
ssh_exchange_identification: read: Connection reset by peer
[root@localhost ~]# </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">如上，测试本地免密登录的时候报了个<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.6;color:rgb(51,51,51);background-color:rgb(242,245,249);">ssh_exchange_identification: read: Connection reset by peer</code>错误，于是着手排查错误，发现是<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.6;color:rgb(51,51,51);background-color:rgb(242,245,249);">/etc/hosts.allow</code>文件里限制了IP，于是修改一下该配置文件即可，如下：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># vim /etc/hosts.allow  #  修改为 sshd: ALL</span>
[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># service sshd restart</span>
[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># ssh localhost  # 测试登录成功</span>
Last login: Sat Mar 24 21:56:38 2018 from localhost
[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># logout</span>
Connection to localhost closed.
[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">接下来就可以启动HDFS了，不过在启动之前需要先格式化文件系统：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># /usr/local/hadoop-2.6.0-cdh5.7.0/bin/hdfs namenode -format</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">注：只有第一次启动才需要格式化</p><p style="color:rgb(61,70,77);line-height:1.8;">使用服务启动脚本启动服务：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># /usr/local/hadoop-2.6.0-cdh5.7.0/sbin/start-dfs.sh</span>
18/03/24 21:59:03 WARN util.NativeCodeLoader: Unable to load native-hadoop library <span class="hljs-keyword" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(51,51,51);font-weight:bold;">for</span> your platform... using <span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">builtin</span>-java classes <span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">where</span> applicable
Starting namenodes on [192.168.77.130]
192.168.77.130: namenode running as process 8928. Stop it first.
localhost: starting datanode, logging to /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/logs/hadoop-root-datanode-localhost.out
Starting secondary namenodes [0.0.0.0]
The authenticity of host <span class="hljs-string" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(221,17,68);">'0.0.0.0 (0.0.0.0)'</span> can<span class="hljs-string" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(221,17,68);">'t be established.
ECDSA key fingerprint is 63:74:14:e8:15:4c:45:13:9e:16:56:92:6a:8c:1a:84.
Are you sure you want to continue connecting (yes/no)? yes  # 第一次启动会询问是否连接节点
0.0.0.0: Warning: Permanently added '</span>0.0.0.0<span class="hljs-string" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(221,17,68);">' (ECDSA) to the list of known hosts.
0.0.0.0: starting secondarynamenode, logging to /usr/local/hadoop-2.6.0-cdh5.7.0/logs/hadoop-root-secondarynamenode-localhost.out
18/03/24 21:59:22 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[root@localhost ~]# jps  # 检查是否有以下几个进程，如果少了一个都是不成功的
8928 NameNode
9875 Jps
9578 DataNode
9757 SecondaryNameNode
[root@localhost ~]# netstat -lntp |grep java  # 检查端口
tcp        0      0 0.0.0.0:50090           0.0.0.0:*               LISTEN      9757/java           
tcp        0      0 192.168.77.130:8020     0.0.0.0:*               LISTEN      8928/java           
tcp        0      0 0.0.0.0:50070           0.0.0.0:*               LISTEN      8928/java           
tcp        0      0 0.0.0.0:50010           0.0.0.0:*               LISTEN      9578/java           
tcp        0      0 0.0.0.0:50075           0.0.0.0:*               LISTEN      9578/java           
tcp        0      0 0.0.0.0:50020           0.0.0.0:*               LISTEN      9578/java           
tcp        0      0 127.0.0.1:53703         0.0.0.0:*               LISTEN      9578/java           
[root@localhost ~]# </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">然后将Hadoop的安装目录配置到环境变量中，方便之后使用它的命令：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># vim ~/.bash_profile  # 增加以下内容</span>
<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">export</span> HADOOP_HOME=/usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/hadoop-2.6.0-cdh5.7.0/
<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">export</span> PATH=<span class="hljs-variable" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">$HADOOP_HOME</span>/bin:<span class="hljs-variable" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,128,128);">$PATH</span>
[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># source !$</span>
<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">source</span> ~/.bash_profile
[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;">#</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">确认服务启动成功后，使用浏览器访问<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.6;color:rgb(51,51,51);background-color:rgb(242,245,249);">192.168.77.130:50070</code>，会访问到如下页面：<br><img src="http://i2.51cto.com/images/blog/201803/24/12b780ba5ae4be7690e004a69bef33eb.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">点击Live Nodes查看活着的节点：<br><img src="http://i2.51cto.com/images/blog/201803/24/fd9bb902c8db497e3ac8d73c3e78f910.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">如上，可以看到节点的信息。到此，我们伪分布式的hadoop集群就搭建完成了。</p><hr style="background-color:rgb(239,240,241);border-width:0px;"><h3 style="color:rgb(61,70,77);">HDFS shell操作</h3><p style="color:rgb(61,70,77);line-height:1.8;">以上已经介绍了如何搭建伪分布式的Hadoop，既然环境已经搭建起来了，那要怎么去操作呢？这就是本节将要介绍的内容：</p><p style="color:rgb(61,70,77);line-height:1.8;">HDFS自带有一些shell命令，通过这些命令我们可以去操作HDFS文件系统，这些命令与Linux的命令挺相似的，如果熟悉Linux的命令很容易就可以上手HDFS的命令，关于这些命令的官方文档地址如下：</p><blockquote style="color:rgb(129,145,152);border-left:solid rgb(66,133,244);background:rgb(242,245,249);"><p style="color:rgb(61,70,77);line-height:1.8;"><a href="http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.7.0/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapredCommands.html" rel="nofollow" style="color:rgb(66,133,244);">http://archive.cloudera.com/cdh5/cdh/5/hadoop-2.6.0-cdh5.7.0/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapredCommands.html</a></p></blockquote><p style="color:rgb(61,70,77);line-height:1.8;">以下介绍几个常用的命令：</p><p style="color:rgb(61,70,77);line-height:1.8;">首先我们创建一个测试文件：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost ~]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># cd /data/</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># vim hello.txt  # 随便写一些内容</span>
hadoop welcome
hadoop hdfs mapreduce
hadoop hdfs
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">1.查看文件系统的根目录：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -ls /</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;">#</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">2.将刚刚创建的文件拷贝到文件系统的根目录下：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -put ./hello.txt /</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -ls /</span>
Found 1 items
-rw-r--r--   1 root supergroup         49 2018-03-24 22:37 /hello.txt
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">3.查看文件内容：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -cat /hello.txt</span>
hadoop welcome
hadoop hdfs mapreduce
hadoop hdfs
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">4.创建目录：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -mkdir /test</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -ls /</span>
Found 2 items
-rw-r--r--   1 root supergroup         49 2018-03-24 22:37 /hello.txt
drwxr-xr-x   - root supergroup          0 2018-03-24 22:40 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">5.递归创建目录：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -mkdir -p /test/a/b/c</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">6.递归查看目录：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="hljs bash" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -ls -R /</span>
-rw-r--r--   1 root supergroup         49 2018-03-24 23:02 /hello.txt
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a/b
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a/b/c
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">7.拷贝文件：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -copyFromLocal ./hello.txt /test/a/b</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -ls -R /</span>
-rw-r--r--   1 root supergroup         49 2018-03-24 23:02 /hello.txt
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a
drwxr-xr-x   - root supergroup          0 2018-03-24 23:06 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a/b
drwxr-xr-x   - root supergroup          0 2018-03-24 23:04 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a/b/c
-rw-r--r--   1 root supergroup         49 2018-03-24 23:06 /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>/a/b/hello.txt
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">8.从文件系统中拿出文件：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -get /test/a/b/hello.txt</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">9.删除文件：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -rm /hello.txt</span>
Deleted /hello.txt
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">10.删除目录：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -rm -R /test</span>
Deleted /<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">test</span>
[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># </span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">以上就是最为常用的一些操作命令了，如果需要使用其他命令，直接执行<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.6;color:rgb(51,51,51);background-color:rgb(242,245,249);">hdfs dfs</code>就可以查看到所支持的所有命令。</p><p style="color:rgb(61,70,77);line-height:1.8;">接下来我们在浏览器里查看文件系统，首先将刚刚删除的文件put回去：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -put ./hello.txt /</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">在浏览器上查看文件系统：<br><img src="http://i2.51cto.com/images/blog/201803/24/2d7fe35badc18dcbf60fe616d42e53c2.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">查看文件的信息：<br><img src="http://i2.51cto.com/images/blog/201803/24/9723de29ea509a7af075e177a46bc826.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">可以看到关于该文件的详细信息：<br><img src="http://i2.51cto.com/images/blog/201803/24/a82b8faf1327b0830c0999b805ff74a3.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p><p style="color:rgb(61,70,77);line-height:1.8;">由于这个文件太小了，所以只有一个数据块。</p><p style="color:rgb(61,70,77);line-height:1.8;">我们来put一个比较大的文件，例如我们之前使用的Hadoop的安装包：</p><pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;line-height:1.45;color:rgb(86,116,130);background:rgb(242,245,249);"><code class="language-bash hljs" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(51,51,51);background-color:transparent;line-height:inherit;border:0px;">[root@localhost /data]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># cd /usr/local/src/</span>
[root@localhost /usr/<span class="hljs-built_in" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(0,134,179);">local</span>/src]<span class="hljs-comment" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,136);font-style:italic;"># hdfs dfs -put ./hadoop-2.6.0-cdh5.7.0.tar.gz /</span></code></pre><p style="color:rgb(61,70,77);line-height:1.8;">如下，可以看到，这个文件被分为了三个数据块：<br><img src="http://i2.51cto.com/images/blog/201803/24/d95d4e22fa0735255dc50f1010e4c7d8.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="HDFS伪分布式环境搭建" style="border:none;"></p></div></div><div class="artical-copyright" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(153,153,153);line-height:1;border-top:1px dashed rgb(204,204,204);border-bottom:1px dashed rgb(204,204,204);font-size:14px;text-align:left;">版权声明：原创作品，如需转载，请注明出处。否则将追究法律责任</div><div class="for-tag" style="font-family:'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;color:rgb(51,51,51);font-size:14px;text-align:left;"><span style="line-height:26px;color:rgb(144,144,144);background:rgb(239,239,239);"><a href="http://blog.51cto.com/search/result?q=Hadoop" rel="nofollow" style="color:rgb(51,51,51);">Hadoop</a></span><span style="line-height:26px;color:rgb(144,144,144);background:rgb(239,239,239);"><a href="http://blog.51cto.com/search/result?q=HDFS" rel="nofollow" style="color:rgb(51,51,51);">HDFS</a></span><span style="line-height:26px;color:rgb(144,144,144);background:rgb(239,239,239);"><a href="http://blog.51cto.com/search/result?q=%E5%A4%A7%E6%95%B0%E6%8D%AE" rel="nofollow" style="color:rgb(51,51,51);">大数据</a></span></div>            </div>
                </div>