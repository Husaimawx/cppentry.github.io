---
layout:     post
title:      Hbase编程入门之MapReduce
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p>refer to: http://blog.csdn.net/darke1014/article/details/8665484</p>
<p></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
Tips：如果用Eclipse开发，需要加入hadoop所有的jar包以及HBase三个jar包（hbase，zooKooper，protobuf-java）。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
下面介绍一下，用mapreduce怎样操作HBase，主要对HBase中的数据进行读取。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<span style="font-size:24px;"><strong>案例一：</strong></span><br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<strong>首先先介绍下如何上传数据，还是以最熟悉到wordcount案例开始，我们的目的是将wordcount的结果存储到Hbase而不是HDFS下。</strong></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
给出代码：</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> test1;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.io.IOException;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.StringTokenizer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.conf.Configuration;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.fs.Path;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.IntWritable;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.Text;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Job;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Mapper;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Reducer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.util.GenericOptionsParser;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HBaseConfiguration;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HColumnDescriptor;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HTableDescriptor;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.HBaseAdmin;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.Put;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.io.ImmutableBytesWritable;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableOutputFormat;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableReducer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.util.Bytes;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> WordCountHBase {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> TokenizerMapper   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Mapper&lt;Object, Text, Text, IntWritable&gt;{  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> IntWritable one = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> IntWritable(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> Text word = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Text();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//map函数没有改变</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> map(Object key, Text value, Context context  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                    ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      StringTokenizer itr = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> StringTokenizer(value.toString());  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (itr.hasMoreTokens()) {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        word.set(itr.nextToken());  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        context.write(word, one);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
map函数没有改变<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//Reduce类,主要是将键值传到HBase表中</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> IntSumReducer   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> TableReducer &lt;Text,IntWritable,ImmutableBytesWritable&gt; {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> IntWritable result = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> IntWritable();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> reduce(Text key, Iterable&lt;IntWritable&gt; values,   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                     Context context  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                     ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> sum = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">for</span><span style="border:none;background-color:inherit;"> (IntWritable val : values) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      sum += val.get();  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    result.set(sum);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    Put put = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Put(key.getBytes());  </span><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//put实例化，每一个词存一行</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//列族为content，列修饰符为count，列值为数目</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    put.add(Bytes.toBytes(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"content"</span><span style="border:none;background-color:inherit;">), Bytes.toBytes(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"count"</span><span style="border:none;background-color:inherit;">), Bytes.toBytes(String.valueOf(sum)));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    context.write(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> ImmutableBytesWritable(key.getBytes()), put);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
由上面可知IntSumReducer继承自TableReduce，在hadoop里面TableReducer继承Reducer类。它的原型为：TableReducer&lt;KeyIn,Values,KeyOut&gt;可以看出，HBase里面是读出的Key类型是ImmutableBytesWritable，意为不可变类型，因为HBase里所有数据都是用字符串存储的。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">  </span><span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@SuppressWarnings</span><span style="border:none;background-color:inherit;">(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"deprecation"</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> main(String[] args) </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> Exception {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      String tablename  = <span class="string" style="border:none;color:#0000FF;background-color:inherit;">"wordcount"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//实例化Configuration，注意不能用 new HBaseConfiguration()了。</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     Configuration conf = HBaseConfiguration.create();  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     HBaseAdmin admin = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HBaseAdmin(conf);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="border:none;background-color:inherit;">(admin.tableExists(tablename)){  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">         System.out.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"table exists! recreating ..."</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">         admin.disableTable(tablename);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">         admin.deleteTable(tablename);  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     HTableDescriptor htd = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HTableDescriptor(tablename);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     HColumnDescriptor hcd = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HColumnDescriptor(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"content"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     htd.addFamily(hcd);        <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//创建列族</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">     admin.createTable(htd);    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//创建表</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    String[] otherArgs = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> GenericOptionsParser(conf, args).getRemainingArgs();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="border:none;background-color:inherit;"> (otherArgs.length != </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      System.err.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"Usage: wordcount &lt;in&gt; &lt;out&gt;"</span><span style="border:none;background-color:inherit;">+otherArgs.length);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      System.exit(<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    Job job = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Job(conf, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"word count"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setJarByClass(WordCountHBase.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setMapperClass(TokenizerMapper.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//job.setCombinerClass(IntSumReducer.class);</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    FileInputFormat.addInputPath(job, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(otherArgs[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">]));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//此处的TableMapReduceUtil注意要用hadoop.hbase.mapreduce包中的，而不是hadoop.hbase.mapred包中的</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    TableMapReduceUtil.initTableReducerJob(tablename, IntSumReducer.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">, job);      </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//key和value到类型设定最好放在initTableReducerJob函数后面，否则会报错</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setOutputKeyClass(Text.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setOutputValueClass(IntWritable.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    System.exit(job.waitForCompletion(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">true</span><span style="border:none;background-color:inherit;">) ? </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;"> : </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<span style="font-family:Arial;font-size:14px;line-height:26px;">在job配置的时候没有设置 job.setReduceClass(); 而是用 </span><span style="font-family:Arial;font-size:14px;line-height:26px;"><strong>TableMapReduceUtil.initTableReducerJob</strong>(</span><span style="font-family:Arial;font-size:14px;line-height:26px;">tablename,
 IntSumReducer.class, job</span><span style="font-family:Arial;font-size:14px;line-height:26px;">);</span><span style="font-family:Arial;font-size:14px;line-height:26px;"> 来执行reduce类。</span>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
需要注意的是此处的TableMapReduceUtil是hadoop.hbase.mapreduce包中的，而不是hadoop.hbase.mapred包中的，否则会报错。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<span style="font-size:24px;"><strong><br></strong></span></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<span style="font-size:24px;"><strong>案例二：</strong></span><br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<strong>下面再介绍下如何进行读取，读取数据时比较简单，编写Mapper函数，读取&lt;key,value&gt;值就行了，Reducer函数直接输出得到的结果就行了。</strong><br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> test1;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.io.IOException;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.StringTokenizer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.conf.Configuration;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.fs.Path;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.IntWritable;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.Text;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Job;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Mapper;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Reducer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.util.GenericOptionsParser;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HBaseConfiguration;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HColumnDescriptor;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HTableDescriptor;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.HBaseAdmin;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.Put;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.Result;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.Scan;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.io.ImmutableBytesWritable;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableMapReduceUtil;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableMapper;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableOutputFormat;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableReducer;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.util.Bytes;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> test1.WordCount.IntSumReducer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> com.sun.corba.se.impl.encoding.OSFCodeSetRegistry.Entry;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> ReadHBase {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> TokenizerMapper   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> TableMapper&lt;Text, Text&gt;{  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> map(ImmutableBytesWritable row, Result values, Context context  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                    ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        StringBuffer sb = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> StringBuffer(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">""</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">for</span><span style="border:none;background-color:inherit;">(java.util.Map.Entry&lt;</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[],</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt; value : values.getFamilyMap(  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                <span class="string" style="border:none;color:#0000FF;background-color:inherit;">"content"</span><span style="border:none;background-color:inherit;">.getBytes()).entrySet()){  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">            String str = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> String(value.getValue());  </span><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//将字节数组转换成String类型，需要new String();</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">            <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="border:none;background-color:inherit;">(str != </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">null</span><span style="border:none;background-color:inherit;">){  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                sb.append(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> String(value.getKey()));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                sb.append(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">":"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                sb.append(str);  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">            }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">            context.write(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Text(row.get()), </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Text(</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> String(sb)));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">              </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    </span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
map函数继承到TableMapper接口，从result中读取查询结果。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> IntSumReducer   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">       <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Reducer &lt;Text,Text,Text,Text&gt; {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> Text result = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Text();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> reduce(Text key, Iterable&lt;Text&gt; values,   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                       Context context  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">                       ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">for</span><span style="border:none;background-color:inherit;"> (Text val : values) {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">          result.set(val);  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">          context.write(key,result);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li></ol></div>
<span style="font-family:Arial;font-size:14px;line-height:26px;">reduce函数没有改变，直接输出到文件中即可</span><br style="font-family:Arial;font-size:14px;line-height:26px;"><p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/darke1014/article/details/8665484#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@SuppressWarnings</span><span style="border:none;background-color:inherit;">(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"deprecation"</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">blic <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> main(String[] args) </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> Exception {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"> String tablename  = <span class="string" style="border:none;color:#0000FF;background-color:inherit;">"wordcount"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"> <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//实例化Configuration，注意不能用 new HBaseConfiguration()了。</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">Configuration conf = HBaseConfiguration.create();  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  String[] otherArgs = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> GenericOptionsParser(conf, args).getRemainingArgs();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="border:none;background-color:inherit;"> (otherArgs.length != </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2</span><span style="border:none;background-color:inherit;">) {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    System.err.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"Usage: wordcount &lt;in&gt; &lt;out&gt;"</span><span style="border:none;background-color:inherit;">+otherArgs.length);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    System.exit(<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  Job job = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Job(conf, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"word count"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  job.setJarByClass(ReadHBase.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  FileOutputFormat.setOutputPath(job, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(otherArgs[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">]));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  job.setReducerClass(IntSumReducer.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">//此处的TableMapReduceUtil注意要用hadoop.hbase.mapreduce包中的，而不是hadoop.hbase.mapred包中的</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  Scan scan = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Scan(args[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">].getBytes());  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  TableMapReduceUtil.initTableMapperJob(tablename, scan, TokenizerMapper.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">, Text.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">, Text.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">, job);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  System.exit(job.waitForCompletion(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">true</span><span style="border:none;background-color:inherit;">) ? </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;"> : </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<span style="font-family:Arial;font-size:14px;line-height:26px;">其中我输入的两个参数分别是“aa ouput”   分别是开始查找的行（这里为从“aa”行开始找），和输出文件到存储路径（这里为存到HDFS目录到output文件夹下）</span><br style="font-family:Arial;font-size:14px;line-height:26px;"><span style="font-family:Arial;font-size:14px;line-height:26px;"></span>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
要注意的是，在JOB的配置中需要实现initTableMapperJob方法。与第一个例子类似，    <br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
在job配置的时候不用设置 job.setMapperClass(); 而是用 <strong></strong>TableMapReduceUtil.initTableMapperJob(tablename, scan, TokenizerMapper.class, Text.class, Text.class, job);来执行mapper类。Scan实例是查找的起始行。</p>
<br>            </div>
                </div>