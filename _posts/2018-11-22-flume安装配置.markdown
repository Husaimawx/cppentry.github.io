---
layout:     post
title:      flume安装配置
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p><span style="font-size:18px;"><strong>一、关于flume的基本介绍</strong></span><br><span style="font-size:12px;">    Flume是Cloudera提供的一个高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统，Flume支持在日志系统中定制各类数据发送方，</span><br><span style="font-size:12px;">  用于收集数据；同时，Flume提供对数据进行简单处理，并写到各种数据接受方的能力。</span><br><span style="font-size:12px;">  </span><br><span style="font-size:12px;">  Flume的逻辑架构：</span></p>
<p><span style="font-size:12px;"><img src="" alt=""><img src="https://img-blog.csdn.net/20140402135449406?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZnd6amhibWM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></p>
<p><img src="" alt=""><br><span style="font-size:12px;">  Flume逻辑上分三层架构：agent，collector，storage</span><br><span style="font-size:12px;">  </span><br><span style="font-size:12px;">  agent</span><br><span style="font-size:12px;">  agent用于采集数据，agent是flume中产生数据流的地方，同时，agent会将产生的数据流传输到collector。</span><br><span style="font-size:12px;">  </span><br><span style="font-size:12px;">  collector</span><br><span style="font-size:12px;">  collector的作用是将多个agent的数据汇总后，加载到storage中。</span><br><span style="font-size:12px;">  </span><br><span style="font-size:12px;">  storage</span><br><span style="font-size:12px;">  storage是存储系统，可以是一个普通file，也可以是HDFS，HIVE，HBase等。</span><br><span style="font-size:12px;">  </span><br><span style="font-size:12px;">  Master</span><br><span style="font-size:12px;">  Master是管理协调agent和collector的配置等信息，是flume集群的控制器。</span><br><span style="font-size:12px;">  </span></p>
<p><span style="font-size:12px;">  在Flume中，最重要的抽象是data flow（数据流），data flow描述了数据从产生，传输、处理并最终写入目标的一条路径。</span></p>
<p><span style="font-size:12px;"><img src="https://img-blog.csdn.net/20140402135527015?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZnd6amhibWM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></p>
<p><img src="" alt=""><br><img src="" alt=""><br><span style="font-size:12px;">  对于agent数据流配置就是从哪得到数据，把数据发送到哪个collector。</span><br><span style="font-size:12px;">  对于collector是接收agent发过来的数据，把数据发送到指定的目标机器上。</span><br><br><span style="font-size:18px;"><strong>二、安装配置</strong></span><br><span style="font-size:12px;">  步骤1：</span><br><span style="font-size:12px;">    下载flume最新的稳定版本，官方最新版本为1.4.0，连接地址：http://www.apache.org/dyn/closer.cgi/flume/1.4.0/apache-flume-1.4.0-bin.tar.gz，     将下载的文件放置在/usr/local下。</span><br><span style="font-size:12px;">  步骤2：</span><br><span style="font-size:12px;">    解压flume安装包到/usr/local目录下面下面，</span><br><span style="font-size:12px;">    在命令行中输入：tar zxvf apache-flume-1.4.0-bin.tar.gz，</span><br><span style="font-size:12px;">    重新命名为flume-1.4.0：mv apache-flume-1.4.0-bin flume-1.4.0。</span><br><span style="font-size:12px;">  步骤3：</span><br><span style="font-size:12px;">    修改etc/profile文件，加入：</span><br><span style="font-size:12px;">    export FLUME_HOME=/usr/local/flume-1.4.0</span><br><span style="font-size:12px;">    export PATH=.:$PATH:$FLUME_HOME</span><br><span style="font-size:12px;">  步骤4：</span><br><span style="font-size:12px;">    进入/usr/local/flume-1.4.0/conf目录，执行命令：</span><br><span style="font-size:12px;">    cp flume-conf.properties.template example-conf.properties</span><br><span style="font-size:12px;">  步骤5：</span><br><span style="font-size:12px;">    在example-conf.properties中增加如下配置：</span><br><span style="font-size:12px;">    #agent1表示代理名称</span><br><span style="font-size:12px;">    agent1.sources=source1</span><br><span style="font-size:12px;">    agent1.sinks=sink1</span><br><span style="font-size:12px;">    agent1.channels=channel1</span><br><span style="font-size:12px;">    </span><br><span style="font-size:12px;">    #Spooling Directory是监控指定文件夹中新文件的变化，一旦新文件出现，就解析该文件内容，然后写入到channle。写入完成后，    标记该文件已完成或者删       除该文件。</span><br><span style="font-size:12px;">    #配置source1</span><br><span style="font-size:12px;">    agent1.sources.source1.type=spooldir</span><br><span style="font-size:12px;">    agent1.sources.source1.spoolDir=/root/hmbbs</span><br><span style="font-size:12px;">    agent1.sources.source1.channels=channel1</span><br><span style="font-size:12px;">    agent1.sources.source1.fileHeader = false</span><br><span style="font-size:12px;">    agent1.sources.source1.interceptors = i1</span><br><span style="font-size:12px;">    agent1.sources.source1.interceptors.i1.type = timestamp</span><br><span style="font-size:12px;">    </span><br><span style="font-size:12px;">    #配置sink1</span><br><span style="font-size:12px;">    agent1.sinks.sink1.type=hdfs</span><br><span style="font-size:12px;">    agent1.sinks.sink1.hdfs.path=hdfs://hadoop0:9000/hmbbs</span><br><span style="font-size:12px;">    agent1.sinks.sink1.hdfs.fileType=DataStream</span><br><span style="font-size:12px;">    agent1.sinks.sink1.hdfs.writeFormat=TEXT</span><br><span style="font-size:12px;">    agent1.sinks.sink1.hdfs.rollInterval=1</span><br><span style="font-size:12px;">    agent1.sinks.sink1.channel=channel1</span><br><span style="font-size:12px;">    agent1.sinks.sink1.hdfs.filePrefix=%Y-%m-%d</span><br><span style="font-size:12px;">    #配置channel1</span><br><span style="font-size:12px;">    agent1.channels.channel1.type=file</span><br><span style="font-size:12px;">    agent1.channels.channel1.checkpointDir=/root/hmbbs_tmp123</span><br><span style="font-size:12px;">    agent1.channels.channel1.dataDirs=/root/hmbbs_tmp</span><br><span style="font-size:12px;">  步骤6：</span><br><span style="font-size:12px;">    执行命令bin/flume-ng agent -n agent1 -c conf -f conf/example-conf.properties -Dflume.root.logger=DEBUG,console</span><br></p>
            </div>
                </div>