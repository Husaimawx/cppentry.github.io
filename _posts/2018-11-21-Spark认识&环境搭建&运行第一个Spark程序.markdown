---
layout:     post
title:      Spark认识&环境搭建&运行第一个Spark程序
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p></p><div class="summary" style="color:rgb(0,0,0);margin:0px 0px 1.5em;padding:5px 10px;background-color:rgb(247,247,247);font-family:'楷体';font-size:20px;text-align:left;"><strong>摘要：</strong>Spark作为新一代大数据计算引擎，因为内存计算的特性，具有比hadoop更快的计算速度。这里总结下对Spark的认识、虚拟机Spark安装、Spark开发环境搭建及编写第一个scala程序、运行第一个Spark程序。</div><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">1.Spark是什么</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">Spark是一个快速且通用的集群计算平台</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">2.Spark的特点</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">1）Spark是快速的</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">   Spark扩充了流行的Mapreduce计算模型</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">   Spark是基于内存的计算</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">2）Spark是通用的</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">    Spark的设计容纳了其它分布式系统拥有的功能</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">    批处理，迭代式计算，交互查询和流处理等</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">3）Spark是高度开放的</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">    Spark提供了Python,Java,Scala,SQL的API和丰富的内置库。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">    Spark和其它的大数据工具整合的很好，包括hadoop,kafka等</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">3.Spark的组件</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">Spark包括多个<span style="line-height:1.8;color:rgb(255,0,0);">紧密集成</span>的组件</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170707210324659-1725791751.png" alt="" width="607" height="192" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"> Spark Core:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　包含Spark的基本功能，包含任务调度，内存管理，容错机制等</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　内部定义了RDDs(弹性分布式数据集)</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　提供了很多APIs来创建和操作这些RDDs</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　应用场景，为其他组件提供底层的服务</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">Spark SQL:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"> 　　是Spark处理结构化数据的库，就像Hive SQL,Mysql一样</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　应用场景，企业中用来做报表统计</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">Spark Streaming:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　是实时数据流处理组件，类似Storm</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark Streaming提供了API来操作实时流数据</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　应用场景，企业中用来从Kafka接收数据做实时统计</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">MLlib:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">       一个包含通用机器学习功能的包，Machine learning lib</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">       包含分类，聚类，回归等，还包括模型评估和数据导入。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<span style="line-height:1.8;color:rgb(255,0,0);">MLlib提供的上面这些方法，都支持集群上的横向扩展。</span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);">　　<span style="line-height:1.8;color:rgb(0,0,0);">应用场景，机器学习。</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">Graphx:</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">　　是处理图的库（例如，社交网络图），并进行图的并行计算。</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">　　像Spark Streaming,Spark SQL一样，它也继承了RDD API。</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">　　它提供了各种图的操作，和常用的图算法，例如PangeRank算法。</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">　　应用场景，图计算。</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">Cluster Managers:</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">　　就是集群管理，Spark自带一个集群管理是单独调度器。</span></span></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="line-height:1.8;color:rgb(255,153,0);"><span style="line-height:1.8;color:rgb(0,0,0);">　　常见集群管理包括Hadoop YARN,Apache Mesos</span></span></p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">4.紧密集成的优点</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark底层优化了，基于Spark底层的组件也得到了相应的优化。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　紧密集成，节省了各个组件组合使用时的部署、测试等时间。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　向Spark增加新的组件时，其它组件，可立刻享用新组件的功能。</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">5.Spark与Hadoop的比较</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Hadoop应用场景：离线处理、对时效性要求不高</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark应用场景：时效性要求高的场景、机器学习等领域</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Doug Cutting的观点：这是生态系统，每个组件都有其作用，各善其职即可。Spark不具有HDFS的存储能力，要借助HDFS等持久化数据。大数据将会孕育出更多的新技术。</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">6.Spark运行环境</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark是Scala写的，运行在JVM上，所以运行环境Java7+</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　如果使用Python API,需要安装Python2.6+或者Python3.4+</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　版本对应：Spark1.6.2 -  Scala2.10    Spark2.0.0 -  Scala2.11</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">7.Spark安装</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark下载地址：http://spark.apache.org/downloads.html     注：搭Spark不需要Hadoop,如有hadoop集群，可下载相应的版本。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170708161338081-1264339667.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　这里安装在CentOS6.5虚拟机上，将下载好的文件上传虚拟机，并执行解压：tar -zxvf spark-2.0.1-bin-hadoop2.6.tgz</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark目录：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　bin包含用来和Spark交互的可执行文件，如Spark shell。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　examples包含一些单机Spark job,可以研究和运行这些例子。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Spark的Shell:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　Spark的shell能够处理分布在集群上的数据。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　Spark把数据加载到节点的内存中，因此分布式处理可在秒级完成。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　快速使用迭代式计算，实时查询、分析一般能够在shells中完成。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　Spark提供了Python shells和Scala shells。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　这里以Scala shell为例，演示读取本地文件并进行操作：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　进入Scala shell:./spark-shell</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709110332415-1250113989.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　创建测试文件helloSpark并输入内容：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709111031290-1066023809.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　输入val lines=sc.textFile("/home/lucy/hellospark") 加载文件内容，输入lines.count()进行统计行数：    （ 注：sc为spark content）</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"> 　　　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709111832806-732959196.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　ssh的配置：（ssh localhost需要输入密码，这在运行spark程序时是不可以的）</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　ssh-keygen （生成秘钥）</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　.ssh目录下cat xxx_rsa.pub&gt; authorized_keys</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　chmod 600 authorized_keys</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">8.Spark开发环境搭建</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　Scala 下载地址: http://www.scala-lang.org/download/2.11.6.html   注：默认安装选项会自动配置环境变量,<span style="line-height:1.8;color:rgb(255,0,0);">安装路径不能有空格</span>。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　IntelliJ IDEA 下载地址：https://www.jetbrains.com/idea/</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　注册码地址：http://idea.lanyus.com</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　由于这里下载的ideaIU-15.0.2.exe，已经包含有Scala插件，如果不包含需要下载。查看是否已有scala插件可以新建项目，打开Files-&gt;settings选择Plugins,输入scala查看：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709143214978-627148134.png" alt="" style="border:0px;max-width:900px;"></p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">9.编写第一个Scala程序</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　依次点击File-&gt;New-&gt;Project，选择Scala-&gt;SBT，下一步，打开如下窗口：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709152927634-1808062523.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　这里Scala选择为2.11.6，创建完成后会进行初始化操作，自动下载jar包等。下载时常看具体网络情况。待所有进度条完成后，项目目录已经出来了，如下：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709153633697-1649567216.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　编辑build.sbt:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　name := "LearnSpark"</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　version := "1.0"</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　scalaVersion := "2.11.1"</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　libraryDependencies += "org.apache.spark" % "spark-core_2.11" % "2.0.2"</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　编辑完成后，点击刷新，后台自动下载对应的依赖：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709160234197-1301433555.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　src-&gt;scala右击新建scala类WordCount</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709160924212-1107952223.png" alt="" style="border:0px;max-width:900px;"></p><div class="cnblogs_code" style="color:rgb(0,0,0);background-color:rgb(245,245,245);border:1px solid rgb(204,204,204);padding:5px;margin:5px 0px;text-align:left;font-family:'Courier New';font-size:12px;"><div class="cnblogs_code_toolbar" style="margin-top:5px;"><span class="cnblogs_code_copy" style="padding-right:5px;line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="background-color:rgb(255,255,255);max-width:900px;border:none rgb(221,221,221);"></a></span></div><pre style="margin-bottom:0px;white-space:pre-wrap;max-width:600px;font-family:'Courier New';"><span style="color:rgb(0,0,255);line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="color:rgb(0,128,0);line-height:1.5;"></span><span style="color:rgb(0,128,0);line-height:1.5;"></span><span style="color:rgb(0,128,0);line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="color:rgb(0,0,255);line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="color:rgb(0,0,255);line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="color:rgb(0,0,255);line-height:1.5;"></span><span style="line-height:1.5;"></span><span style="line-height:1.5;"></span></pre><div class="cnblogs_code_toolbar" style="margin-top:5px;"><span class="cnblogs_code_copy" style="padding-right:5px;line-height:1.5;"><a title="复制代码" style="color:rgb(61,129,238);border:none;"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="background-color:rgb(255,255,255);max-width:900px;border:none rgb(221,221,221);"></a></span></div></div><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　代码编写完成后，进行打包（配置jar包，build）:</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　配置jar包：File-&gt;Project Structure，选择Artifacts，点击+号：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709162933009-626864230.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709163131993-479145970.png" alt="" style="border:0px;max-width:900px;">　　</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　这里不打包依赖。配置jar包完成后，Build-&gt;Build Artifacts,等待build完成。</p><h3 style="font-size:17px;line-height:25px;color:rgb(255,255,255);font-family:'微软雅黑', '宋体', '黑体', Arial;height:25px;padding:5px 0px 5px 20px;text-align:left;margin-top:15px;margin-bottom:15px;background-color:rgb(163,187,80);">10.运行第一个Spark程序</h3><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　这里需要先启动集群：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　启动master:  ./sbin/start-master.sh</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　启动worker:  ./bin/spark-class org.apache.spark.deploy.worker.Worker spark://localhost:7077  </p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　　　　　这里的地址为：启动master后,在浏览器输入localhost:8080,查看到的master地址</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　　　　　　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709164628884-2012834048.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　启动成功后，jps查看进程：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709164844540-893497592.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　接下来执行提交命令，将打好的jar包上传到linux目录，jar包在项目目录下的out\artifacts下。</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　提交作业： ./bin/spark-submit --master spark://localhost:7077 --class WordCount /home/lucy/learnspark.jar</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　可以在4040端口查看job进度：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709171142962-699064477.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　查看结果：</p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　<img src="https://images2015.cnblogs.com/blog/160633/201707/160633-20170709171516853-396451951.png" alt="" style="border:0px;max-width:900px;"></p><p style="color:rgb(0,0,0);line-height:1.8;margin:10px auto;font-family:Georgia, 'Times New Roman', Times, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">　　由于按照空格分割字符串，所以这里将Spark! 视为一个单词。至此，任务运行结束！</p><br><p><a href="https://www.cnblogs.com/wonglu/p/5901356.html#autoid-8-0-0" rel="nofollow">转载地址：https://www.cnblogs.com/wonglu/p/5901356.html#autoid-8-0-0</a></p>            </div>
                </div>