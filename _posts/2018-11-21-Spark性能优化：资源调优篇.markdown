---
layout:     post
title:      Spark性能优化：资源调优篇
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <h1 class="article-title" style="line-height:35px;color:inherit;"><a href="https://www.iteblog.com/archives/1659.html" rel="nofollow" style="color:rgb(68,68,68);font-weight:normal;font-size:24px;line-height:60px;">Spark性能优化：资源调优篇</a></h1><div class="meta"><span id="mute-category" class="muted" style="color:rgb(153,153,153);"><span class="fa fa-list-alt" style="display:inline-block;font-family:FontAwesome;line-height:1;width:24px;font-size:1.73em;text-align:center;"></span><a href="https://www.iteblog.com/archives/category/spark/" rel="nofollow" style="color:rgb(0,166,124);"> </a>原文地址：<a href="https://www.iteblog.com/archives/1659.html" rel="nofollow">https://www.iteblog.com/archives/1659.html</a></span></div><div class="note" style="border:1px solid rgb(214,233,198);color:rgb(60,118,61);background-color:rgb(223,240,216);"><a href="https://www.iteblog.com/archives/1657" rel="nofollow" title="" style="color:rgb(0,166,124);">《Spark性能优化：开发调优篇》</a><br><a href="https://www.iteblog.com/archives/1659" rel="nofollow" title="" style="color:rgb(0,166,124);">《Spark性能优化：资源调优篇》</a><br><a href="https://www.iteblog.com/archives/1671" rel="nofollow" title="" style="color:rgb(0,166,124);">《Spark性能优化：数据倾斜调优》</a><br><a href="https://www.iteblog.com/archives/1672" rel="nofollow" title="" style="color:rgb(0,166,124);">《Spark性能优化：shuffle调优》</a></div><p>　　在开发完<span class="wp_keywordlink_affiliate"><a href="https://www.iteblog.com/archives/tag/spark/" rel="nofollow" title="" style="color:rgb(0,166,124);">Spark</a></span>作业之后，就该为作业配置合适的资源了。<span class="wp_keywordlink_affiliate"><a href="https://www.iteblog.com/archives/tag/spark/" rel="nofollow" title="" style="color:rgb(0,166,124);">Spark</a></span>的资源参数，基本都可以在spark-submit命令中作为参数设置。很多<span class="wp_keywordlink_affiliate"><a href="https://www.iteblog.com/archives/tag/spark/" rel="nofollow" title="" style="color:rgb(0,166,124);">Spark</a></span>初学者，通常不知道该设置哪些必要的参数，以及如何设置这些参数，最后就只能胡乱设置，甚至压根儿不设置。资源参数设置的不合理，可能会导致没有充分利用集群资源，作业运行会极其缓慢；或者设置的资源过大，队列没有足够的资源来提供，进而导致各种异常。总之，无论是哪种情况，都会导致Spark作业的运行效率低下，甚至根本无法运行。因此我们必须对Spark作业的资源使用原理有一个清晰的认识，并知道在Spark作业运行过程中，有哪些资源参数是可以设置的，以及如何设置合适的参数值。</p><div id="toc_container" class="no_bullets" style="background:rgb(249,249,249);border:1px solid rgb(170,170,170);width:400px;display:table;font-size:14.25px;"><p class="toc_title" style="text-align:center;font-weight:700;">文章目录</p><ul class="toc_list" style="list-style:none;background:0px 0px;"><li style="line-height:30px;font-size:13.8225px;background:0px 0px;list-style:none;"><a href="https://www.iteblog.com/archives/1659.html#Spark" rel="nofollow" title="" style="color:rgb(0,166,124);"><span class="toc_number toc_depth_1">1</span> Spark作业基本运行原理</a></li><li style="line-height:30px;font-size:13.8225px;background:0px 0px;list-style:none;"><a href="https://www.iteblog.com/archives/1659.html#i" rel="nofollow" title="" style="color:rgb(0,166,124);"><span class="toc_number toc_depth_1">2</span> 资源参数调优</a></li><li style="line-height:30px;font-size:13.8225px;background:0px 0px;list-style:none;"><a href="https://www.iteblog.com/archives/1659.html#i-2" rel="nofollow" title="" style="color:rgb(0,166,124);"><span class="toc_number toc_depth_1">3</span> 资源参数参考示例</a></li></ul></div><h3 style="line-height:35px;color:inherit;font-size:16px;"><span id="Spark">Spark作业基本运行原理</span></h3><div class="wp-caption aligncenter" style="text-align:center;"><a href="https://www.iteblog.com/pic/spark-base-mech_1659.png" rel="nofollow" title="" style="color:rgb(0,166,124);"><img alt="" class="b-loaded" src="https://img-blog.csdn.net/20180119155911445?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvYTEyM2RlbWk=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" style="vertical-align:middle;border:0px;opacity:1;margin-left:auto;"></a></div><p>　　详细原理见上图。我们使用spark-submit提交一个Spark作业之后，这个作业就会启动一个对应的Driver进程。根据你使用的部署模式（deploy-mode）不同，Driver进程可能在本地启动，也可能在集群中某个工作节点上启动。Driver进程本身会根据我们设置的参数，占有一定数量的内存和CPU core。而Driver进程要做的第一件事情，就是向集群管理器（可以是Spark Standalone集群，也可以是其他的资源管理集群，美团•大众点评使用的是YARN作为资源管理集群）申请运行Spark作业需要使用的资源，这里的资源指的就是Executor进程。YARN集群管理器会根据我们为Spark作业设置的资源参数，在各个工作节点上，启动一定数量的Executor进程，每个Executor进程都占有一定数量的内存和CPU core。</p><p>　　在申请到了作业执行所需的资源之后，Driver进程就会开始调度和执行我们编写的作业代码了。Driver进程会将我们编写的Spark作业代码分拆为多个stage，每个stage执行一部分代码片段，并为每个stage创建一批task，然后将这些task分配到各个Executor进程中执行。task是最小的计算单元，负责执行一模一样的计算逻辑（也就是我们自己编写的某个代码片段），只是每个task处理的数据不同而已。一个stage的所有task都执行完毕之后，会在各个节点本地的磁盘文件中写入计算中间结果，然后Driver就会调度运行下一个stage。下一个stage的task的输入数据就是上一个stage输出的中间结果。如此循环往复，直到将我们自己编写的代码逻辑全部执行完，并且计算完所有的数据，得到我们想要的结果为止。</p><p>　　Spark是根据shuffle类算子来进行stage的划分。如果我们的代码中执行了某个shuffle类算子（比如reduceByKey、join等），那么就会在该算子处，划分出一个stage界限来。可以大致理解为，shuffle算子执行之前的代码会被划分为一个stage，shuffle算子执行以及之后的代码会被划分为下一个stage。因此一个stage刚开始执行的时候，它的每个task可能都会从上一个stage的task所在的节点，去通过网络传输拉取需要自己处理的所有key，然后对拉取到的所有相同的key使用我们自己编写的算子函数执行聚合操作（比如reduceByKey()算子接收的函数）。这个过程就是shuffle。</p><p>　　当我们在代码中执行了cache/persist等持久化操作时，根据我们选择的持久化级别的不同，每个task计算出来的数据也会保存到Executor进程的内存或者所在节点的磁盘文件中。</p><p>　　因此Executor的内存主要分为三块：第一块是让task执行我们自己编写的代码时使用，默认是占Executor总内存的20%；第二块是让task通过shuffle过程拉取了上一个stage的task的输出后，进行聚合等操作时使用，默认也是占Executor总内存的20%；第三块是让RDD持久化时使用，默认占Executor总内存的60%。</p><p>　　task的执行速度是跟每个Executor进程的CPU core数量有直接关系的。一个CPU core同一时间只能执行一个线程。而每个Executor进程上分配到的多个task，都是以每个task一条线程的方式，多线程并发运行的。如果CPU core数量比较充足，而且分配到的task数量比较合理，那么通常来说，可以比较快速和高效地执行完这些task线程。</p><p>　　以上就是Spark作业的基本运行原理的说明，大家可以结合上图来理解。理解作业基本原理，是我们进行资源参数调优的基本前提。</p><h3 style="line-height:35px;color:inherit;font-size:16px;"><span id="i">资源参数调优</span></h3><p>　　了解完了Spark作业运行的基本原理之后，对资源相关的参数就容易理解了。所谓的Spark资源参数调优，其实主要就是对Spark运行过程中各个使用资源的地方，通过调节各种参数，来优化资源使用的效率，从而提升Spark作业的执行性能。以下参数就是Spark中主要的资源参数，每个参数都对应着作业运行原理中的某个部分，我们同时也给出了一个调优的参考值。</p><p><strong>num-executors</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置Spark作业总共要用多少个Executor进程来执行。Driver在向YARN集群管理器申请资源时，YARN集群管理器会尽可能按照你的设置来在集群的各个工作节点上，启动相应数量的Executor进程。这个参数非常之重要，如果不设置的话，默认只会给你启动少量的Executor进程，此时你的Spark作业的运行速度是非常慢的。</p><p>　　<strong>参数调优建议</strong>：每个Spark作业的运行一般设置50~100个左右的Executor进程比较合适，设置太少或太多的Executor进程都不好。设置的太少，无法充分利用集群资源；设置的太多的话，大部分队列可能无法给予充分的资源。</p><p><strong>executor-memory</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置每个Executor进程的内存。Executor内存的大小，很多时候直接决定了Spark作业的性能，而且跟常见的JVM OOM异常，也有直接的关联。</p><p>　　<strong>参数调优建议</strong>：每个Executor进程的内存设置4G~8G较为合适。但是这只是一个参考值，具体的设置还是得根据不同部门的资源队列来定。可以看看自己团队的资源队列的最大内存限制是多少，num-executors乘以executor-memory，就代表了你的Spark作业申请到的总内存量（也就是所有Executor进程的内存总和），这个量是不能超过队列的最大内存量的。此外，如果你是跟团队里其他人共享这个资源队列，那么申请的总内存量最好不要超过资源队列最大总内存的1/3~1/2，避免你自己的Spark作业占用了队列所有的资源，导致别的同学的作业无法运行。</p><p><strong>executor-cores</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置每个Executor进程的CPU core数量。这个参数决定了每个Executor进程并行执行task线程的能力。因为每个CPU core同一时间只能执行一个task线程，因此每个Executor进程的CPU core数量越多，越能够快速地执行完分配给自己的所有task线程。</p><p>　　<strong>参数调优建议</strong>：Executor的CPU core数量设置为2~4个较为合适。同样得根据不同部门的资源队列来定，可以看看自己的资源队列的最大CPU core限制是多少，再依据设置的Executor数量，来决定每个Executor进程可以分配到几个CPU core。同样建议，如果是跟他人共享这个队列，那么num-executors * executor-cores不要超过队列总CPU core的1/3~1/2左右比较合适，也是避免影响其他同学的作业运行。</p><p><strong>driver-memory</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置Driver进程的内存。</p><p>　　<strong>参数调优建议</strong>：Driver的内存通常来说不设置，或者设置1G左右应该就够了。唯一需要注意的一点是，如果需要使用collect算子将RDD的数据全部拉取到Driver上进行处理，那么必须确保Driver的内存足够大，否则会出现OOM内存溢出的问题。</p><p><strong>spark.default.parallelism</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置每个stage的默认task数量。这个参数极为重要，如果不设置可能会直接影响你的Spark作业性能。</p><p>　　<strong>参数调优建议</strong>：Spark作业的默认task数量为500~1000个较为合适。很多同学常犯的一个错误就是不去设置这个参数，那么此时就会导致Spark自己根据底层HDFS的block数量来设置task的数量，默认是一个HDFS block对应一个task。通常来说，Spark默认设置的数量是偏少的（比如就几十个task），如果task数量偏少的话，就会导致你前面设置好的Executor的参数都前功尽弃。试想一下，无论你的Executor进程有多少个，内存和CPU有多大，但是task只有1个或者10个，那么90%的Executor进程可能根本就没有task执行，也就是白白浪费了资源！因此Spark官网建议的设置原则是，设置该参数为num-executors * executor-cores的2~3倍较为合适，比如Executor的总CPU core数量为300个，那么设置1000个task是可以的，此时可以充分地利用Spark集群的资源。</p><p><strong>spark.storage.memoryFraction</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置RDD持久化数据在Executor内存中能占的比例，默认是0.6。也就是说，默认Executor 60%的内存，可以用来保存持久化的RDD数据。根据你选择的不同的持久化策略，如果内存不够时，可能数据就不会持久化，或者数据会写入磁盘。</p><p>　　<strong>参数调优建议</strong>：如果Spark作业中，有较多的RDD持久化操作，该参数的值可以适当提高一些，保证持久化的数据能够容纳在内存中。避免内存不够缓存所有的数据，导致数据只能写入磁盘中，降低了性能。但是如果Spark作业中的shuffle类操作比较多，而持久化操作比较少，那么这个参数的值适当降低一些比较合适。此外，如果发现作业由于频繁的gc导致运行缓慢（通过spark web ui可以观察到作业的gc耗时），意味着task执行用户代码的内存不够用，那么同样建议调低这个参数的值。</p><p><strong>spark.shuffle.memoryFraction</strong></p><p>　　<strong>参数说明</strong>：该参数用于设置shuffle过程中一个task拉取到上个stage的task的输出后，进行聚合操作时能够使用的Executor内存的比例，默认是0.2。也就是说，Executor默认只有20%的内存用来进行该操作。shuffle操作在进行聚合时，如果发现使用的内存超出了这个20%的限制，那么多余的数据就会溢写到磁盘文件中去，此时就会极大地降低性能。</p><p>　　<strong>参数调优建议</strong>：如果Spark作业中的RDD持久化操作较少，shuffle操作较多时，建议降低持久化操作的内存占比，提高shuffle操作的内存占比比例，避免shuffle过程中数据过多时内存不够用，必须溢写到磁盘上，降低了性能。此外，如果发现作业由于频繁的gc导致运行缓慢，意味着task执行用户代码的内存不够用，那么同样建议调低这个参数的值。<br>资源参数的调优，没有一个固定的值，需要同学们根据自己的实际情况（包括Spark作业中的shuffle操作数量、RDD持久化操作数量以及spark web ui中显示的作业gc情况），同时参考本篇文章中给出的原理以及调优建议，合理地设置上述参数。</p><h3 style="line-height:35px;color:inherit;font-size:16px;"><span id="i-2">资源参数参考示例</span></h3><p>以下是一份spark-submit命令的示例，大家可以参考一下，并根据自己的实际情况进行调节：</p><div><div id="highlighter_937070" class="syntaxhighlighter nogutter scala" style="overflow:auto !important;font-size:13px !important;background-color:rgb(247,247,247) !important;line-height:1.6 !important;"><table border="0" cellpadding="0" cellspacing="0" style="background:none !important;border-width:0px !important;border-style: !important;border-color: !important;line-height:1.1em !important;margin-left:0px !important;overflow:visible !important;vertical-align:baseline !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;font-size:1em !important;min-height:auto !important;"><tbody style="background:none !important;border:0px !important;line-height:1.1em !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><tr style="background:none !important;border:0px !important;line-height:1.1em !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><td class="code" style="background:none !important;border-width:0px !important;border-style: !important;border-color: !important;line-height:1.1em !important;overflow:visible !important;vertical-align:baseline !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;font-size:1em !important;min-height:auto !important;"><div style="background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><div class="line number1 index0 alt2" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">./bin/spark-submit \</code></div><div class="line number2 index1 alt1" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--master yarn-cluster \</code></div><div class="line number3 index2 alt2" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--num-executors </code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">100</code> <code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">\</code></div><div class="line number4 index3 alt1" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--executor-memory </code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">6</code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">G \</code></div><div class="line number5 index4 alt2" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--executor-cores </code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">4</code> <code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">\</code></div><div class="line number6 index5 alt1" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--driver-memory </code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">1</code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">G \</code></div><div class="line number7 index6 alt2" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--conf spark.default.parallelism</code><code class="scala keyword" style="color:rgb(137,89,168) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-weight:bold !important;font-size:1em !important;min-height:auto !important;">=</code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">1000</code> <code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">\</code></div><div class="line number8 index7 alt1" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--conf spark.storage.memoryFraction</code><code class="scala keyword" style="color:rgb(137,89,168) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-weight:bold !important;font-size:1em !important;min-height:auto !important;">=</code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">0.5</code> <code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">\</code></div><div class="line number9 index8 alt2" style="background-image:none !important;background-position: !important;background-repeat: !important;background-attachment: !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;"><code class="scala spaces" style="color:rgb(51,51,51);font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">  </code><code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">--conf spark.shuffle.memoryFraction</code><code class="scala keyword" style="color:rgb(137,89,168) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-weight:bold !important;font-size:1em !important;min-height:auto !important;">=</code><code class="scala value" style="color:rgb(0,153,0) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">0.3</code> <code class="scala plain" style="color:rgb(77,77,76) !important;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background:none !important;border:0px !important;line-height:1.6 !important;overflow:visible !important;vertical-align:baseline !important;font-size:1em !important;min-height:auto !important;">\</code></div></div></td></tr></tbody></table></div></div>            </div>
                </div>