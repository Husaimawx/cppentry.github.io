---
layout:     post
title:      hive学习3-DDL语句
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p><strong>Databases in Hive</strong> -- 在HIVE 中使用数据库<br></p>
<p><br></p>
<p>Hive offers no support for row-level  inserts, updates, and deletes.</p>
Hive doesn’t support transactions. Hive adds ex-tensions to provide<br>
better performance in the context of Hadoop and to integrate with<br><p>custom extensions and even external programs.</p>
<p><br></p>
<p>Hive 不支持行级插入，更新，删除。也不支持事务</p>
<p><br></p>
<p>创建数据库<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">CREATE</span><span> </span><span class="keyword">DATABASE</span><span> financials;  </span></span></li></ol></div>
<p><br></p>
<p>仓库数据库判断数据库是否存在<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">CREATE</span><span> </span><span class="keyword">DATABASE</span><span> IF </span><span class="op">NOT</span><span> EXISTS financials;  </span></span></li></ol></div>
<p><br></p>
<p>显示现在有的数据库<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; SHOW DATABASES;  </span></span></li><li><span><span class="keyword">default</span><span>  </span></span></li><li class="alt"><span>financials  </span></li><li><span>hive&gt; <span class="keyword">CREATE</span><span> </span><span class="keyword">DATABASE</span><span> human_resources;  </span></span></li><li class="alt"><span>hive&gt; SHOW DATABASES;  </span></li><li><span><span class="keyword">default</span><span>  </span></span></li><li class="alt"><span>financials  </span></li><li><span>human_resources  </span></li></ol></div>
<p><br></p>
<p>条件查询数据库<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; SHOW DATABASES </span><span class="op">LIKE</span><span> </span><span class="string">'h.*'</span><span>;  </span></span></li><li><span>human_resources  </span></li><li class="alt"><span>hive&gt; ...  </span></li></ol></div>
<br><p>创建指定存放文件位置 数据库<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">CREATE</span><span> </span><span class="keyword">DATABASE</span><span> financials  </span></span></li><li><span>    &gt; LOCATION <span class="string">'/my/preferred/directory'</span><span>;  </span></span></li></ol></div>
<p><br></p>
<p>创建数据库时 添加注释信息<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">CREATE</span><span> </span><span class="keyword">DATABASE</span><span> financials  </span></span></li><li><span>    &gt; COMMENT <span class="string">'Holds all financial tables'</span><span>;  </span></span></li><li class="alt"><span>hive&gt; DESCRIBE <span class="keyword">DATABASE</span><span> financials;  </span></span></li><li><span>financials   Holds <span class="op">all</span><span> financial tables  </span></span></li><li class="alt"><span>  hdfs://master-server/<span class="func">user</span><span>/hive/warehouse/financials.db  </span></span></li></ol></div>
<br><br><p>创建数据库 添加扩展信息<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">CREATE</span><span> </span><span class="keyword">DATABASE</span><span> financials  </span></span></li><li><span>    &gt; <span class="keyword">WITH</span><span> DBPROPERTIES (</span><span class="string">'creator'</span><span> = </span><span class="string">'Mark Moneybags'</span><span>, </span><span class="string">'date'</span><span> = </span><span class="string">'2012-01-02'</span><span>);  </span></span></li><li class="alt"><span>hive&gt; DESCRIBE <span class="keyword">DATABASE</span><span> financials;  </span></span></li><li><span>financials   hdfs://master-server/<span class="func">user</span><span>/hive/warehouse/financials.db  </span></span></li><li class="alt"><span>hive&gt; DESCRIBE <span class="keyword">DATABASE</span><span> EXTENDED financials;  </span></span></li><li><span>financials   hdfs://master-server/<span class="func">user</span><span>/hive/warehouse/financials.db  </span></span></li><li class="alt"><span> {<span class="keyword">date</span><span>=2012-01-02, creator=Mark Moneybags);  </span></span></li></ol></div>
<p><br></p>
<p>使用数据库</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; USE financials;  </span></span></li></ol></div>
<p><br></p>
<p>设置显示当前数据库</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">set</span><span> hive.cli.print.</span><span class="keyword">current</span><span>.db=</span><span class="keyword">true</span><span>;  </span></span></li><li><span>hive (financials)&gt; USE <span class="keyword">default</span><span>;  </span></span></li><li class="alt"><span>hive (<span class="keyword">default</span><span>)&gt; </span><span class="keyword">set</span><span> hive.cli.print.</span><span class="keyword">current</span><span>.db=</span><span class="keyword">false</span><span>;  </span></span></li><li><span>hive&gt; ...  </span></li></ol></div>
<p><br></p>
<p>删除数据库</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">DROP</span><span> </span><span class="keyword">DATABASE</span><span> IF EXISTS financials;  </span></span></li></ol></div>
<p><br></p>
<p>当数据库存在表时，先要删除表 再能删除数据库<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">DROP</span><span> </span><span class="keyword">DATABASE</span><span> IF EXISTS financials </span><span class="keyword">CASCADE</span><span>;  </span></span></li></ol></div>
<br><p><strong><br></strong></p>
<p><strong>Alter Database</strong> -- 修改数据库</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">ALTER</span><span> </span><span class="keyword">DATABASE</span><span> financials </span><span class="keyword">SET</span><span> DBPROPERTIES (</span><span class="string">'edited-by'</span><span> = </span><span class="string">'Joe Dba'</span><span>);  </span></span></li></ol></div>
<br>
There is no way to delete or “unset” a DBPROPERTY  没有方法删除或重置 DBPROPERTY 
<p><br></p>
<p><br></p>
<p><strong>Creating Tables</strong> -- 创建表</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> </span><span class="keyword">TABLE</span><span> IF </span><span class="op">NOT</span><span> EXISTS mydb.employees (  </span></span></li><li><span>  <span class="keyword">name</span><span>         STRING COMMENT </span><span class="string">'Employee name'</span><span>,  </span></span></li><li class="alt"><span>  salary       <span class="keyword">FLOAT</span><span>  COMMENT </span><span class="string">'Employee salary'</span><span>,  </span></span></li><li><span>  subordinates ARRAY&lt;STRING&gt; COMMENT <span class="string">'Names of subordinates'</span><span>,  </span></span></li><li class="alt"><span>  deductions   MAP&lt;STRING, <span class="keyword">FLOAT</span><span>&gt;  </span></span></li><li><span>               COMMENT 'Keys are deductions names, <span class="keyword">values</span><span> are percentages  </span></span></li><li class="alt"><span>  address      STRUCT&lt;street:STRING, city:STRING, state:STRING, zip:<span class="keyword">INT</span><span>&gt;  </span></span></li><li><span>               COMMENT <span class="string">'Home address'</span><span>)  </span></span></li><li class="alt"><span>COMMENT <span class="string">'Description of the table'</span><span>  </span></span></li><li><span>TBLPROPERTIES (<span class="string">'creator'</span><span>=</span><span class="string">'me'</span><span>, </span><span class="string">'created_at'</span><span>=</span><span class="string">'2012-01-02 10:00:00'</span><span>, ...)  </span></span></li><li class="alt"><span>LOCATION <span class="string">'/user/hive/warehouse/mydb.db/employees'</span><span>;  </span></span></li></ol></div>
<br><p>创建表-复制表结构<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> </span><span class="keyword">TABLE</span><span> IF </span><span class="op">NOT</span><span> EXISTS mydb.employees2  </span></span></li><li><span><span class="op">LIKE</span><span> mydb.employees;  </span></span></li></ol></div>
<p><br></p>
<p>显示某个数据库中的表<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; USE mydb;  </span></span></li><li><span>hive&gt; SHOW TABLES;  </span></li><li class="alt"><span>employees  </span></li><li><span>table1  </span></li><li class="alt"><span>table2  </span></li></ol></div>
<br><div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; USE </span><span class="keyword">default</span><span>;  </span></span></li><li><span>hive&gt; SHOW TABLES <span class="op">IN</span><span> mydb;  </span></span></li><li class="alt"><span>employees  </span></li></ol></div>
<br><p>显示指定筛选条件 表名<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; USE mydb;  </span></span></li><li><span>hive&gt; SHOW TABLES <span class="string">'empl.*'</span><span>;  </span></span></li><li class="alt"><span>employees  </span></li></ol></div>
<br><p>显示表扩展信息<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; DESCRIBE EXTENDED mydb.employees;  </span></span></li><li><span><span class="keyword">name</span><span>    string  Employee </span><span class="keyword">name</span><span>  </span></span></li><li class="alt"><span>salary  <span class="keyword">float</span><span>   Employee salary  </span></span></li><li><span>subordinates    array&lt;string&gt;   Names <span class="keyword">of</span><span> subordinates  </span></span></li><li class="alt"><span>deductions      map&lt;string,<span class="keyword">float</span><span>&gt; Keys are deductions names, </span><span class="keyword">values</span><span> are percentages  </span></span></li><li><span>address struct&lt;street:string,city:string,state:string,zip:<span class="keyword">int</span><span>&gt;  Home address  </span></span></li><li class="alt"><span>Detailed <span class="keyword">Table</span><span> Information      </span><span class="keyword">Table</span><span>(tableName:employees, dbName:mydb, owner:me,  </span></span></li><li><span>...  </span></li><li class="alt"><span>location:hdfs://master-server/<span class="func">user</span><span>/hive/warehouse/mydb.db/employees,  </span></span></li><li><span>parameters:{creator=me, created_at=<span class="string">'2012-01-02 10:00:00'</span><span>,  </span></span></li><li class="alt"><span>            last_modified_user=me, last_modified_time=1337544510,  </span></li><li><span>            comment:Description <span class="keyword">of</span><span> the </span><span class="keyword">table</span><span>, ...}, ...)  </span></span></li></ol></div>
<br><p><br></p>
<p>指定显示某个字段的信息<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; DESCRIBE mydb.employees.salary;  </span></span></li><li><span>salary  <span class="keyword">float</span><span>   Employee salary  </span></span></li></ol></div>
<p><br></p>
<p>External Tables -- 外部表</p>
<p><br></p>
<p>外部表，删除表不删除数据<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> EXTERNAL </span><span class="keyword">TABLE</span><span> IF </span><span class="op">NOT</span><span> EXISTS stocks (  </span></span></li><li><span>  exchange        STRING,  </span></li><li class="alt"><span>  symbol          STRING,  </span></li><li><span>  ymd             STRING,  </span></li><li class="alt"><span>  price_open      <span class="keyword">FLOAT</span><span>,  </span></span></li><li><span>  price_high      <span class="keyword">FLOAT</span><span>,  </span></span></li><li class="alt"><span>  price_low       <span class="keyword">FLOAT</span><span>,  </span></span></li><li><span>  price_close     <span class="keyword">FLOAT</span><span>,  </span></span></li><li class="alt"><span>  volume          <span class="keyword">INT</span><span>,  </span></span></li><li><span>  price_adj_close <span class="keyword">FLOAT</span><span>)  </span></span></li><li class="alt"><span>ROW FORMAT DELIMITED FIELDS TERMINATED <span class="keyword">BY</span><span> </span><span class="string">','</span><span>  </span></span></li><li><span>LOCATION <span class="string">'/data/stocks'</span><span>;  </span></span></li></ol></div>
<br><p>复制表结构仓库外部表<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> EXTERNAL </span><span class="keyword">TABLE</span><span> IF </span><span class="op">NOT</span><span> EXISTS mydb.employees3  </span></span></li><li><span><span class="op">LIKE</span><span> mydb.employees  </span></span></li><li class="alt"><span>LOCATION <span class="string">'/path/to/data'</span><span>;  </span></span></li></ol></div>
<br><p><strong><br></strong></p>
<p><strong>Partitioned, Managed Tables</strong> --分区表</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> </span><span class="keyword">TABLE</span><span> employees (  </span></span></li><li><span>  <span class="keyword">name</span><span>         STRING,  </span></span></li><li class="alt"><span>  salary       <span class="keyword">FLOAT</span><span>,  </span></span></li><li><span>  subordinates ARRAY&lt;STRING&gt;,  </span></li><li class="alt"><span>  deductions   MAP&lt;STRING, <span class="keyword">FLOAT</span><span>&gt;,  </span></span></li><li><span>  address      STRUCT&lt;street:STRING, city:STRING, state:STRING, zip:<span class="keyword">INT</span><span>&gt;  </span></span></li><li class="alt"><span>)  </span></li><li><span>PARTITIONED <span class="keyword">BY</span><span> (country STRING, state STRING);  </span></span></li></ol></div>
<p><br></p>
<p>However, Hive will now create subdirectories reflecting the partitioning structure. For<br>
example:</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>...  </span></span></li><li><span>.../employees/country=CA/state=AB  </span></li><li class="alt"><span>.../employees/country=CA/state=BC  </span></li><li><span>...  </span></li><li class="alt"><span>.../employees/country=US/state=AL  </span></li><li><span>.../employees/country=US/state=AK  </span></li><li class="alt"><span>...  </span></li></ol></div>
<br><p>建议安全措施<br>
把HIVE 设置成“严格”模式,禁止分区表的查询没有<br>
一个WHERE子句<br><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; </span><span class="keyword">set</span><span> hive.mapred.mode=strict;  </span></span></li><li><span>hive&gt; <span class="keyword">SELECT</span><span> e.</span><span class="keyword">name</span><span>, e.salary </span><span class="keyword">FROM</span><span> employees e LIMIT 100;  </span></span></li><li class="alt"><span>FAILED: Error <span class="op">in</span><span> semantic analysis: </span><span class="keyword">No</span><span> partition predicate found </span><span class="keyword">for</span><span>  </span></span></li><li><span> Alias <span class="string">"e"</span><span> </span><span class="keyword">Table</span><span> </span><span class="string">"employees"</span><span>  </span></span></li><li class="alt"><span>hive&gt; <span class="keyword">set</span><span> hive.mapred.mode=nonstrict;  </span></span></li><li><span>hive&gt; <span class="keyword">SELECT</span><span> e.</span><span class="keyword">name</span><span>, e.salary </span><span class="keyword">FROM</span><span> employees e LIMIT 100;  </span></span></li></ol></div>
<br><p>查看现有分区</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; SHOW PARTITIONS employees;  </span></span></li><li><span>...  </span></li><li class="alt"><span>Country=CA/state=AB  </span></li><li><span>country=CA/state=BC  </span></li><li class="alt"><span>...  </span></li><li><span>country=US/state=AL  </span></li><li class="alt"><span>country=US/state=AK  </span></li></ol></div>
<br><p>查看分区详细 分区键</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; SHOW PARTITIONS employees PARTITION(country=</span><span class="string">'US'</span><span>);  </span></span></li><li><span>country=US/state=AL  </span></li><li class="alt"><span>country=US/state=AK  </span></li><li><span>...  </span></li><li class="alt"><span>hive&gt; SHOW PARTITIONS employees PARTITION(country=<span class="string">'US'</span><span>, state=</span><span class="string">'AK'</span><span>);  </span></span></li><li><span>country=US/state=AK  </span></li></ol></div>
<p><br></p>
<p>通过 DESC 显示分区键</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; DESCRIBE EXTENDED employees;  </span></span></li><li><span><span class="keyword">name</span><span>         string,  </span></span></li><li class="alt"><span>salary       <span class="keyword">float</span><span>,  </span></span></li><li><span>...  </span></li><li class="alt"><span>address      struct&lt;...&gt;,  </span></li><li><span>country      string,  </span></li><li class="alt"><span>state        string  </span></li><li><span>Detailed <span class="keyword">Table</span><span> Information...  </span></span></li><li class="alt"><span>partitionKeys:[FieldSchema(<span class="keyword">name</span><span>:country, type:string, comment:</span><span class="op">null</span><span>),  </span></span></li><li><span>FieldSchema(<span class="keyword">name</span><span>:state, type:string, comment:</span><span class="op">null</span><span>)],  </span></span></li><li class="alt"><span>...  </span></li></ol></div>
<p><br></p>
<p>从文件读入 分区表</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">LOAD</span><span> DATA </span><span class="keyword">LOCAL</span><span> INPATH </span><span class="string">'${env:HOME}/california-employees'</span><span>  </span></span></li><li><span><span class="keyword">INTO</span><span> </span><span class="keyword">TABLE</span><span> employees  </span></span></li><li class="alt"><span>PARTITION (country = <span class="string">'US'</span><span>, state = </span><span class="string">'CA'</span><span>);  </span></span></li></ol></div>
<br><p><br></p>
<p><strong>External Partitioned Tables</strong> 外部分区表<br></p>
<p><br></p>
<p>1.先创建外部表结构<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> EXTERNAL </span><span class="keyword">TABLE</span><span> IF </span><span class="op">NOT</span><span> EXISTS log_messages (  </span></span></li><li><span>  hms             <span class="keyword">INT</span><span>,  </span></span></li><li class="alt"><span>  severity        STRING,  </span></li><li><span>  server          STRING,  </span></li><li class="alt"><span>  process_id      <span class="keyword">INT</span><span>,  </span></span></li><li><span>  message         STRING)  </span></li><li class="alt"><span>PARTITIONED <span class="keyword">BY</span><span> (</span><span class="func">year</span><span> </span><span class="keyword">INT</span><span>, </span><span class="func">month</span><span> </span><span class="keyword">INT</span><span>, </span><span class="func">day</span><span> </span><span class="keyword">INT</span><span>)  </span></span></li><li><span>ROW FORMAT DELIMITED FIELDS TERMINATED <span class="keyword">BY</span><span> </span><span class="string">'\t'</span><span>;  </span></span></li></ol></div>
<br><p>2.为外部表增加指定分区</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages </span><span class="keyword">ADD</span><span> PARTITION(</span><span class="func">year</span><span> = 2012, </span><span class="func">month</span><span> = 1, </span><span class="func">day</span><span> = 2)  </span></span></li><li><span>LOCATION <span class="string">'hdfs://master_server/data/log_messages/2012/01/02'</span><span>;  </span></span></li></ol></div>
<br><p>3.把数据表复制外部表目录结构中<br></p>
<p>Copy the data for the partition being moved to S3. For example, you can use the<br>
hadoop distcp command:<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hadoop distcp /data/log_messages/2011/12/02 s3n://ourbucket/logs/2011/12/02  </span></span></li></ol></div>
<br>
•Alter the table to point the partition to the S3 location:<br><div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages PARTITION(</span><span class="func">year</span><span> = 2011, </span><span class="func">month</span><span> = 12, </span><span class="func">day</span><span> = 2)  </span></span></li></ol></div>
<br>
SET LOCATION 's3n://ourbucket/logs/2011/01/02';<br>
•Remove the HDFS copy of the partition using the hadoop fs -rmr command:<br><div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hadoop fs -rmr /data/log_messages/2011/01/02  </span></span></li></ol></div>
<p><br></p>
<p>显示 表分区信息<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; SHOW PARTITIONS log_messages;  </span></span></li><li><span>...  </span></li><li class="alt"><span><span class="func">year</span><span>=2011/</span><span class="func">month</span><span>=12/</span><span class="func">day</span><span>=31  </span></span></li><li><span><span class="func">year</span><span>=2012/</span><span class="func">month</span><span>=1/</span><span class="func">day</span><span>=1  </span></span></li><li class="alt"><span><span class="func">year</span><span>=2012/</span><span class="func">month</span><span>=1/</span><span class="func">day</span><span>=2  </span></span></li></ol></div>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; DESCRIBE EXTENDED log_messages;  </span></span></li><li><span>...  </span></li><li class="alt"><span>message         string,  </span></li><li><span><span class="func">year</span><span>            </span><span class="keyword">int</span><span>,  </span></span></li><li class="alt"><span><span class="func">month</span><span>           </span><span class="keyword">int</span><span>,  </span></span></li><li><span><span class="func">day</span><span>             </span><span class="keyword">int</span><span>  </span></span></li><li class="alt"><span>Detailed <span class="keyword">Table</span><span> Information...  </span></span></li><li><span>partitionKeys:[FieldSchema(<span class="keyword">name</span><span>:</span><span class="func">year</span><span>, type:</span><span class="keyword">int</span><span>, comment:</span><span class="op">null</span><span>),  </span></span></li><li class="alt"><span>FieldSchema(<span class="keyword">name</span><span>:</span><span class="func">month</span><span>, type:</span><span class="keyword">int</span><span>, comment:</span><span class="op">null</span><span>),  </span></span></li><li><span>FieldSchema(<span class="keyword">name</span><span>:</span><span class="func">day</span><span>, type:</span><span class="keyword">int</span><span>, comment:</span><span class="op">null</span><span>)],  </span></span></li><li class="alt"><span>...  </span></li></ol></div>
<br><div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span>hive&gt; DESCRIBE EXTENDED log_messages PARTITION (</span><span class="func">year</span><span>=2012, </span><span class="func">month</span><span>=1, </span><span class="func">day</span><span>=2);  </span></span></li><li><span>...  </span></li><li class="alt"><span>location:s3n://ourbucket/logs/2011/01/02,  </span></li><li><span>...  </span></li></ol></div>
<br><p><strong><br></strong></p>
<p><strong>Customizing Table Storage Formats</strong> -- 表存储格式</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">CREATE</span><span> </span><span class="keyword">TABLE</span><span> employees (  </span></span></li><li><span>  <span class="keyword">name</span><span>         STRING,  </span></span></li><li class="alt"><span>  salary       <span class="keyword">FLOAT</span><span>,  </span></span></li><li><span>  subordinates ARRAY&lt;STRING&gt;,  </span></li><li class="alt"><span>  deductions   MAP&lt;STRING, <span class="keyword">FLOAT</span><span>&gt;,  </span></span></li><li><span>  address      STRUCT&lt;street:STRING, city:STRING, state:STRING, zip:<span class="keyword">INT</span><span>&gt;  </span></span></li><li class="alt"><span>)  </span></li><li><span>ROW FORMAT DELIMITED  </span></li><li class="alt"><span>FIELDS TERMINATED <span class="keyword">BY</span><span> </span><span class="string">'\001'</span><span>  </span></span></li><li><span>COLLECTION ITEMS TERMINATED <span class="keyword">BY</span><span> </span><span class="string">'\002'</span><span>  </span></span></li><li class="alt"><span>MAP KEYS TERMINATED <span class="keyword">BY</span><span> </span><span class="string">'\003'</span><span>  </span></span></li><li><span>LINES TERMINATED <span class="keyword">BY</span><span> </span><span class="string">'\n'</span><span>  </span></span></li><li class="alt"><span>STORED <span class="keyword">AS</span><span> TEXTFILE;  </span></span></li></ol></div>
<p><strong><br></strong></p>
<p><strong>Dropping Tables</strong> -- 删除表</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">DROP</span><span> </span><span class="keyword">TABLE</span><span> IF EXISTS employees;  </span></span></li></ol></div>
<br><p>For external tables, the metadata is deleted but the data is not.</p>
<p><br></p>
<p><strong>Alter Table</strong> --修改表结构</p>
<p><br></p>
<p>ALTER TABLE modifies  table metadata  only. The  data  for  the  table  is<br>
untouched. It’s up to you to ensure that any modifications are consistent<br>
with the actual data.</p>
<p><br></p>
<p><strong>Renaming a Table</strong> -- 修改表名<strong><br></strong></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages RENAME </span><span class="keyword">TO</span><span> logmsgs;  </span></span></li></ol></div>
<br><p><strong>Adding, Modifying, and Dropping a Table Partition </strong>-- 增加，修改，删除 表分区<strong><br></strong></p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages </span><span class="keyword">ADD</span><span> IF </span><span class="op">NOT</span><span> EXISTS  </span></span></li><li><span>PARTITION (<span class="func">year</span><span> = 2011, </span><span class="func">month</span><span> = 1, </span><span class="func">day</span><span> = 1) LOCATION </span><span class="string">'/logs/2011/01/01'</span><span>  </span></span></li><li class="alt"><span>PARTITION (<span class="func">year</span><span> = 2011, </span><span class="func">month</span><span> = 1, </span><span class="func">day</span><span> = 2) LOCATION </span><span class="string">'/logs/2011/01/02'</span><span>  </span></span></li><li><span>PARTITION (<span class="func">year</span><span> = 2011, </span><span class="func">month</span><span> = 1, </span><span class="func">day</span><span> = 3) LOCATION </span><span class="string">'/logs/2011/01/03'</span><span>  </span></span></li></ol></div>
<br><div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages PARTITION(</span><span class="func">year</span><span> = 2011, </span><span class="func">month</span><span> = 12, </span><span class="func">day</span><span> = 2)  </span></span></li><li><span><span class="keyword">SET</span><span> LOCATION </span><span class="string">'s3n://ourbucket/logs/2011/01/02'</span><span>;  </span></span></li></ol></div>
<br><div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages </span><span class="keyword">DROP</span><span> IF EXISTS PARTITION(</span><span class="func">year</span><span> = 2011, </span><span class="func">month</span><span> = 12, </span><span class="func">day</span><span> = 2);  </span></span></li></ol></div>
<br><p><br></p>
<p><strong>Changing Columns</strong> --修改列</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages  </span></span></li><li><span>CHANGE <span class="keyword">COLUMN</span><span> hms hours_minutes_seconds </span><span class="keyword">INT</span><span>  </span></span></li><li class="alt"><span>COMMENT <span class="string">'The hours, minutes, and seconds part of the timestamp'</span><span>  </span></span></li><li><span><span class="keyword">AFTER</span><span> severity;  </span></span></li></ol></div>
<br><p><strong>Adding Columns</strong> --增加列</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages </span><span class="keyword">ADD</span><span> COLUMNS (  </span></span></li><li><span> app_name   STRING COMMENT <span class="string">'Application name'</span><span>,  </span></span></li><li class="alt"><span> session_id LONG   COMMENT <span class="string">'The current session id'</span><span>);  </span></span></li></ol></div>
<br><p><strong>Deleting or Replacing Columns</strong> --删除 替换列</p>
<p><br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages </span><span class="func">REPLACE</span><span> COLUMNS (  </span></span></li><li><span> hours_mins_secs <span class="keyword">INT</span><span>    COMMENT </span><span class="string">'hour, minute, seconds from timestamp'</span><span>,  </span></span></li><li class="alt"><span> severity        STRING COMMENT <span class="string">'The message severity'</span><span>  </span></span></li><li><span> message         STRING COMMENT <span class="string">'The rest of the message'</span><span>);  </span></span></li></ol></div>
<br><p>This statement effectively renames the original hms column and removes the server and<br>
process_id columns from the original schema definition. As for all ALTER statements,<br>
only the table metadata is changed.</p>
<p><strong><br></strong></p>
<p><strong>Alter Table Properties</strong> --修改表属性</p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages </span><span class="keyword">SET</span><span> TBLPROPERTIES (  </span></span></li><li><span> <span class="string">'notes'</span><span> = </span><span class="string">'The process id is no longer captured; this column is always NULL'</span><span>);  </span></span></li></ol></div>
<br><p><strong>Alter Storage Properties</strong> --修改存储属性<br></p>
<div class="dp-highlighter bg_sql">
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> log_messages  </span></span></li><li><span>PARTITION(<span class="func">year</span><span> = 2012, </span><span class="func">month</span><span> = 1, </span><span class="func">day</span><span> = 1)  </span></span></li><li class="alt"><span><span class="keyword">SET</span><span> FILEFORMAT SEQUENCEFILE;  </span></span></li></ol></div>
<p><br></p>
<p>You can specify a new SerDe along with SerDe properties or change the properties for<br>
the existing SerDe. The following example specifies that a table will use a Java class<br>
named com.example.JSONSerDe to process a file of JSON-encoded records<br></p>
<div class="bar">
<div class="tools"><strong>[sql]</strong> <a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="ViewSource" title="view plain">
view plain</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="CopyToClipboard" title="copy">copy</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="PrintSource" title="print">print</a><a href="http://blog.csdn.net/iquicksandi/article/details/8522691#" rel="nofollow" class="About" title="?">?</a></div>
</div>
<ol class="dp-sql" start="1"><li class="alt"><span><span class="keyword">ALTER</span><span> </span><span class="keyword">TABLE</span><span> table_using_JSON_storage  </span></span></li><li><span><span class="keyword">SET</span><span> SERDE </span><span class="string">'com.example.JSONSerDe'</span><span>  </span></span></li><li class="alt"><span><span class="keyword">WITH</span><span> SERDEPROPERTIES (  </span></span></li><li><span> <span class="string">'prop1'</span><span> = </span><span class="string">'value1'</span><span>, 
<br></span></span></li></ol>            </div>
                </div>