---
layout:     post
title:      【Flume-1.8.0】Flume概要
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <h1></h1><h1><strong>1 Flume概述</strong></h1><p align="justify">Flume<span style="font-family:'宋体';">是一种分布式</span><span style="font-family:'宋体';">（</span>distributed<span style="font-family:'宋体';">）</span><span style="font-family:'宋体';">，可靠</span><span style="font-family:'宋体';">（</span>reliable<span style="font-family:'宋体';">）</span><span style="font-family:'宋体';">且可用</span><span style="font-family:'宋体';">（</span>available<span style="font-family:'宋体';">）</span><span style="font-family:'宋体';">的服务，用于高效地收集，汇总和移动大量日志数据。它具有基于流式数据流的简单而灵活的架构。它有可靠性机制和许多故障转移和恢复机制，</span><span style="font-family:'宋体';">具有强大的容错性和容错能力。</span><span style="font-family:'宋体';">它使用一个简单的可扩展数据模型，允许在线分析应用程序。</span><span style="text-align:center;"> </span></p><p align="justify">Apache Flume 1.8.0<span style="font-family:'宋体';">是</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'宋体';">作为</span><span style="font-family:'Times New Roman';">Apache</span><span style="font-family:'宋体';">顶级项目（</span><span style="font-family:'Times New Roman';">TLP</span><span style="font-family:'宋体';">）的第</span><span style="font-family:'Times New Roman';">11</span><span style="font-family:'宋体';">个版本。</span><span style="font-family:'Times New Roman';">Apache Flume 1.8.0</span><span style="font-family:'宋体';">是可用于生产的软件。</span><span style="font-family:'宋体';">目前有两个发布代码行，版本</span>0.9.x<span style="font-family:'宋体';">和</span><span style="font-family:'Times New Roman';">1.x.</span><span style="font-family:'宋体';">本文档适用于</span>1.4.x<span style="font-family:'宋体';">及其以后的版本。</span></p><p align="justify"><span style="font-family:'宋体';">系统要求</span>：</p><p align="justify">Java<span style="font-family:'宋体';">运行时环境 </span><span style="font-family:'Times New Roman';">- Java 1.8</span><span style="font-family:'宋体';">或更高版本。</span><span style="font-family:'宋体';">目录权限</span> - <span style="font-family:'宋体';">代理</span><span style="font-family:'宋体';">（</span>agent<span style="font-family:'宋体';">）</span><span style="font-family:'宋体';">使用目录的读</span>/<span style="font-family:'宋体';">写权限</span></p><table><tbody><tr><td valign="top"><p><span style="color:#00b050;">1</span><span style="color:#4ea1db;">、</span><span style="color:rgb(0,176,80);"><span style="color:rgb(0,176,80);font-family:'Times New Roman';font-size:14px;text-align:left;background-color:rgb(255,255,255);">Flume</span><span style="font-family:'迷你简启体';">是一个</span>数据收集</span><span style="color:rgb(0,176,80);"><span style="font-family:'迷你简启体';">工具，</span></span><span style="color:rgb(0,176,80);"><span style="font-family:'迷你简启体';">具有强大的</span></span><span style="color:rgb(0,176,80);"><span style="font-family:'迷你简启体';">容灾</span></span><span style="color:rgb(0,176,80);"><span style="font-family:'迷你简启体';">和容错能力</span></span><span style="color:rgb(0,176,80);"><span style="font-family:'迷你简启体';">，可用于在线分析。</span></span></p><p><span style="color:rgb(0,176,80);">2<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">的最新版本为</span><span style="font-family:'Times New Roman';">1.8.0</span><span style="font-family:'迷你简启体';">。可用于生产。</span></span></p><p><span style="color:rgb(0,176,80);">3<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">有两个发布的版本，一个是</span><span style="font-family:'Times New Roman';">0.9.x</span><span style="font-family:'迷你简启体';">，一个是</span><span style="font-family:'Times New Roman';">1.x</span><span style="font-family:'迷你简启体';">。推荐使用</span><span style="font-family:'Times New Roman';">1.x</span><span style="font-family:'迷你简启体';">版本。</span></span><span style="color:rgb(0,176,80);">本文档适用于<span style="font-family:'Times New Roman';">1.4.x</span></span><span style="color:rgb(0,176,80);">及其以后的版本。</span></p><p><span style="color:rgb(0,176,80);">4<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">对系统的要求，</span><span style="font-family:'Times New Roman';">Java</span><span style="font-family:'迷你简启体';">要求</span><span style="font-family:'Times New Roman';">1.8</span><span style="font-family:'迷你简启体';">或者更高，</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">要有操作目录的读写权限。</span></span></p></td></tr></tbody></table><h1><strong>2 Flume<span style="font-family:'楷体';">架构</span></strong></h1><p align="justify">Flume event<span style="font-family:'宋体';">是一个数据流单元，里面装载着</span><span style="font-family:'Times New Roman';">byte</span><span style="font-family:'宋体';">类型的数据，这组数据的属性是可选的，可配置的。</span>Flume agent<span style="font-family:'宋体';">是一个（</span>JVM<span style="font-family:'宋体';">）进程，</span><span style="font-family:'宋体';">是</span><span style="font-family:'宋体';">用于承载</span>event<span style="font-family:'宋体';">从外部源流向下一个目标（</span>hop<span style="font-family:'宋体';">）的组件。</span></p><p align="justify">Flume source<span style="font-family:'宋体';">消费</span><span style="font-family:'宋体';">由外部源（如</span>Web<span style="font-family:'宋体';">服务器）传递给它的</span>event<span style="font-family:'宋体';">。外部源以</span>Flume source<span style="font-family:'宋体';">识别的格式向</span>Flume<span style="font-family:'宋体';">发送</span>event<span style="font-family:'宋体';">。例如，</span>Avro source<span style="font-family:'宋体';">可用于接收来自</span>Avro<span style="font-family:'宋体';">客户端或</span><span style="font-family:'宋体';">另一个</span>agent<span style="font-family:'宋体';">的</span>Avro sink<span style="font-family:'宋体';">发送</span><span style="font-family:'宋体';">的</span>event<span style="font-family:'宋体';">。使用</span>Thrift Flume Source<span style="font-family:'宋体';">可以定义类似的流程，以接收来自</span><span style="font-family:'Times New Roman';">Thrift Sink</span><span style="font-family:'宋体';">或</span><span style="font-family:'Times New Roman';">Flume Thrift Rpc</span><span style="font-family:'宋体';">客户端的</span>event<span style="font-family:'宋体';">。当</span>source<span style="font-family:'宋体';">接收</span>event<span style="font-family:'宋体';">时，它会将其存储到一个或多个</span>channel<span style="font-family:'宋体';">。</span>Channel<span style="font-family:'宋体';">可以存储</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'宋体';">，直到</span>event<span style="font-family:'宋体';">被</span>sink<span style="font-family:'宋体';">消费</span><span style="font-family:'宋体';">。</span>File channel<span style="font-family:'宋体';">就是一个例子</span><span style="font-family:'宋体';">，</span>HDFS sink<span style="font-family:'宋体';">从</span>channel<span style="font-family:'宋体';">中删除</span>event<span style="font-family:'宋体';">并将</span>event<span style="font-family:'宋体';">放入</span>HDFS<span style="font-family:'宋体';">等外部存储库或将其转发到流中下一个</span>agent<span style="font-family:'宋体';">（下一个</span>hop<span style="font-family:'宋体';">）的</span>source<span style="font-family:'宋体';">。</span>agent<span style="font-family:'宋体';">中的</span>source<span style="font-family:'宋体';">和</span>sink<span style="font-family:'宋体';">与</span>channel<span style="font-family:'宋体';">中的</span>event<span style="font-family:'宋体';">异步运行。</span></p><p align="justify">Flume<span style="font-family:'宋体';">允许用户构建</span><span style="font-family:'宋体';">多级</span>hop<span style="font-family:'宋体';">，</span>event<span style="font-family:'宋体';">在到达最终目的地之前通过多个</span>agent<span style="font-family:'宋体';">传播。它还允许扇入</span>(fan-in)<span style="font-family:'宋体';">和扇出</span>(fan-out)<span style="font-family:'宋体';">流，上下文路由和备份路由（故障转移）。</span></p><p align="justify"><span style="font-family:'宋体';">这些</span>event<span style="font-family:'宋体';">在每个</span>agent<span style="font-family:'宋体';">的</span>channel<span style="font-family:'宋体';">中进行组织。然后将</span>event<span style="font-family:'宋体';">传递到流中的下一个</span>agent<span style="font-family:'宋体';">或终端存储库（如</span>HDFS<span style="font-family:'宋体';">）。仅当</span>event<span style="font-family:'宋体';">存储在下一个</span>agent<span style="font-family:'宋体';">的</span>channel<span style="font-family:'宋体';">或终端存储库中后才会从</span>channel<span style="font-family:'宋体';">中删除</span>event<span style="font-family:'宋体';">。</span><span style="font-family:'宋体';">这是</span>Flume<span style="font-family:'宋体';">如何提供流的端到端可靠性原理。</span></p><p align="justify">Flume<span style="font-family:'宋体';">采用事务（</span><span style="font-family:'Times New Roman';">transaction</span><span style="font-family:'宋体';">）来保证事件的可靠传递。这确保了该组事件可靠地在流程中从点到点传递。在多跳流情况下，来自前一个</span>hop<span style="font-family:'宋体';">的</span>sink<span style="font-family:'宋体';">和来自下一个</span>hop<span style="font-family:'宋体';">的</span>source<span style="font-family:'宋体';">都以事务运行，以确保数据安全地存储在下一个</span>hop<span style="font-family:'宋体';">的</span>channel<span style="font-family:'宋体';">中。</span></p><p align="justify"><span style="font-family:'宋体';">这些</span>event<span style="font-family:'宋体';">在</span>channel<span style="font-family:'宋体';">中</span><span style="font-family:'宋体';">组织</span><span style="font-family:'宋体';">，</span>channel<span style="font-family:'宋体';">负责</span><span style="font-family:'宋体';">从失败中恢复</span><span style="font-family:'宋体';">。</span>Flume<span style="font-family:'宋体';">支持由本地文件系统支持的持久</span>file channel<span style="font-family:'宋体';">。还有一个</span>memory channel<span style="font-family:'宋体';">，它将</span>event<span style="font-family:'宋体';">简单地存储在内存队列中，速度更快，但是当</span>agent<span style="font-family:'宋体';">进程死亡时仍然留在</span>memory channel<span style="font-family:'宋体';">中的任何</span>event<span style="font-family:'宋体';">都无法恢复。</span></p><table><tbody><tr><td valign="top"><p><span style="color:rgb(0,176,80);">1<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">有三个组件，</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">，它们合起来称为一个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">，也可以理解为一个</span><span style="font-family:'Times New Roman';">hop</span><span style="font-family:'迷你简启体';">。启动后的一个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">就是一个</span><span style="font-family:'Times New Roman';">JVM</span><span style="font-family:'迷你简启体';">进程。在同一个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">中，</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">，</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">可以有多个。</span></span></p><p><span style="color:rgb(0,176,80);">2<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">可以有多种类型，收集某种类型的数据就使用对应的</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">。</span><span style="font-family:'Times New Roman';">Channel</span><span style="font-family:'迷你简启体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">也是一样的。每种具体的类型有多种参数可以配置。</span></span></p><p><span style="color:rgb(0,176,80);">3<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">将数据封装为</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'迷你简启体';">，在</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">中存储和恢复。数据（也就是</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">封装好的</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'迷你简启体';">）在一个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">中的流向一定是中</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">到</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">，再到</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">。</span></span></p><p><span style="color:rgb(0,176,80);">4<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">中的</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">与</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">中的</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'迷你简启体';">异步运行。</span></span></p><p><span style="color:rgb(0,176,80);">5<span style="font-family:'迷你简启体';">、仅当</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'迷你简启体';">存储在下一个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">的</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">或终端存储库中后才会从</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">中删除</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'迷你简启体';">。</span></span></p><p><span style="color:rgb(0,176,80);">6<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">采用事务（</span><span style="font-family:'Times New Roman';">transaction</span><span style="font-family:'迷你简启体';">）来保证</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'迷你简启体';">的可靠传递。</span></span></p><p><span style="color:rgb(0,176,80);">7<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">负责</span></span><span style="color:rgb(0,176,80);">从失败中恢复</span><span style="color:rgb(0,176,80);">event<span style="font-family:'迷你简启体';">。当</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">的类型为</span><span style="font-family:'Times New Roman';">memory channel</span><span style="font-family:'迷你简启体';">时，</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">是无法实现容灾的。虽然</span><span style="font-family:'Times New Roman';">memory channel</span><span style="font-family:'迷你简启体';">的速度会更快。</span></span></p></td></tr></tbody></table><h1><strong>3 <span style="font-family:'楷体';">使用</span></strong></h1><p align="justify">Flume agent<span style="font-family:'宋体';">配置文件存储在本地配置文件中。这是一个遵循</span><span style="font-family:'Times New Roman';">Java properties</span><span style="font-family:'宋体';">文件格式的文本文件。一个或多个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">的配置文件可以在同一个配置文件目录中指定。配置文件包括</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">中每个</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'宋体';">，</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'宋体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'宋体';">的属性，以及它们如何连接在一起形成数据流。</span></p><p align="justify"><span style="font-family:'宋体';">流中的每个组件（</span>source<span style="font-family:'宋体';">，</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'宋体';">或</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'宋体';">）都具有特定的类型和实例的名称、类型和一组属性。例如，</span><span style="font-family:'Times New Roman';">Avro source</span><span style="font-family:'宋体';">需要主机名（或</span><span style="font-family:'Times New Roman';">IP</span><span style="font-family:'宋体';">地址）和端口号才能接收数据。</span><span style="font-family:'Times New Roman';">Memory channel</span><span style="font-family:'宋体';">可以具有最大队列大小（</span><span style="font-family:'Times New Roman';">capacity</span><span style="font-family:'宋体';">），</span><span style="font-family:'Times New Roman';">HDFS sink</span><span style="font-family:'宋体';">需要知道文件系统</span><span style="font-family:'Times New Roman';">URI</span><span style="font-family:'宋体';">，创建文件的路径等。组件的所有这些属性需要在属性文件中进行设置。</span></p><p align="justify">agent<span style="font-family:'宋体';">需要知道要加载的单个组件以及它们如何连接以构成流。这是通过列出</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">中每个</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'宋体';">，</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'宋体';">和</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'宋体';">的名称，然后为每个</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'宋体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'宋体';">指定连接</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'宋体';">来完成的。例如，</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">通过称为</span><span style="font-family:'Times New Roman';">File channel</span><span style="font-family:'宋体';">的文件通道将来自</span><span style="font-family:'Times New Roman';">Avro source</span><span style="font-family:'宋体';">的</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'宋体';">（称为</span><span style="font-family:'Times New Roman';">avroWeb</span><span style="font-family:'宋体';">）传输到</span><span style="font-family:'Times New Roman';">HDFS sink hdfs-cluster1</span><span style="font-family:'宋体';">。配置文件将包含这些组件和文件通道的名称，作为</span><span style="font-family:'Times New Roman';">avroWeb source</span><span style="font-family:'宋体';">和</span><span style="font-family:'Times New Roman';">hdfs-cluster1 sink</span><span style="font-family:'宋体';">的共享通道。</span></p><p align="justify"><span style="font-family:'宋体';">代理程序使用名为</span>flume-ng<span style="font-family:'宋体';">的</span><span style="font-family:'Times New Roman';">shell</span><span style="font-family:'宋体';">脚本启动，该脚本位于</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'宋体';">的</span><span style="font-family:'Times New Roman';">bin</span><span style="font-family:'宋体';">目录中。需要在命令行上指定代理名称，配置目录和配置文件：</span></p><table><tbody><tr><td valign="top"><p align="justify">$ bin / flume-ng agent -n $ agent_name -c conf -f conf / flume-conf.properties.template</p></td></tr></tbody></table><p align="justify"><span style="font-family:'宋体';"><br>现在代理将开始运行在给定属性文件中配置的</span>source<span style="font-family:'宋体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'宋体';">。</span></p><p align="justify"><span style="font-family:'宋体';">配置示例：</span></p><p align="justify"><span style="font-family:'宋体';">如下给出了一个示例配置文件，描述单节点</span>Flume<span style="font-family:'宋体';">部署。该配置允许用户生成事件并随后将其记录到控制台。</span></p><table><tbody><tr><td valign="top"><p align="justify"><em><span style="color:rgb(127,127,127);"># example.conf: A single-node Flume configuration</span></em></p><p align="justify"> </p><p align="justify"><em><span style="color:rgb(126,126,126);"># Name the components on this agent</span></em></p><p align="justify">a1.sources = r1</p><p align="justify">a1.sinks = k1</p><p align="justify">a1.channels = c1</p><p align="justify"> </p><p align="justify"><em><span style="color:rgb(126,126,126);"># Describe/configure the source</span></em></p><p align="justify">a1.sources.r1.type = netcat</p><p align="justify">a1.sources.r1.bind = localhost</p><p align="justify">a1.sources.r1.port = 44444</p><p align="justify"> </p><p align="justify"><em><span style="color:rgb(126,126,126);"># Describe the sink</span></em></p><p align="justify">a1.sinks.k1.type = logger</p><p align="justify"> </p><p align="justify"><em><span style="color:rgb(126,126,126);"># Use a channel which buffers events in memory</span></em></p><p align="justify">a1.channels.c1.type = memory</p><p align="justify">a1.channels.c1.capacity = 1000</p><p align="justify">a1.channels.c1.transactionCapacity = 100</p><p align="justify"> </p><p align="justify"><em><span style="color:rgb(126,126,126);"># Bind the source and sink to the channel</span></em></p><p align="justify">a1.sources.r1.channels = c1</p><p align="justify">a1.sinks.k1.channel = c1</p></td></tr></tbody></table><p align="justify"><span style="font-family:'宋体';">该配置定义了一个名为</span>a1<span style="font-family:'宋体';">的</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">。</span><span style="font-family:'Times New Roman';">a1</span><span style="font-family:'宋体';">有一个侦听端口</span><span style="font-family:'Times New Roman';">44444</span><span style="font-family:'宋体';">上的数据的</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'宋体';">，一个缓存内存中事件数据的</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'宋体';">，以及一个将</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'宋体';">数据记录到控制台的</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'宋体';">。配置文件命名各种组件，然后描述它们的类型和配置参数。一个给定的配置文件可能会定义多个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">， 当一个给定的</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'宋体';">进程启动时，要告诉程序启动的</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'宋体';">的名称。</span></p><p align="justify"><span style="font-family:'宋体';">给定这个配置文件，我们可以按如下方式启动</span>Flume<span style="font-family:'宋体';">：</span></p><table><tbody><tr><td valign="top"><p>$ bin / flume-ng agent --conf conf --conf -file example.conf --name a1 -Dflume.root.logger = INFO<span style="font-family:'宋体';">，</span><span style="font-family:Consolas;">console</span></p></td></tr></tbody></table><p align="justify"><span style="font-family:'宋体';">请注意，在完整部署中，我们通常会包含一个选项：</span>-- conf = &lt;conf-dir&gt;<span style="font-family:'宋体';">。所述</span><span style="font-family:'Times New Roman';">&lt;CONF-DIR&gt;</span><span style="font-family:'宋体';">目录将包括一个</span><span style="font-family:'Times New Roman';">shell</span><span style="font-family:'宋体';">脚本</span>flume-env.sh<span style="font-family:'宋体';">和一个</span><span style="font-family:'Times New Roman';">log4j</span><span style="font-family:'宋体';">的属性文件</span><span style="font-family:'宋体';">。在这个例子中，我们传递一个</span>Java<span style="font-family:'宋体';">选项来强制</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'宋体';">将日志输出到控制台，并且我们没有自定义环境脚本。</span></p><p align="justify"><span style="font-family:'宋体';">从一个单独的终端，我们可以</span>telnet<span style="font-family:'宋体';">端口</span><span style="font-family:'Times New Roman';">44444</span><span style="font-family:'宋体';">并发送一个</span><span style="font-family:'Times New Roman';">event</span><span style="font-family:'宋体';">给</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'宋体';">：</span></p><table><tbody><tr><td valign="top"><p align="justify">$ telnet localhost 44444</p><p align="justify">Trying 127.0.0.1...</p><p align="justify">Connected to localhost.localdomain (127.0.0.1).</p><p align="justify">Escape character is '^]'.</p><p align="justify">Hello world! &lt;ENTER&gt;</p><p align="justify">OK</p></td></tr></tbody></table><p align="justify"><span style="font-family:'宋体';">原始的</span>Flume<span style="font-family:'宋体';">终端将在日志消息中输出事件。</span></p><table><tbody><tr><td valign="top"><p align="justify">12/06/19 15:32:19 INFO source.NetcatSource: Source starting</p><p align="justify">12/06/19 15:32:19 INFO source.NetcatSource: Created serverSocket:sun.nio.ch.ServerSocketChannelImpl[/127.0.0.1:44444]</p><p align="justify">12/06/19 15:32:34 INFO sink.LoggerSink: Event: { headers:{} body: 48 65 6C 6C 6F 20 77 6F 72 6C 64 21 0D          Hello world!. }</p></td></tr></tbody></table><br><table><tbody><tr><td valign="top"><p><span style="color:rgb(0,176,80);">1<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">依靠配置文件启动。多个配置文件可以存放在一个配置文件目录下面。每个配置文件可以配置多个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">。每个</span><span style="font-family:'Times New Roman';">agent</span><span style="font-family:'迷你简启体';">需要指定</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">，以及它们是如何绑定在一起的。每个具体的</span><span style="font-family:'Times New Roman';">source</span><span style="font-family:'迷你简启体';">类型的参数是不同的，根据它们的实际情况来确定，</span><span style="font-family:'Times New Roman';">channel</span><span style="font-family:'迷你简启体';">和</span><span style="font-family:'Times New Roman';">sink</span><span style="font-family:'迷你简启体';">的情况也是一样的。</span></span></p><p><span style="color:rgb(0,176,80);">2<span style="font-family:'迷你简启体';">、</span><span style="font-family:'Times New Roman';">Flume</span><span style="font-family:'迷你简启体';">程序通过</span><span style="font-family:'Times New Roman';">flume-ng</span><span style="font-family:'迷你简启体';">这个脚本启动。启动时需要在命令行上指定代理名称，配置目录和配置文件目录。配置文件目录应该包括一个</span><span style="font-family:'Times New Roman';">flume-env.sh</span><span style="font-family:'迷你简启体';">和一个</span><span style="font-family:'Times New Roman';">log4j</span><span style="font-family:'迷你简启体';">的属性文件。</span></span></p></td></tr></tbody></table>            </div>
                </div>