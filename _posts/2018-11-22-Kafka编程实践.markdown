---
layout:     post
title:      Kafka编程实践
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，欢迎注明来源后转载。					https://blog.csdn.net/hanphy/article/details/79236167				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<div><span style="font-size:12pt;"><span style="font-size:12pt;font-weight:bold;">Kafka 编程实践</span></span></div>
<div><br></div>
<div>搭建了一个Kafka集群之后，看怎么用Java程序编写去利用它。</div>
<div><br></div>
<div>参考Kafka文档（<a href="http://kafka.apache.org/documentation/" rel="nofollow" style="font-size:9pt;color:rgb(0,0,238);text-decoration:underline;">http://kafka.apache.org/documentation/</a>），Kafka可以用在三个场景：</div>
<div>
<ol start="1"><li>Messaging System</li><li>Storage System</li><li>Stream Processing</li></ol><div><br></div>
</div>
<div>我用Java实现了一个“<span style="font-weight:bold;">生产者-消费者</span>”的场景。打算用一个工程，通过参数的形式来分别启动“生产者”和“消费者”进程。</div>
<div><br></div>
<div>建一个Java+Maven工程，在pom.xml中加个包：</div>
<div>
<div><br></div>
<div style="overflow:hidden;width:inherit;z-index:2;">
<table style="display:block;border-spacing:0px;table-layout:fixed;border:medium none;width:346px;"><colgroup><col style="width:346px;"></colgroup><tbody><tr style="vertical-align:top;"><td style="border-top-width:1px;border-bottom-width:1px;border-left-width:1px;border-style:solid none solid solid;border-color:rgb(164,184,199);min-width:31px;background-color:rgb(205,230,249);">
<div><span style="font-size:9pt;background-color:rgb(205,230,249);">&lt;dependency&gt;</span></div>
<div><span style="font-size:9pt;background-color:rgb(205,230,249);">    &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;</span></div>
<div><span style="font-size:9pt;background-color:rgb(205,230,249);">    &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;</span></div>
<div><span style="font-size:9pt;background-color:rgb(205,230,249);">    &lt;version&gt;1.0.0&lt;/version&gt;</span></div>
<div><span style="font-size:9pt;background-color:rgb(205,230,249);">&lt;/dependency&gt;</span></div>
</td>
</tr></tbody></table></div>
<div><br></div>
</div>
<div>新建三个类：Main、Producer、Consumer</div>
<div>
<ul><li><span style="line-height:1.45;">Main，负责</span><span style="line-height:1.45;">启动程序并解析参数，选择启动Producer还是Consumer；</span></li><li><span style="line-height:1.45;">Producer，负责生产一批量的消息到一个topic</span></li><li><span style="line-height:1.45;">Consumer，循环监听一个topic，有消息就打印</span></li></ul></div>
<div><br></div>
<br><div><span style="font-weight:bold;font-size:10pt;">Producer类</span></div>
<div><br></div>
<div>消息：我设定消息是一个Json字符串，模拟得像样一点：</div>
<div style="overflow:hidden;width:inherit;z-index:2;">
<table style="display:block;border-spacing:0px;table-layout:fixed;border:none;"><colgroup><col></colgroup><tbody><tr style="vertical-align:top;"><td style="border-top-width:1px;border-bottom-width:1px;border-left-width:1px;border-style:solid none solid solid;border-color:rgb(164,184,199);min-width:31px;background-color:rgb(205,230,249);">
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">private</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">String
 genJsonObject() {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">return</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"{\"id\":\""</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">+
 java.util.UUID.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">randomUUID</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">().toString().substring(0,
 13) +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"\""</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">",
 \"value\":\""</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">+</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">random</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.nextFloat()
 +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"\""</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">",
 \"timestamp\":\""</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">+</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">sdformat</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.format(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">java.util.Date())
 +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"\""</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"}"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
</td>
</tr></tbody></table></div>
<div><br></div>
<div>生产它们：</div>
<div>
<div><br></div>
<div style="overflow:hidden;width:inherit;z-index:2;">
<table style="display:block;border-spacing:0px;table-layout:fixed;border:none;"><colgroup><col></colgroup><tbody><tr style="vertical-align:top;"><td style="border-top-width:1px;border-bottom-width:1px;border-left-width:1px;border-style:solid none solid solid;border-color:rgb(164,184,199);min-width:31px;background-color:rgb(205,230,249);">
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">public</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">void</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">produce(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topic</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,
 Long</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">number</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">random</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">java.util.Random(System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">currentTimeMillis</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">());</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">for</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">int</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">i</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=
 0;</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">i</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">&lt;</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">number</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">i</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">++)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">message</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=
 genJsonObject();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">key</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=
 java.util.UUID.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">randomUUID</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">().toString().substring(0,
 13);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">producer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.send(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">ProducerRecord&lt;String,
 String&gt;(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topic</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">key</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">message</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">));</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"Sent:
 "</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">+</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">message</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';color:#3f7f5f;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">//
 随机延时</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">try</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">{</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        Thread.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">sleep</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(1000
 +</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">random</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.nextInt(5000)
 );</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">catch</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(InterruptedException</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">e</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">e</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.printStackTrace();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"finish
 producing."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
</td>
</tr></tbody></table></div>
<div><br></div>
</div>
<div><br></div>
<div><span style="font-size:10pt;font-weight:bold;">Consumer类</span></div>
<div><br></div>
<div>获取：</div>
<div>
<div><br></div>
<div style="overflow:hidden;width:inherit;z-index:2;">
<table style="display:block;border-spacing:0px;table-layout:fixed;border:none;"><colgroup><col></colgroup><tbody><tr style="vertical-align:top;"><td style="border-top-width:1px;border-bottom-width:1px;border-left-width:1px;border-style:solid none solid solid;border-color:rgb(164,184,199);min-width:31px;background-color:rgb(205,230,249);">
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">public</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">void</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">consume(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topics</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            java.util.List&lt;String&gt;</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topicList</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">java.util.ArrayList&lt;String&gt;();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">for</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">t</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topics</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.split(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">","</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topicList</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.add(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">t</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">consumer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.subscribe(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topicList</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">while</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">true</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  ConsumerRecords&lt;String, String&gt;</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">records</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">consumer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.poll(1);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">for</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(ConsumerRecord&lt;String,
 String&gt;</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">record</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">records</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.printf(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"offset
 = %d, key = %s, value = %s%n"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">record</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.offset(),</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">record</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.key(),</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">record</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.value());</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            }</span></div>
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
</td>
</tr></tbody></table></div>
<div><br></div>
</div>
<div><span style="font-weight:bold;">Main类</span></div>
<div>
<div><br></div>
<div style="overflow:hidden;width:inherit;z-index:2;">
<table style="display:block;border-spacing:0px;table-layout:fixed;border:none;"><colgroup><col></colgroup><tbody><tr style="vertical-align:top;"><td style="border-top-width:1px;border-bottom-width:1px;border-left-width:1px;border-style:solid none solid solid;border-color:rgb(164,184,199);min-width:31px;background-color:rgb(205,230,249);">
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">package</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">kafkademo;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">public</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">class</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">Main
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">static</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">public</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">void</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">main(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">[])
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">switch</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">[0])
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">case</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"consumer"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">runAsConsumer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">break</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">case</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"producer"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">runAsProducer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">break</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">default</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">usage</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">return</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">private</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">static</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">void</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">usage()
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"Usage:"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"   
 Program type:"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"       
 consumer    run as a consumer."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"       
 producer    run as a producer."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"   
 Options:"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--server=host:port 
 kafka entry point."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--number=number    
 number of message to produce."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"
 --topic=topic      topic of message to produce."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            System.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">out</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.println(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--topics=topics    
 topics of message to fetch from as a consumers."</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">private</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">static</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">void</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">runAsProducer(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">[])
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">host</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"localhost:9092"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            Long</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">number</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=
 1L;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topic</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"test-demo"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            java.util.Properties</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">props</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">java.util.Properties();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">for</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">if</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.startsWith(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--server="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">host</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.split(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)[1];</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#3f7f5f;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">//
 "49.4.67.131:9092");</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">if</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.startsWith(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--number="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">numString</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.split(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)[1];</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">if</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"INFINITE"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.equals(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">numString</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                              </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">number</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=
 Long.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;font-weight:bold;">MAX_VALUE</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        }</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">else</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">{</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                              </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">number</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=
 Long.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-style:italic;">parseLong</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">numString</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">if</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.startsWith(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--topic="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topic</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.split(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)[1];</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            Producer</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">producer</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">Producer();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">props</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.put(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"bootstrap.servers"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">host</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">producer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.init(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">props</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">producer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.produce(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topic</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">number</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">producer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.tearDown();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">private</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">static</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">void</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">runAsConsumer(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">[])
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">host</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"localhost:9092"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topics</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"test-demo"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">;</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            java.util.Properties</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">props</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">java.util.Properties();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">for</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(String</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">:</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">args</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">if</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.startsWith(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--server="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">host</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.split(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)[1];</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#3f7f5f;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">//
 "49.4.67.131:9092");</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  </span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">if</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.startsWith(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"--topics="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">))
 {</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                        </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topics</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">arg</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.split(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"="</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">)[1];</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">                  }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            }</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            Consumer</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">consumer</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">=</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);font-weight:bold;">new</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">Consumer();</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">props</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.put(</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">"bootstrap.servers"</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">,</span><span style="background-color:rgb(205,230,249);"><span> </span></span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">host</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">consumer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.init(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">props</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">            </span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">consumer</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">.</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(212,212,212);">consume</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">(</span><span style="font-family:'Courier New';color:#6a3e3e;min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">topics</span><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">);</span></div>
<div style="min-height:10pt;"><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">      }</span></div>
<div><span style="font-family:'Courier New';min-height:10pt;font-size:10pt;background-color:rgb(205,230,249);">}</span></div>
</td>
</tr></tbody></table></div>
<div>
<hr style="border-width:6px 0px;border-style:solid none;border-color:#FFFFFF;background-color:rgb(153,153,153);"><div><br></div>
</div>
</div>
<div>运行起来</div>
<div><br></div>
<div>生产：</div>
<div><img src="https://img-blog.csdn.net/20180202103156148?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGFucGh5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br></div>
<div><br></div>
<div>消费：</div>
<div><img src="https://img-blog.csdn.net/20180202103413781?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGFucGh5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""><br></div>
            </div>
                </div>