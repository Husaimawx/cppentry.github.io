---
layout:     post
title:      Spark从零开始
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/shineflowers/article/details/70052967				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p><span style="font-family:Comic Sans MS;font-size:24px;">Spark简介</span></p><p><span style="font-family:SimSun;font-size:14px;">Spark是一个快速且通用的集群计算机平台。</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>快速</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">1.Spark扩充了流行的Mapreduce计算机模型</span></p><p><span style="font-family:SimSun;font-size:14px;">2.Spark是基于内存的计算</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>通用</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">Spark的设计容纳了其他分布式系统拥有的功能批处理，迭代式计算，交互查询和流处理等。</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Spark是高度开放的</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">Spark提供了Python，Java，Scala，SQL的API和丰富的内置库。</span></p><p><span style="font-family:SimSun;font-size:14px;">Spark和其他的大数据工具整合得很好，包括hadoop，kafka等。</span></p><p><span style="font-family:SimSun;font-size:14px;"><span style='font-family: "Comic Sans MS";font-size:24px;'>Spark历史</span><br></span></p><p><span style="font-family:SimSun;font-size:14px;">1.诞生于2009年，加州大学伯克利分校RAD实验室的一个研究项目，最初是基于Hadoop Mapreduce的。发现Mapreduce在迭代式计算和交互式低效，引入了内存存储</span></p><p><span style="font-family:SimSun;font-size:14px;">2.2010年3月份Spark开源</span></p><p><span style="font-family:SimSun;font-size:14px;">3.2011年AMP实验室在Spark上开发高级组件，像Spark Streaming</span></p><p><span style="font-family:SimSun;font-size:14px;">4.2013年转移到了Apache下，不就便成顶级项目了</span></p><p><span style="font-family:SimSun;font-size:14px;"><span style='font-family: "Comic Sans MS";font-size:24px;'>Spark组件</span><br></span></p><p><span style="font-family:SimSun;font-size:14px;">Spark包括多个紧密集成的组件</span></p><p><span style="font-family:SimSun;font-size:14px;"><img src="http://img.my.csdn.net/uploads/201704/09/1491700599_9102.png" width="531" height="345" alt=""><br></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Spark Core</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">包含Spark的基本功能，包含任务调度，内存管理，容错机制等。</span></p><p><span style="font-family:SimSun;font-size:14px;">内部定义了RDDs(弹性分布式数据集).</span></p><p><span style="font-family:SimSun;font-size:14px;">提供了很多APIs来创建和操作这些RDDs。</span></p><p><span style="font-family:SimSun;font-size:14px;">应用场景，为其他的组件提供底层的服务。</span></p><p><span style="font-family:SimSun;font-size:14px;"><span style="font-family: SimSun;font-size:18px;"><strong>Spark SQL</strong></span><br></span></p><p><span style="font-family:SimSun;font-size:14px;">是Spark处理结构化数据的库，就像Hive SQL，Mysql一样。</span></p><p><span style="font-family:SimSun;font-size:14px;">应用场景，企业中用来做报表统计。</span></p><p><span style="font-family:SimSun;font-size:14px;"><span style="font-family: SimSun;font-size:18px;"><strong>Spark Streaming</strong></span><br></span></p><p><span style="font-family:SimSun;font-size:14px;">是实时数据流处理组件，类似Storm。</span></p><p><span style="font-family:SimSun;font-size:14px;">Spark Streaming提供了API来操作实时流数据。</span></p><p><span style="font-family:SimSun;font-size:14px;">应用场景，企业中用来从Kafka接收数据做实时统计。</span></p><p><span style="font-family:SimSun;"><span style="font-size:18px;"><strong>Mlib</strong></span></span></p><p><span style="font-family:SimSun;font-size:14px;">一个包含通用机器学习功能的包，Machine learning lib。</span></p><p><span style="font-family:SimSun;font-size:14px;">包含分类，聚类，回归等，还包括模型评估和数据导入。</span></p><p><span style="font-family:SimSun;font-size:14px;">Mlib提供的上面这些方法，都支持集群上的横向扩展。</span></p><p><span style="font-family:SimSun;font-size:14px;">应用场景，机器学习</span></p><p><span style="font-family:SimSun;"><span style="font-size:18px;"><strong>Graphx</strong></span></span></p><p><span style="font-family:SimSun;font-size:14px;">是处理图的库(例如社交网络图)，并进行图的并行计算。</span></p><p><span style="font-family:SimSun;font-size:14px;">像Spark Streaming，Spark SQL一样，它也继承了RDD API。</span></p><p><span style="font-family:SimSun;font-size:14px;">它提供了各种图的操作，和常用的图算法，例如PangeRank算法。</span></p><p><span style="font-family:SimSun;font-size:14px;">应用场景，图计算。</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Cluster Managers</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">就是集群管理，Spark自带一个集群管理是单独调度器。</span></p><p><span style="font-family:SimSun;font-size:14px;">常见集群管理包括Hadoop YARN，Apache Mesos</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>紧密集成的优点</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">Spark底层优化了，基于Spark底层的组件也得到了相应的优化。</span></p><p><span style="font-family:SimSun;font-size:14px;">紧密集成，节省了各个组件组合使用时的部署，测试等时间。</span></p><p><span style="font-family:SimSun;font-size:14px;">向Spark增加新的组件时，其他组件可立刻享用新组件的功能。</span></p><p><span style="font-family:SimSun;font-size:14px;"><span style='font-family: "Comic Sans MS";font-size:24px;'>Spark和Hadoop比较</span><br></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Hadoop应用场景</strong></span></p><p><span style="font-family: SimSun;"><span style="font-size:14px;">1.离线处理</span></span></p><p><span style="font-family: SimSun;"><span style="font-size:14px;">2.对时效性要求不高</span></span></p><p><span style="font-family:SimSun;"></span></p><p><span style="font-size: 18px;"><span style="font-family:SimSun;"><strong>Spark应用场景</strong></span></span></p><p><span style="font-family:SimSun;font-size:14px;">1.时效性要求高的场景</span></p><p><span style="font-family:SimSun;font-size:14px;">2.机器学习等领域</span></p><p><span style="font-family:Comic Sans MS;"><span style="font-size: 24px;">Spark下载和安装</span></span></p><p><span style='font-family: "Comic Sans MS";'><span style="font-size:14px;"><span style="font-family: SimSun;">Spark是Scala写的，运行在JVM上，所以运行环境Java7+</span></span></span></p><p><span style="font-family:SimSun;font-size:14px;">如果使用Python API，需要安装Python 2.6+或者Python 3.4+。</span></p><p><span style="font-family:SimSun;font-size:14px;">Spark 1.6.2 - Scala 2.10  Spark 2.0.0 - Scala 2.11</span></p><p><span style="font-family:SimSun;font-size:14px;">下载地址：<a target="_blank" href="http://spark.apache.org/downloads.html" rel="nofollow">http://spark.apache.org/downloads.html</a>，</span></p><p><span style="font-family:SimSun;font-size:14px;">搭Spark不需要Hadoop，如有hadoop集群，可下载相应的版本。</span></p><p><span style="font-family:SimSun;font-size:14px;">下载完成后，解压目录如下：</span></p><span style="font-family:SimSun;font-size:14px;"><img src="http://img.my.csdn.net/uploads/201704/11/1491874040_1989.png" width="708" height="374" alt=""><br></span><p><span style="font-family:SimSun;"><span style="font-size: 14px;">bin包含用来和Spark交互的可执行文件，如Spark shell。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">core，streaming,python...包含主要组件的源代码</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">examples包含一些单机Spark job，你可以研究和运行这些例子。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><span style='font-family: "Comic Sans MS"; font-size: 24px;'>Spark Shell</span><br></span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark shell使你能够处理分布在集群上的数据。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark把数据加载到节点的内存中，因此分布式处理可在秒级完成。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">快速迭代式计算，实时查询、分析一般能够在shells完成。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark提供了Python shells和Scala shells。</span></span></p><p><span style="font-family:Comic Sans MS;"><span style="font-size: 24px;">RDDs介绍</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Driver program</strong></span></p><p><span style="font-family:SimSun;font-size:14px;">包含程序的main()方法，RDDs的定义和操作。</span></p><p><span style="font-family:SimSun;font-size:14px;">它管理很多节点，我们称作executors。</span></p><p><span style="font-family:SimSun;font-size:14px;"><img src="http://img.my.csdn.net/uploads/201704/11/1491878188_8062.png" width="554" height="261" alt=""><br></span></p><p><span style="font-family:SimSun;font-size:14px;"><br></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>SparkContext</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><span style="font-family: SimSun;font-size:14px;">Driver programs通过SparkContext对象访问Spark。SparkContext对象代表和一个集群的连接。</span><br></span></span></p><p><span style="font-family:SimSun;font-size:14px;">在Shell中SparkContext自动创建好了，就是sc。</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>RDDs</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Resilient distributed datasets(弹性分布式数据集，简写RDDs)。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">这些RDDs，并行的分布在整个集群中。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">RDDs是Spark分发数据和计算的基础抽象类。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">一个RDDs是一个不可改变的分布式集合对象</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark中，所有计算都是通过RDDs的创建、转换操作完成的。</span></span></p><p><span style="font-family:SimSun;">一个RDDs内部由许多partitions(分片)组成。</span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>分片</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">每个分片包括一部分数据，partitions可在集群不同节点上计算。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">分片是Spark并行处理的单元，Spark顺序的，并行地处理分片</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>RDDs的创建方法</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">1. 把一个存在的集合传给SparkContext的parallelize()方法(测试的时候使用)</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">val rdd = sc.parallelize(Array(1, 2, 3, 4), 4)</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">第1个参数：待并行化处理的集合</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">第2个参数：分区个数</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">2. 加载外部数据集</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">val rdd = sc.textFile("helloSpark.txt") </span></span></p><p><span style="font-family:Comic Sans MS;"><span style="font-size: 24px;">Scala的基础知识</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Scala的变量声明</strong></span></p><p><span style="font-family:Comic Sans MS;"><span style="font-size: 24px;"><span style="font-family: SimSun; font-size: 14px;">在Scala中创建变量的时候，必须使用val或者var</span></span></span></p><p><span style="font-family:Comic Sans MS;"><span style="font-size: 24px;"><span style="font-family: SimSun; font-size: 14px;">val，变量值不可修改，一旦分配不能重新指向别的值</span></span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">var，分配后，可以指向类型相同的值。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><span style="font-family: SimSun;font-size:18px;"><strong>Scala的匿名函数和类型推断</strong></span><br></span></span></p><p><span style="font-family:SimSun;font-size:14px;">lines.filter(line =&gt; line.contains("world"))</span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">定义一个匿名函数，接收一个参数line</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">使用line这个String类型变量上的contains方法，并且返回结果。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">line的类型不需指定，能够推断出来。</span></span></p><p><span style="font-family:Comic Sans MS;"><span style="font-size: 24px;">RDD基本操作之Transformation</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>Transformation</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">转换，从之前的RDD构建一个新的RDD，像map()和filter()。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><span style="font-family: SimSun;font-size:18px;">1.逐元素Transformation</span><br></span></span></p><p><span style="font-family:SimSun;font-size:14px;"><span style="font-family: SimSun;">map()：接收函数，把函数应用到RDD的每一个元素，返回新RDD。</span></span></p><p><span style="font-family:SimSun;font-size:14px;">filter()：接收函数，返回只包含满足filter()函数的元素的新RDD。</span></p><p><span style="font-family:SimSun;font-size:14px;">flatMap()：对每个输入元素，输出多个输出元素。flat压扁的意思，将RDD中元素压扁后返回一个新的RDD。</span></p><p><span style="font-family:SimSun;font-size:14px;">集合运算：RDDs支持数学集合的计算，例如并集，交集计算。</span></p><p><span style='font-size: 24px; font-family: "Comic Sans MS";'>RDD基本操作之Action<br></span><span style="font-family:SimSun;font-size:18px;"><strong>Action介绍</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">在RDD上计算出来一个结果，把结果返回给driver program或保存在文件系统，count()，save</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">一些Action说明如下：</span></span></p><p></p><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">1.reduce(func)：</span>通过函数func</span><span style="margin: 0px; padding: 0px;">先聚集各分区的数据集，再聚集分区之间的数据，func接收两个参数，返回一个新值，新值再做为参数继续传递给函数func，直到最后一个元素</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">2.collect()：</span>以数据的形式返回数据集中的所有元素给Driver程序，为防止Driver程序内存溢出，一般要控制返回的数据集大小<br style="margin: 0px; padding: 0px;"></span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">3.count()：</span>返回数据集元素个数<br style="margin: 0px; padding: 0px;"></span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">4.first()：</span>返回数据集的第一个元素</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">5.take(n)：</span>以数组的形式返回数据集上的前n个元素</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">6.top(n)：</span>按默认或者指定的排序规则返回前n个元素，默认按降序输出</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">7.takeOrdered(n,[ordering]):</span> 按自然顺序或者指定的排序规则返回前n个元素</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;"><span style="font-family:SimSun;font-size:14px;">例1：</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_Highlighter sh-gutter" style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div id="highlighter_825872" class="syntaxhighlighter  java" style="padding: 0px; width: 686.575px; margin: 1em 0px !important; position: relative !important; overflow: auto !important; background-color: rgb(255, 255, 255) !important;"><table border="0" cellpadding="0" cellspacing="0" style="border: 1px solid silver; width: 686.4px; border-collapse: collapse; word-break: break-word; margin: 0px !important; padding: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: auto !important; background: none !important;"><tbody style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><tr style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><td class="gutter" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: 35px !important; min-height: auto !important; color: rgb(175, 175, 175) !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">1</span></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">2</span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">3</span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">4</span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">5</span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">6</span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">7</span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">8</span></div><div class="line number9 index8 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">9</span></div><div class="line number10 index9 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">10</span></div><div class="line number11 index10 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">11</span></div><div class="line number12 index11 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">12</span></div><div class="line number13 index12 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">13</span></div><div class="line number14 index13 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">14</span></div><div class="line number15 index14 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">15</span></div><div class="line number16 index15 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">16</span></div><div class="line number17 index16 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">17</span></div><div class="line number18 index17 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">18</span></div><div class="line number19 index18 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">19</span></div><div class="line number20 index19 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">20</span></div><div class="line number21 index20 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">21</span></div><div class="line number22 index21 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">22</span></div><div class="line number23 index22 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">23</span></div><div class="line number24 index23 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">24</span></div></td><td class="code" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="container" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: relative !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><span style="font-family:SimSun;font-size:14px;">def main(args: Array[String]) {</span></code></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val conf = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkConf().setMaster(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"local"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">).setAppName(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"reduce"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val sc = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkContext(conf)</code></span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val rdd = sc.parallelize(</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">1</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">to </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">10</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">,</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val reduceRDD = rdd.reduce(_ + _)</code></span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val reduceRDD1 = rdd.reduce(_ - _) </code><code class="java comments" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 130, 0) !important; background: none !important;">//如果分区数据为1结果为 -53</code></span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val countRDD = rdd.count()</code></span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val firstRDD = rdd.first()</code></span></div><div class="line number9 index8 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val takeRDD = rdd.take(</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">5</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)    </code><code class="java comments" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 130, 0) !important; background: none !important;">//输出前个元素</code></span></div><div class="line number10 index9 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val topRDD = rdd.top(</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">3</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)      </code><code class="java comments" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 130, 0) !important; background: none !important;">//从高到底输出前三个元素</code></span></div><div class="line number11 index10 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val takeOrderedRDD = rdd.takeOrdered(</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">3</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)    </code><code class="java comments" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 130, 0) !important; background: none !important;">//按自然顺序从底到高输出前三个元素</code></span></div><div class="line number12 index11 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div class="line number13 index12 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"func +: "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">+reduceRDD)</code></span></div><div class="line number14 index13 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"func -: "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">+reduceRDD1)</code></span></div><div class="line number15 index14 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"count: "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">+countRDD)</code></span></div><div class="line number16 index15 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"first: "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">+firstRDD)</code></span></div><div class="line number17 index16 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"take:"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number18 index17 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">takeRDD.foreach(x =&gt; print(x +</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">" "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">))</code></span></div><div class="line number19 index18 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"\ntop:"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number20 index19 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">topRDD.foreach(x =&gt; print(x +</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">" "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">))</code></span></div><div class="line number21 index20 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"\ntakeOrdered:"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number22 index21 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">takeOrderedRDD.foreach(x =&gt; print(x +</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">" "</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">))</code></span></div><div class="line number23 index22 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">sc.stop</code></span></div><div class="line number24 index23 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">  </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">}</code></span></div></div></td></tr></tbody></table></div></div></div></div></div></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;"><span style="font-family:SimSun;font-size:14px;">输出：</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245);"><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5;"><a target="_blank" title="复制代码" style="color: rgb(7, 93, 179); text-decoration: underline; margin: 0px; padding: 0px; border: none !important;"><span style="font-family:SimSun;font-size:14px;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border: none !important; max-width: 900px; margin: 0px; padding: 0px;"></span></a></span></div><pre style="white-space: pre-wrap; word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">func +: <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">55</span><span style="margin: 0px; padding: 0px; line-height: 1.5;">
func </span>-: <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">15</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(0, 128, 0);">//</span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(0, 128, 0);">如果分区数据为1结果为 -53</span>
count: <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">10</span><span style="margin: 0px; padding: 0px; line-height: 1.5;">
first: </span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">1</span><span style="margin: 0px; padding: 0px; line-height: 1.5;">
take:
</span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">1</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">2</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">3</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">4</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">5</span><span style="margin: 0px; padding: 0px; line-height: 1.5;">
top:
</span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">10</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">9</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">8</span><span style="margin: 0px; padding: 0px; line-height: 1.5;">
takeOrdered:
</span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">1</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">2</span> <span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">3</span></span></pre><div class="cnblogs_code_toolbar" style="margin: 5px 0px 0px; padding: 0px;"><span class="cnblogs_code_copy" style="margin: 0px; padding: 0px 5px 0px 0px; line-height: 1.5;"><a target="_blank" title="复制代码" style="color: rgb(7, 93, 179); text-decoration: underline; margin: 0px; padding: 0px; border: none !important;"><span style="font-family:SimSun;font-size:14px;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border: none !important; max-width: 900px; margin: 0px; padding: 0px;"></span></a></span></div></div></div></div></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> <span style="margin: 0px; padding: 0px;">(RDD依赖图：红色块表示一个RDD区，黑色块表示该分区集合，下同)</span></span></div><div style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><img src="http://images2015.cnblogs.com/blog/776259/201604/776259-20160420211125679-465741576.png" alt="" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">         （RDD依赖图）</span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><img src="file:///D:/Program%20Files/WizNote/temp/1ea90053-11d4-46bc-906e-bd74e27ebd25_128_files/7b572a78-ac73-4842-bc98-c8474583a0a4.png" alt="" border="0" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">8.countByKey()：</span></span>作用于K-V类型的RDD上，统计每个key的个数，返回(K,K的个数)</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">9.collectAsMap()：</span></span>作用于K-V类型的RDD上，作用与collect不同的是collectAsMap函数不包含重复的key，对于重复的key。后面的元素覆盖前面的元素</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">10.lookup(k)：</span>作用于K-V类型的RDD上，返回指定K的所有V值</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">例2：</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_Highlighter sh-gutter" style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div id="highlighter_509303" class="syntaxhighlighter  java" style="padding: 0px; width: 686.575px; margin: 1em 0px !important; position: relative !important; overflow: auto !important; background-color: rgb(255, 255, 255) !important;"><table border="0" cellpadding="0" cellspacing="0" style="border: 1px solid silver; width: 686.4px; border-collapse: collapse; word-break: break-word; margin: 0px !important; padding: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: auto !important; background: none !important;"><tbody style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><tr style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><td class="gutter" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: 35px !important; min-height: auto !important; color: rgb(175, 175, 175) !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">1</span></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">2</span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">3</span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">4</span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">5</span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">6</span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">7</span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">8</span></div><div class="line number9 index8 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">9</span></div><div class="line number10 index9 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">10</span></div><div class="line number11 index10 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">11</span></div><div class="line number12 index11 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">12</span></div><div class="line number13 index12 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">13</span></div><div class="line number14 index13 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">14</span></div><div class="line number15 index14 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">15</span></div></td><td class="code" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="container" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: relative !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><span style="font-family:SimSun;font-size:14px;">def main(args: Array[String]) {</span></code></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val conf = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkConf().setMaster(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"local"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">).setAppName(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"KVFunc"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val sc = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkContext(conf)</code></span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val arr = List((</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"A"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">1</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"B"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"A"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"B"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">3</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">))</code></span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val rdd = sc.parallelize(arr,</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val countByKeyRDD = rdd.countByKey()</code></span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val collectAsMapRDD = rdd.collectAsMap()</code></span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div class="line number9 index8 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"countByKey:"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number10 index9 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">countByKeyRDD.foreach(print)</code></span></div><div class="line number11 index10 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div class="line number12 index11 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"\ncollectAsMap:"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number13 index12 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">collectAsMapRDD.foreach(print)</code></span></div><div class="line number14 index13 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">   </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">sc.stop</code></span></div><div class="line number15 index14 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"> </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">}</code></span></div></div></td></tr></tbody></table></div></div></div></div></div></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;"><span style="font-family:SimSun;font-size:14px;">输出：</span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245);"><pre style="white-space: pre-wrap; word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">countByKey:
(B,</span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">2</span>)(A,<span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">2</span><span style="margin: 0px; padding: 0px; line-height: 1.5;">)
collectAsMap:
(A,</span><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">2</span>)(B,<span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);">3</span>)</span></pre></div></div></div></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><img src="file:///D:/Program%20Files/WizNote/temp/1ea90053-11d4-46bc-906e-bd74e27ebd25_128_files/3bfb2ad4-80f7-4ad5-8084-45473ba22a2a.png" alt="" border="0" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> <img src="http://images2015.cnblogs.com/blog/776259/201604/776259-20160420211321898-953494488.png" alt="" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">        （RDD依赖图）</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;"><span style="font-family:SimSun;font-size:14px;">11.aggregate(zeroValue:U)(seqOp:(U,T) =&gt; U,comOp(U,U) =&gt; U):</span></span></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">seqOp函数将每个分区的数据聚合成类型为U的值，comOp函数将各分区的U类型数据聚合起来得到类型为U的值</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_Highlighter sh-gutter" style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div id="highlighter_772833" class="syntaxhighlighter  java" style="padding: 0px; width: 686.575px; margin: 1em 0px !important; position: relative !important; overflow: auto !important; background-color: rgb(255, 255, 255) !important;"><table border="0" cellpadding="0" cellspacing="0" style="border: 1px solid silver; width: 686.4px; border-collapse: collapse; word-break: break-word; margin: 0px !important; padding: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: auto !important; background: none !important;"><tbody style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><tr style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><td class="gutter" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: 35px !important; min-height: auto !important; color: rgb(175, 175, 175) !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">1</span></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">2</span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">3</span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">4</span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">5</span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">6</span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">7</span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">8</span></div></td><td class="code" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="container" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: relative !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><span style="font-family:SimSun;font-size:14px;">def main(args: Array[String]) {</span></code></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val conf = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkConf().setMaster(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"local"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">).setAppName(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"Fold"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val sc = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkContext(conf)</code></span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val rdd = sc.parallelize(List(</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">1</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">,</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">,</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">3</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">,</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">4</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">),</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val aggregateRDD = rdd.aggregate(</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)(_+_,_ * _)</code></span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(aggregateRDD)</code></span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">sc.stop</code></span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">  </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">}</code></span></div></div></td></tr></tbody></table></div></div></div></div></div></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">输出：</span></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_code" style="margin: 5px 0px; padding: 5px; border: 1px solid rgb(204, 204, 204); overflow: auto; background-color: rgb(245, 245, 245);"><pre style="white-space: pre-wrap; word-wrap: break-word; margin-top: 0px; margin-bottom: 0px; padding: 0px;"><span style="margin: 0px; padding: 0px; line-height: 1.5; color: rgb(128, 0, 128);"><span style="font-family:SimSun;font-size:14px;">90</span></span></pre></div></div></div></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">步骤1：分区1：zeroValue+1+2=5   分区2：zeroValue+3+4=9</span></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">步骤2：zeroValue*分区1的结果*分区2的结果=90</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><img src="file:///D:/Program%20Files/WizNote/temp/6bf69209-2cac-41aa-9b2e-98555738daeb.png" alt="" border="0" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> <img src="http://images2015.cnblogs.com/blog/776259/201604/776259-20160420211348273-88463613.png" alt="" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">            （RDD依赖图）</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">12.fold(zeroValue:T)(op:(T,T) =&gt; T):</span>通过op函数聚合各分区中的元素及合并各分区的元素，op函数需要两个参数，在开始时第一个传入的参数为zeroValue,T为RDD数据集的数据类型，，其作用相当于SeqOp和comOp函数都相同的aggregate函数</span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">例3</span></div><div style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_Highlighter sh-gutter" style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div id="highlighter_213600" class="syntaxhighlighter  java" style="padding: 0px; width: 686.575px; margin: 1em 0px !important; position: relative !important; overflow: auto !important; background-color: rgb(255, 255, 255) !important;"><table border="0" cellpadding="0" cellspacing="0" style="border: 1px solid silver; width: 686.4px; border-collapse: collapse; word-break: break-word; margin: 0px !important; padding: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: auto !important; background: none !important;"><tbody style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><tr style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><td class="gutter" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: 35px !important; min-height: auto !important; color: rgb(175, 175, 175) !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">1</span></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">2</span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">3</span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">4</span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">5</span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">6</span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">7</span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;">8</span></div></td><td class="code" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="container" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: relative !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><span style="font-family:SimSun;font-size:14px;">def main(args: Array[String]) {</span></code></div><div class="line number2 index1 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val conf = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkConf().setMaster(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"local"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">).setAppName(</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"Fold"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number3 index2 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val sc = </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">new</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">SparkContext(conf)</code></span></div><div class="line number4 index3 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val rdd = sc.parallelize(Array((</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"a"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">1</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"b"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"a"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"c"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">5</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">), (</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"a"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">3</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)), </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">2</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">)</code></span></div><div class="line number5 index4 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val foldRDD = rdd.fold((</code><code class="java string" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: blue !important; background: none !important;">"d"</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">, </code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">0</code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">))((val1, val2) =&gt; { </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">if</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">(val1._2 &gt;= val2._2) val1 </code><code class="java keyword" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 0, 255) !important; background: none !important;">else</code> <code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">val2</code></span></div><div class="line number6 index5 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">})</code></span></div><div class="line number7 index6 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">    </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">println(foldRDD)</code></span></div><div class="line number8 index7 alt1" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java spaces" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">  </code><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">}</code></span></div></div></td></tr></tbody></table></div></div></div></div></div></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">输出：</span></div></div><div style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div class="linenums" style="margin: 0px; padding: 0px;"><div class="L0" style="margin: 0px; padding: 0px;"><div class="cnblogs_Highlighter sh-gutter" style="margin: 0px; padding: 0px;"><div style="margin: 0px; padding: 0px;"><div id="highlighter_285929" class="syntaxhighlighter  java" style="padding: 0px; width: 686.575px; margin: 1em 0px !important; position: relative !important; overflow: auto !important; background-color: rgb(255, 255, 255) !important;"><table border="0" cellpadding="0" cellspacing="0" style="border: 1px solid silver; width: 686.4px; border-collapse: collapse; word-break: break-word; margin: 0px !important; padding: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; min-height: auto !important; background: none !important;"><tbody style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><tr style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><td class="gutter" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: 35px !important; min-height: auto !important; color: rgb(175, 175, 175) !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 0.5em !important; border-width: 0px 2px 0px 0px !important; border-right-style: solid !important; border-right-color: rgb(108, 226, 108) !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; text-align: right !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;">1</span></div></td><td class="code" style="padding: 3px; border: 1px solid silver; border-collapse: collapse; margin: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="container" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.1em !important; outline: 0px !important; overflow: visible !important; position: relative !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;"><div class="line number1 index0 alt2" style="margin: 0px !important; padding: 0px 1em !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; white-space: nowrap !important; background: none rgb(244, 244, 244) !important;"><span style="font-family:SimSun;font-size:14px;"><code class="java plain" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; background: none !important;">c,</code><code class="java value" style="margin: 0px !important; padding: 0px !important; border: 0px !important; bottom: auto !important; float: none !important; height: auto !important; left: auto !important; line-height: 1.8em !important; outline: 0px !important; overflow: visible !important; position: static !important; right: auto !important; top: auto !important; vertical-align: baseline !important; width: auto !important; min-height: auto !important; color: rgb(0, 153, 0) !important; background: none !important;">5</code></span></div></div></td></tr></tbody></table></div></div></div></div></div></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">其过程如下：</span></div></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">1.开始时将(“d”,0)作为op函数的第一个参数传入，将Array中和第一个元素("a",1)作为op函数的第二个参数传入，并比较value的值，返回value值较大的元素</span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">2.将上一步返回的元素又作为op函数的第一个参数传入，Array的下一个元素作为op函数的第二个参数传入，比较大小</span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">3.重复第2步骤</span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">每个分区的数据集都会经过以上三步后汇聚后再重复以上三步得出最大值的那个元素，对于其他op函数也类似，只不过函数里的处理数据的方式不同而已</span></div><div style="margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><img src="file:///D:/Program%20Files/WizNote/temp/552043d6-6afd-49d5-a700-a2c26e734e4a.png" alt="" border="0" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> <img src="http://images2015.cnblogs.com/blog/776259/201604/776259-20160420211420335-1384986861.png" alt="" style="border: 0px; max-width: 900px; margin: 0px; padding: 0px;"></span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;">             （RDD依赖图）</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">13.saveAsFile(path:String)：</span>将最终的结果数据保存到指定的HDFS目录中</span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"> </span></div><div style="background-color: rgb(254, 254, 242); margin: 0px; padding: 0px;"><span style="font-family:SimSun;font-size:14px;"><span style="margin: 0px; padding: 0px; line-height: 1.5;">14.saveAsSequenceFile(path:String)：</span>将最终的结果数据以sequence的格式保存到指定的HDFS目录中</span></div><span style='font-family: "Comic Sans MS"; font-size: 24px;'>RDDs的特性</span><br><p></p><p><span style="font-family:SimSun;font-size:18px;"><strong>RDDs的血统关系图</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark维护着RDDs之间的依赖关系和创建关系，叫做血统关系图。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark使用血统关系图来计算每个RDD的需求和恢复丢失的数据。</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>延迟计算(Lazy Evaluation)</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark对RDDs的计算是，他们第一次使用action操作的时候</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">这种方式在处理大数据的时候特别有用，可以减少数据的传输</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">Spark内部记录metadata表明transformations操作已经被响应了</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">加载数据也是延迟计算，数据只有在必要的时候，才会被加载进去</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>RDD.persist()持久化</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">默认每次在RDDs上面进行action操作时，Spark都重新计算RDDs</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">如果想重复利用一个RDD，可以使用RDD.persist()</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">unpersist()从缓存中移除</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><span style='font-family: "Comic Sans MS"; font-size: 24px;'>KeyValue对RDDs</span><br></span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>创建KeyValue对RDDs</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">使用map()函数，返回key/value对</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">例如，包含数行数据的RDD，把每行数据的第一个单词作为keys</span></span></p><p><span style="font-family:SimSun;font-size:18px;"><strong>combinByKey()</strong></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">(createCombiner, mergeValue, mergeCombiners, partitioner)</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">最常用的基于key的聚合函数，返回的类型可以与输入类型不一样</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">许多基于key的聚合函数都用到了它，像groupByKey()</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">遍历partition中的元素，元素的key，要么之前见过的，要么不是。</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">如果是新元素，使用我们提供的createCombiner()函数</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">如果是这个partition中已经存在的key，就会使用mergeValue()函数</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">合计每个partition的结果的时候，使用mergeCombiners()函数</span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><br></span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><br></span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;"><br></span></span></p><p><span style="font-family:SimSun;"><span style="font-size: 14px;">参考：<a target="_blank" href="http://www.cnblogs.com/MOBIN/p/5414490.html" rel="nofollow">http://www.cnblogs.com/MOBIN/p/5414490.html</a></span></span></p><p><span style="font-family:SimSun;font-size:14px;"><br></span></p>            </div>
                </div>