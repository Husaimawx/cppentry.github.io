---
layout:     post
title:      kafka开发
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<div style="font-family:Arial;font-size:14.285715103149414px;line-height:25.997024536132813px;">
<a href="http://http//blog.csdn.net/honglei915/article/details/37563647" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">转载注明出处：http://blog.csdn.net/honglei915/article/details/37563647</a></div>
<div style="font-family:Arial;font-size:14.285715103149414px;line-height:25.997024536132813px;">
<div><span style="font-family:Tahoma;font-size:16px;">上篇文章中我们搭建了kafka的服务器，并可以使用Kafka的命令行工具创建topic，发送和接收消息。下面我们来搭建kafka的开发环境。</span></div>
<div>
<div style="font-family:Tahoma;font-size:16px;"><br></div>
<div style="font-family:Tahoma;font-size:16px;"><span style="font-size:18px;"><strong>添加依赖</strong></span><br></div>
<div style="font-family:Tahoma;font-size:16px;"><span style="font-size:18px;"><strong><br></strong></span></div>
<div style="font-family:Tahoma;font-size:16px;">搭建开发环境需要引入kafka的jar包，一种方式是将Kafka安装包中lib下的jar包加入到项目的classpath中，这种比较简单了。不过我们使用另一种更加流行的方式：使用maven管理jar包依赖。</div>
<div style="font-family:Tahoma;font-size:16px;">创建好maven项目后，在pom.xml中添加以下依赖：</div>
<div style="font-family:Tahoma;font-size:16px;">
<div align="left"><span style="font-family:Consolas;font-size:12px;color:rgb(0,128,128);"><span style="font-size:10pt;">               </span></span>
<div class="dp-highlighter bg_html" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[html]</strong> <a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-xml" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">dependency</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">         <span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">groupId</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;"> org.apache.kafka</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;/</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">groupId</span><span style="border:none;background-color:inherit;"> </span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">         <span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">artifactId</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;"> kafka_2.10</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;/</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">artifactId</span><span style="border:none;background-color:inherit;"> </span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">         <span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">version</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;"> 0.8.0</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;/</span><span style="border:none;background-color:inherit;"> </span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">version</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&lt;/</span><span class="tag-name" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">dependency</span><span class="tag" style="border:none;color:rgb(153,51,0);background-color:inherit;font-weight:bold;">&gt;</span><span style="border:none;background-color:inherit;">  </span></span></li></ol></div>
<br></div>
</div>
<div style="font-family:Tahoma;font-size:16px;">添加依赖后你会发现有两个jar包的依赖找不到。没关系我都帮你想好了，点击<a href="http://download.csdn.net/detail/honglei915/7613037" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">这里</a>下载这两个jar包，解压后你有两种选择，第一种是使用mvn的install命令将jar包安装到本地仓库，另一种是直接将解压后的文件夹拷贝到mvn本地仓库的com文件夹下，比如我的本地仓库是d:\mvn,完成后我的目录结构是这样的：</div>
<div style="font-family:Tahoma;font-size:16px;"><br></div>
<div style="font-family:Tahoma;font-size:16px;"><img src="https://img-blog.csdn.net/20140708140300000?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaG9uZ2xlaTkxNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="目录结构" align="middle" style="border:none;"><br></div>
<div style="font-family:Tahoma;font-size:16px;"><br></div>
<div style="font-family:Tahoma;font-size:16px;"><strong>配置程序</strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong><br></strong></div>
<div style="font-family:Tahoma;font-size:16px;">首先是一个充当配置文件作用的接口,配置了Kafka的各种连接参数：</div>
<div style="font-family:Tahoma;font-size:16px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> com.sohu.kafkademon;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">interface</span><span style="border:none;background-color:inherit;"> KafkaProperties  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">{  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String zkConnect = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"10.22.10.139:2181"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String groupId = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"group1"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String topic = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"topic1"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String kafkaServerURL = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"10.22.10.139"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> kafkaServerPort = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">9092</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> kafkaProducerBufferSize = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">64</span><span style="border:none;background-color:inherit;"> * </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1024</span><span style="border:none;background-color:inherit;">;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> connectionTimeOut = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">20000</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> reconnectInterval = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">10000</span><span style="border:none;background-color:inherit;">;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String topic2 = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"topic2"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String topic3 = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"topic3"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> String clientId = </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"SimpleConsumerDemoClient"</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<br><br></div>
<div style="font-family:Tahoma;font-size:16px;"><strong>producer</strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong><br></strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong></strong>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> com.sohu.kafkademon;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.Properties;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.producer.KeyedMessage;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.producer.ProducerConfig;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">/**</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> * @author leicui bourne_cui@163.com</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> */</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> KafkaProducer </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Thread  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">{  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> kafka.javaapi.producer.Producer&lt;Integer, String&gt; producer;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> String topic;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> Properties props = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Properties();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> KafkaProducer(String topic)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    {  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"serializer.class"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"kafka.serializer.StringEncoder"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"metadata.broker.list"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"10.22.10.139:9092"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        producer = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> kafka.javaapi.producer.Producer&lt;Integer, String&gt;(</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> ProducerConfig(props));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">this</span><span style="border:none;background-color:inherit;">.topic = topic;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@Override</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> run() {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> messageNo = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">true</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        {  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            String messageStr = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> String(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"Message_"</span><span style="border:none;background-color:inherit;"> + messageNo);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            System.out.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"Send:"</span><span style="border:none;background-color:inherit;"> + messageStr);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            producer.send(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> KeyedMessage&lt;Integer, String&gt;(topic, messageStr));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            messageNo++;  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">try</span><span style="border:none;background-color:inherit;"> {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                sleep(<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">3000</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            } <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">catch</span><span style="border:none;background-color:inherit;"> (InterruptedException e) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// TODO Auto-generated catch block</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                e.printStackTrace();  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<br><br></div>
<div style="font-family:Tahoma;font-size:16px;"><strong><br></strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong>consumer</strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong><br></strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong></strong>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> com.sohu.kafkademon;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.HashMap;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.List;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.Map;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.Properties;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.consumer.ConsumerConfig;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.consumer.ConsumerIterator;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.consumer.KafkaStream;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.javaapi.consumer.ConsumerConnector;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">/**</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> * @author leicui bourne_cui@163.com</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> */</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> KafkaConsumer </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Thread  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">{  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> ConsumerConnector consumer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> String topic;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> KafkaConsumer(String topic)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    {  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        consumer = kafka.consumer.Consumer.createJavaConsumerConnector(  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                createConsumerConfig());  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">this</span><span style="border:none;background-color:inherit;">.topic = topic;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> ConsumerConfig createConsumerConfig()  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    {  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        Properties props = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Properties();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"zookeeper.connect"</span><span style="border:none;background-color:inherit;">, KafkaProperties.zkConnect);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"group.id"</span><span style="border:none;background-color:inherit;">, KafkaProperties.groupId);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"zookeeper.session.timeout.ms"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"40000"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"zookeeper.sync.time.ms"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"200"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"auto.commit.interval.ms"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"1000"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> ConsumerConfig(props);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@Override</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> run() {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        Map&lt;String, Integer&gt; topicCountMap = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HashMap&lt;String, Integer&gt;();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        topicCountMap.put(topic, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Integer(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        Map&lt;String, List&lt;KafkaStream&lt;<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[], </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt;&gt;&gt; consumerMap = consumer.createMessageStreams(topicCountMap);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        KafkaStream&lt;<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[], </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt; stream = consumerMap.get(topic).get(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        ConsumerIterator&lt;<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[], </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt; it = stream.iterator();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (it.hasNext()) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            System.out.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"receive："</span><span style="border:none;background-color:inherit;"> + </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> String(it.next().message()));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">try</span><span style="border:none;background-color:inherit;"> {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                sleep(<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">3000</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            } <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">catch</span><span style="border:none;background-color:inherit;"> (InterruptedException e) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                e.printStackTrace();  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<br><br></div>
<div style="font-family:Tahoma;font-size:16px;"><strong>简单的发送接收</strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong><br></strong></div>
<div style="font-family:Tahoma;font-size:16px;">运行下面这个程序，就可以进行简单的发送接收消息了：</div>
<div style="font-family:Tahoma;font-size:16px;"><strong></strong>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> com.sohu.kafkademon;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">/**</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> * @author leicui bourne_cui@163.com</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> */</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> KafkaConsumerProducerDemo  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">{  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> main(String[] args)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    {  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        KafkaProducer producerThread = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> KafkaProducer(KafkaProperties.topic);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        producerThread.start();  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        KafkaConsumer consumerThread = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> KafkaConsumer(KafkaProperties.topic);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        consumerThread.start();  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<br><br></div>
<div style="font-family:Tahoma;font-size:16px;"><strong>高级别的consumer</strong></div>
<div style="font-family:Tahoma;font-size:16px;"><strong><br></strong></div>
<div style="font-family:Tahoma;font-size:16px;">下面是比较负载的发送接收的程序：</div>
<div style="font-family:Tahoma;font-size:16px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/honglei915/article/details/37563647#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> com.sohu.kafkademon;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.HashMap;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.List;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.Map;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.Properties;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.consumer.ConsumerConfig;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.consumer.ConsumerIterator;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.consumer.KafkaStream;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> kafka.javaapi.consumer.ConsumerConnector;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">/**</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> * @author leicui bourne_cui@163.com</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> */</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> KafkaConsumer </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Thread  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">{  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> ConsumerConnector consumer;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> String topic;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> KafkaConsumer(String topic)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    {  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        consumer = kafka.consumer.Consumer.createJavaConsumerConnector(  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                createConsumerConfig());  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">this</span><span style="border:none;background-color:inherit;">.topic = topic;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> ConsumerConfig createConsumerConfig()  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    {  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        Properties props = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Properties();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"zookeeper.connect"</span><span style="border:none;background-color:inherit;">, KafkaProperties.zkConnect);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"group.id"</span><span style="border:none;background-color:inherit;">, KafkaProperties.groupId);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"zookeeper.session.timeout.ms"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"40000"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"zookeeper.sync.time.ms"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"200"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        props.put(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"auto.commit.interval.ms"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"1000"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">return</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> ConsumerConfig(props);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@Override</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> run() {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        Map&lt;String, Integer&gt; topicCountMap = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HashMap&lt;String, Integer&gt;();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        topicCountMap.put(topic, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Integer(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        Map&lt;String, List&lt;KafkaStream&lt;<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[], </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt;&gt;&gt; consumerMap = consumer.createMessageStreams(topicCountMap);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        KafkaStream&lt;<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[], </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt; stream = consumerMap.get(topic).get(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        ConsumerIterator&lt;<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[], </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">byte</span><span style="border:none;background-color:inherit;">[]&gt; it = stream.iterator();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (it.hasNext()) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            System.out.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"receive："</span><span style="border:none;background-color:inherit;"> + </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> String(it.next().message()));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">try</span><span style="border:none;background-color:inherit;"> {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                sleep(<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">3000</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            } <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">catch</span><span style="border:none;background-color:inherit;"> (InterruptedException e) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">                e.printStackTrace();  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">            }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">        }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18.095239639282227px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
</div>
</div>
</div>
            </div>
                </div>