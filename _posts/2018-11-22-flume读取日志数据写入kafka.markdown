---
layout:     post
title:      flume读取日志数据写入kafka
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
一、flume配置</p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
flume要求1.6以上版本</p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
flume-conf.properties文件配置内容，sinks的输出作为kafka的product<br></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
</p>
<div class="dp-highlighter bg_html" style="font-family:Consolas, 'Courier New', Courier, mono, serif;color:rgb(69,69,69);line-height:24px;background-color:rgb(231,229,220);">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);border-right-width:1px;border-right-style:solid;border-right-color:rgb(231,229,220);background-color:rgb(248,248,248);">
<span>[html]</span> <a href="http://blog.csdn.net/huguoping830623/article/details/48138319#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">view
 plain</a><span class="tracking-ad"> <a href="http://blog.csdn.net/huguoping830623/article/details/48138319#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">copy</a></span>
<div style="width:16px;z-index:99;">
</div>
<span class="tracking-ad"></span></div>
</div>
<ol start="1" class="dp-xml" style="border-style:none solid none none;border-right-width:1px;border-right-color:rgb(231,229,220);color:rgb(92,92,92);background-color:rgb(255,255,255);"><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sources</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">r1</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">k1</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.channels</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">c1</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"># Describe/configure the source  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sources.r1.type</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">exec</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sources.r1.command</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">tail</span><span style="border:none;background-color:inherit;"> -F /home/airib/work/log.log  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"># Describe the sink  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">#<span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.type</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">logger</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.type</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">org</span><span style="border:none;background-color:inherit;">.apache.flume.sink.kafka.KafkaSink  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.topic</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">test</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.brokerList</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">localhost</span><span style="border:none;background-color:inherit;">:9092  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.requiredAcks</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.batchSize</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">20</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"># Use a channel which buffers events in memory  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.channels.c1.type</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">memory</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.channels.c1.capacity</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">1000</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.channels.c1.transactionCapacity</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">100</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"># Bind the source and sink to the channel  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sources.r1.channels</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">c1</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">a1.sinks.k1.channel</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">c1</span><span style="border:none;background-color:inherit;">  </span></span></li></ol></div>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<br></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
flume启动</p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
 bin/flume-ng agent --conf conf --conf-file conf/flume-conf.properties --name a1 -Dflume.root.logger=INFO,console<br></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<br></p>
<span style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">二  kafka的消费者java源代码</span>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
</p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
</p>
<div class="dp-highlighter bg_html" style="font-family:Consolas, 'Courier New', Courier, mono, serif;color:rgb(69,69,69);line-height:24px;background-color:rgb(231,229,220);">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);border-right-width:1px;border-right-style:solid;border-right-color:rgb(231,229,220);background-color:rgb(248,248,248);">
<span>[html]</span> <a href="http://blog.csdn.net/huguoping830623/article/details/48138319#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">view
 plain</a><span class="tracking-ad"> <a href="http://blog.csdn.net/huguoping830623/article/details/48138319#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">copy</a></span>
<div style="width:16px;z-index:99;">
</div>
<span class="tracking-ad"></span></div>
</div>
<ol start="1" class="dp-xml" style="border-style:none solid none none;border-right-width:1px;border-right-color:rgb(231,229,220);color:rgb(92,92,92);background-color:rgb(255,255,255);"><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;"><span style="border:none;background-color:inherit;">package com.hgp.kafka.kafka;  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import java.util.HashMap;  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import java.util.List;  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import java.util.Map;  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import java.util.Properties;  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import kafka.consumer.ConsumerConfig;  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import kafka.consumer.ConsumerIterator;  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import kafka.consumer.KafkaStream;  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import kafka.javaapi.consumer.ConsumerConnector;  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import kafka.serializer.StringDecoder;  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">import kafka.utils.VerifiableProperties;  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">public class KafkaConsumer {  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    private final ConsumerConnector consumer;  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    private KafkaConsumer() {  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        Properties <span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">props</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">new</span><span style="border:none;background-color:inherit;"> Properties();  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        //zookeeper 配置  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("zookeeper.connect", "localhost:2181");  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        //group 代表一个消费组  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("group.id", "jd-group");  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        //zk连接超时  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("zookeeper.session.timeout.ms", "4000");  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("zookeeper.sync.time.ms", "200");  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("auto.commit.interval.ms", "1000");  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("auto.offset.reset", "smallest");  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        //序列化类  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        props.put("serializer.class", "kafka.serializer.StringEncoder");  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        ConsumerConfig <span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">config</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">new</span><span style="border:none;background-color:inherit;"> ConsumerConfig(props);  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        <span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">consumer</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">kafka</span><span style="border:none;background-color:inherit;">.consumer.Consumer.createJavaConsumerConnector(config);  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    }  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    void consume() {  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        Map<span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">String</span><span style="border:none;background-color:inherit;">, Integer</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span style="border:none;background-color:inherit;"> </span><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">topicCountMap</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">new</span><span style="border:none;background-color:inherit;"> HashMap</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">String</span><span style="border:none;background-color:inherit;">, Integer</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span style="border:none;background-color:inherit;">();  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        topicCountMap.put("test", new Integer(1));  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        StringDecoder <span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">keyDecoder</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">new</span><span style="border:none;background-color:inherit;"> StringDecoder(new VerifiableProperties());  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        StringDecoder <span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">valueDecoder</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">new</span><span style="border:none;background-color:inherit;"> StringDecoder(new VerifiableProperties());  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        Map<span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">String</span><span style="border:none;background-color:inherit;">, List</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">KafkaStream</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">String</span><span style="border:none;background-color:inherit;">, String</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span style="border:none;background-color:inherit;"> </span><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">consumerMap</span><span style="border:none;background-color:inherit;"> =   </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">                <span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">consumer</span><span style="border:none;background-color:inherit;">.createMessageStreams(topicCountMap,keyDecoder,valueDecoder);  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        KafkaStream<span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">String</span><span style="border:none;background-color:inherit;">, String</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span style="border:none;background-color:inherit;"> </span><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">stream</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">consumerMap</span><span style="border:none;background-color:inherit;">.get("test").get(0);  </span></span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        ConsumerIterator<span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&lt;</span><span class="tag-name" style="font-weight:700;border:none;color:rgb(153,51,0);background-color:inherit;">String</span><span style="border:none;background-color:inherit;">, String</span><span class="tag" style="font-weight:700;color:rgb(153,51,0);border:none;background-color:inherit;">&gt;</span><span style="border:none;background-color:inherit;"> </span><span class="attribute" style="border:none;color:#FF0000;background-color:inherit;">it</span><span style="border:none;background-color:inherit;"> = </span><span class="attribute-value" style="border:none;color:rgb(0,0,255);background-color:inherit;">stream</span><span style="border:none;background-color:inherit;">.iterator();  </span></span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        while (it.hasNext())  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">            System.out.println(it.next().message());  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    }  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    public static void main(String[] args) {  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">        new KafkaConsumer().consume();  </span></li><li class="alt" style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);color:inherit;line-height:18px;">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">    }  </span></li><li style="margin-left:40px;list-style:decimal;border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:rgb(0,0,0);background-color:inherit;">}  </span></li></ol></div>
<br style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;"><p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
kafka启动命令</p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;">启动Zookeeper server： </span><br></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;background-color:rgb(250,250,250);">bin/zookeeper-server-start.sh config/zookeeper.properties &amp;</span><br></span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;background-color:rgb(250,250,250);"><br></span></span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;">启动Kafka server:</span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;">bin/kafka-server-start.sh config/server.properties &amp; </span><br></span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;background-color:rgb(250,250,250);"><span style="font-family:Helvetica, Tahoma, Arial, sans-serif;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"><br></span></span></span></span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;">运行producer： </span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;">bin/kafka-console-producer.sh --broker-list localhost:</span><span class="number" style="color:rgb(192,0,0);font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;">9092</span><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"> --topic test</span><br></span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;background-color:rgb(250,250,250);"><span style="font-family:Helvetica, Tahoma, Arial, sans-serif;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"><span style="font-family:Helvetica, Tahoma, Arial, sans-serif;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"><br></span></span></span></span></span></span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;">运行consumer： </span></p>
<p style="color:rgb(69,69,69);font-family:'PingFang SC', 'Microsoft YaHei', SimHei, Arial, SimSun;font-size:16px;line-height:24px;">
<span style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;background-color:rgb(250,250,250);"><span style="font-family:Helvetica, Tahoma, Arial, sans-serif;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"><span style="font-family:Helvetica, Tahoma, Arial, sans-serif;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"><span style="font-family:Helvetica, Tahoma, Arial, sans-serif;line-height:25.2000007629395px;"><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;">bin/kafka-console-consumer.sh --zookeeper localhost:</span><span class="number" style="color:rgb(192,0,0);font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;">2181</span><span style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;line-height:18px;"> --topic test --from-beginning </span></span></span></span></span></span></span></span></p>
            </div>
                </div>