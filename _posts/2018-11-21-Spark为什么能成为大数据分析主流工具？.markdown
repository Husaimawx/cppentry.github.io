---
layout:     post
title:      Spark为什么能成为大数据分析主流工具？
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="color:rgb(255,76,0);"><span style="letter-spacing:1px;">一．Spark是什么</span></span><br></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">Spark是伯克利大学2009年开始研发的一个项目，它是大数据时代下的一个快速处理数据分析工作的框架。spark发展十分迅速，2014年，Hadoop的四大商业机构均宣称全力支持Spark，今后将全面接收基于Spark编写的数据挖掘与分析算法，多家世界顶级的数据企业例如Google，Facebook等现已纷纷转向Spark框架。</span></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">近两年，Spark在中国的发展达到了一个前所未有的状态和高度。其中阿里巴巴的搜索和广告业务，最初使用Mahout和MapReduce来解决复杂的机器学习问题，但是在效率和代码维护方面并不理想，现已转向Spark框架。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">淘宝技术团队使用Spark实现了多次迭代的机器学习算法和一些高计算复杂度的算法，并将其运用在推荐系统上；同时还利用Spark中的一系列组件解决了基于最大连通图的社区发现、基于三角形计数的关系衡量、基于随机游走的用户属性传播等许多生产问题。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">此外，腾讯也是最早使用Spark的应用之一，借助Spark快速迭代的优势，腾讯提出了大数据精准推荐，并采用“数据+算法+系统”这套技术方案支持每天上百亿的请求量。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span><span style="letter-spacing:1px;color:rgb(255,76,0);">二、为什么spark如此之火？</span></span></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;color:rgb(0,128,255);">Spark四大特性之特性一：快速</span></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">相同的实验环境与数据下，在内存中运行相同的程序，Spark比MapReduce快约100倍；在磁盘中运行相同的程序，Spark要MapReduce快约10倍。例如图2所示，Spark和MapReduce进行逻辑回归运算后的实验数据。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">针对于非常考验系统性能的排序问题，图3解释Spark与MapReduce对100TB数据样本排序的实验结果比较：MapReduce用了2100台机器，花费72分钟；而Spark仅用207台机器，不到前者的1/10，花费23分钟，接近前者的1/3。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">此外，众多实验表明，在处理迭代式应用上Spark比MapReduce快20多倍；计算数据分析类报表的性能提高了40多倍；Spark能够在5-7秒的延时内交互式扫描1TB数据集。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">Spark运行速度如此之快，主要得益于以下两方面：一方面，Spark中的运算大多是基于内存的。Spark提出了一种分布式的内存抽象，称为弹性分布式数据集（RDD，Resilient DistributedDatasets）。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">RDD支持基于工作集的应用，同时具有数据流模型的特点：自动容错、位置感知调度和可伸缩性。RDD允许用户在执行多个查询时显式地将工作集缓存在内存中，后续的查询能够重用工作集，这极大地提升了查询速度。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">另一方面，Spark从稳定的物理存储（如分布式文件系统）中加载记录，记录被传入由一组确定性操作构成的DAG，然后写回稳定存储。DAG数据流图能够在运行时自动实现任务调度和故障恢复。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">尽管非循环数据流是一种很强大的抽象方法，但仍然有些应用无法使用这种方式描述。Spark能够在多个并行操作之间重用工作数据集，适用于非循环数据流模型难以处理的应用。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;color:rgb(0,128,255);">Spark四大特性之特性二：易用</span></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">Spark编程非常高效、简洁，支持多种语言的API，如Java, Scala, Python等，而且代码非常简洁。例如在基于MapReduce开发的WordCount示例程序中，用户需要重写Map类和Reduce类，虽然MapReduce类似八股文的程序编写模式极大地简化了并行程序开发过程，但是程序代码至少几十行。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">若基于Spark开发同样的WordCount程序，仅需下面短短的几行代码，例如下面程序是对存储在HDFS上的wc.input中的单词个数进行统计：</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">sc.textFile("hdfs://master:8020/user/dong/spark/wc.input").flatMap(_.split("")).map((_,1)).reduceByKey(_+ _).collect由此可见，Spark编程非常简洁。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">这主要是因为Spark是基于Scala开发，其对数据处理提供了丰富的操作，极大地提高了用户的程序开发效率。目前基于Spark的实际项目开发中约70%采用Scala语言，这是因为Spark本身就是基于Scala开发的；其次是JAVA，约占20%；此外还有Python等。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;color:rgb(0,128,255);">Spark四大特性之特性三：通用</span></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">相对与第一代的大数据生态系统<a href="http://hainiubl.com/topics/176" rel="nofollow">Hadoop</a>中的MapReduce，Spark 无论是在性能还是在方案的统一性方面，都有着极大的优越性，虽然MapReduce在此方面也在做积极的努力，但Spark的优势还是明显的。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">Spark框架通常涉及到五个最核心的组件。如图4所示，位于下面的Apache Spark又称为Spark Core。在Spark Core的基础上，针对一些特殊的需求，Spark开发了一系列组件：Spark SQL（在Spark上建立是SQL，类似于Hive）；Spark Streaming（实时流处理系统）；MLlib（用户友好的机器学习库）；GraphX（图处理组件），此外还有一个BlinkDB（基于海量数据的交互式查询引擎，能够在设定的误差范围内或响应时间内进行SQL查询）。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"><br></span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">将这些组件放在一起，就构成了一个Spark的软件栈。基于这个软件栈Spark提出并实现了一种理念“one stack to rule them all”，即Spark可以对大数据进行综合处理：实时数据流处理、批处理和交互式查询。这一软件栈就体现了Spark的通用性。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;color:rgb(0,128,255);"><a href="http://hainiubl.com/topics/202" rel="nofollow">Spark</a>四大特性之特性四：多种运行模式</span></p><p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);"><br></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">在运行方面，Spark的运行无处不在。Spark既可以运行本地local模式，也可以以Standalone、cluster等多种模式运行在Yarn、Mesos上，还可以运行在云端例如EC2。此外，Spark的数据来源非常广泛，可以处理来自HDFS、HBase、 Hive、Cassandra、Tachyon上的各种类型的数据。</span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;"> </span></p><p style="margin-left:8px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;background-color:rgb(255,255,255);line-height:1.75em;"><span style="font-size:15px;letter-spacing:1px;">Spark这套速度极快的内存分析引擎与以往的大数据处理框架相比具有诸多优势，从而能够轻松地为大数据应用企业带来理想的投资回报。Spark项目将一系列创新型思维带入了大数据处理市场，并且表现出极为强劲的发展势头。</span></p>            </div>
                </div>