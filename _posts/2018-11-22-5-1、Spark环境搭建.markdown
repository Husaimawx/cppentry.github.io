---
layout:     post
title:      5-1、Spark环境搭建
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：分享的快乐。。					https://blog.csdn.net/baolibin528/article/details/50865575				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h1>2<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Spark</span><span style="font-family:'宋体';">环境搭建</span></h1>
<h3>2.1<span style="font-family:'宋体';">、官网下载</span></h3>
<p>Spark<span style="font-family:'宋体';">官网地址：</span><a href="http://spark.apache.org/" rel="nofollow"><span style="color:rgb(0,0,255);">http://spark.apache.org/</span></a></p>
<p> <img src="https://img-blog.csdn.net/20160312150045349?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>下载后如下：</p>
<p> <img src="https://img-blog.csdn.net/20160312150106131?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>Linux<span style="font-family:'宋体';">上安装部署</span><span style="font-family:Calibri;">Spark</span></p>
<p>Jdk</p>
<p>Scala</p>
<p>SSH</p>
<p>Hadoop</p>
<p>Spark</p>
<h3>2.2<span style="font-family:'宋体';">、安装模式</span></h3>
<p>Local<span style="font-family:'宋体';">模式</span><span style="font-family:Calibri;">(</span><span style="font-family:'宋体';">学习、测试之用</span><span style="font-family:Calibri;">)  </span></p>
<p>Standalone<span style="font-family:'宋体';">模式（内置的资源管理和调度框架）</span></p>
<p>Mesos<span style="font-family:'宋体';">（</span><span style="font-family:Calibri;">Apache</span><span style="font-family:'宋体';">）</span></p>
<p>Yarn<span style="font-family:'宋体';">（</span><span style="font-family:Calibri;">Hadoop</span><span style="font-family:'宋体';">）</span></p>
<h3>2.3<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">local</span><span style="font-family:'宋体';">模式</span></h3>
<p>软件：</p>
<p>jdk1.8</p>
<p>centos6.5</p>
<p>hadoop2.6.0</p>
<p>spark-1.5.2-bin-hadoop2.6.tgz</p>
<p> </p>
<p>1<span style="font-family:'宋体';">、解压，编辑</span><span style="font-family:Arial;">spark-env.sh</span><span style="font-family:'宋体';">文件</span></p>
<p style="background:rgb(248,248,248);"><span style="color:rgb(192,192,192);">[html]</span><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="view plain"><span style="color:rgb(160,160,160);">view plain</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="copy"><span style="color:rgb(160,160,160);">copy</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="print"><span style="color:rgb(160,160,160);">print</span></a><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="?"><span style="color:rgb(160,160,160);">?</span></a></p>
<p style="background:rgb(245,250,226);">1. [root@spark0 conf]# cp spark-env.sh.template spark-env.sh  </p>
<p style="background:rgb(245,250,226);">2. [root@spark0 conf]# vim spark-env.sh  </p>
<p style="background:rgb(245,250,226);"><span style="color:rgb(255,0,0);">3. </span><span style="color:rgb(255,0,0);">SPARK_MASTER_IP</span>=<span style="color:rgb(0,0,255);">192</span>.168.6.2  </p>
<p> <img src="https://img-blog.csdn.net/20160312150110069?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p></p>
<p> </p>
<p>2<span style="font-family:'宋体';">、设置主节点</span><span style="font-family:Arial;">IP</span><span style="font-family:'宋体';">地址：</span></p>
<p><img src="https://img-blog.csdn.net/20160312150113178?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>3<span style="font-family:'宋体';">、设置从节点</span><span style="font-family:Arial;">IP</span><span style="font-family:'宋体';">地址：</span></p>
<p><img src="https://img-blog.csdn.net/20160312150116163?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>添加<span style="font-family:Arial;">IP</span><span style="font-family:'宋体';">地址：</span></p>
<p></p>
<p> <img src="https://img-blog.csdn.net/20160312150119959?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>4<span style="font-family:'宋体';">、启动：</span></p>
<p style="background:rgb(248,248,248);"><span style="color:rgb(192,192,192);">[html]</span><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="view plain"><span style="color:rgb(160,160,160);">view plain</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="copy"><span style="color:rgb(160,160,160);">copy</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="print"><span style="color:rgb(160,160,160);">print</span></a><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="?"><span style="color:rgb(160,160,160);">?</span></a></p>
<p style="background:rgb(245,250,226);">1. sbin/start-all.sh   </p>
<p> <img src="https://img-blog.csdn.net/20160312150125897?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p></p>
<p>查看进程：</p>
<p></p>
<p> <img src="https://img-blog.csdn.net/20160312150203741?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>5<span style="font-family:'宋体';">、启动</span><span style="font-family:Arial;">spark-shell</span><span style="font-family:'宋体';">：</span></p>
<p style="background:rgb(248,248,248);"><span style="color:rgb(192,192,192);">[html]</span><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="view plain"><span style="color:rgb(160,160,160);">view plain</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="copy"><span style="color:rgb(160,160,160);">copy</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="print"><span style="color:rgb(160,160,160);">print</span></a><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="?"><span style="color:rgb(160,160,160);">?</span></a></p>
<p style="background:rgb(245,250,226);">1. bin/spark-shell   </p>
<p> <img src="https://img-blog.csdn.net/20160312150213288?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p></p>
<p> </p>
<p>6<span style="font-family:'宋体';">、运行一个简单的例子：</span></p>
<p style="background:rgb(248,248,248);"><span style="color:rgb(192,192,192);">[html]</span><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="view plain"><span style="color:rgb(160,160,160);">view plain</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="copy"><span style="color:rgb(160,160,160);">copy</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="print"><span style="color:rgb(160,160,160);">print</span></a><a href="http://blog.csdn.net/baolibin528/article/details/50286441" rel="nofollow" title="?"><span style="color:rgb(160,160,160);">?</span></a></p>
<p style="background:rgb(245,250,226);">1. val <span style="color:rgb(255,0,0);">rdd</span>=<span style="color:rgb(0,0,255);">sc</span>.textFile("/home/spark0/spark.txt").collect  </p>
<p> <img src="https://img-blog.csdn.net/20160312150216320?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p></p>
<p> </p>
<p>7<span style="font-family:'宋体';">、网页 </span><span style="font-family:Arial;">http://192.168.6.2:4040/jobs/ </span><span style="font-family:'宋体';">查看任务：</span></p>
<p></p>
<p> </p>
<img src="https://img-blog.csdn.net/20160312150223258?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><p></p>
<p> </p>
<p> </p>
<h3>2.4<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Standalone</span><span style="font-family:'宋体';">模式</span></h3>
<p> </p>
<p> </p>
<p>提前安装好<span style="font-family:Arial;">hadoop</span><span style="font-family:'宋体';">，</span></p>
<p>我准备了两个节点，<span style="font-family:Arial;">jdk</span><span style="font-family:'宋体';">和</span><span style="font-family:Arial;">hadoop</span><span style="font-family:'宋体';">先安装好。</span></p>
<p> </p>
<p>我用的两个节点，电脑配置不行，<span style="font-family:Arial;">3</span><span style="font-family:'宋体';">个节点演示能更好些</span></p>
<p> </p>
<p>1<span style="font-family:'宋体';">、解压</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150226319?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>2<span style="font-family:'宋体';">、编辑文件：</span></p>
<p style="background:rgb(248,248,248);"><span style="color:rgb(192,192,192);">[html]</span><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="view plain"><span style="color:rgb(160,160,160);">view plain</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="copy"><span style="color:rgb(160,160,160);">copy</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="print"><span style="color:rgb(160,160,160);">print</span></a><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="?"><span style="color:rgb(160,160,160);">?</span></a></p>
<p style="background:rgb(245,250,226);">1. [root@spark0 conf]# cpspark-env.sh.template spark-env.sh  </p>
<p style="background:rgb(245,250,226);">2. [root@spark0 conf]# vim spark-env.sh  </p>
<p style="background:rgb(245,250,226);"><span style="color:rgb(255,0,0);">3. </span><span style="color:rgb(255,0,0);">SPARK_MASTER_IP</span>=<span style="color:rgb(0,0,255);">192</span>.168.6.2  </p>
<p style="background:rgb(245,250,226);">4.    </p>
<p style="background:rgb(245,250,226);">5. [root@spark0 conf]# cp slaves.templateslaves  </p>
<p style="background:rgb(245,250,226);">6. [root@spark0 conf]# vim slaves  </p>
<p style="background:rgb(245,250,226);">7. # A Spark Worker will be started on each ofthe machines listed below.  </p>
<p style="background:rgb(245,250,226);">8. 192.168.6.2  </p>
<p style="background:rgb(245,250,226);">9. 192.168.6.3  </p>
<p style="background:rgb(245,250,226);">10.    </p>
<p><br>
3<span style="font-family:'宋体';">、配置好的拷贝到另一个几点上面去：</span></p>
<p>[root@spark0 local]# scp -r sparkspark1:/usr/local/</p>
<p> </p>
<p>4<span style="font-family:'宋体';">、查看主节点的进程，除了</span><span style="font-family:Arial;">worker</span><span style="font-family:'宋体';">还有</span><span style="font-family:Arial;">master</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150229273?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>5<span style="font-family:'宋体';">、查看另一个节点，除了</span><span style="font-family:Arial;">hadoop</span><span style="font-family:'宋体';">进程，只有</span><span style="font-family:Arial;">worker</span><span style="font-family:'宋体';">，没有</span><span style="font-family:Arial;">master</span><span style="font-family:'宋体';">进程</span></p>
<p></p>
<p> <img src="https://img-blog.csdn.net/20160312150232897?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>6<span style="font-family:'宋体';">、例子，先在本地设置一个文件</span></p>
<p><img src="https://img-blog.csdn.net/20160312150236413?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>7<span style="font-family:'宋体';">、打开</span><span style="font-family:Arial;">spark-shell</span><span style="font-family:'宋体';">，运行一个小例子：</span></p>
<p style="background:rgb(248,248,248);"><span style="color:rgb(192,192,192);">[html]</span><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="view plain"><span style="color:rgb(160,160,160);">view plain</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="copy"><span style="color:rgb(160,160,160);">copy</span></a><span style="color:rgb(192,192,192);"> </span><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="print"><span style="color:rgb(160,160,160);">print</span></a><a href="http://blog.csdn.net/baolibin528/article/details/50286585" rel="nofollow" title="?"><span style="color:rgb(160,160,160);">?</span></a></p>
<p style="background:rgb(245,250,226);">1. scala<span style="color:rgb(0,0,255);">&gt;</span> val <span style="color:rgb(255,0,0);">rdd</span>=<span style="color:rgb(0,0,255);">sc</span>.textFile("/home/spark0/spark.txt").collect  </p>
<p> <img src="https://img-blog.csdn.net/20160312150239836?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p></p>
<p> </p>
<p>8<span style="font-family:'宋体';">、关闭，两个节点的</span><span style="font-family:Arial;">spark</span><span style="font-family:'宋体';">集群：</span></p>
<p></p>
<p> <img src="https://img-blog.csdn.net/20160312150243008?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<h3>2.5<span style="font-family:'宋体';">、</span>Intellij IDEA<span style="font-family:'宋体';">搭建配置</span><span style="font-family:Calibri;">Scala</span><span style="font-family:'宋体';">环境</span></h3>
<p>Intellij IDEA<span style="font-family:'宋体';">搭建配置</span><span style="font-family:Calibri;">Scala</span><span style="font-family:'宋体';">环境</span></p>
<p>1<span style="font-family:'宋体';">、配置</span><span style="font-family:Calibri;">S</span>cala<span style="font-family:'宋体';">插件：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150247304?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>选择安装插件：</p>
<p> <img src="https://img-blog.csdn.net/20160312150250804?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>点击<span style="font-family:Calibri;">I</span>nstall：</p>
<p> <img src="https://img-blog.csdn.net/20160312150253883?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>安装进度：</p>
<p> <img src="https://img-blog.csdn.net/20160312150257976?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>安装完插件之后，重启Intellij IDEA:</p>
<p> <img src="https://img-blog.csdn.net/20160312150301741?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>2<span style="font-family:'宋体';">、配置</span><span style="font-family:Calibri;">JDK</span><span style="font-family:'宋体';">：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150312319?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>把本地的JDK<span style="font-family:'宋体';">加载</span>进去：</p>
<p> <img src="https://img-blog.csdn.net/20160312150315649?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>加载了Jdk<span style="font-family:'宋体';">和</span>Scala：</p>
<p> <img src="https://img-blog.csdn.net/20160312150319944?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p> </p>
<p>3<span style="font-family:'宋体';">、搭建</span>一个Scala项目：</p>
<p> <img src="https://img-blog.csdn.net/20160312150326321?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>项目名称和项目地址：</p>
<p> <img src="https://img-blog.csdn.net/20160312150330525?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>右键src<span style="font-family:'宋体';">目录，新建</span><span style="font-family:Calibri;">package</span>和类:</p>
<p> <img src="https://img-blog.csdn.net/20160312150334196?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>书写简单的测验代码：</p>
<p> <img src="https://img-blog.csdn.net/20160312150338431?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>代码如下：</p>
<table><tbody><tr><td valign="top">
<p><span style="color:rgb(128,128,128);">/**</span><span style="color:rgb(128,128,128);"><br></span><span style="color:rgb(128,128,128);">  * Created by admin on 2015/12/15.</span><span style="color:rgb(128,128,128);"><br></span><span style="color:rgb(128,128,128);">  */</span><span style="color:rgb(128,128,128);"><br></span><span style="color:rgb(0,0,128);">object </span>Demo1 {<br>
  <span style="color:rgb(0,0,128);">def </span>main(args: Array[<span style="color:rgb(32,153,157);">String</span>]) {<br>
    <span style="color:rgb(0,0,128);">val </span>a=<span style="color:rgb(0,0,255);">123</span><span style="color:rgb(0,0,255);"><br></span><span style="color:rgb(0,0,255);">    </span>println(a)<br>
  }<br>
}</p>
<p> </p>
</td>
</tr></tbody></table><p> </p>
<p> </p>
<p> </p>
<p>右键该类，运行代码：</p>
<p> <img src="https://img-blog.csdn.net/20160312150342757?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>运行结果：</p>
<p> <img src="https://img-blog.csdn.net/20160312150347462?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>4<span style="font-family:'宋体';">、打包：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150351634?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>Next step<span style="font-family:'宋体';">：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150355070?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>选择主类：</p>
<p> <img src="https://img-blog.csdn.net/20160312150357835?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>Next step<span style="font-family:'宋体';">：</span></p>
<p>点击应用、OK</p>
<p> <img src="https://img-blog.csdn.net/20160312150402916?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>Next step<span style="font-family:'宋体';">：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150409320?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>Next step<span style="font-family:'宋体';">：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150415307?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>Next step<span style="font-family:'宋体';">：</span></p>
<p>本地打好的包：</p>
<p> <img src="https://img-blog.csdn.net/20160312150418838?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<h3>2.6<span style="font-family:'宋体';">、</span>Intellij IDEA<span style="font-family:'宋体';">开发集群提交运行</span><span style="font-family:Calibri;">Spark</span><span style="font-family:'宋体';">代码</span></h3>
<p>Intellij IDEA<span style="font-family:'宋体';">开发集群提交运行</span><span style="font-family:Calibri;">Spark</span><span style="font-family:'宋体';">代码</span></p>
<p> </p>
<p>1、 右键项目：</p>
<p> 选择倒第四个Open Module Settings<span style="font-family:'宋体';">：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150422151?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>2<span style="font-family:'宋体';">、</span>添加Spark<span style="font-family:'宋体';">依赖包：</span></p>
<p> <img src="https://img-blog.csdn.net/20160312150425242?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>添加进去：</p>
<p> <img src="https://img-blog.csdn.net/20160312150434945?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p>3<span style="font-family:'宋体';">、</span>进度：</p>
<p> <img src="https://img-blog.csdn.net/20160312150439929?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>4<span style="font-family:'宋体';">、</span>编写Wc<span style="font-family:'宋体';">代码：</span></p>
<p>新建一个<span style="font-family:Calibri;">S</span>cala<span style="font-family:'宋体';">类，开始编写</span>spark代码：</p>
<table><tbody><tr><td valign="top">
<p><span style="color:rgb(0,0,128);">import </span>org.apache.spark.{SparkContext, SparkConf}<br><br><span style="color:rgb(128,128,128);">/**</span><span style="color:rgb(128,128,128);"><br></span><span style="color:rgb(128,128,128);">  * Created by admin on 2015/12/15.</span><span style="color:rgb(128,128,128);"><br></span><span style="color:rgb(128,128,128);">  */</span><span style="color:rgb(128,128,128);"><br></span><span style="color:rgb(0,0,128);">object </span>SparkDemo1 {<br>
   <span style="color:rgb(0,0,128);">def </span>main (args: Array[<span style="color:rgb(32,153,157);">String</span>]) {<br>
      <span style="color:rgb(0,0,128);">if</span>(args.length&lt;<span style="color:rgb(0,0,255);">1</span>){<br>
        System.<span style="color:rgb(102,14,122);">err</span>.print(<span style="color:rgb(0,128,0);">"Usage &lt;File&gt;"</span>)<br>
        System.exit(<span style="color:rgb(0,0,255);">1</span>)<br>
      }<br>
     <span style="color:rgb(0,0,128);">val </span>conf=<span style="color:rgb(0,0,128);">new </span>SparkConf()<br>
     <span style="color:rgb(0,0,128);">val </span>sc=<span style="color:rgb(0,0,128);">new </span>SparkContext(conf)<br>
     <span style="color:rgb(0,0,128);">val </span>line=sc.textFile(args(<span style="color:rgb(0,0,255);">0</span>))<br><br>
     line.flatMap(_.split(<span style="color:rgb(0,128,0);">"</span><span style="color:rgb(0,0,128);">\t</span><span style="color:rgb(0,128,0);">"</span>)).map((_,<span style="color:rgb(0,0,255);">1</span>)).reduceByKey(_+_).collect().foreach(println)<br><br>
     sc.stop()<br>
  }<br>
}</p>
<p> </p>
</td>
</tr></tbody></table><p>Intellij IDA视图如下：</p>
<p> <img src="https://img-blog.csdn.net/20160312150443336?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>5<span style="font-family:'宋体';">、</span>打包：</p>
<p> <img src="https://img-blog.csdn.net/20160312150446588?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>打好的包：</p>
<p> <img src="https://img-blog.csdn.net/20160312150452307?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p>用的是Standalone集群：</p>
<p> <img src="https://img-blog.csdn.net/20160312150459667?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> <img src="https://img-blog.csdn.net/20160312150506601?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>6<span style="font-family:'宋体';">、</span>集群运行代码：</p>
<p>[root@spark0 spark]# bin/spark-submit --class SparkDemo1 /usr/local/spark/ScalaDemo1.jar /usr/local/spark-1.5.2-bin-hadoop2.6/bigdata/wcDemo1.txt</p>
<p> </p>
<p> <img src="https://img-blog.csdn.net/20160312150511230?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>运行结果：</p>
<p> <img src="https://img-blog.csdn.net/20160312150516023?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p>整个运行过程：</p>
<table><tbody><tr><td valign="top">
<p>[root@spark0 spark]# bin/spark-submit --class SparkDemo1 /usr/local/spark/ScalaDemo1.jar /usr/local/spark-1.5.2-bin-hadoop2.6/bigdata/wcDemo1.txt</p>
<p>Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties</p>
<p>15/12/15 14:44:21 INFO SparkContext: Running Spark version 1.5.2</p>
<p>15/12/15 14:44:21 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable</p>
<p>15/12/15 14:44:21 INFO SecurityManager: Changing view acls to: root</p>
<p>15/12/15 14:44:21 INFO SecurityManager: Changing modify acls to: root</p>
<p>15/12/15 14:44:21 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: Set(root); users with modify permissions: Set(root)</p>
<p>15/12/15 14:44:23 INFO Slf4jLogger: Slf4jLogger started</p>
<p>15/12/15 14:44:23 INFO Remoting: Starting remoting</p>
<p>15/12/15 14:44:23 INFO Remoting: Remoting started; listening on addresses :[akka.tcp://sparkDriver@192.168.6.2:40172]</p>
<p>15/12/15 14:44:23 INFO Utils: Successfully started service 'sparkDriver' on port 40172.</p>
<p>15/12/15 14:44:23 INFO SparkEnv: Registering MapOutputTracker</p>
<p>15/12/15 14:44:23 INFO SparkEnv: Registering BlockManagerMaster</p>
<p>15/12/15 14:44:23 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-dbd5e9f3-bfa1-4c03-9bbe-9ff2661049f2</p>
<p>15/12/15 14:44:23 INFO MemoryStore: MemoryStore started with capacity 534.5 MB</p>
<p>15/12/15 14:44:23 INFO HttpFileServer: HTTP File server directory is /tmp/spark-ffda6806-746c-4740-9558-bd3a047fafe2/httpd-0ded5c18-fb57-4ab7-bcd2-3ef6a5fa550d</p>
<p>15/12/15 14:44:23 INFO HttpServer: Starting HTTP Server</p>
<p>15/12/15 14:44:23 INFO Utils: Successfully started service 'HTTP file server' on port 40716.</p>
<p>15/12/15 14:44:23 INFO SparkEnv: Registering OutputCommitCoordinator</p>
<p>15/12/15 14:44:24 INFO Utils: Successfully started service 'SparkUI' on port 4040.</p>
<p>15/12/15 14:44:24 INFO SparkUI: Started SparkUI at http://192.168.6.2:4040</p>
<p>15/12/15 14:44:24 INFO SparkContext: Added JAR file:/usr/local/spark/ScalaDemo1.jar at http://192.168.6.2:40716/jars/ScalaDemo1.jar with timestamp 1450161864561</p>
<p>15/12/15 14:44:24 WARN MetricsSystem: Using default name DAGScheduler for source because spark.app.id is not set.</p>
<p>15/12/15 14:44:24 INFO Executor: Starting executor ID driver on host localhost</p>
<p>15/12/15 14:44:25 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 40076.</p>
<p>15/12/15 14:44:25 INFO NettyBlockTransferService: Server created on 40076</p>
<p>15/12/15 14:44:25 INFO BlockManagerMaster: Trying to register BlockManager</p>
<p>15/12/15 14:44:25 INFO BlockManagerMasterEndpoint: Registering block manager localhost:40076 with 534.5 MB RAM, BlockManagerId(driver, localhost, 40076)</p>
<p>15/12/15 14:44:25 INFO BlockManagerMaster: Registered BlockManager</p>
<p>15/12/15 14:44:29 INFO MemoryStore: ensureFreeSpace(130448) called with curMem=0, maxMem=560497950</p>
<p>15/12/15 14:44:29 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 127.4 KB, free 534.4 MB)</p>
<p>15/12/15 14:44:29 INFO MemoryStore: ensureFreeSpace(14276) called with curMem=130448, maxMem=560497950</p>
<p>15/12/15 14:44:29 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 13.9 KB, free 534.4 MB)</p>
<p>15/12/15 14:44:29 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on localhost:40076 (size: 13.9 KB, free: 534.5 MB)</p>
<p>15/12/15 14:44:29 INFO SparkContext: Created broadcast 0 from textFile at SparkDemo1.scala:14</p>
<p>15/12/15 14:44:30 INFO FileInputFormat: Total input paths to process : 1</p>
<p>15/12/15 14:44:30 INFO SparkContext: Starting job: collect at SparkDemo1.scala:16</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Registering RDD 3 (map at SparkDemo1.scala:16)</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Got job 0 (collect at SparkDemo1.scala:16) with 1 output partitions</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Final stage: ResultStage 1(collect at SparkDemo1.scala:16)</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 0)</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Missing parents: List(ShuffleMapStage 0)</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Submitting ShuffleMapStage 0 (MapPartitionsRDD[3] at map at SparkDemo1.scala:16), which has no missing parents</p>
<p>15/12/15 14:44:30 INFO MemoryStore: ensureFreeSpace(4064) called with curMem=144724, maxMem=560497950</p>
<p>15/12/15 14:44:30 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 4.0 KB, free 534.4 MB)</p>
<p>15/12/15 14:44:30 INFO MemoryStore: ensureFreeSpace(2328) called with curMem=148788, maxMem=560497950</p>
<p>15/12/15 14:44:30 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 2.3 KB, free 534.4 MB)</p>
<p>15/12/15 14:44:30 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on localhost:40076 (size: 2.3 KB, free: 534.5 MB)</p>
<p>15/12/15 14:44:30 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:861</p>
<p>15/12/15 14:44:30 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 0 (MapPartitionsRDD[3] at map at SparkDemo1.scala:16)</p>
<p>15/12/15 14:44:30 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks</p>
<p>15/12/15 14:44:30 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0, localhost, PROCESS_LOCAL, 2213 bytes)</p>
<p>15/12/15 14:44:30 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)</p>
<p>15/12/15 14:44:30 INFO Executor: Fetching http://192.168.6.2:40716/jars/ScalaDemo1.jar with timestamp 1450161864561</p>
<p>15/12/15 14:44:31 INFO Utils: Fetching http://192.168.6.2:40716/jars/ScalaDemo1.jar to /tmp/spark-ffda6806-746c-4740-9558-bd3a047fafe2/userFiles-e4174a0b-997b-424c-893b-0570668f9320/fetchFileTemp8876302010385452933.tmp</p>
<p>15/12/15 14:44:36 INFO Executor: Adding file:/tmp/spark-ffda6806-746c-4740-9558-bd3a047fafe2/userFiles-e4174a0b-997b-424c-893b-0570668f9320/ScalaDemo1.jar to class loader</p>
<p>15/12/15 14:44:36 INFO HadoopRDD: Input split: file:/usr/local/spark-1.5.2-bin-hadoop2.6/bigdata/wcDemo1.txt:0+142</p>
<p>15/12/15 14:44:36 INFO deprecation: mapred.tip.id is deprecated. Instead, use mapreduce.task.id</p>
<p>15/12/15 14:44:36 INFO deprecation: mapred.task.id is deprecated. Instead, use mapreduce.task.attempt.id</p>
<p>15/12/15 14:44:36 INFO deprecation: mapred.task.is.map is deprecated. Instead, use mapreduce.task.ismap</p>
<p>15/12/15 14:44:36 INFO deprecation: mapred.task.partition is deprecated. Instead, use mapreduce.task.partition</p>
<p>15/12/15 14:44:36 INFO deprecation: mapred.job.id is deprecated. Instead, use mapreduce.job.id</p>
<p>15/12/15 14:44:37 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 2253 bytes result sent to driver</p>
<p>15/12/15 14:44:37 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 7131 ms on localhost (1/1)</p>
<p>15/12/15 14:44:37 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool </p>
<p>15/12/15 14:44:38 INFO DAGScheduler: ShuffleMapStage 0 (map at SparkDemo1.scala:16) finished in 7.402 s</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: looking for newly runnable stages</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: running: Set()</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: waiting: Set(ResultStage 1)</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: failed: Set()</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: Missing parents for ResultStage 1: List()</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: Submitting ResultStage 1 (ShuffledRDD[4] at reduceByKey at SparkDemo1.scala:16), which is now runnable</p>
<p>15/12/15 14:44:38 INFO MemoryStore: ensureFreeSpace(2288) called with curMem=151116, maxMem=560497950</p>
<p>15/12/15 14:44:38 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 2.2 KB, free 534.4 MB)</p>
<p>15/12/15 14:44:38 INFO MemoryStore: ensureFreeSpace(1375) called with curMem=153404, maxMem=560497950</p>
<p>15/12/15 14:44:38 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 1375.0 B, free 534.4 MB)</p>
<p>15/12/15 14:44:38 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on localhost:40076 (size: 1375.0 B, free: 534.5 MB)</p>
<p>15/12/15 14:44:38 INFO SparkContext: Created broadcast 2 from broadcast at DAGScheduler.scala:861</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 1 (ShuffledRDD[4] at reduceByKey at SparkDemo1.scala:16)</p>
<p>15/12/15 14:44:38 INFO TaskSchedulerImpl: Adding task set 1.0 with 1 tasks</p>
<p>15/12/15 14:44:38 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1, localhost, PROCESS_LOCAL, 1955 bytes)</p>
<p>15/12/15 14:44:38 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)</p>
<p>15/12/15 14:44:38 INFO ShuffleBlockFetcherIterator: Getting 1 non-empty blocks out of 1 blocks</p>
<p>15/12/15 14:44:38 INFO ShuffleBlockFetcherIterator: Started 0 remote fetches in 96 ms</p>
<p>15/12/15 14:44:38 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1541 bytes result sent to driver</p>
<p>15/12/15 14:44:38 INFO DAGScheduler: ResultStage 1 (collect at SparkDemo1.scala:16) finished in 0.335 s</p>
<p>15/12/15 14:44:38 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 335 ms on localhost (1/1)</p>
<p>15/12/15 14:44:38 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool </p>
<p>15/12/15 14:44:38 INFO DAGScheduler: Job 0 finished: collect at SparkDemo1.scala:16, took 8.480429 s</p>
<p>(spark,5)</p>
<p>(hive,3)</p>
<p>(hadoop,5)</p>
<p>(docker,1)</p>
<p>(flume,1)</p>
<p>(solr,1)</p>
<p>(storm,1)</p>
<p>(elasticsearch,1)</p>
<p>(kafka,1)</p>
<p>(sqoop,1)</p>
<p>(redis,1)</p>
<p>(hbase,1)</p>
<p>15/12/15 14:44:39 INFO SparkUI: Stopped Spark web UI at http://192.168.6.2:4040</p>
<p>15/12/15 14:44:39 INFO DAGScheduler: Stopping DAGScheduler</p>
<p>15/12/15 14:44:42 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!</p>
<p>15/12/15 14:44:42 INFO MemoryStore: MemoryStore cleared</p>
<p>15/12/15 14:44:42 INFO BlockManager: BlockManager stopped</p>
<p>15/12/15 14:44:42 INFO BlockManagerMaster: BlockManagerMaster stopped</p>
<p>15/12/15 14:44:42 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!</p>
<p>15/12/15 14:44:42 INFO RemoteActorRefProvider$RemotingTerminator: Shutting down remote daemon.</p>
<p>15/12/15 14:44:42 INFO RemoteActorRefProvider$RemotingTerminator: Remote daemon shut down; proceeding with flushing remote transports.</p>
<p>15/12/15 14:44:42 INFO SparkContext: Successfully stopped SparkContext</p>
<p>15/12/15 14:44:42 INFO ShutdownHookManager: Shutdown hook called</p>
<p>15/12/15 14:44:42 INFO ShutdownHookManager: Deleting directory /tmp/spark-ffda6806-746c-4740-9558-bd3a047fafe2</p>
<p>[root@spark0 spark]#</p>
</td>
</tr></tbody></table><p> </p>
<p> </p>
<p>7<span style="font-family:'宋体';">、关闭</span><span style="font-family:Calibri;">S</span>park集群：</p>
<p> <img src="https://img-blog.csdn.net/20160312150529433?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<h3>2.7<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">spark</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">union</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">join</span><span style="font-family:'宋体';">操作演示</span></h3>
<p> </p>
<p>union<span style="font-family:'宋体';">简介：</span></p>
<p>通常如果我们需要将两个<span style="font-family:Calibri;">select</span><span style="font-family:'宋体';">语句的结果作为一个整体显示出来，我们就需要用到</span><span style="font-family:Calibri;">union</span><span style="font-family:'宋体';">或者</span><span style="font-family:Calibri;">union all</span><span style="font-family:'宋体';">关键字。</span><span style="font-family:Calibri;">union(</span><span style="font-family:'宋体';">或称为联合</span><span style="font-family:Calibri;">)</span><span style="font-family:'宋体';">的作用是将多个结果合并在一起显示出来。 </span></p>
<p> </p>
<p>Union<span style="font-family:'宋体';">：对两个结果集进行并集操作，不包括重复行，同时进行默认规则的排序； </span></p>
<p>(Union All<span style="font-family:'宋体';">：对两个结果集进行并集操作，包括重复行，不进行排序；</span><span style="font-family:Calibri;">) </span></p>
<p> </p>
<p>Join<span style="font-family:'宋体';">连接</span>：</p>
<p>SQL<span style="font-family:'宋体';">中大概有这么几种</span><span style="font-family:Calibri;">JOIN</span><span style="font-family:'宋体';">：</span></p>
<p>cross join  交叉连接(<span style="font-family:'宋体';">笛卡尔积</span><span style="font-family:Calibri;">)</span></p>
<p>inner join  内连接</p>
<p>left outer join  左外连接<span style="font-family:Calibri;">(</span><span style="font-family:'宋体';">左面</span>有的，右面没有的，右面填NULL)</p>
<p>right outer join  右外连接</p>
<p>full outer join   全连接</p>
<p> <img src="https://img-blog.csdn.net/20160312150534683?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
<p>创建<span style="font-family:Calibri;">rdd1</span><span style="font-family:'宋体';">：</span></p>
<p>scala&gt;  val rdd1=sc.parallelize(List(('a',2),('b',4),('c',6),('d',9)))</p>
<p>rdd1: org.apache.spark.rdd.RDD[(Char, Int)] = ParallelCollectionRDD[6] at parallelize at &lt;console&gt;:15</p>
<p> </p>
<p>创建rdd2：</p>
<p>scala&gt; val rdd2=sc.parallelize(List(('c',6),('c',7),('d',8),('e',10)))</p>
<p>rdd2: org.apache.spark.rdd.RDD[(Char, Int)] = ParallelCollectionRDD[7] at parallelize at &lt;console&gt;:15</p>
<p> </p>
<p>执行union<span style="font-family:'宋体';">：</span></p>
<p>scala&gt; val unionrdd=rdd1 union rdd2</p>
<p>unionrdd: org.apache.spark.rdd.RDD[(Char, Int)] = UnionRDD[8] at union at &lt;console&gt;:19</p>
<p> </p>
<p>scala&gt; unionrdd.collect</p>
<p>res2: Array[(Char, Int)] = Array((a,2), (b,4), (c,6), (d,9), (c,6), (c,7), (d,8), (e,10))</p>
<p> </p>
<p> </p>
<p>执行：<span style="font-family:Calibri;">join</span><span style="font-family:'宋体';">：</span></p>
<p>scala&gt; val joinrdd=rdd1 join rdd2</p>
<p>joinrdd: org.apache.spark.rdd.RDD[(Char, (Int, Int))] = MapPartitionsRDD[11] at join at &lt;console&gt;:19</p>
<p> </p>
<p>scala&gt; joinrdd.collect</p>
<p>res3: Array[(Char, (Int, Int))] = Array((d,(9,8)), (c,(6,6)), (c,(6,7)))</p>
<p> </p>
<p> <img src="https://img-blog.csdn.net/20160312150539558?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>
<p> </p>
<p> </p>
<p> </p>
            </div>
                </div>