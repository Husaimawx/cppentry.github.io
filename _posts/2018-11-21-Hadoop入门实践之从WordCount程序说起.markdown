---
layout:     post
title:      Hadoop入门实践之从WordCount程序说起
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h3 style="font-family:Arial;line-height:25.99431800842285px;">
<span style="font-weight:normal;">这段时间需要学习Hadoop了，以前一直听说Hadoop，但是从来没有研究过，这几天粗略看完了《Hadoop实战》这本书，对Hadoop编程有了大致的了解。接下来就是多看多写了。以Hadoop自带的例子WordCount程序开始，来记录我的Hadoop学习过程。</span></h3>
<p style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
Hadoop自带例子WordCount.java</p>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">/**</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  Licensed under the Apache License, Version 2.0 (the "License");</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  you may not use this file except in compliance with the License.</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  You may obtain a copy of the License at</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *      http://www.apache.org/licenses/LICENSE-2.0</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  Unless required by applicable law or agreed to in writing, software</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  distributed under the License is distributed on an "AS IS" BASIS,</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  See the License for the specific language governing permissions and</span> </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> *  limitations under the License.</span> </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;"> */</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">package</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.examples;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.io.IOException;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.StringTokenizer;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.conf.Configuration;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.fs.Path;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.IntWritable;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.Text;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Job;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Mapper;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Reducer;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.util.GenericOptionsParser;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> WordCount {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> TokenizerMapper   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">       <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Mapper&lt;Object, Text, Text, IntWritable&gt;{  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> IntWritable one = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> IntWritable(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> Text word = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Text();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">        </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> map(Object key, Text value, Context context  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">                    ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      StringTokenizer itr = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> StringTokenizer(value.toString());  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (itr.hasMoreTokens()) {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">        word.set(itr.nextToken());  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">        context.write(word, one);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> IntSumReducer   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">       <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;"> Reducer&lt;Text,IntWritable,Text,IntWritable&gt; {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> IntWritable result = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> IntWritable();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> reduce(Text key, Iterable&lt;IntWritable&gt; values,   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">                       Context context  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">                       ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> sum = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">;  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">for</span><span style="border:none;background-color:inherit;"> (IntWritable val : values) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">        sum += val.get();  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      result.set(sum);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      context.write(key, result);  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> main(String[] args) </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> Exception {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    Configuration conf = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Configuration();  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    String[] otherArgs = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> GenericOptionsParser(conf, args).getRemainingArgs();  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="border:none;background-color:inherit;"> (otherArgs.length != </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2</span><span style="border:none;background-color:inherit;">) {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      System.err.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"Usage: wordcount &lt;in&gt; &lt;out&gt;"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">      System.exit(<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    Job job = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Job(conf, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"word count"</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setJarByClass(WordCount.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setMapperClass(TokenizerMapper.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setReducerClass(IntSumReducer.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setOutputKeyClass(Text.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setOutputValueClass(IntWritable.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    FileInputFormat.addInputPath(job, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(otherArgs[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">]));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    FileOutputFormat.setOutputPath(job, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(otherArgs[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">]));  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">    System.exit(job.waitForCompletion(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">true</span><span style="border:none;background-color:inherit;">) ? </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;"> : </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">  }  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">}  </span></li></ol></div>
<div>这个程序的功能是对文件中各个单词的数目进行统计。</div>
<div><br></div>
在Wordount.java中有两个静态内部类TokenizerMapper，IntSumReducer，关于静态内部类，可以参考另一篇文章<a href="http://developer.51cto.com/art/200811/97875.htm" rel="nofollow" style="color:rgb(255,153,0);text-decoration:none;">Java中的静态内部类</a>。这两个类分别对应与MapReduce中的map和reduce。至于为什么要用静态的内部类，个人理解是这样的：一般一个简单作业（Job）包含了一个map过程和一个reduce过程，Job，Map，Reduce写在一个文件中便于文件的组织。但是，Hadoop内部需要使用反射的方式来实例化客户端的Map和Reduce，所以使用了静态内部类的方式，参考了StackOverflow上的一个帖子：<a href="http://stackoverflow.com/questions/14828131/do-mappers-and-reducers-in-hadoop-have-to-be-static-classes" rel="nofollow" style="color:rgb(255,153,0);text-decoration:none;">Do
 Mappers and Reducers in Hadoop have to be static classes?</a>，如果不许要将Job，Map和Reduce组织在一起，完全可以将这三个类写在三个类文件中。</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<br></div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
在程序的main函数中首先实例化一个Configuration，用于加载Hadoop的配置信息，然后就解析给程序传递的参数，这里我们传递了两个字符串参数，经过解析之后保存在有两个元素的数组otherArgs中，其中otherArgs[0]为要进行统计的文件的路径，otherArgs[1]为经过MapReduce计算之后的结果所保存的位置。
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">Job job = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Job(conf, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"word count"</span><span style="border:none;background-color:inherit;">);  </span></span></li></ol></div>
语句实例化一个Job对象，然后就为Job对像指定运行时所需的类<br><div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">job.setJarByClass(WordCount.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li></ol></div>
表示告诉Hadoop集群，作业从哪个类开始运行，<br><div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">job.setMapperClass(TokenizerMapper.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li></ol></div>
表示执行哪个类的map方法，我们这里指定的是方法<br><div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> map(Object key, Text value, Context context  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">                   ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     StringTokenizer itr = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> StringTokenizer(value.toString());  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (itr.hasMoreTokens()) {  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">       word.set(itr.nextToken());  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">       context.write(word, one);  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">   }  </span></li></ol></div>
这个方法对要进行map的每行数据，使用StringTokenizer类进行分割，分割出来的值在保存到context中进行，从而在reduce中进行单词数量统计。</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">job.setReducerClass(IntSumReducer.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li></ol></div>
这行语句设置用于进行Reduce的类，告诉Hadoop集群执行哪个reduce函数：</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> reduce(Text key, Iterable&lt;IntWritable&gt; values,   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">                      Context context  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">                      ) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> sum = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">;  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">for</span><span style="border:none;background-color:inherit;"> (IntWritable val : values) {  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">       sum += val.get();  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     }  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     result.set(sum);  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">     context.write(key, result);  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">   }  </span></li></ol></div>
在这个函数执行之前，Hadoop已经为我们将各个单词的个数大概的归并在一起了，函数的前两个参数是Text 类型和Iterable类型，参数名分别为key和alues，其中在这里key表示在map方法中分割得到的单词，values表示在map阶段统计的单词的数量（由于reduce阶段接收到多个数据结点发送过来的统计结果，所以对应于一个key，可能有多个value，所以将这些value都保存在一迭代器中，然后对迭代器进行遍历，这个过程以后再讨论。），遍历values迭代器，对每个key的数量进行汇总，然后再记录在context中。</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">job.setOutputKeyClass(Text.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">job.setOutputValueClass(IntWritable.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li></ol></div>
表示MapReduce执行结束之后，将结果保存在HDFS中时，保存的数据类型。这里将结果的key以Text类型保存，value以IntWritable类型保存。</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">FileInputFormat.addInputPath(job, </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(otherArgs[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">]));  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;">FileOutputFormat.setOutputPath(job, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(otherArgs[</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">]));  </span></span></li></ol></div>
分别表示输入和输出的路径。</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<br></div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
这个程序相对于Hadoop的例子，我去掉了</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;font-size:12px;background-color:rgb(231,229,220);overflow:auto;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/workformywork/article/details/13767157#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:17.27272605895996px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">job.setCombinerClass(IntSumReducer.</span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);  </span></span></li></ol></div>
这行语句，在Hadoop中，Combiner主要用于提升Hadoop的处理效率，为了集中于理解MapReduce，我去掉了这行代码，待以后讨论提升Hadoop性能时，再学习Combiner。</div>
<div style="font-family:Arial;font-size:13.63636302947998px;line-height:25.99431800842285px;">
原文地址：<a href="http://blog.csdn.net/workformywork/article/details/13767157" rel="nofollow">点击打开链接</a></div>
            </div>
                </div>