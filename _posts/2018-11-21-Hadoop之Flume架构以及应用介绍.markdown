---
layout:     post
title:      Hadoop之Flume架构以及应用介绍
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>在具体介绍本文内容之前，先给大家看一下<a target="_blank" href="http://lib.csdn.net/base/hadoop" rel="nofollow" class="replace_word" title="Hadoop知识库" style="color:rgb(223,52,52); font-weight:bold">Hadoop</a>业务的整体开发流程： <br style="">
<img src="https://img-blog.csdn.net/20160530152554920" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<span style="white-space:pre"></span>从<a target="_blank" href="http://lib.csdn.net/base/hadoop" rel="nofollow" class="replace_word" title="Hadoop知识库" style="color:rgb(223,52,52); font-weight:bold">hadoop</a>的业务开发流程图中可以看出，在<a target="_blank" href="http://lib.csdn.net/base/hadoop" rel="nofollow" class="replace_word" title="Hadoop知识库" style="color:rgb(223,52,52); font-weight:bold">大数据</a>的业务处理过程中，对于数据的采集是十分重要的一步，也是不可避免的一步，从而引出我们本文的主角—Flume。本文将围绕Flume的<a target="_blank" href="http://lib.csdn.net/base/architecture" rel="nofollow" class="replace_word" title="大型网站架构知识库" style="color:rgb(223,52,52); font-weight:bold">架构</a>、Flume的应用(日志采集)进行详细的介绍。 <br style="">
</p>
<h1>一、Flume架构介绍 </h1>
<h2><span style="white-space:pre"></span>     1、Flume的概念 </h2>
<img src="https://img-blog.csdn.net/20160530153940611" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<span style="white-space:pre"></span>flume是分布式的日志收集系统，它将各个服务器中的数据收集起来并送到指定的地方去，比如说送到图中的HDFS，简单来说flume就是收集日志的。 <br style="">
<h2>     2、Event的概念 </h2>
<span style="white-space:pre"></span>在这里有必要先介绍一下flume中event的相关概念：flume的核心是把数据从数据源(source)收集过来，在将收集到的数据送到指定的目的地(sink)。为了保证输送的过程一定成功，在送到目的地(sink)之前，会先缓存数据(channel),待数据真正到达目的地(sink)后，flume在删除自己缓存的数据。 <br style="">
在整个数据的传输的过程中，流动的是event，即事务保证是在event级别进行的。那么什么是event呢？—–event将传输的数据进行封装，是flume传输数据的基本单位，如果是文本文件，通常是一行记录，event也是事务的基本单位。event从source，流向channel，再到sink，本身为一个字节数组，并可携带headers(头信息)信息。event代表着一个数据的最小完整单元，从外部数据源来，向外部的目的地去。 <br style="">
<span style="white-space:pre"></span>为了方便大家理解，给出一张event的数据流向图： <br style="">
<img src="https://img-blog.csdn.net/20160530163300022" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
一个完整的event包括：event headers、event body、event信息(即文本文件中的单行记录)，如下所以： <br style="">
<img src="https://img-blog.csdn.net/20160530163629374" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
其中event信息就是flume收集到的日记记录。 <br style="">
<h2>     3、flume架构介绍 </h2>
<span style="white-space:pre"></span>flume之所以这么神奇，是源于它自身的一个设计，这个设计就是agent，agent本身是一个<a target="_blank" href="http://lib.csdn.net/base/java" rel="nofollow" class="replace_word" title="Java 知识库" style="color:rgb(223,52,52); font-weight:bold">Java</a>进程，运行在日志收集节点—所谓日志收集节点就是服务器节点。 <br style="">
agent里面包含3个核心的组件：source—-&gt;channel—–&gt;sink,类似生产者、仓库、消费者的架构。 <br style="">
source：source组件是专门用来收集数据的，可以处理各种类型、各种格式的日志数据,包括avro、thrift、exec、jms、spooling directory、netcat、sequence generator、syslog、http、legacy、自定义。 <br style="">
channel：source组件把数据收集来以后，临时存放在channel中，即channel组件在agent中是专门用来存放临时数据的——对采集到的数据进行简单的缓存，可以存放在memory、jdbc、file等等。 <br style="">
sink：sink组件是用于把数据发送到目的地的组件，目的地包括hdfs、logger、avro、thrift、ipc、file、null、<a target="_blank" href="http://lib.csdn.net/base/hbase" rel="nofollow" class="replace_word" title="Hbase知识库" style="color:rgb(223,52,52); font-weight:bold">Hbase</a>、solr、自定义。 <br style="">
<h2>     4、flume的运行机制 </h2>
<span style="white-space:pre"></span>flume的核心就是一个agent，这个agent对外有两个进行交互的地方，一个是接受数据的输入——source，一个是数据的输出sink，sink负责将数据发送到外部指定的目的地。source接收到数据之后，将数据发送给channel，chanel作为一个数据缓冲区会临时存放这些数据，随后sink会将channel中的数据发送到指定的地方—-例如HDFS等，注意：只有在sink将channel中的数据成功发送出去之后，channel才会将临时数据进行删除，这种机制保证了数据传输的可靠性与安全性。 <br style="">
5、flume的广义用法 <br style="">
flume之所以这么神奇—-其原因也在于flume可以支持多级flume的agent，即flume可以前后相继，例如sink可以将数据写到下一个agent的source中，这样的话就可以连成串了，可以整体处理了。flume还支持扇入(fan-in)、扇出(fan-out)。所谓扇入就是source可以接受多个输入，所谓扇出就是sink可以将数据输出多个目的地destination中。 <br style="">
<img src="https://img-blog.csdn.net/20160530190347644" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<h1>二、flume应用—日志采集 </h1>
<span style="white-space:pre"></span>对于flume的原理其实很容易理解，我们更应该掌握flume的具体使用方法，flume提供了大量内置的Source、Channel和Sink类型。而且不同类型的Source、Channel和Sink可以自由组合—–组合方式基于用户设置的配置文件，非常灵活。比如：Channel可以把事件暂存在内存里，也可以持久化到本地硬盘上。Sink可以把日志写入HDFS, <a target="_blank" href="http://lib.csdn.net/base/hbase" rel="nofollow" class="replace_word" title="Hbase知识库" style="color:rgb(223,52,52); font-weight:bold">hbase</a>，甚至是另外一个Source等等。下面我将用具体的案例详述flume的具体用法。 <br style="">
<span style="white-space:pre"></span>其实flume的用法很简单—-书写一个配置文件，在配置文件当中描述source、channel与sink的具体实现，而后运行一个agent实例，在运行agent实例的过程中会读取配置文件的内容，这样flume就会采集到数据。 <br style="">
配置文件的编写原则： <br style="">
<span style="white-space:pre"></span>1&gt;从整体上描述代理agent中sources、sinks、channels所涉及到的组件
<p></p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_1_7939701" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>    <span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>2&gt;详细描述agent中每一个source、sink与channel的具体实现：即在描述source的时候，需要 <br style="">
指定source到底是什么类型的，即这个source是接受文件的、还是接受http的、还是接受thrift <br style="">
的；对于sink也是同理，需要指定结果是输出到HDFS中，还是Hbase中啊等等；对于channel <br style="">
需要指定是内存啊，还是<a target="_blank" href="http://lib.csdn.net/base/mysql" rel="nofollow" class="replace_word" title="MySQL知识库" style="color:rgb(223,52,52); font-weight:bold">数据库</a>啊，还是文件啊等等。</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_2_9782082" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>    <span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = netcat
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.bind</span> = localhost
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.port</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">44444</span>

    <span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = logger

    <span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in memory</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = memory
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.capacity</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">1000</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.transactionCapacity</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">100</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>3&gt;通过channel将source与sink连接起来</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_3_3228429" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>    <span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
    a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
启动agent的shell操作：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_4_6990419" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>    flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span>  <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf   <span class="hljs-attribute" style="box-sizing: border-box;">-f</span>  <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/example<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>file  
    <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console  </code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
参数说明： -n 指定agent名称(与配置文件中代理的名字相同) <br style="">
-c 指定flume中配置文件的目录 <br style="">
-f 指定配置文件 <br style="">
-Dflume.root.logger=DEBUG,console 设置日志等级</p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
具体案例： <br style="">
</p>
<h2>案例1： NetCat Source</h2>
<p></p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>监听一个指定的网络端口，即只要应用程序向这个端口里面写数据，这个source组件就可以获取到信息。 其中 Sink：logger Channel：memory <br style="">
flume官网中NetCat Source描述：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_5_5768920" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs vhdl has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">Property</span> Name <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">Default</span>     Description
channels       –     
<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">type</span>           –     The <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">component</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">type</span> name, needs <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> be netcat
bind           –  日志需要发送到的主机名或者Ip地址，该主机运行着netcat类型的source在监听          
<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">port</span>           –  日志需要发送到的端口号，该端口号要有netcat类型的source在监听      </code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
a) 编写配置文件：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_6_6707012" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = netcat
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.bind</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">192.168</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.port</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">44444</span>

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = logger

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in memory</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = memory
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.capacity</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">1000</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.transactionCapacity</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">100</span>

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
b) 启动flume agent a1 服务端</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_10_7153170" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-f</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/netcat<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>conf   <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
c) 使用telnet发送数据</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_11_2027976" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-title" style="box-sizing: border-box;">telnet</span>  <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">192.168</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span>  <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">44444</span>  big <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world！（windows中运行的）</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在控制台上查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160530211114709" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"></p>
<h2 style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px">
案例2：NetCat Source</h2>
<p style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px">
<span style="font-size:14px"><span style="white-space:pre"></span>监听一个指定的网络端口，即只要应用程序向这个端口里面写数据，这个source组件就可以获取到信息。 其中 Sink：hdfs Channel：file (相比于案例1的两个变化) </span></p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
flume官网中HDFS Sink的描述： <br style="">
<img src="https://img-blog.csdn.net/20160530213143487" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
a) 编写配置文件：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_9_326517" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = netcat
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.bind</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">192.168</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.port</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">44444</span>

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = hdfs
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.path</span> = hdfs://hadoop80:<span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">9000</span>/dataoutput
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.writeFormat</span> = Text
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.fileType</span> = DataStream
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollInterval</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">10</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollSize</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollCount</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.filePrefix</span> = %<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">Y</span>-%m-%d-%H-%M-%S
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.useLocalTimeStamp</span> = true

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in file</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = file
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.checkpointDir</span> = /usr/flume/checkpoint
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.dataDirs</span> = /usr/flume/data

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li><li style="box-sizing: border-box; padding: 0px 5px;">29</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li><li style="box-sizing: border-box; padding: 0px 5px;">29</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
b) 启动flume agent a1 服务端</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_10_7153170" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-f</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/netcat<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>conf   <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
c) 使用telnet发送数据</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_11_2027976" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-title" style="box-sizing: border-box;">telnet</span>  <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">192.168</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span>  <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">44444</span>  big <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world！（windows中运行的）</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在HDFS中查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160530214141812" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
</p>
<h2>案例3：Spooling Directory Source</h2>
<p></p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span><span style="white-space:pre"></span>监听一个指定的目录，即只要应用程序向这个指定的目录中添加新的文件，source组件就可以获取到该信息，并解析该文件的内容，然后写入到channle。写入完成后，标记该文件已完成或者删除该文件。其中 Sink：logger Channel：memory <br style="">
flume官网中Spooling Directory Source描述：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_12_2201917" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs oxygene has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">Property</span> Name       <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">Default</span>      Description
channels              –  
<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">type</span>                  –          The component <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">type</span> name, needs <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> be spooldir.
spoolDir              –          Spooling Directory Source监听的目录
fileSuffix         .COMPLETED    文件内容写入到channel之后，标记该文件
deletePolicy       never         文件内容写入到channel之后的删除策略: never <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">or</span> immediate
fileHeader         <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">false</span>         Whether <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">add</span> a header storing the absolute path filename.
ignorePattern      ^$           Regular expression specifying which files <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> ignore (<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">skip</span>)
interceptors          –          指定传输中<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">event</span>的head(头信息)，常用timestamp</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
Spooling Directory Source的两个注意事项：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_13_5091855" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs applescript has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>①If a <span class="hljs-type" style="box-sizing: border-box;">file</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">is</span> written <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">after</span> being placed <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">into</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">the</span> spooling directory, Flume will print an <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">error</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">its</span> <span class="hljs-command" style="box-sizing: border-box;">log</span> <span class="hljs-type" style="box-sizing: border-box;">file</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">and</span> stop processing.
即：拷贝到spool目录下的文件不可以再打开编辑
②If a <span class="hljs-type" style="box-sizing: border-box;">file</span> <span class="hljs-property" style="box-sizing: border-box;">name</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">is</span> reused <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">at</span> a later <span class="hljs-property" style="box-sizing: border-box;">time</span>, Flume will print an <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">error</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">its</span> <span class="hljs-command" style="box-sizing: border-box;">log</span> <span class="hljs-type" style="box-sizing: border-box;">file</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">and</span> stop processing.
即：不能将具有相同文件名字的文件拷贝到这个目录下</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
a) 编写配置文件：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_14_490050" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = spooldir
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.spoolDir</span> = /usr/local/datainput
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.fileHeader</span> = true
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.interceptors</span> = i1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.interceptors</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.i</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = timestamp

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = logger

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in memory</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = memory
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.capacity</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">1000</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.transactionCapacity</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">100</span>

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
b) 启动flume agent a1 服务端</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_19_8809636" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-f</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/spool<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>conf   <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
c) 使用cp命令向Spooling Directory 中发送数据</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_20_1176188" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'> cp datafile  /usr/local/datainput   (注：datafile中的内容为：big <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world！)</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在控制台上查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160531092947740" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
从控制台显示的结果可以看出event的头信息中包含了时间戳信息。 <br style="">
同时我们查看一下Spooling Directory中的datafile信息—-文件内容写入到channel之后，该文件被标记了：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_17_1252635" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs ruby has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>[root<span class="hljs-variable" style="color: rgb(102, 0, 102); box-sizing: border-box;">@hadoop80</span> datainput]<span class="hljs-comment" style="color: rgb(136, 0, 0); box-sizing: border-box;"># ls</span>
datafile.<span class="hljs-constant" style="box-sizing: border-box;">COMPLETED</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li></ul>
<h2 style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px">
案例4：Spooling Directory Source</h2>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>监听一个指定的目录，即只要应用程序向这个指定的目录中添加新的文件，source组件就可以获取到该信息，并解析该文件的内容，然后写入到channle。写入完成后，标记该文件已完成或者删除该文件。 其中 Sink：hdfs Channel：file (相比于案例3的两个变化)</p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
a) 编写配置文件：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_18_554524" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = spooldir
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.spoolDir</span> = /usr/local/datainput
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.fileHeader</span> = true
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.interceptors</span> = i1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.interceptors</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.i</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = timestamp

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = hdfs
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.path</span> = hdfs://hadoop80:<span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">9000</span>/dataoutput
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.writeFormat</span> = Text
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.fileType</span> = DataStream
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollInterval</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">10</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollSize</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollCount</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.filePrefix</span> = %<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">Y</span>-%m-%d-%H-%M-%S
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.useLocalTimeStamp</span> = true

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in file</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = file
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.checkpointDir</span> = /usr/flume/checkpoint
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.dataDirs</span> = /usr/flume/data

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li><li style="box-sizing: border-box; padding: 0px 5px;">29</li><li style="box-sizing: border-box; padding: 0px 5px;">30</li><li style="box-sizing: border-box; padding: 0px 5px;">31</li><li style="box-sizing: border-box; padding: 0px 5px;">32</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li><li style="box-sizing: border-box; padding: 0px 5px;">29</li><li style="box-sizing: border-box; padding: 0px 5px;">30</li><li style="box-sizing: border-box; padding: 0px 5px;">31</li><li style="box-sizing: border-box; padding: 0px 5px;">32</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
b) 启动flume agent a1 服务端</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_19_8809636" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-f</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/spool<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>conf   <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
c) 使用cp命令向Spooling Directory 中发送数据</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_20_1176188" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'> cp datafile  /usr/local/datainput   (注：datafile中的内容为：big <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world！)</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在控制台上可以参看sink的运行进度日志： <br style="">
<img src="https://img-blog.csdn.net/20160531094446417" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
d) 在HDFS中查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160531094639919" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<img src="https://img-blog.csdn.net/20160531094652974" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
从案例1与案例2、案例3与案例4的对比中我们可以发现：flume的配置文件在编写的过程中是非常灵活的。</p>
<h2 style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px">
案例5：Exec Source</h2>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>监听一个指定的命令，获取一条命令的结果作为它的数据源 <br style="">
常用的是tail -F file指令，即只要应用程序向日志(文件)里面写数据，source组件就可以获取到日志(文件)中最新的内容 。 其中 Sink：hdfs Channel：file <br style="">
这个案列为了方便显示Exec Source的运行效果，结合<a target="_blank" href="http://lib.csdn.net/base/hive" rel="nofollow" class="replace_word" title="Hive知识库" style="color:rgb(223,52,52); font-weight:bold">Hive</a>中的external table进行来说明。</p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
a) 编写配置文件：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_21_9398280" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = exec
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.command</span> = tail -F /usr/local/log<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.file</span>

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = hdfs
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.path</span> = hdfs://hadoop80:<span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">9000</span>/dataoutput
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.writeFormat</span> = Text
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.fileType</span> = DataStream
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollInterval</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">10</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollSize</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollCount</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.filePrefix</span> = %<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">Y</span>-%m-%d-%H-%M-%S
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.useLocalTimeStamp</span> = true

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in file</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = file
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.checkpointDir</span> = /usr/flume/checkpoint
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.dataDirs</span> = /usr/flume/data

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
b)在<a target="_blank" href="http://lib.csdn.net/base/hive" rel="nofollow" class="replace_word" title="Hive知识库" style="color:rgb(223,52,52); font-weight:bold">hive</a>中建立外部表—–hdfs://hadoop80:9000/dataoutput的目录，方便查看日志捕获内容</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_22_3716679" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs oxygene has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>hive&gt; <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">create</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">external</span> table t1(infor  string)
    &gt; row format delimited
    &gt; fields terminated <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">by</span> <span class="hljs-string" style="color: rgb(0, 136, 0); box-sizing: border-box;">'\t'</span>
    &gt; location <span class="hljs-string" style="color: rgb(0, 136, 0); box-sizing: border-box;">'/dataoutput/'</span>;
OK
Time taken: <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0.284</span> seconds</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
c) 启动flume agent a1 服务端</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_23_6955282" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-f</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/exec<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>conf   <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 使用echo命令向/usr/local/datainput 中发送数据</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_24_7893374" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'> echo  big <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> &gt; log.file</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在HDFS和Hive分别中查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160531103741650" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"></p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_25_3083825" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs cs has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>hive&gt; <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">select</span> * <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">from</span> t1;
OK
big data
Time taken: <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0.086</span> seconds</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
e)使用echo命令向/usr/local/datainput 中在追加一条数据</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_26_6530171" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-title" style="box-sizing: border-box;">echo</span> big <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world! &gt;&gt; log.file</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在HDFS和Hive再次分别中查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160531104040589" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<img src="https://img-blog.csdn.net/20160531104108195" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"></p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_27_9212366" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-title" style="box-sizing: border-box;">hive</span>&gt; select * from t1;
<span class="hljs-type" style="box-sizing: border-box; color: rgb(102, 0, 102);">OK</span>
<span class="hljs-title" style="box-sizing: border-box;">big</span> <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span></span>
<span class="hljs-title" style="box-sizing: border-box;">big</span> <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world!</span>
<span class="hljs-type" style="box-sizing: border-box; color: rgb(102, 0, 102);">Time</span> taken: <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0.511</span> seconds</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
总结Exec source：Exec source和Spooling Directory Source是两种常用的日志采集的方式，其中Exec source可以实现对日志的实时采集，Spooling Directory Source在对日志的实时采集上稍有欠缺，尽管Exec source可以实现对日志的实时采集，但是当Flume不运行或者指令执行出错时，Exec source将无法收集到日志数据，日志会出现丢失，从而无法保证收集日志的完整性。</p>
<h2 style="margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px">
案例6：Avro Source</h2>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
<span style="white-space:pre"></span>监听一个指定的Avro 端口，通过Avro 端口可以获取到Avro client发送过来的文件 。即只要应用程序通过Avro 端口发送文件，source组件就可以获取到该文件中的内容。 其中 Sink：hdfs Channel：file <br style="">
(注：Avro和Thrift都是一些序列化的网络端口–通过这些网络端口可以接受或者发送信息，Avro可以发送一个给定的文件给Flume，Avro 源使用AVRO RPC机制) <br style="">
Avro Source运行原理如下图： <br style="">
<img src="https://img-blog.csdn.net/20160531111151304" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
flume官网中Avro Source的描述：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_28_4610560" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs vhdl has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">Property</span>     Name   <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">Default</span> Description
channels      –  
<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">type</span>          –     The <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">component</span> <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">type</span> name, needs <span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">to</span> be avro
bind          –     日志需要发送到的主机名或者ip，该主机运行着ARVO类型的source
<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">port</span>          –     日志需要发送到的端口号，该端口要有ARVO类型的source在监听</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
1)编写配置文件</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_29_3389061" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs avrasm has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Name the components on this agent</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span> = <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">r1</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span> = k1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe/configure the source</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = avro
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.bind</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">192.168</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.port</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">4141</span>

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Describe the sink</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = hdfs
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.path</span> = hdfs://hadoop80:<span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">9000</span>/dataoutput
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.writeFormat</span> = Text
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.fileType</span> = DataStream
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollInterval</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">10</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollSize</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.rollCount</span> = <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">0</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.filePrefix</span> = %<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">Y</span>-%m-%d-%H-%M-%S
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.hdfs</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.useLocalTimeStamp</span> = true

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Use a channel which buffers events in file</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.type</span> = file
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.checkpointDir</span> = /usr/flume/checkpoint
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.c</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.dataDirs</span> = /usr/flume/data

<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;"># Bind the source and sink to the channel</span>
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sources</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.r</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channels</span> = c1
a1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.sinks</span><span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.k</span>1<span class="hljs-preprocessor" style="color: rgb(68, 68, 68); box-sizing: border-box;">.channel</span> = c1</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li><li style="box-sizing: border-box; padding: 0px 5px;">29</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li><li style="box-sizing: border-box; padding: 0px 5px;">4</li><li style="box-sizing: border-box; padding: 0px 5px;">5</li><li style="box-sizing: border-box; padding: 0px 5px;">6</li><li style="box-sizing: border-box; padding: 0px 5px;">7</li><li style="box-sizing: border-box; padding: 0px 5px;">8</li><li style="box-sizing: border-box; padding: 0px 5px;">9</li><li style="box-sizing: border-box; padding: 0px 5px;">10</li><li style="box-sizing: border-box; padding: 0px 5px;">11</li><li style="box-sizing: border-box; padding: 0px 5px;">12</li><li style="box-sizing: border-box; padding: 0px 5px;">13</li><li style="box-sizing: border-box; padding: 0px 5px;">14</li><li style="box-sizing: border-box; padding: 0px 5px;">15</li><li style="box-sizing: border-box; padding: 0px 5px;">16</li><li style="box-sizing: border-box; padding: 0px 5px;">17</li><li style="box-sizing: border-box; padding: 0px 5px;">18</li><li style="box-sizing: border-box; padding: 0px 5px;">19</li><li style="box-sizing: border-box; padding: 0px 5px;">20</li><li style="box-sizing: border-box; padding: 0px 5px;">21</li><li style="box-sizing: border-box; padding: 0px 5px;">22</li><li style="box-sizing: border-box; padding: 0px 5px;">23</li><li style="box-sizing: border-box; padding: 0px 5px;">24</li><li style="box-sizing: border-box; padding: 0px 5px;">25</li><li style="box-sizing: border-box; padding: 0px 5px;">26</li><li style="box-sizing: border-box; padding: 0px 5px;">27</li><li style="box-sizing: border-box; padding: 0px 5px;">28</li><li style="box-sizing: border-box; padding: 0px 5px;">29</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
b) 启动flume agent a1 服务端</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_30_3039614" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span>  agent <span class="hljs-attribute" style="box-sizing: border-box;">-n</span> a1  <span class="hljs-attribute" style="box-sizing: border-box;">-c</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-f</span> <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf/avro<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>conf   <span class="hljs-attribute" style="box-sizing: border-box;">-Dflume</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>root<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>logger<span class="hljs-subst" style="color: rgb(0, 0, 0); box-sizing: border-box;">=</span>DEBUG,console</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
c)使用avro-client发送文件</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_31_6801605" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs lasso has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>flume<span class="hljs-attribute" style="box-sizing: border-box;">-ng</span> avro<span class="hljs-attribute" style="box-sizing: border-box;">-client</span> <span class="hljs-attribute" style="box-sizing: border-box;">-c</span>  <span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">..</span>/conf  <span class="hljs-attribute" style="box-sizing: border-box;">-H</span> <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">192.168</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span><span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">.80</span>  <span class="hljs-attribute" style="box-sizing: border-box;">-p</span> <span class="hljs-number" style="color: rgb(0, 102, 102); box-sizing: border-box;">4141</span> <span class="hljs-attribute" style="box-sizing: border-box;">-F</span> /usr/<span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">local</span>/<span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">log</span><span class="hljs-built_in" style="color: rgb(102, 0, 102); box-sizing: border-box;">.</span>file</code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
注：log.file文件中的内容为：</p>
<pre code_snippet_id="2471367" snippet_file_name="blog_20170705_32_6659901" class="prettyprint" name="code" style='white-space: nowrap; word-wrap: break-word; box-sizing: border-box; position: relative; overflow-y: hidden; overflow-x: auto; margin-top: 0px; margin-bottom: 1.1em; font-family: "Source Code Pro", monospace; padding: 5px 5px 5px 60px; font-size: 14px; line-height: 1.45; word-break: break-all; color: rgb(51, 51, 51); background-color: rgba(128, 128, 128, 0.0470588); border: 0px solid rgb(136, 136, 136); border-radius: 0px;'><code class="hljs haskell has-numbering" style='display: block; padding: 0px; background: transparent; color: inherit; box-sizing: border-box; font-family: "Source Code Pro", monospace;font-size:undefined; white-space: pre; border-radius: 0px; word-wrap: normal;'>[root@hadoop80 local]# more log.file
<span class="hljs-title" style="box-sizing: border-box;">big</span> <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span></span>
<span class="hljs-title" style="box-sizing: border-box;">big</span> <span class="hljs-typedef" style="box-sizing: border-box;"><span class="hljs-keyword" style="color: rgb(0, 0, 136); box-sizing: border-box;">data</span> world!</span></code></pre><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right; opacity: 0;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li></ul><ul class="pre-numbering" style="box-sizing: border-box; position: absolute; width: 50px; background-color: rgb(238, 238, 238); top: 0px; left: 0px; margin: 0px; padding: 6px 0px 40px; border-right: 1px solid rgb(221, 221, 221); list-style: none; text-align: right;"><li style="box-sizing: border-box; padding: 0px 5px;">1</li><li style="box-sizing: border-box; padding: 0px 5px;">2</li><li style="box-sizing: border-box; padding: 0px 5px;">3</li></ul>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
d) 在HDFS中查看flume收集到的日志数据： <br style="">
<img src="https://img-blog.csdn.net/20160531112942467" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<img src="https://img-blog.csdn.net/20160531122918121" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"> <br style="">
<img src="https://img-blog.csdn.net/20160531122951552" alt="这里写图片描述" title="" style="border:none; max-width:602px; height:auto"></p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
通过上面的几个案例，我们可以发现：flume配置文件的书写是相当灵活的—-不同类型的Source、Channel和Sink可以自由组合！</p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
最后对上面用的几个flume source进行适当总结： <br style="">
① NetCat Source：监听一个指定的网络端口，即只要应用程序向这个端口里面写数据，这个source组件 <br style="">
就可以获取到信息。 <br style="">
②Spooling Directory Source：监听一个指定的目录，即只要应用程序向这个指定的目录中添加新的文 <br style="">
件，source组件就可以获取到该信息，并解析该文件的内容，然后写入到channle。写入完成后，标记 <br style="">
该文件已完成或者删除该文件。 <br style="">
③Exec Source：监听一个指定的命令，获取一条命令的结果作为它的数据源 <br style="">
常用的是tail -F file指令，即只要应用程序向日志(文件)里面写数据，source组件就可以获取到日志(文件)中最新的内容 。 <br style="">
④Avro Source：监听一个指定的Avro 端口，通过Avro 端口可以获取到Avro client发送过来的文件 。即只要应用程序通过Avro 端口发送文件，source组件就可以获取到该文件中的内容。</p>
<p style='margin-top:0px; margin-bottom:1.1em; padding-top:0px; padding-bottom:0px; color:rgb(63,63,63); font-family:"microsoft yahei"; font-size:15px'>
如有问题，欢迎留言指正！</p>
            </div>
                </div>