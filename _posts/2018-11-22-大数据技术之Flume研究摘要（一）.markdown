---
layout:     post
title:      大数据技术之Flume研究摘要（一）
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
Flume<span style="font-family:'宋体';">是</span>Cloudera<span style="font-family:'宋体';">提供的一个高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统，</span>Flume<span style="font-family:'宋体';">支持在日志系统中定制各类数据发送方，用于收集数据；同时，</span>Flume<span style="font-family:'宋体';">提供对数据进行简单处理，并写到各种数据接受方（可定制）的能力。</span><br></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
Flume<span style="font-family:'宋体';">有两个版本，</span>Flume 0.9X<span style="font-family:'宋体';">或</span>CDH3<span style="font-family:'宋体';">及更早版本的统称</span>Flume-og<span style="font-family:'宋体';">，</span>Flume-og<span style="font-family:'宋体';">由</span>agent<span style="font-family:'宋体';">、</span>collection<span style="font-family:'宋体';">、</span>master<span style="font-family:'宋体';">等组件组成；</span>Flume1.X<span style="font-family:'宋体';">或</span>CDH4<span style="font-family:'宋体';">及以后的版本统称</span>Flume-ng<span style="font-family:'宋体';">，</span>Flume-ng<span style="font-family:'宋体';">由</span>agent<span style="font-family:'宋体';">、</span>client<span style="font-family:'宋体';">等组件组成，截止到目前为止，</span>Flume<span style="font-family:'宋体';">最新版本为</span>1.6.0<span style="font-family:'宋体';">版本，</span>Flume1.6.0<span style="font-family:'宋体';">有几个新特性：</span></p>
<p style="margin-left:28px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
</p>
<ul><li><span style="line-height:24px;font-family:Simsun, serif;">Flume Sink and Source for Apache Kafka</span><span style="line-height:24px;font-family:'宋体';">（</span><span style="line-height:24px;font-family:Simsun, serif;">source</span><span style="line-height:24px;font-family:'宋体';">、</span><span style="line-height:24px;font-family:Simsun, serif;">sink</span><span style="line-height:24px;font-family:'宋体';">新增对</span><span style="line-height:24px;font-family:Simsun, serif;">Kafka</span><span style="line-height:24px;font-family:'宋体';">的支持）</span></li><li><span style="line-height:24px;font-family:Simsun, serif;">A new channel that uses Kafka</span><span style="line-height:24px;font-family:'宋体';">（</span><span style="line-height:24px;font-family:Simsun, serif;">channel</span><span style="line-height:24px;font-family:'宋体';">使用</span><span style="line-height:24px;font-family:Simsun, serif;">Kafka</span><span style="line-height:24px;font-family:'宋体';">的消息通道）</span></li><li><span style="line-height:24px;font-family:Simsun, serif;">Hive Sink based on the new Hive Streamingsupport</span></li><li><span style="line-height:24px;font-family:Simsun, serif;">End to End authentication in Flume</span></li><li><span style="line-height:24px;font-family:Simsun, serif;">Simple regex search-and-replace interceptor</span><span style="line-height:24px;font-family:'宋体';">（拦截器支持简单的正则表达式）</span></li></ul><p></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Agent</span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span>Flume</span><span style="font-family:'宋体';">运行的核心是</span><span>agent</span><span style="font-family:'宋体';">，</span><span>agent</span><span style="font-family:'宋体';">用于采集数据，将数据源的数据发送给</span><span>collector</span><span style="font-family:'宋体';">。它是一个完整的数据收集工具，含有三个核心组件，分别是</span><span>source</span><span style="font-family:'宋体';">、</span><span>channel</span><span style="font-family:'宋体';">、</span><span>sink</span><span style="font-family:'宋体';">。</span><span>Event</span><span style="font-family:'宋体';">从</span><span>Source</span><span style="font-family:'宋体';">，流向</span><span>Channel</span><span style="font-family:'宋体';">，再到</span><span>Sink</span><span style="font-family:'宋体';">。</span><span>Event</span><span style="font-family:'宋体';">代表着一个数据流的最小完整单元，从外部数据源来，向外部的目的地去。</span><span>Source:</span><span style="font-family:'宋体';">完成对日志数据的收集，分成</span><span>transtion</span><span style="font-family:'宋体';">和</span><span>
 event </span><span style="font-family:'宋体';">打入到</span><span>channel</span><span style="font-family:'宋体';">之中。</span><span>Channel:</span><span style="font-family:'宋体';">主要提供一个队列的功能，对</span><span>source</span><span style="font-family:'宋体';">提供中的数据进行简单的缓存。</span><span>Sink:</span><span style="font-family:'宋体';">取出</span><span>Channel</span><span style="font-family:'宋体';">中的数据，进行相应的存储文件系统，数据库，或者提交到远程服务器。通过这些组件，</span><span>event</span><span style="font-family:'宋体';">可以从一个地方流向另一个地方，如下图所示。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<img src="https://img-blog.csdn.net/20150716100705424?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span>Source</span><span style="font-family:'宋体';">消费从外部流进的</span><span>Events</span><span style="font-family:'宋体';">，如</span><span>AvroSource</span><span style="font-family:'宋体';">接收外部客户端传来的或是从别的</span><span>agent</span><span style="font-family:'宋体';">流出来的</span><span>Avro
 Event</span><span style="font-family:'宋体';">。</span><span>Source</span><span style="font-family:'宋体';">可以把</span><span>event</span><span style="font-family:'宋体';">送往一个或多个</span><span>channel</span><span style="font-family:'宋体';">。</span><span>channel</span><span style="font-family:'宋体';">是一个队列，持有</span><span>event</span><span style="font-family:'宋体';">等待</span><span>sink</span><span style="font-family:'宋体';">来消费，一种</span><span>Channel</span><span style="font-family:'宋体';">的实现：</span><span>FileChannel</span><span style="font-family:'宋体';">使用本地文件系统来作为它的存储。</span><span>Sink</span><span style="font-family:'宋体';">的作用是把</span><span>Event</span><span style="font-family:'宋体';">从</span><span>channel</span><span style="font-family:'宋体';">里移除，送往外部数据仓库或给下一站</span><span>agent</span><span style="font-family:'宋体';">的</span><span>Source</span><span style="font-family:'宋体';">，如</span><span>HDFSEventSink</span><span style="font-family:'宋体';">送往</span><span>HDFS</span><span style="font-family:'宋体';">。同个</span><span>agent</span><span style="font-family:'宋体';">下的</span><span>source</span><span style="font-family:'宋体';">和</span><span>sink</span><span style="font-family:'宋体';">是异步的。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span>flume-ng</span><span style="font-family:'宋体';">是由一个个</span><span>agent</span><span style="font-family:'宋体';">组成的。一个</span><span>agent</span><span style="font-family:'宋体';">就像一个细胞一样。当然可以自由组合，如下图：</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<img src="https://img-blog.csdn.net/20150716100718047?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><br></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span>下图为多对一Collection场景：<br><img src="https://img-blog.csdn.net/20150716100731879?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"></span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"></span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Source</span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:'宋体';">完成对日志数据的收集，分成</span>transtion<span style="font-family:'宋体';">和</span> event<span style="font-family:'宋体';">打入到</span>channel<span style="font-family:'宋体';">之中</span></p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
</p>
<ul><li><span style="line-height:25.6000003814697px;">Source</span><span style="line-height:25.6000003814697px;font-family:'宋体';">用于获取数据，可从文本文件，</span><span style="line-height:25.6000003814697px;">syslog</span><span style="line-height:25.6000003814697px;font-family:'宋体';">，</span><span style="line-height:25.6000003814697px;">HTTP</span><span style="line-height:25.6000003814697px;font-family:'宋体';">等获取数据</span></li><li><span style="line-height:25.6000003814697px;">Sink</span><span style="line-height:25.6000003814697px;font-family:'宋体';">将</span><span style="line-height:25.6000003814697px;">Source</span><span style="line-height:25.6000003814697px;font-family:'宋体';">获得的数据进一步传输给后面的</span><span style="line-height:25.6000003814697px;">Collector</span><span style="line-height:25.6000003814697px;font-family:'宋体';">。</span></li><li><span style="line-height:25.6000003814697px;">syslogTcp(5140) |agentSink("localhost",12345)</span></li><li><span style="line-height:25.6000003814697px;">tail("/etc/services") |agentSink("localhost",12345)</span></li></ul><p></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:'宋体';">可以让应用程序同已有的</span>Source<span style="font-family:'宋体';">直接打交道，如</span>AvroSource<span style="font-family:'宋体';">，</span>SyslogTcpSource<span style="font-family:'宋体';">。也可以写一个</span>Source<span style="font-family:'宋体';">，以</span>IPC<span style="font-family:'宋体';">或</span>RPC<span style="font-family:'宋体';">的方式接入自己的应用。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
Flume<span style="font-family:'宋体';">自带了直接可用的数据源</span>(source)<span style="font-family:'宋体';">，如：</span></p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>text("filename")</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>tail("filename")</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>fsyslogTcp(5140)</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>console("format")</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>exec</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>execPeriodic</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>execStream</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>irc</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>log4jfile</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>multitail</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>nonlsynth</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>null</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>report</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>rpcSource</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>scribe</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>seqfile</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>syslogTcp</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>syslogTcp1</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>syslogUdp</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>……</p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"></span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:'宋体';color:rgb(68,68,68);">对于直接读取文件</span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Source,</span><span style="font-size:14px;line-height:21px;font-family:'宋体';color:rgb(68,68,68);">有两种方式：</span></span></p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>ExecSource:<span style="font-family:'宋体';">以运行</span>Linux<span style="font-family:'宋体';">命令的方式，持续的输出最新的数据，如</span>tail
 -F <span style="font-family:'宋体';">
文件名指令，在这种方式下，取的文件名必须是指定的。</span> ExecSource<span style="font-family:'宋体';">可以实现对日志的实时收集，但是存在</span>Flume<span style="font-family:'宋体';">不运行或者指令执行出错时，将无法收集到日志数据，无法保证日志数据的完整性。</span></p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>SpoolSource:<span style="font-family:'宋体';">监测配置的目录下新增的文件，并将文件中的数据读取出来。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="line-height:24px;font-family:'宋体';color:#FF0000;">需要注意：</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">拷贝到</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">spool</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">目录下的文件不可以再打开编辑；</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">spool</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">目录下不可包含相应的子目录。</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">SpoolSource</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">虽然无法实现实时的收集数据，但是可以使用以分钟的方式分割文件，趋近于实时。如果应用无法实现以分钟切割日志文件的话，可以两种收集方式结合使用。</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">在实际使用的过程中，可以结合</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">log4j</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">使用，使用</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">log4j</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">的时候，将</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">log4j</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">的文件分割机制设为</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">1</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">分钟一次，将文件拷贝到</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">spool</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">的监控目录。</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">log4j</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">有一个</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">TimeRolling</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">的插件，可以把</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">log4j</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">分割的文件到</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">spool</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">目录。基本实现了实时的监控。</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Flume</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">在传完文件之后，将会修改文件的后缀，变为</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">.COMPLETED</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">（后缀也可以在配置文件中灵活指定）</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"></span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Channel</span></span><span style="font-size:14px;line-height:21px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"><br></span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Channel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">有多种方式：</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">有</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">MemoryChannel,JDBCChannel,MemoryRecoverChannel,FileChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">MemoryChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">可以实现高速的吞吐，但是无法保证数据的完整性。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">MemoryRecoverChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">在官方文档的建议上已经建义使用</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">FileChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">来替换。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">FileChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">保证数据的完整性与一致性。在具体配置不限的</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">FileChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">时，建议</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">FileChannel</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">设置的目录和程序日志文件保存的目录设成不同的磁盘，以便提高效率。</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);"><br><br></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Sink</span></span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Sink</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">在设置存储数据时，可以向文件系统、数据库、</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">hadoop</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">存数据，在日志数据较少时，可以将数据存储在文件系中，并且设定一定的时间间隔保存数据。在日志数据较多时，可以将相应的日志数据存储到</span><span style="line-height:24px;font-family:Tahoma, sans-serif;color:rgb(68,68,68);">Hadoop</span><span style="line-height:24px;font-family:'宋体';color:rgb(68,68,68);">中，便于日后进行相应的数据分析。</span></p>
<p style="clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
Flume<span style="font-family:'宋体';">提供了很多</span>Sink<span style="font-family:'宋体';">，如：</span></p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>console[("format")]</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>text(<span style="font-family:'宋体';">“</span>txtfile<span style="font-family:'宋体';">”</span>)</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>dfs(<span style="font-family:'宋体';">“</span>dfsfile<span style="font-family:'宋体';">”</span>)</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>syslogTcp(<span style="font-family:'宋体';">“</span>host<span style="font-family:'宋体';">”</span>,port)</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>agentSink[("machine"[,port])]</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>agentDFOSink[("machine"[,port])]</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>agentBESink[("machine"[,port])]</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>attr2hbase</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>avroSink</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>collectorSink</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>counter</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>formatDfs</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>hbase</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>irc</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>logicalSink</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>multigrep</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>regexhisto</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>regexhistospec</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>rpcSink</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>seqfile</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>thriftSink</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<span style="font-family:Wingdings;">l<span style="font-size:9px;"></span></span>……</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<br></p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
扫描下面的二维码可以关注作者的微信公众号。</p>
<p style="margin-left:56px;clear:both;min-height:1em;color:rgb(62,62,62);font-family:'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;font-size:16px;line-height:25.6000003814697px;">
<img src="https://img-blog.csdn.net/20150716100816853?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQv/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></p>
            </div>
                </div>