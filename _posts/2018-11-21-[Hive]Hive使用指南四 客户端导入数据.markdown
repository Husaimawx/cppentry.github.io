---
layout:     post
title:      [Hive]Hive使用指南四 客户端导入数据
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/SunnyYoona/article/details/52935649				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p style="font-family:Arial;font-size:15px;line-height:24px;"></p><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">根据导入的地方不一样，主要介绍下面几种方式:</p><ul style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><li style="line-height:1.5;">从本地文件系统中导入数据到Hive表</li><li style="line-height:1.5;">从HDFS上导入数据到Hive表</li><li style="line-height:1.5;">从别的表中查询出相应的数据并导入到Hive表中</li></ul><h3 id="1-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.5em;">1. 本地文件系统导入Hive表中<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h3><h4 id="1-1-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.2em;">1.1 导入普通Hive表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-1-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h4><h5 id="1-1-1-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:13px;">1.1.1 创建Hive普通表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-1-1-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h5><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" id="LC1" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">CREATE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TABLE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">IF</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">NOT</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">EXISTS</span> order_uid_total(</span><span class="hljs-operator">
</span><span class="line" id="LC2" style="display:inline;">  uid <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>,</span><span class="hljs-operator">
</span><span class="line" id="LC3" style="display:inline;">  bucket_type <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>,</span><span class="hljs-operator">
</span><span class="line" id="LC4" style="display:inline;"><span class="hljs-operator">  file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span></span></span><span class="hljs-operator">
</span><span class="line" id="LC5" style="display:inline;">)</span><span class="hljs-operator">
</span><span class="line" id="LC6" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">ROW</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FORMAT</span> DELIMITED</span><span class="hljs-operator">
</span><span class="line" id="LC7" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FIELDS</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\t'</span></span></span><span class="hljs-operator">
</span><span class="line" id="LC8" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">LINES</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\n'</span></span></span><span class="hljs-operator">
</span><span class="line" id="LC9" style="display:inline;">STORED <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">AS</span> TEXTFILE;</span>
<span class="line" id="LC10" style="display:inline;"></span></code></pre></div></div><h5 id="1-1-2" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:13px;">1.1.2 导入数据<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-1-2" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h5><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">load</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">data</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">local</span> inpath <span class="hljs-string" style="color:rgb(196,26,22);">'/home/xiaosi/adv/order_uid_total.txt'</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">into</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">table</span> order_uid_total;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><h5 id="1-1-3" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:13px;">1.1.3 查看数据<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-1-3" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h5><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs applescript" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;">hive (test)&gt; select * <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">from</span> order_uid_total <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">where</span> bucket_type = '<span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span>' limit <span class="hljs-number" style="color:rgb(28,0,207);">10</span>;</span>
<span class="line" style="display:inline;">OK</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">868</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">865</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;">DC8 <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">861</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">867</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">861</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">868</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">867</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" id="LC11" style="display:inline;"><span class="hljs-number" style="color:rgb(28,0,207);">867</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" id="LC12" style="display:inline;">A00 <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">put</span> uids<span class="hljs-number" style="color:rgb(28,0,207);">.3</span>_1</span>
<span class="line" id="LC13" style="display:inline;"></span></code></pre></div></div><h4 id="1-2-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.2em;">1.2 导入Hive分区表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-2-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h4><h5 id="1-2-1" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:13px;">1.2.1 创建分区表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-2-1" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h5><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">CREATE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TABLE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">IF</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">NOT</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">EXISTS</span> order_uid_total_partition(</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator">  uid <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;">)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;">PARTITIONED <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span>(bucket_type <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>, file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">ROW</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FORMAT</span> DELIMITED</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FIELDS</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\t'</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">LINES</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\n'</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;">STORED <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">AS</span> TEXTFILE;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><h5 id="1-2-2" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:13px;">1.2.2 静态导入数据<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-2-2" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h5><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">load</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">data</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">local</span> inpath <span class="hljs-string" style="color:rgb(196,26,22);">'/home/xiaosi/adv/order_uid_total_partition.txt'</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">into</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">table</span> order_uid_total_partition <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">partition</span>(bucket_type=<span class="hljs-string" style="color:rgb(196,26,22);">'put'</span>,file_name=<span class="hljs-string" style="color:rgb(196,26,22);">'uids_3_1'</span>);</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><h5 id="1-2-3" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:13px;">1.2.3 动态导入数据<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#1-2-3" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h5><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">如果表中有多个分区，按上面插入语句会要写很多的SQL，而且查询语句要对应上不同的分区，这样就插入语句用起来就会很繁琐。为了解决这个问题，Hive中提供了动态分区插入的功能，它能跟分区字段的内容自动创建分区，并在每个分区插入相应的内容:</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">insert</span> overwrite <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">table</span> order_uid_total_partition</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">partition</span> (bucket_type, file_name)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">select</span> uid, bucket_type, file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">from</span> order_uid_total;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">如果直接运行上面代码，会报如下错误：</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs vbnet" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;">FAILED: SemanticException [<span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">Error</span> <span class="hljs-number" style="color:rgb(28,0,207);">10096</span>]: Dynamic partition <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">strict</span> mode requires at least one <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">static</span> partition column. <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">To</span> turn this <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">off</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">set</span> hive.exec.dynamic.partition.mode=nonstrict</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">从上面错误提示中，我们知道我们需要设置分区动态导入模式：</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">set</span> hive.<span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">exec</span>.dynamic.<span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">partition</span>.<span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">mode</span>=nonstrict;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">默认值为<code style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:rgb(85,85,85);background-color:rgb(249,242,244);font-weight:inherit;">strict</code>，设置完毕之后，再次导入数据即可。</p><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><span>备注</span></p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs ruleslanguage" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">SELECT</span>语句中要包含分区字段</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><h3 id="2-hdfs-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.5em;">2. HDFS上导入数据到Hive表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#2-hdfs-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h3><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">从本地文件系统中将数据导入到Hive表的过程中，其实是先将数据临时复制到HDFS的一个目录下，然后再将数据从那个临时目录下移动到对应的Hive表的数据目录里面。因此，我们可以直接从HDFS上的一个目录移动到相应Hive表的数据目录下，假设HDFS上有下面这个文件<code style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:rgb(85,85,85);background-color:rgb(249,242,244);font-weight:inherit;">data/order_uid_total.txt</code>，具体的操作如下:</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">load</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">data</span> inpath <span class="hljs-string" style="color:rgb(196,26,22);">'data/order_uid_total.txt'</span> overwrite <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">into</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">table</span> order_uid_total;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">相对比于从本地文件导入Hive表中，唯一的区别就是少了一个local关键词。local表示文件位于本地文件系统上，如果没有local关键词，表示文件位于HDFS上。</p><h3 id="3-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.5em;">3. 从别的表中查询出相应的数据导入到Hive表中<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#3-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h3><h4 id="3-1-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.2em;">3.1 普通Hive表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#3-1-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h4><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">创建普通Hive表</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">CREATE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TABLE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">IF</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">NOT</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">EXISTS</span> order_uid_total(</span><span class="hljs-operator">
</span><span class="line" style="display:inline;">  uid <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>,</span><span class="hljs-operator">
</span><span class="line" style="display:inline;">  bucket_type <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>,</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator">  file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;">)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">ROW</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FORMAT</span> DELIMITED</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FIELDS</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\t'</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">LINES</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\n'</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;">STORED <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">AS</span> TEXTFILE;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">查询数据导入Hive表中</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">insert</span> overwrite <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">table</span> order_uid_total</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">select</span> uid, bucket_type, file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">from</span> order_uid_total_partition;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><h4 id="3-2-hive" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-weight:500;line-height:1.1;color:rgb(51,51,51);font-size:1.2em;">3.2 分区Hive表<a href="http://gitlab.corp.qunar.com/jifeng.si/learningnotes/blob/master/IT/%E5%A4%A7%E6%95%B0%E6%8D%AE/Hive/%5BHive%5DHive%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97%E5%9B%9B%20%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.md#3-2-hive" rel="nofollow" style="background:transparent;color:rgb(68,110,155);"></a></h4><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">创建分区Hive表</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">CREATE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TABLE</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">IF</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">NOT</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">EXISTS</span> order_uid_total_partition(</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator">  uid <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;">)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;">PARTITIONED <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span>(bucket_type <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>, file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">string</span>)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">ROW</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FORMAT</span> DELIMITED</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">FIELDS</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\t'</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-operator"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">LINES</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">TERMINATED</span> <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">BY</span> <span class="hljs-string" style="color:rgb(196,26,22);">'\n'</span></span></span><span class="hljs-operator">
</span><span class="line" style="display:inline;">STORED <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">AS</span> TEXTFILE;</span>
<span class="line" style="display:inline;"></span></code></pre></div></div><p style="color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;">查询数据导入Hive表中</p><div class="highlighted-data white" style="border:none;table-layout:fixed;color:rgb(51,51,51);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:14px;"><div class="highlight" style="border:1px solid rgb(221,221,221);"><pre style="font-family:Menlo, 'Liberation Mono', Consolas, 'Courier New', 'andale mono', 'lucida console', monospace;background-color:rgb(255,255,255);border:none;font-size:12px !important;line-height:16px !important;"><code class="hljs sql" style="font-family:Menlo, Monaco, Consolas, 'Courier New', monospace;color:#000000;display:block;"><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">insert</span> overwrite <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">table</span> order_uid_total_partition</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">partition</span> (bucket_type, file_name)</span><span class="hljs-operator">
</span><span class="line" style="display:inline;"><span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">select</span> uid, bucket_type, file_name <span class="hljs-keyword" style="font-weight:bold;color:rgb(170,13,145);">from</span> order_uid_total;</span></code></pre></div></div><p style="font-family:Arial;font-size:15px;line-height:24px;"><span style="font-family:Helvetica, 'Hiragino Sans GB', 'Microsoft Yahei', SimSun, SimHei, arial, sans-serif;"><br></span></p>            </div>
                </div>