---
layout:     post
title:      Spark学习2  【翻译】快速入门
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
本教程提供一个使用Spark的快速介绍。 首先，我们通过Spark交互shell（Python或Scala）介绍其API，然后演示如何使用Java、Scala和Python实现Spark应用。</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
跟随该指南，首先从Spark网站下载一个Spark发行包。因为我们不使用HDFS，所以你可以下载任何版本的Hadoop版本的包。</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
注意，在Spark2.0之前，Spark的主要编程接口是弹性分布式数据集（RDD）。在Spark2.0之后，RDDs会被Dataset替代。Dataset是类似RDD的强类型，但是底层做了很多优化。RDD接口仍然会被支持，你可以通过<a href="http://spark.apache.org/docs/latest/rdd-programming-guide.html" rel="nofollow">RDD 编程指南</a>获取到到完整的接口文档。然而，我们强烈建议你使用比RDD性能更好的Dataset。查看<a href="http://spark.apache.org/docs/latest/sql-programming-guide.html" rel="nofollow">SQL编程指南</a>获取更多关于Dataset的信息。</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<span><strong>使用Spark Shell进行交互分析</strong></span></div>
<hr style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<span><strong><br></strong></span></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<strong><span>基础</span></strong></div>
<hr style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
Spark Shell作为一个强大的交互式数据分析工具，提供了一种简单的方式来学习它的API。Spark Shell可以使用Scala（运行在Java VM上，适合运行已有的Java库）或Python来运行。在Spark目录中运行如下命令：</div>
<div class="wiz-code-container" id="wiz_cm_1504060948983_2235" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);">
<div style="overflow:hidden;width:3px;">
<textarea cols="22" rows="3"></textarea></div><div class="CodeMirror-scroll" style="overflow:hidden !important;"><div class="CodeMirror-sizer" style="border-right-width:30px;min-height:31px;"><div><div class="CodeMirror-lines" style="min-height:1px;"><div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"><pre style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;"><div></div></div></div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"></div><div style="z-index:1;"></div><div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;"><div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;"></div></div><div class="CodeMirror-code"><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">1</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span>.<span class="cm-operator">/</span><span class="cm-builtin" style="color:rgb(222,203,107);">bin</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">pyspark</span></span></pre></div></div></div></div></div></div><div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;"></div><div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;"></div></div></div></div></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">Spark中最主要的抽象是弹性分部署集合Dataset。Dataset可以从Hadoop InputFormats创建，也可有由其它Dataset转换而来。由于Python的动态特性，在Python中Dataset不必是强类型的。因此，在Python中所有Dataset都是Dataset[Row]，我们称之为DataFrame，它与Pandas和R语言中的数据框架概念是一致的。 让我们从Spark源目录中的README文件创建一个新的DataFrame。</div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div class="wiz-code-container" id="wiz_cm_1504061482852_4966"><div class="CodeMirror CodeMirror-wrap cm-s-material CodeMirror-blur" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);"><div style="overflow:hidden;width:3px;"><textarea cols="22" rows="3"></textarea></div>
<div class="CodeMirror-scroll" style="overflow:hidden !important;">
<div class="CodeMirror-sizer" style="border-right-width:30px;min-height:31px;">
<div>
<div class="CodeMirror-lines" style="min-height:1px;">
<div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
<pre></pre>
</div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
</div>
<div style="z-index:1;">
<div class="CodeMirror-selected" style="visibility:hidden;width:354.535px;">
</div>
</div>
<div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;">
</div>
<div class="CodeMirror-code">
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
1</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span> = <span class="cm-variable" style="color:rgb(130,177,255);">spark</span>.<span class="cm-property" style="color:rgb(128,203,174);">read</span>.<span class="cm-property" style="color:rgb(128,203,174);">text</span>(<span class="cm-string" style="color:rgb(195,232,141);">"README.md"</span>)</span></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;">
</div>
<div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);">
<div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;">
</div>
</div>
</div>
</div>
</div>
<div>你可以通过调用接口直接获取DataFrame中的数据，或者转换DataFrame成一个新的DataFrame。详细信息请此查看<a href="http://spark.apache.org/docs/latest/api/python/index.html#pyspark.sql.DataFrame" rel="nofollow">API文档</a>。</div>
<div></div>
<div class="wiz-code-container" id="wiz_cm_1504062509651_693" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);">
<div style="overflow:hidden;width:3px;">
<textarea cols="22" rows="3"></textarea></div><div class="CodeMirror-scroll" style="overflow:hidden !important;"><div class="CodeMirror-sizer" style="border-right-width:30px;min-height:126px;"><div><div class="CodeMirror-lines" style="min-height:1px;"><div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"><pre style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;"><div></div></div></div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"></div><div style="z-index:1;"></div><div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;"><div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;"></div></div><div class="CodeMirror-code"><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">1</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">count</span>()  <span class="cm-comment" style="color:rgb(84,110,122);"># 该DataFrame的行数</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">2</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-number" style="color:rgb(247,118,105);">126</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">3</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span></span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">4</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">first</span>()  <span class="cm-comment" style="color:rgb(84,110,122);"># 该DataFrame的第一行</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">5</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-variable" style="color:rgb(130,177,255);">Row</span>(<span class="cm-variable" style="color:rgb(130,177,255);">value</span>=<span class="cm-string" style="color:rgb(195,232,141);">u'# Apache Spark'</span>)</span></pre></div></div></div></div></div></div><div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;"></div><div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;"></div></div></div></div></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">让我们将该DataFame转换为一个新的DataFrame。我们调用filter来过滤该文件中的部分行并转为一个新的DataFrame。</div><div class="wiz-code-container" id="wiz_cm_1504062703872_2053" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);"><div style="overflow:hidden;width:3px;"><textarea cols="22" rows="3"></textarea></div>
<div class="CodeMirror-scroll" style="overflow:hidden !important;">
<div class="CodeMirror-sizer" style="border-right-width:30px;min-height:31px;">
<div>
<div class="CodeMirror-lines" style="min-height:1px;">
<div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
<pre></pre>
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;">
<div></div>
</div>
</div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
</div>
<div style="z-index:1;"></div>
<div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;">
<div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;">
</div>
</div>
<div class="CodeMirror-code">
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
1</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">linesWithSpark</span> = <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">filter</span>(<span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">value</span>.<span class="cm-property" style="color:rgb(128,203,174);">contains</span>(<span class="cm-string" style="color:rgb(195,232,141);">"Spark"</span>))</span></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;">
</div>
<div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);">
<div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;">
</div>
</div>
</div>
</div>
</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
我们可以将所有的转换和动作串联在一起：</div>
<div class="wiz-code-container" id="wiz_cm_1504092014697_9171" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);">
<div style="overflow:hidden;width:3px;">
<textarea cols="22" rows="3"></textarea></div><div class="CodeMirror-scroll" style="overflow:hidden !important;"><div class="CodeMirror-sizer" style="border-right-width:30px;min-height:55px;"><div><div class="CodeMirror-lines" style="min-height:1px;"><div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"><pre style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;"><div></div></div></div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"></div><div style="z-index:1;"></div><div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;"><div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;"></div></div><div class="CodeMirror-code"><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">1</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">filter</span>(<span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">value</span>.<span class="cm-property" style="color:rgb(128,203,174);">contains</span>(<span class="cm-string" style="color:rgb(195,232,141);">"Spark"</span>)).<span class="cm-property" style="color:rgb(128,203,174);">count</span>()  <span class="cm-comment" style="color:rgb(84,110,122);"># 多少行包含"Spark"</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">2</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-number" style="color:rgb(247,118,105);">15</span></span></pre></div></div></div></div></div></div><div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;"></div><div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;"></div></div></div></div></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><br></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><span><strong>更多数<span style="font-weight:normal;">Dataset</span>操作</strong></span></div><hr style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">Dataset actions和transformations可用于更复杂的计算。假设我们想找到单词数量最多的行：</div><div class="wiz-code-container" id="wiz_cm_1504092362004_1825" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);"><div style="overflow:hidden;width:3px;"><textarea cols="22" rows="3"></textarea></div>
<div class="CodeMirror-scroll" style="overflow:hidden !important;">
<div class="CodeMirror-sizer" style="border-right-width:30px;min-height:79px;">
<div>
<div class="CodeMirror-lines" style="min-height:1px;">
<div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
<pre></pre>
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;">
<div></div>
</div>
</div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
</div>
<div style="z-index:1;"></div>
<div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;">
<div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;">
</div>
</div>
<div class="CodeMirror-code">
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
1</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-keyword" style="color:rgb(199,146,234);">from</span> <span class="cm-variable" style="color:rgb(130,177,255);">pyspark</span>.<span class="cm-property" style="color:rgb(128,203,174);">sql</span>.<span class="cm-property" style="color:rgb(128,203,174);">functions</span> <span class="cm-keyword" style="color:rgb(199,146,234);">import</span> <span class="cm-operator">*</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
2</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">select</span>(<span class="cm-variable" style="color:rgb(130,177,255);">size</span>(<span class="cm-variable" style="color:rgb(130,177,255);">split</span>(<span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">value</span>, <span class="cm-string" style="color:rgb(195,232,141);">"\s+"</span>)).<span class="cm-property" style="color:rgb(128,203,174);">name</span>(<span class="cm-string" style="color:rgb(195,232,141);">"numWords"</span>)).<span class="cm-property" style="color:rgb(128,203,174);">agg</span>(<span class="cm-builtin" style="color:rgb(222,203,107);">max</span>(<span class="cm-variable" style="color:rgb(130,177,255);">col</span>(<span class="cm-string" style="color:rgb(195,232,141);">"numWords"</span>))).<span class="cm-property" style="color:rgb(128,203,174);">collect</span>()</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
3</div>
</div>
<pre class="CodeMirror-line"><span>[<span class="cm-variable" style="color:rgb(130,177,255);">Row</span>(<span class="cm-builtin" style="color:rgb(222,203,107);">max</span>(<span class="cm-variable" style="color:rgb(130,177,255);">numWords</span>)=<span class="cm-number" style="color:rgb(247,118,105);">15</span>)]</span></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;">
</div>
<div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);">
<div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;">
</div>
</div>
</div>
</div>
</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
首先将行映射为一个整数值，创建一个别名为numWords的<span>新的DataFrame。</span> 在该<span>DataFrame</span>上调用agg来找到单词的最大个数。select和agg的参数都是Column，我们可以使用df.colName来从一个DataFrame获取列。我们也可以导入pyspark.sql.functions，其提供了一系列简便的函数来实现一个旧的列创建一个新的列。</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
MapReduce是Hadoop中常用的数据流模式。Spark可也可以轻松实现：</div>
<div class="wiz-code-container" id="wiz_cm_1504093226101_9145" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);">
<div style="overflow:hidden;width:3px;">
<textarea cols="22" rows="3"></textarea></div><div class="CodeMirror-scroll" style="overflow:hidden !important;"><div class="CodeMirror-sizer" style="border-right-width:30px;min-height:31px;"><div><div class="CodeMirror-lines" style="min-height:1px;"><div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"><pre style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;"><div></div></div></div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"></div><div style="z-index:1;"></div><div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;"><div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;"></div></div><div class="CodeMirror-code"><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">1</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">wordCounts</span> = <span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">select</span>(<span class="cm-variable" style="color:rgb(130,177,255);">explode</span>(<span class="cm-variable" style="color:rgb(130,177,255);">split</span>(<span class="cm-variable" style="color:rgb(130,177,255);">textFile</span>.<span class="cm-property" style="color:rgb(128,203,174);">value</span>, <span class="cm-string" style="color:rgb(195,232,141);">"\s+"</span>)).<span class="cm-property" style="color:rgb(128,203,174);">as</span>(<span class="cm-string" style="color:rgb(195,232,141);">"word"</span>)).<span class="cm-property" style="color:rgb(128,203,174);">groupBy</span>(<span class="cm-string" style="color:rgb(195,232,141);">"word"</span>).<span class="cm-property" style="color:rgb(128,203,174);">count</span>()</span></pre></div></div></div></div></div></div><div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;"></div><div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;"></div></div></div></div></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">在这里，我们使用select中的explode函数来将行数据集转换为单词数据集， 然后结合使用groupBy和count来计算包含两列"word"和“count”的文件DataFrame中的每个单词的数目。我们可以使用collect来获取我们的shell中的单词数统计：</div><div class="wiz-code-container" id="wiz_cm_1504093541581_2711" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);"><div style="overflow:hidden;width:3px;"><textarea cols="22" rows="3"></textarea></div>
<div class="CodeMirror-scroll" style="overflow:hidden !important;">
<div class="CodeMirror-sizer" style="border-right-width:30px;min-height:55px;">
<div>
<div class="CodeMirror-lines" style="min-height:1px;">
<div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
<pre></pre>
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;">
<div></div>
</div>
</div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
</div>
<div style="z-index:1;"></div>
<div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;">
<div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;">
</div>
</div>
<div class="CodeMirror-code">
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
1</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">wordCounts</span>.<span class="cm-property" style="color:rgb(128,203,174);">collect</span>()</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
2</div>
</div>
<pre class="CodeMirror-line"><span>[<span class="cm-variable" style="color:rgb(130,177,255);">Row</span>(<span class="cm-variable" style="color:rgb(130,177,255);">word</span>=<span class="cm-string" style="color:rgb(195,232,141);">u'online'</span>, <span class="cm-variable" style="color:rgb(130,177,255);">count</span>=<span class="cm-number" style="color:rgb(247,118,105);">1</span>), <span class="cm-variable" style="color:rgb(130,177,255);">Row</span>(<span class="cm-variable" style="color:rgb(130,177,255);">word</span>=<span class="cm-string" style="color:rgb(195,232,141);">u'graphs'</span>, <span class="cm-variable" style="color:rgb(130,177,255);">count</span>=<span class="cm-number" style="color:rgb(247,118,105);">1</span>), ...]</span></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;">
</div>
<div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);">
<div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;">
</div>
</div>
</div>
</div>
</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<span><strong>缓存</strong></span></div>
<hr style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
Spark支持把数据集拉到集群的内存缓存中。当数据被重复访问时，这很有用。例如，当查询一个小的热点数据集或者当运行一个类似PageRank的交互式算法。作为一个简单的例子，我们把linesWithSpark数据集标记在缓存中：</div>
<div class="wiz-code-container" id="wiz_cm_1504093752743_9583" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);">
<div style="overflow:hidden;width:3px;">
<textarea cols="22" rows="3"></textarea></div><div class="CodeMirror-scroll" style="overflow:hidden !important;"><div class="CodeMirror-sizer" style="border-right-width:30px;min-height:174px;"><div><div class="CodeMirror-lines" style="min-height:1px;"><div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"><pre style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;"><div></div></div></div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"></div><div style="z-index:1;"></div><div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;"><div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;"></div></div><div class="CodeMirror-code"><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">1</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">linesWithSpark</span>.<span class="cm-property" style="color:rgb(128,203,174);">cache</span>()</span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">2</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span></span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">3</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">linesWithSpark</span>.<span class="cm-property" style="color:rgb(128,203,174);">count</span>()</span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">4</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-number" style="color:rgb(247,118,105);">15</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">5</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span></span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">6</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-operator">&gt;&gt;&gt;</span> <span class="cm-variable" style="color:rgb(130,177,255);">linesWithSpark</span>.<span class="cm-property" style="color:rgb(128,203,174);">count</span>()</span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">7</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-number" style="color:rgb(247,118,105);">15</span></span></pre></div></div></div></div></div></div><div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;"></div><div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;"></div></div></div></div></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">使用Spark来探索和缓存100行的文本数据，这看起来很傻。但是真正让人感兴趣的部分是，我们可以在非常大的数据集中使用同样的函数，甚至超过成百上千个节点。你同样可以使用bin/pyspark交互式连接到一个集群，具体详情查看<a href="http://spark.apache.org/docs/latest/rdd-programming-guide.html#using-the-shell" rel="nofollow">RDD programming guide</a>。</div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><br></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><span><strong>独立的应用程序</strong></span></div><hr style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">假设我们系统使用Spark API写一个独立的应用程序。我们 通过使用Scala（用sbt）、Java（用Maven）和Python来写一个简单的应用程序来学习下。</div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">现在我们将介绍如何使用Python API(PySpark)写一个应用程序。</div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">示例，我们将创建一个简单的Spark应用, SimpleApp.py。</div><div class="wiz-code-container" id="wiz_cm_1504094226907_9422" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);"><div style="overflow:hidden;width:3px;"><textarea cols="22" rows="3"></textarea></div>
<div class="CodeMirror-scroll" style="overflow:hidden !important;">
<div class="CodeMirror-sizer" style="border-right-width:30px;min-height:316px;">
<div>
<div class="CodeMirror-lines" style="min-height:1px;">
<div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
<pre></pre>
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;">
<div></div>
</div>
</div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
</div>
<div style="z-index:1;"></div>
<div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;">
<div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;">
</div>
</div>
<div class="CodeMirror-code">
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
1</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-string" style="color:rgb(195,232,141);">"""SimpleApp.py"""</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
2</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-keyword" style="color:rgb(199,146,234);">from</span> <span class="cm-variable" style="color:rgb(130,177,255);">pyspark</span>.<span class="cm-property" style="color:rgb(128,203,174);">sql</span> <span class="cm-keyword" style="color:rgb(199,146,234);">import</span> <span class="cm-variable" style="color:rgb(130,177,255);">SparkSession</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
3</div>
</div>
<pre class="CodeMirror-line"><span><span></span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
4</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">logFile</span> = <span class="cm-string" style="color:rgb(195,232,141);">"YOUR_SPARK_HOME/README.md"</span>  <span class="cm-comment" style="color:rgb(84,110,122);"># Should be some file on your system</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
5</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">spark</span> = <span class="cm-variable" style="color:rgb(130,177,255);">SparkSession</span>.<span class="cm-property" style="color:rgb(128,203,174);">builder</span>().<span class="cm-property" style="color:rgb(128,203,174);">appName</span>(<span class="cm-variable" style="color:rgb(130,177,255);">appName</span>).<span class="cm-property" style="color:rgb(128,203,174);">master</span>(<span class="cm-variable" style="color:rgb(130,177,255);">master</span>).<span class="cm-property" style="color:rgb(128,203,174);">getOrCreate</span>()</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
6</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">logData</span> = <span class="cm-variable" style="color:rgb(130,177,255);">spark</span>.<span class="cm-property" style="color:rgb(128,203,174);">read</span>.<span class="cm-property" style="color:rgb(128,203,174);">text</span>(<span class="cm-variable" style="color:rgb(130,177,255);">logFile</span>).<span class="cm-property" style="color:rgb(128,203,174);">cache</span>()</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
7</div>
</div>
<pre class="CodeMirror-line"><span><span></span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
8</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">numAs</span> = <span class="cm-variable" style="color:rgb(130,177,255);">logData</span>.<span class="cm-property" style="color:rgb(128,203,174);">filter</span>(<span class="cm-variable" style="color:rgb(130,177,255);">logData</span>.<span class="cm-property" style="color:rgb(128,203,174);">value</span>.<span class="cm-property" style="color:rgb(128,203,174);">contains</span>(<span class="cm-string" style="color:rgb(195,232,141);">'a'</span>)).<span class="cm-property" style="color:rgb(128,203,174);">count</span>()</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
9</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">numBs</span> = <span class="cm-variable" style="color:rgb(130,177,255);">logData</span>.<span class="cm-property" style="color:rgb(128,203,174);">filter</span>(<span class="cm-variable" style="color:rgb(130,177,255);">logData</span>.<span class="cm-property" style="color:rgb(128,203,174);">value</span>.<span class="cm-property" style="color:rgb(128,203,174);">contains</span>(<span class="cm-string" style="color:rgb(195,232,141);">'b'</span>)).<span class="cm-property" style="color:rgb(128,203,174);">count</span>()</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
10</div>
</div>
<pre class="CodeMirror-line"><span><span></span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
11</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-builtin" style="color:rgb(222,203,107);">print</span>(<span class="cm-string" style="color:rgb(195,232,141);">"Lines with a: %i, lines with b: %i"</span> <span class="cm-operator">%</span> (<span class="cm-variable" style="color:rgb(130,177,255);">numAs</span>, <span class="cm-variable" style="color:rgb(130,177,255);">numBs</span>))</span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
12</div>
</div>
<pre class="CodeMirror-line"><span><span></span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
13</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-variable" style="color:rgb(130,177,255);">spark</span>.<span class="cm-property" style="color:rgb(128,203,174);">stop</span>()</span></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;">
</div>
<div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);">
<div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;">
</div>
</div>
</div>
</div>
</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
这个程序仅仅统计文本文件中包含'a'和'b'的行的数目。注意，你需要将YOUR_SPARK_HOME替换为Spark的安装路径。Scala和Java例子中，我们使用SparkSession创建数据集。如果应用依赖自定义或第三方库的引用，我们可以将代码依赖打包为一个.zip文件，通过--py-files参数添加到spark-submit中(具体查看spark-submit --help)。 SimpleApp足够简单，我们不需要指定任何的代码依赖。</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<strong>译者注</strong>： </div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
    SimpleApp.py第5行中的SparkSession.builder()调用会失败，实际应该是SparkSession.builder.appName(appName).master(master).getOrCreate()。 builder不是<span>SparkSession的</span>一个方法，而是一个属性</div>
</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
我们可以使用bin/spark-submit脚本运行该程序：</div>
<div class="wiz-code-container" id="wiz_cm_1504094602277_1903" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<div class="CodeMirror CodeMirror-wrap cm-s-material" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);">
<div style="overflow:hidden;width:3px;">
<textarea cols="22" rows="3"></textarea></div><div class="CodeMirror-scroll" style="overflow:hidden !important;"><div class="CodeMirror-sizer" style="border-right-width:30px;min-height:150px;"><div><div class="CodeMirror-lines" style="min-height:1px;"><div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"><pre style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;"><div></div></div></div><div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;"></div><div style="z-index:1;"></div><div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;"><div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;"></div></div><div class="CodeMirror-code"><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">1</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-comment" style="color:rgb(84,110,122);"># Use spark-submit to run your application</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">2</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-error" style="color:rgb(255,255,255);background-color:rgb(236,95,103);">$</span> <span class="cm-variable" style="color:rgb(130,177,255);">YOUR_SPARK_HOME</span><span class="cm-operator">/</span><span class="cm-builtin" style="color:rgb(222,203,107);">bin</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">spark</span><span class="cm-operator">-</span><span class="cm-variable" style="color:rgb(130,177,255);">submit</span> <span class="cm-error" style="color:rgb(255,255,255);background-color:rgb(236,95,103);">\</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">3</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span>  <span class="cm-operator">--</span><span class="cm-variable" style="color:rgb(130,177,255);">master</span> <span class="cm-variable" style="color:rgb(130,177,255);">local</span>[<span class="cm-number" style="color:rgb(247,118,105);">4</span>] <span class="cm-error" style="color:rgb(255,255,255);background-color:rgb(236,95,103);">\</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">4</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span>  <span class="cm-variable cm-error" style="color:rgb(255,255,255);background-color:rgb(236,95,103);">SimpleApp</span>.<span class="cm-property" style="color:rgb(128,203,174);">py</span></span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">5</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span>...</span></pre></div><div><div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">6</div></div><pre class="CodeMirror-line" style="border-width:0px;font-family:inherit;line-height:inherit;color:inherit;z-index:2;overflow:visible;background:transparent;"><span><span class="cm-property" style="color:rgb(128,203,174);">Lines</span> <span class="cm-keyword" style="color:rgb(199,146,234);">with</span> <span class="cm-variable" style="color:rgb(130,177,255);">a</span>: <span class="cm-number" style="color:rgb(247,118,105);">46</span>, <span class="cm-variable" style="color:rgb(130,177,255);">Lines</span> <span class="cm-keyword" style="color:rgb(199,146,234);">with</span> <span class="cm-variable" style="color:rgb(130,177,255);">b</span>: <span class="cm-number" style="color:rgb(247,118,105);">23</span></span></pre></div></div></div></div></div></div><div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;"></div><div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;"></div></div></div></div></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><strong><br></strong></div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><strong><span>下一步</span></strong></div><hr style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">恭喜你成功运行你的第一个Spark应用程序！</div><div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><ul><li>要深度了解API， 可以查看 <span style="color:rgb(29,31,34);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;"><span> </span></span><a href="http://spark.apache.org/docs/latest/rdd-programming-guide.html" rel="nofollow" style="color:rgb(0,85,128);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;">RDD programming guide</a>和<span style="color:rgb(29,31,34);font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;"><span> </span></span><a href="http://spark.apache.org/docs/latest/sql-programming-guide.html" rel="nofollow" style="color:rgb(0,136,204);text-decoration:none;font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;">SQL programming guide</a>。</li><li>要在集群中运行应用程序，可以查看<a href="http://spark.apache.org/docs/latest/cluster-overview.html" rel="nofollow">部署概要</a></li><li>最后，Spark在examples文件夹(Scala，Java, Python, R)中包含了一些示例。.你可以像下面这样运行：</li></ul></div><div class="wiz-code-container" id="wiz_cm_1504094841213_2327" style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;"><div class="CodeMirror CodeMirror-wrap cm-s-material CodeMirror-blur" style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;color:rgb(233,237,237);background:rgb(38,50,56);"><div style="overflow:hidden;width:3px;"><textarea cols="22" rows="3"></textarea></div>
<div class="CodeMirror-scroll" style="overflow:hidden !important;">
<div class="CodeMirror-sizer" style="border-right-width:30px;min-height:198px;">
<div>
<div class="CodeMirror-lines" style="min-height:1px;">
<div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
<pre></pre>
</div>
<div class="CodeMirror-measure" style="overflow:hidden;visibility:hidden;">
</div>
<div style="z-index:1;"></div>
<div class="CodeMirror-cursors" style="visibility:hidden;z-index:3;">
<div class="CodeMirror-cursor" style="border-left-width:1px;border-left-style:solid;border-left-color:rgb(248,248,240);border-right-style:none;width:0px;">
</div>
</div>
<div class="CodeMirror-code">
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
1</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-comment" style="color:rgb(84,110,122);"># For Scala and Java, use run-example:</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
2</div>
</div>
<pre class="CodeMirror-line"><span>.<span class="cm-operator">/</span><span class="cm-builtin" style="color:rgb(222,203,107);">bin</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">run</span><span class="cm-operator">-</span><span class="cm-variable" style="color:rgb(130,177,255);">example</span> <span class="cm-variable" style="color:rgb(130,177,255);">SparkPi</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
3</div>
</div>
<pre class="CodeMirror-line"><span><span></span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
4</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-comment" style="color:rgb(84,110,122);"># For Python examples, use spark-submit directly:</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
5</div>
</div>
<pre class="CodeMirror-line"><span>.<span class="cm-operator">/</span><span class="cm-builtin" style="color:rgb(222,203,107);">bin</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">spark</span><span class="cm-operator">-</span><span class="cm-variable" style="color:rgb(130,177,255);">submit</span> <span class="cm-variable" style="color:rgb(130,177,255);">examples</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">src</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">main</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">python</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">pi</span>.<span class="cm-property" style="color:rgb(128,203,174);">py</span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
6</div>
</div>
<pre class="CodeMirror-line"><span><span></span></span></pre>
</div>
<div>
<div class="CodeMirror-gutter-wrapper" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
7</div>
</div>
<pre class="CodeMirror-line"><span><span class="cm-comment" style="color:rgb(84,110,122);"># For R examples, use spark-submit directly:</span></span></pre>
</div>
<div class="CodeMirror-activeline">
<div class="CodeMirror-activeline-background CodeMirror-linebackground" style="z-index:0;visibility:hidden;">
</div>
<div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="z-index:4;width:29px;">
</div>
<div class="CodeMirror-gutter-wrapper CodeMirror-activeline-gutter" style="z-index:4;border:none !important;background:none !important;">
<div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="min-width:20px;text-align:center;color:rgb(83,127,126);z-index:4;width:21px;">
8</div>
</div>
<pre class="CodeMirror-line"><span>.<span class="cm-operator">/</span><span class="cm-builtin" style="color:rgb(222,203,107);">bin</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">spark</span><span class="cm-operator">-</span><span class="cm-variable" style="color:rgb(130,177,255);">submit</span> <span class="cm-variable" style="color:rgb(130,177,255);">examples</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">src</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">main</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">r</span><span class="cm-operator">/</span><span class="cm-variable" style="color:rgb(130,177,255);">dataframe</span>.<span class="cm-property" style="color:rgb(128,203,174);">R</span></span></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div style="width:1px;border-bottom-width:0px;border-bottom-style:solid;border-bottom-color:transparent;">
</div>
<div class="CodeMirror-gutters" style="border:none;min-height:100%;z-index:3;color:rgb(83,127,126);">
<div class="CodeMirror-gutter CodeMirror-linenumbers" style="display:inline-block;vertical-align:top;width:29px;">
</div>
</div>
</div>
</div>
</div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div style="font-family:Helvetica, 'Hiragino Sans GB', '微软雅黑', 'Microsoft YaHei UI', SimSun, SimHei, arial, sans-serif;font-size:16px;line-height:25.6px;">
<br></div>
<div></div>
</div>            </div>
                </div>