---
layout:     post
title:      hive使用技巧（三）——巧用group by实现去重统计
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="font-family:Arial;font-size:14px;line-height:26px;">
相关文章推荐：</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<a href="http://blog.csdn.net/kwu_ganymede/article/details/49096077" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;"></a></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<a href="http://blog.csdn.net/kwu_ganymede/article/details/49096077" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">hive使用技巧（一）自动化动态分配表分区及修改hive表字段名称</a><br><a href="http://blog.csdn.net/kwu_ganymede/article/details/49927311" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">hive使用技巧（二）——共享中间结果集</a><br><a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">hive使用技巧（三）——巧用group by实现去重统计</a><br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<a href="http://blog.csdn.net/kwu_ganymede/article/details/51365002" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">hive使用技巧（四）——巧用MapJoin解决数据倾斜问题</a></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<a href="http://blog.csdn.net/kwu_ganymede/article/details/53435656" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;">Hive使用技巧（五）—— 一行转多行,多行转一行</a></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<a href="http://blog.csdn.net/kwu_ganymede/article/details/51365002" rel="nofollow" style="color:rgb(202,0,0);text-decoration:none;"></a></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
网站统计中常用的指标，pv ,uv , 独立IP,登录用户等，都涉及去重操作。全年的统计，PV超过100亿以上。即使是简单的去重统计也非常困难。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
1、统计去重，原来SQL如下</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_sql" style="font-family:Consolas, 'Courier New', Courier, mono, serif;line-height:26px;background-color:rgb(231,229,220);">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);background-color:rgb(248,248,248);">
<strong>[sql]</strong> <a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">view
 plain</a><span> <a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">copy</a></span>
<div style="width:18px;z-index:99;">
</div>
<span></span></div>
</div>
<ol start="1" class="dp-sql" style="border:none;color:rgb(92,92,92);background-color:rgb(255,255,255);"><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;"> substr(</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">,1,4) </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">year</span><span style="border:none;background-color:inherit;">,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(*) PV,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">distinct</span><span style="border:none;background-color:inherit;"> cookieid) UV,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">distinct</span><span style="border:none;background-color:inherit;"> ip) IP,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(</span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">distinct</span><span style="border:none;background-color:inherit;"> userid) LOGIN   </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> dms.tracklog_5min a    </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">where</span><span style="border:none;background-color:inherit;"> substr(</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">,1,4)=</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2015'</span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">group</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">by</span><span style="border:none;background-color:inherit;"> substr(</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">,1,4)  </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">;  </span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
统计中四个指示，三个都涉及了去重，任务跑了几个小时都未出结果。</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
2、利用group by 实现去重</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_sql" style="font-family:Consolas, 'Courier New', Courier, mono, serif;line-height:26px;background-color:rgb(231,229,220);">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);background-color:rgb(248,248,248);">
<strong>[sql]</strong> <a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">view
 plain</a><span> <a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">copy</a></span>
<div style="width:18px;z-index:99;">
</div>
<span></span></div>
</div>
<ol start="1" class="dp-sql" style="border:none;color:rgb(92,92,92);background-color:rgb(255,255,255);"><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;"> </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"2015"</span><span style="border:none;background-color:inherit;">,</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"PV"</span><span style="border:none;background-color:inherit;">,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(*) </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> dms.tracklog_5min  </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">where</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&gt;=</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2015'</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">and</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&lt;</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2016'</span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">union</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">all</span><span style="border:none;background-color:inherit;">   </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;"> </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"201505"</span><span style="border:none;background-color:inherit;">,</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"UV"</span><span style="border:none;background-color:inherit;">,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(*) </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> (  </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;">  cookieid </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> dms.tracklog_5min  </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">where</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&gt;=</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2015'</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">and</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&lt;</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2016'</span><span style="border:none;background-color:inherit;">  </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">group</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">by</span><span style="border:none;background-color:inherit;"> cookieid ) a   </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">union</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">all</span><span style="border:none;background-color:inherit;">   </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;"> </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"2015"</span><span style="border:none;background-color:inherit;">,</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"IP"</span><span style="border:none;background-color:inherit;">,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(*) </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> (  </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;">  ip </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> dms.tracklog_5min  </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">where</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&gt;=</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2015'</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">and</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&lt;</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2016'</span><span style="border:none;background-color:inherit;">  </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">group</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">by</span><span style="border:none;background-color:inherit;"> ip ) a   </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">union</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">all</span><span style="border:none;background-color:inherit;">   </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;"> </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"2015"</span><span style="border:none;background-color:inherit;">,</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"LOGIN"</span><span style="border:none;background-color:inherit;">,</span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">count</span><span style="border:none;background-color:inherit;">(*) </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> (  </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">select</span><span style="border:none;background-color:inherit;">  userid </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">from</span><span style="border:none;background-color:inherit;"> dms.tracklog_5min  </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">where</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&gt;=</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2015'</span><span style="border:none;background-color:inherit;"> </span><span class="op" style="border:none;color:rgb(128,128,128);background-color:inherit;">and</span><span style="border:none;background-color:inherit;"> </span><span class="func" style="border:none;color:rgb(255,20,147);background-color:inherit;">day</span><span style="border:none;background-color:inherit;">&lt;</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">'2016'</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">group</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">by</span><span style="border:none;background-color:inherit;"> userid) b;  </span></span></li></ol></div>
<br style="font-family:Arial;font-size:14px;line-height:26px;"><span style="font-family:Arial;font-size:14px;line-height:26px;">单独统计pv,uv,IP,login等指标，并union拼起来，任务跑了不到1个小时就去来结果了</span>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
3、参数的优化</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_sql" style="font-family:Consolas, 'Courier New', Courier, mono, serif;line-height:26px;background-color:rgb(231,229,220);">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);background-color:rgb(248,248,248);">
<strong>[sql]</strong> <a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">view
 plain</a><span> <a href="http://blog.csdn.net/kwu_ganymede/article/details/50381011#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;background-color:inherit;">copy</a></span>
<div style="width:18px;z-index:99;">
</div>
<span></span></div>
</div>
<ol start="1" class="dp-sql" style="border:none;color:rgb(92,92,92);background-color:rgb(255,255,255);"><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">SET</span><span style="border:none;background-color:inherit;"> mapred.reduce.tasks=50;  </span></span></li><li style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;line-height:18px;background-color:rgb(248,248,248);">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">SET</span><span style="border:none;background-color:inherit;"> mapreduce.reduce.memory.mb=6000;  </span></span></li><li class="alt" style="border-left-width:3px;border-style:none none none solid;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);font-weight:bold;background-color:inherit;">SET</span><span style="border:none;background-color:inherit;"> mapreduce.reduce.shuffle.memory.limit.percent=0.06;  </span></span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
涉及数据倾斜的话，主要是reduce中数据倾斜的问题，可能通过设置<a href="http://lib.csdn.net/base/hive" rel="nofollow" class="replace_word" title="Hive知识库" style="color:rgb(223,52,52);text-decoration:none;font-weight:bold;">Hive</a>中reduce的并行数，reduce的内存大小单位为m，reduce中 shuffle的刷磁盘的比例，来解决。</p>
            </div>
                </div>