---
layout:     post
title:      spark集群与spark HA高可用快速部署 spark研习第一季
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/refuil/article/details/51991536				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h1 id="1spark-部署" style='margin:50px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(0,119,187); font-size:30px; background-color:rgb(249,249,245)'>
1、spark 部署</h1>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
标签： spark</p>
<hr style='margin:30px 0px; border-top-width:0px; border-right-width:0px; border-left-width:0px; border-bottom-style:dashed; border-bottom-color:rgb(207,207,207); color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="0-apache-spark项目架构" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
0 apache spark项目架构</h2>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>spark SQL  --  spark streaming --  MLlib  --  GraphX
</code></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="01-hadoop快速搭建主要利用hdfs存储框架" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
0.1 hadoop快速搭建，主要利用hdfs存储框架</h3>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
下载hadoop-2.6.0，解压，到etc/hadoop/目录下</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="02-快速配置文件" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
0.2 快速配置文件</h3>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h1 id="cat-core-sitexml" style='margin:50px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(0,119,187); font-size:30px; background-color:rgb(249,249,245)'>
cat core-site.xml</h1>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;configuration&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">fs.defaultFS</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">hdfs://worker1:9000</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">hadoop.tmp.dir</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">/opt/hadoop-2.6.0/tmp</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">hadoop.native.lib</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">true</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0)">Should native hadoop libraries, if present, be used.</span><span class="tag" style="color:rgb(0,0,136)">&lt;/description&gt;</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;/configuration&gt;</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h1 id="cat-hdfs-sitexml" style='margin:50px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(0,119,187); font-size:30px; background-color:rgb(249,249,245)'>
cat hdfs-site.xml</h1>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;configuration&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">dfs.replication</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">2</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">dfs.namenode.secondary.http-address</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">worker1:50090</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0)">The secondary namenode http server address and port.</span><span class="tag" style="color:rgb(0,0,136)">&lt;/description&gt;</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">dfs.namenode.name.dir</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">/opt/hadoop-2.6.0/dfs/name</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">dfs.datanode.data.dir</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">/opt/hadoop-2.6.0/dfs/data</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">dfs.namenode.checkpoint.dir</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">file:///opt/hadoop-2.6.0/dfs/namesecondary</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">                </span><span class="tag" style="color:rgb(0,0,136)">&lt;description&gt;</span><span class="pln" style="color:rgb(0,0,0)">Determines where on the local filesystem the DFSsecondary name node should store the temporary images to merge. If this is acomma-delimited list of directories then the image is replicated in all of thedirectories for redundancy.</span><span class="tag" style="color:rgb(0,0,136)">&lt;/description&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;/configuration&gt;</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h1 id="cat-hadoop-envsh" style='margin:50px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(0,119,187); font-size:30px; background-color:rgb(249,249,245)'>
cat hadoop-env.sh</h1>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">jdk</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_OPTS</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">"-Djava.library.path=$HADOOP_HOME/lib:$HADOOP_HOME/lib/native"</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_CONF_DIR</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$</span><span class="pun" style="color:rgb(102,102,0)">{</span><span class="pln" style="color:rgb(0,0,0)">HADOOP_CONF_DIR</span><span class="pun" style="color:rgb(102,102,0)">:-</span><span class="str" style="color:rgb(0,136,0)">"/etc/hadoop"</span><span class="pun" style="color:rgb(102,102,0)">}</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h1 id="cat-mapred-sitexml" style='margin:50px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(0,119,187); font-size:30px; background-color:rgb(249,249,245)'>
cat mapred-site.xml</h1>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;configuration&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">            </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">mapreduce.framework.name</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">            </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">yarn</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;/configuration&gt;</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h1 id="cat-yarn-sitexml" style='margin:50px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(0,119,187); font-size:30px; background-color:rgb(249,249,245)'>
cat yarn-site.xml</h1>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;configuration&gt;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)">&lt;!-- Site specific YARN configuration properties --&gt;</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">yarn.resourcemanager.hostname</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;property&gt;</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;name&gt;</span><span class="pln" style="color:rgb(0,0,0)">yarn.nodemanager.aux-services</span><span class="tag" style="color:rgb(0,0,136)">&lt;/name&gt;</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">        </span><span class="tag" style="color:rgb(0,0,136)">&lt;value&gt;</span><span class="pln" style="color:rgb(0,0,0)">mapreduce_shuffle</span><span class="tag" style="color:rgb(0,0,136)">&lt;/value&gt;</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="tag" style="color:rgb(0,0,136)">&lt;/property&gt;</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="tag" style="color:rgb(0,0,136)">&lt;/configuration&gt;</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="03-hadoop-hdfs快速启动测试" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
0.3 hadoop hdfs快速启动测试</h3>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ sbin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">start</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">dfs</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh  </span><span class="com" style="color:rgb(136,0,0)">//开启进程</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">jps </span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">5212</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">NameNode</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">5493</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">SecondaryNameNode</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">5909</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Jps</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">5336</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">DataNode</span><span class="pln" style="color:rgb(0,0,0)">    </span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)">//如果没有DataNode，查看log/下的最新启动情况</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">可能是因为</span><span class="pln" style="color:rgb(0,0,0)">hostname</span><span class="pun" style="color:rgb(102,102,0)">没有改为</span><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="pun" style="color:rgb(102,102,0)">引起，每次重启虚拟机会遇到这种情况。</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">再次</span><span class="pln" style="color:rgb(0,0,0)">sbin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">start</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">dfs</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh </span><span class="pun" style="color:rgb(102,102,0)">如果</span><span class="pln" style="color:rgb(0,0,0)">namenode</span><span class="pun" style="color:rgb(102,102,0)">没有起来</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ bin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">hdfs namenode </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">format   </span><span class="com" style="color:rgb(136,0,0)">//格式化</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">最后浏览器查看</span><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">50070</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="1-spark安装及配置" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1. Spark安装及配置</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="11-运行环境配置" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
1.1 运行环境配置</h3>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>A.下载及配置JDK,Scala,sbt,Maven  到/opt 目录下
</code></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
JDK jdk-7u79-linux-x64.gz <br>
Scala <a target="_blank" href="http://downloads.typesafe.com/scala/2.10.5/scala-2.10.5.tgz" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://downloads.typesafe.com/scala/2.10.5/scala-2.10.5.tgz</a> <br>
Maven apache-maven-3.2.5-bin.tar.gz <br>
SBT sbt-0.13.7.tgz <br>
解压 tar zxf jdk-7u79-linux-x64.gz <br>
tar zxf scala-2.10.5.tgz</p>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>B.配置
</code></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">vi </span><span class="pun" style="color:rgb(102,102,0)">~</span><span class="str" style="color:rgb(0,136,0)">/.bash_profile   ##vi /</span><span class="pln" style="color:rgb(0,0,0)">etc</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">profile  </span><span class="pun" style="color:rgb(102,102,0)">以下皆替换</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">jdk</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> CLASSPATH</span><span class="pun" style="color:rgb(102,102,0)">=.:</span><span class="pln" style="color:rgb(0,0,0)">$JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">lib</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">dt</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">jar</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">lib</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">tools</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">jar</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SCALA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">scala</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.10</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$SCALA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ source </span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">etc</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">profile    </span><span class="com" style="color:rgb(136,0,0)">//source ~/.bash_profile</span></code></li></ol></pre>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>C.测试
</code></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ java </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">version</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">java version </span><span class="str" style="color:rgb(0,136,0)">"1.7.0_79"</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Java</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">TM</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> SE </span><span class="typ" style="color:rgb(102,0,102)">Runtime</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Environment</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">build </span><span class="lit" style="color:rgb(0,102,102)">1.7</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0_79</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">b15</span><span class="pun" style="color:rgb(102,102,0)">)</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Java</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">HotSpot</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">TM</span><span class="pun" style="color:rgb(102,102,0)">)</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">64</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Bit</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Server</span><span class="pln" style="color:rgb(0,0,0)"> VM </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">build </span><span class="lit" style="color:rgb(0,102,102)">24.79</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">b02</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> mixed mode</span><span class="pun" style="color:rgb(102,102,0)">)</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ scala </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">version</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Scala</span><span class="pln" style="color:rgb(0,0,0)"> code runner version </span><span class="lit" style="color:rgb(0,102,102)">2.10</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Copyright</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">2002</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2013</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> LAMP</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">EPFL</span></code></li></ol></pre>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>D.Maven,sbt配置
</code></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> MAVEN_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">apache</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">maven</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SBT_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">sbt</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$SCALA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$MAVEN_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$SBT_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$source </span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">etc</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">profile</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ mvn </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="pln" style="color:rgb(0,0,0)">version</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Apache</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Maven</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">3.2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="lit" style="color:rgb(0,102,102)">12a6b3acb947671f09b81f49094c53f426d8cea1</span><span class="pun" style="color:rgb(102,102,0)">;</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">2014</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">12</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">15T01</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">29</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">23</span><span class="pun" style="color:rgb(102,102,0)">+</span><span class="lit" style="color:rgb(0,102,102)">08</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">00</span><span class="pun" style="color:rgb(102,102,0)">)</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Maven</span><span class="pln" style="color:rgb(0,0,0)"> home</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">apache</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">maven</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Java</span><span class="pln" style="color:rgb(0,0,0)"> version</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">1.7</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0_79</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> vendor</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Oracle</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Corporation</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Java</span><span class="pln" style="color:rgb(0,0,0)"> home</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">jdk</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Default</span><span class="pln" style="color:rgb(0,0,0)"> locale</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> en_US</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> platform encoding</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> UTF</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">8</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">OS name</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">"linux"</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> version</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">"2.6.32-504.el6.x86_64"</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> arch</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">"amd64"</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> family</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">"unix"</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ sbt </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="pln" style="color:rgb(0,0,0)">version         </span><span class="com" style="color:rgb(136,0,0)">//warning '--'</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">sbt launcher version </span><span class="lit" style="color:rgb(0,102,102)">0.13</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">7</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="12-spark配置" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
1.2 Spark配置</h3>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>A.下载Hadoop,Spark
</code></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
spark-1.4.0 <a target="_blank" href="http://d3kbcqa49mib13.cloudfront.net/spark-1.4.0-bin-hadoop2.6.tgz" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://d3kbcqa49mib13.cloudfront.net/spark-1.4.0-bin-hadoop2.6.tgz</a> <br>
Hadoop <a target="_blank" href="http://mirror.bit.edu.cn/apache/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://mirror.bit.edu.cn/apache/hadoop/common/hadoop-2.6.0/hadoop-2.6.0.tar.gz</a> <br>
解压</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ tar zxf spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">hadoop2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6.tgz</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ tar zxf hadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0.tar</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">gz</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ ll </span><span class="pun" style="color:rgb(102,102,0)">查看</span></code></li></ol></pre>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>B. 配置Hadoop,Spark的安装目录
</code></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">vi </span><span class="pun" style="color:rgb(102,102,0)">~/.</span><span class="pln" style="color:rgb(0,0,0)">bash_profile</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">jdk</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> CLASSPATH</span><span class="pun" style="color:rgb(102,102,0)">=.:</span><span class="pln" style="color:rgb(0,0,0)">$JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">lib</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">dt</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">jar</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">lib</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">tools</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">jar</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SCALA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">scala</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">scala</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.10</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SPARK_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">hadoop2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_CONF_DIR</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">etc</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> MAVEN_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">apache</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">maven</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SBT_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">sbt</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$SCALA_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$SPARK_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$HADOOP_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$HADOOP_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">sbin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$MAVEN_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$SBT_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">source </span><span class="pun" style="color:rgb(102,102,0)">~/.</span><span class="pln" style="color:rgb(0,0,0)">bash_profile</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="13-spark配置文件" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
1.3 Spark配置文件</h3>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>A.复制配置文件 
</code></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)"># cd spark-1.4.0-bin-hadoop2.6</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)"># cd conf</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)"># cp spark-env.sh.template spark-env.sh</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
在spark-env.sh最后添加下面</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SCALA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">scala</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.10</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">5</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SPARK_MASTER_IP</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">worker1    </span><span class="com" style="color:rgb(136,0,0)">//如果是master需要改动</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SPARK_WORKER_MEMORY</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="lit" style="color:rgb(0,102,102)">1G</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> JAVA_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">jdk      </span><span class="com" style="color:rgb(136,0,0)">//注意jdk的文件名变了</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> HADOOP_CONF_DIR</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">etc</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">hadoop</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
配置spark-defaults.sh, 后面添加</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">master                     spark</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//worker1:7077</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">eventLog</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">enabled           </span><span class="kwd" style="color:rgb(0,0,136)">true</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">eventLog</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">dir               hdfs</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//worker1:9000/usr</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">executor</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">extraJavaOptions  </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">XX</span><span class="pun" style="color:rgb(102,102,0)">:+</span><span class="typ" style="color:rgb(102,0,102)">PrintGCDetails</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Dkey</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">value </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Dnumbers</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">"one two three"</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">yarn</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">historyServer</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">address worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">18080</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">history</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">fs</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">logDirectory    hdfs</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//worker1:9000/usr   ##根据情况在hadoop hdfs目录下添加/usr 文件夹</span></code></li></ol></pre>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>B.配置slaves
</code></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
在slaves最后添加下面</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">worker1</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">worker2</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">worker3</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
cd ..</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="14-启动master" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1.4. 启动master</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">.</span><span class="str" style="color:rgb(0,136,0)">/sbin/</span><span class="pln" style="color:rgb(0,0,0)">start</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">master</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="15-启动worker" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1.5. 启动worker</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">.</span><span class="str" style="color:rgb(0,136,0)">/sbin/</span><span class="pln" style="color:rgb(0,0,0)">start</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">slaves</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh spark</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//worker1:7077</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">出错</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> ssh</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Could</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">not</span><span class="pln" style="color:rgb(0,0,0)"> resolve hostname worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Name</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">or</span><span class="pln" style="color:rgb(0,0,0)"> service </span><span class="kwd" style="color:rgb(0,0,136)">not</span><span class="pln" style="color:rgb(0,0,0)"> known</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)">#vim /etc/hosts</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">添加</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">192.168</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">35.131</span><span class="pln" style="color:rgb(0,0,0)">  worker1</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">jps</span><span class="pun" style="color:rgb(102,102,0)">查看</span><span class="pln" style="color:rgb(0,0,0)">master</span><span class="pun" style="color:rgb(102,102,0)">和</span><span class="pln" style="color:rgb(0,0,0)">worker</span><span class="pun" style="color:rgb(102,102,0)">节点上验证</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">集群是否正确启动：</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">通过浏览器查看</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">集群是否启动成功：</span><span class="pln" style="color:rgb(0,0,0)">http</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//master:8080</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="16-启动spark-shell" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1.6. 启动spark-shell</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">.</span><span class="str" style="color:rgb(0,136,0)">/bin/</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">shell </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="pln" style="color:rgb(0,0,0)">master spark</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//worker1:7077</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">如果是</span><span class="pln" style="color:rgb(0,0,0)">master</span><span class="pun" style="color:rgb(102,102,0)">改动</span><span class="pln" style="color:rgb(0,0,0)">worker1</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">浏览器登录</span><span class="pln" style="color:rgb(0,0,0)"> http</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//worker1:4040/ </span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="17-启动spark的historyserver" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1.7 启动spark的historyserver:</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">.</span><span class="str" style="color:rgb(0,136,0)">/sbin/</span><span class="pln" style="color:rgb(0,0,0)">start</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">history</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">server</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">浏览器登录</span><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">18080</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="18-通过spark-shell测试spark集群" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1.8 通过spark-shell测试SPARK集群:</h2>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
a. 将spark安装包下的README.md上传到hdfs:hdfs dfs -put README.md /data/ <br>
直接在spark目录下</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)"># hdfs dfs -mkdir -p /data</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)">#hdfs dfs -put README.md /data</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
b. 通过hdfs的web控制台查看可见上传成功 <br>
c. 在spark-shell中对上传的文件进行操作：</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">val file</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">sc</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">textFile</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="str" style="color:rgb(0,136,0)">"/data/README.md"</span><span class="pun" style="color:rgb(102,102,0)">)</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
对读取的文件进行count操作：</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">val count </span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)"> file</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">flatMap</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">line </span><span class="pun" style="color:rgb(102,102,0)">=&gt;</span><span class="pln" style="color:rgb(0,0,0)"> line</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">split</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="str" style="color:rgb(0,136,0)">" "</span><span class="pun" style="color:rgb(102,102,0)">)).</span><span class="pln" style="color:rgb(0,0,0)">map</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">word </span><span class="pun" style="color:rgb(102,102,0)">=&gt;</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">word</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="lit" style="color:rgb(0,102,102)">1</span><span class="pun" style="color:rgb(102,102,0)">)).</span><span class="pln" style="color:rgb(0,0,0)">reduceByKey</span><span class="pun" style="color:rgb(102,102,0)">(</span><span class="pln" style="color:rgb(0,0,0)">_</span><span class="pun" style="color:rgb(102,102,0)">+</span><span class="pln" style="color:rgb(0,0,0)">_</span><span class="pun" style="color:rgb(102,102,0)">)</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">count</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">collect    </span><span class="com" style="color:rgb(136,0,0)">//用collect命令提交并执行Job:</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
d. 从webUI可见job成功执行：<a target="_blank" href="http://master:4040/" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://master:4040</a></p>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
e. 通过jobhistoryserver可以查看程序执行的历史信息：<a target="_blank" href="http://master:18080/" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://master:18080</a> <br>
注：4040端口用来查看正在运行的程序的job信息，而18080用来查看执行完毕的程序的job信息。</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="19-通过spark-submit提交程序到spark集群测试spark集群" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
1.9 通过spark-submit提交程序到spark集群测试SPARK集群:</h2>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
a. 通过以下命令提交spark自带的sparkPi程序：</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">&gt;&gt;</span><span class="kwd" style="color:rgb(0,0,136)">exit</span><span class="pln" style="color:rgb(0,0,0)">    </span><span class="com" style="color:rgb(136,0,0)">//退出spark-shell</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">submit </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="kwd" style="color:rgb(0,0,136)">class</span><span class="pln" style="color:rgb(0,0,0)"> org</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">apache</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">examples</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="typ" style="color:rgb(102,0,102)">SparkPi</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="pln" style="color:rgb(0,0,0)">master spark</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="com" style="color:rgb(136,0,0)">//master:7077 $SPARK_HOME/lib/spark-examples-1.4.0-hadoop2.6.0.jar    //注意这是1.4版本的，不要直接复制,submit指定的主机名也要按实际更改</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
b. <a target="_blank" href="http://worker1:18080/" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://worker1:18080/</a> //浏览器查看 <br>
出现问题： <br>
ERROR cluster.SparkDeploySchedulerBackend: Application has been killed. Reason: All masters are unresponsive! Giving up. <br>
参考： <br>
<a target="_blank" href="http://blog.csdn.net/javastart/article/details/43730085" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">spark 案例集群测试整理</a> <br>
<a target="_blank" href="http://blog.csdn.net/javastart/article/details/43730085" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://blog.csdn.net/javastart/article/details/43730085</a></p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="2-spark源代码编译" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
2. Spark源代码编译</h2>
<pre style='padding:10px 15px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'>1.Maven编译
</code></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
下载代码 wget <a target="_blank" href="http://d3kbcqa49mib13.cloudfront.net/spark-1.4.0.tgz" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://d3kbcqa49mib13.cloudfront.net/spark-1.4.0.tgz</a></p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ tar zxvf spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0.tgz</span><span class="pln" style="color:rgb(0,0,0)"> </span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$ cd spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$build</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">mvn </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Pyarn</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Phadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Dhadoop</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">version</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">DskipTests</span><span class="pln" style="color:rgb(0,0,0)"> clean </span><span class="kwd" style="color:rgb(0,0,136)">package</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">更为简单的方法，</span><span class="pln" style="color:rgb(0,0,0)">shell</span><span class="pun" style="color:rgb(102,102,0)">脚本编译：</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$</span><span class="pun" style="color:rgb(102,102,0)">./</span><span class="pln" style="color:rgb(0,0,0)">make</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">distribution</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh </span><span class="pun" style="color:rgb(102,102,0)">--</span><span class="pln" style="color:rgb(0,0,0)">tgz </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Phadoop</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Pyarn</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">DskipTests</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Dhadoop</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">version</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="lit" style="color:rgb(0,102,102)">2.6</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Phive</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="typ" style="color:rgb(102,0,102)">Phivethriftserver</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">clean </span><span class="kwd" style="color:rgb(0,0,136)">package</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
2.SBT编译</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="com" style="color:rgb(136,0,0)">#build/sbt -Pyarn -Phadoop-2.6 assembly</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="3-spark-standalone-运行" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
3. Spark Standalone 运行</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="31-配置slaves" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
3.1 配置slaves</h3>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">cd </span><span class="pun" style="color:rgb(102,102,0)">../</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">hadoop2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
在slaves最后添加下面</p>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
worker2 <br>
worker3</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="32-ssh免密码登录" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
3.2 SSH免密码登录</h3>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">$vim </span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">etc</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">hosts</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">添加</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">192.168</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">35.131</span><span class="pln" style="color:rgb(0,0,0)">  worker1</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">192.168</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">35.128</span><span class="pln" style="color:rgb(0,0,0)">  worker2</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">192.168</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">35.129</span><span class="pln" style="color:rgb(0,0,0)">  worker3</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
a：worker1上生成密钥</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">ssh</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">keygen </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">t rsa</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">ssh</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">copy</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">id </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">i </span><span class="pun" style="color:rgb(102,102,0)">~</span><span class="str" style="color:rgb(0,136,0)">/.ssh/</span><span class="pln" style="color:rgb(0,0,0)">id_rsa</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">pub root@worker1  </span><span class="com" style="color:rgb(136,0,0)">//测试分发秘钥给本机</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
b：把本机的公钥追到worker2的 .ssh/authorized_keys 里</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">ssh</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">copy</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">id </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">i </span><span class="pun" style="color:rgb(102,102,0)">~</span><span class="str" style="color:rgb(0,136,0)">/.ssh/</span><span class="pln" style="color:rgb(0,0,0)">id_rsa</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">pub root@worker2</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
c：测试</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">ssh worker2</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">exit</span><span class="pln" style="color:rgb(0,0,0)">   </span><span class="pun" style="color:rgb(102,102,0)">退出</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="33-启动测试" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
3.3 启动测试</h3>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">.</span><span class="str" style="color:rgb(0,136,0)">/sbin/</span><span class="pln" style="color:rgb(0,0,0)">start</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">all</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh</span></code></li></ol></pre>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="34-spark-tool" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
3.4. Spark tool</h3>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h4 id="运行方式" style='margin:10px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:20px; color:rgb(44,62,80); font-size:18px; background-color:rgb(249,249,245)'>
运行方式：</h4>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
1: spark-shell <br>
./bin/spark-shell --executor-memory 1g --driver-memory 1g --master spark://worker1:7077 <br>
2： spark-submit <br>
./bin/spark-submit --class "SimpleApp" --master spark://worker1:7077 /opt/simple-project_2.10-1.0.jar</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="4-spark-standalone-ha-安装" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
4. Spark Standalone HA 安装</h2>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="41-zookeeper分布式协调服务" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
4.1 Zookeeper分布式协调服务</h3>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
默认情况下，Standalone的Spark集群是Master-Slaves架构的集群模式，由一台master来调度资源，这就和大部分的Master-Slaves结构集群一样，存在着Master单点故障的问题。如何解决这个单点故障的问题呢？Spark提供了两种方案：基于文件系统的单点恢复(Single-Node Recovery with Local File system)和基于zookeeper的Standby Masters(Standby Masters with ZooKeeper)。其中ZooKeeper是生产环境下的最佳选择。 <br>
ZooKeeper提供了一个Leader Election机制，利用这个机制你可以在集群中开启多个master并使它们都注册到ZooKeeper实例，ZooKeeper会管理使其中只有一个是Active的，其他的都是Standby的，Active状态的master可以提供服务，standby状态的则不可以。ZooKeeper保存了集群的状态信息，该信息包括所有的Worker，Driver 和Application。当Active的Master出现故障时，ZooKeeper会从其他standby的master中选举出一台，然后该新选举出来的master会恢复挂掉了的master的状态信息，之后该Master就可以正常提供调度服务。整个恢复过程只需要1到2分钟。需要注意的是，在这1到2分钟内，只会影响新程序的提交，那些在master崩溃时已经运行在集群中的程序并不会受影响。</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="42-curatorframework简介" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
4.2 CuratorFramework简介</h3>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
 CuratorFramework极大的简化了ZooKeeper的使用，它提供了high-level的API，并且基于ZooKeeper添加了很多 <br>
特性，包括 <br>
 自劢连接管理：连接到ZooKeeper的Client有可能会连接中断，Curator处理了这种情况，对于Client来说自劢重连 <br>
是透明的。 <br>
 简洁的API：简化了原生态的ZooKeeper的方法，事件等；提供了一个简单易用的接口。 <br>
 Recipe的实现： <br>
– Leader的选择 <br>
– 共享锁 <br>
– 缓存和监控 <br>
– 分布式的队列 <br>
– 分布式的优先队列</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="43-zookeeper-安装" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
4.3 Zookeeper 安装</h3>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
1 .下载 <br>
官网下载<a target="_blank" href="http://www.apache.org/dyn/closer.cgi/zookeeper/" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://www.apache.org/dyn/closer.cgi/zookeeper/</a></p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">tar zxf zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6.tar</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">gz</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">cd zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">首先创建</span><span class="pln" style="color:rgb(0,0,0)">datadir</span><span class="pun" style="color:rgb(102,102,0)">和</span><span class="pln" style="color:rgb(0,0,0)">datalogdir</span><span class="pun" style="color:rgb(102,102,0)">，可以用以下命令创建:</span><span class="pln" style="color:rgb(0,0,0)"> mkdir data</span><span class="pun" style="color:rgb(102,102,0)">;</span><span class="pln" style="color:rgb(0,0,0)"> mkdir logs</span><span class="pun" style="color:rgb(102,102,0)">:</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">修改环境变量:</span><span class="pln" style="color:rgb(0,0,0)"> vim </span><span class="pun" style="color:rgb(102,102,0)">~/.</span><span class="pln" style="color:rgb(0,0,0)">bashrc</span><span class="pun" style="color:rgb(102,102,0)">:</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> ZOOKEEEPER_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$ZOOKEEPER_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">source </span><span class="pun" style="color:rgb(102,102,0)">~/.</span><span class="pln" style="color:rgb(0,0,0)">bashrc</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
2 .配置</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">cd conf</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">cp zoo_sample</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">cfg zoo</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">cfg</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">vi zoo</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">cfg</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
最后面加上</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">dataDir</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">data</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">dataLogDir</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">logs</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">server</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">2888</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">3888</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">server</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">1</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">worker2</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">2888</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">3888</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">server</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">2</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">worker3</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">2888</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">3888</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
注： <br>
dataDir指定的是用来存储内存里数据的快照文件的目录；（在不指定dataLogDir时，该目录也是数据库的更改事务日志的存储目录）； <br>
dataLogDir指定的是数据库的事务日志的存储目录； <br>
server.0,server.1,server.2指定的是ZooKeeper集群的各个节点，这里的数字012对应该节点datadir下的myid文件的内容(在此强调：必须在这里指定所有ZooKeeper节点！)。 <br>
两个端口" 2888" and "3888",前者是ZooKeeper各个节点相互连接通信所用,后者是leader 选举所用。 <br>
更详细的信息请参阅： <br>
<a target="_blank" href="http://zookeeper.apache.org/doc/trunk/zookeeperStarted.html" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://zookeeper.apache.org/doc/trunk/zookeeperStarted.html</a></p>
<ol style='padding:0px; margin:0px 0px 10px 25px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
<li style="line-height:27px">在datadir下建立myid文件并修改内容为0:</li></ol>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">echo </span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">&gt;</span><span class="pln" style="color:rgb(0,0,0)"> myid</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">注意：</span><span class="pln" style="color:rgb(0,0,0)">myid</span><span class="pun" style="color:rgb(102,102,0)">文件的内容对应于</span><span class="pln" style="color:rgb(0,0,0)">zoo</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">cfg</span><span class="pun" style="color:rgb(102,102,0)">中指定的该节点的</span><span class="pln" style="color:rgb(0,0,0)">id</span><span class="pun" style="color:rgb(102,102,0)">,即配置文件中的</span><span class="pln" style="color:rgb(0,0,0)">server</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0.</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
4.复制到其它节点并设置serverid，使用scp命令将ZooKeeper拷贝到另外2台机器上（生产环境的最佳实践是用3台机器做HA），配置另外2台机器的环境变量并source使之生效：</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">scp </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">r zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)"> root@worker2</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">scp </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">r zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)"> root@worker3</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">vim </span><span class="pun" style="color:rgb(102,102,0)">~/.</span><span class="pln" style="color:rgb(0,0,0)">bashrc</span><span class="pun" style="color:rgb(102,102,0)">:</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> ZOOKEEEPER_HOME</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> PATH</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">$ZOOKEEPER_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)">$PATH</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">source </span><span class="pun" style="color:rgb(102,102,0)">~/.</span><span class="pln" style="color:rgb(0,0,0)">bashrc</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">在另外</span><span class="lit" style="color:rgb(0,102,102)">2</span><span class="pun" style="color:rgb(102,102,0)">台机器上将</span><span class="pln" style="color:rgb(0,0,0)">data </span><span class="pun" style="color:rgb(102,102,0)">目录下的文件</span><span class="pln" style="color:rgb(0,0,0)">myid</span><span class="pun" style="color:rgb(102,102,0)">的内容分别修改为</span><span class="lit" style="color:rgb(0,102,102)">1</span><span class="pun" style="color:rgb(102,102,0)">和</span><span class="lit" style="color:rgb(0,102,102)">2</span><span class="pun" style="color:rgb(102,102,0)">。</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">echo </span><span class="str" style="color:rgb(0,136,0)">"1"</span><span class="pun" style="color:rgb(102,102,0)">&gt;</span><span class="pln" style="color:rgb(0,0,0)">myid</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">echo </span><span class="str" style="color:rgb(0,136,0)">"2"</span><span class="pun" style="color:rgb(102,102,0)">&gt;</span><span class="pln" style="color:rgb(0,0,0)">myid</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
5.运行zookeeper集群： <br>
a. 在安装了zk的各个节点上分别执行: zkServer.sh start <br>
b. jps验证启动成功与否，若见‘QuorumPeerMain’表明进程已启动。 <br>
注意：进程启动成功不代表ZooKeeper已经可以开始提供服务。 <br>
c. zkServer.sh status验证启动成功与否，并查看哪台机器被选为leader. <br>
在master节点上启动并验证ZooKeeper状态：</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">zkServer</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh start</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">jps</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">zkServer</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh status</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
注意: 见如下错误信息，‘Error contacting service. It is probably not running.’，但这是正常的，一旦你在另外2台节点上启动了ZooKeeper，该错误信息将不会再出现。一个简单的事实是，只有超过一半的ZooKeeper节点启动后，ZooKeeper才可以正常提供服务。 <br>
在另外2台机器上启动并验证ZooKeeper：</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">3.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">zkServer</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh start</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">jps</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">zkServer</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh status</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
再到master上验证ZooKeeper状态： <br>
可见，现在master节点的错误信息不见了。 <br>
现在3台节点的ZooKeeper都已经启动成功，且一台（worker2）是Leader,其它都是follower.ZooKeeper已经启动成功，并正常对外提供服务！ <br>
测试： <br>
运行 ./bin/zkCli.sh (bin/zkCli.sh -server 127.0.0.1:2181) <br>
根目录 ls /</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="44-修改spark配置使其支持zookeeper下的ha" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
4.4 修改spark配置使其支持ZooKeeper下的HA:</h3>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
1 .修改配置</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">cd $SPARK_HOME</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">conf</span><span class="pun" style="color:rgb(102,102,0)">;</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">vim spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">env</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh</span><span class="pun" style="color:rgb(102,102,0)">:</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">注释掉</span><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SPARK_MASTER_IP</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">MASTER</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">添加</span><span class="kwd" style="color:rgb(0,0,136)">export</span><span class="pln" style="color:rgb(0,0,0)"> SPARK_DAEMON_JAVA_OPTS</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="str" style="color:rgb(0,136,0)">"-Dspark.deploy.recoveryMode=ZOOKEEPER</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="str" style="color:rgb(0,136,0)">-Dspark.deploy.zookeeper.url=worker1:2181,worker2:2181,worker3:2181 -Dspark.deploy.zookeeper.dir=/spark"</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">注意：所有准备用来做</span><span class="pln" style="color:rgb(0,0,0)">master</span><span class="pun" style="color:rgb(102,102,0)">的节点都需要做这个修改。</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
复制到其它2个节点</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">scp </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">r </span><span class="pun" style="color:rgb(102,102,0)">./</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">env</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh root@worker2</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">hadoop2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">conf</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">scp </span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">r </span><span class="pun" style="color:rgb(102,102,0)">./</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">env</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">sh root@worker3</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="str" style="color:rgb(0,136,0)">/opt/</span><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="lit" style="color:rgb(0,102,102)">1.4</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">0</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">bin</span><span class="pun" style="color:rgb(102,102,0)">-</span><span class="pln" style="color:rgb(0,0,0)">hadoop2</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="lit" style="color:rgb(0,102,102)">6</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">conf</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pun" style="color:rgb(102,102,0)">配置：</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">deploy</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">recoveryMode</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">ZOOKEEPER</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">deploy</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">url</span><span class="pun" style="color:rgb(102,102,0)">=</span><span class="pln" style="color:rgb(0,0,0)">worker1</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">2181</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)">worker2</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">2181</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> worker3</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">2181</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">deploy</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">dir</span><span class="pun" style="color:rgb(102,102,0)">=/</span><span class="pln" style="color:rgb(0,0,0)">spark</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">参数</span><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">默认值</span><span class="pln" style="color:rgb(0,0,0)">  </span><span class="pun" style="color:rgb(102,102,0)">描述</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">deploy</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">recoveryMode</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    NONE</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">恢复模式（</span><span class="typ" style="color:rgb(102,0,102)">Master</span><span class="pun" style="color:rgb(102,102,0)">重新启劢的模式），</span></code></li><li class="L2" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">有三种：</span><span class="lit" style="color:rgb(0,102,102)">1.ZooKeeper</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">2.</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">FileSystem</span><span class="pun" style="color:rgb(102,102,0)">,</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">3</span></code></li><li class="L3" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    NONE</span></code></li><li class="L4" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">deploy</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">url</span></code></li><li class="L5" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">无</span></code></li><li class="L6" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="typ" style="color:rgb(102,0,102)">ZooKeeper</span><span class="pun" style="color:rgb(102,102,0)">的</span><span class="typ" style="color:rgb(102,0,102)">Server</span><span class="pun" style="color:rgb(102,102,0)">地址</span></code></li><li class="L7" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    spark</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">deploy</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">zookeeper</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">dir</span></code></li><li class="L8" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="pln" style="color:rgb(0,0,0)">spark</span></code></li><li class="L9" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="typ" style="color:rgb(102,0,102)">ZooKeeper</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="pun" style="color:rgb(102,102,0)">保存集群元数据信息的文件</span></code></li><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="pun" style="color:rgb(102,102,0)">目录，包括</span><span class="typ" style="color:rgb(102,0,102)">Worker</span><span class="pun" style="color:rgb(102,102,0)">，</span><span class="typ" style="color:rgb(102,0,102)">Driver</span><span class="pun" style="color:rgb(102,102,0)">和</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="pln" style="color:rgb(0,0,0)">    </span><span class="typ" style="color:rgb(102,0,102)">Application</span><span class="pun" style="color:rgb(102,102,0)">。</span></code></li></ol></pre>
<ol style='padding:0px; margin:0px 0px 10px 25px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
<li style="line-height:27px">在正式开始启动spark集群之前，我们先来看看启动spark集群的相关命令： <br>
a. start-all.sh其实质是先后执行了start-master.sh和start-slaves.sh: <br>
b. start-master.sh会首先尝试从spark_env.sh中获取spark_master_ip，获取到的话，就在该参数对应的节点上（可以是当前节点也可以不是当期节点）启动master进程；如果没有获取到的话，则会在当前节点上启动master进程： <br>
事实上，如果在spark-env.sh中指定了spark_master_ip，但它的值不是你当前执行start-master.sh或start-all.sh的节点的hostname的话，会报如下错误：</li></ol>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<pre class="prettyprint linenums prettyprinted" style='padding:9.5px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; font-size:14px; color:rgb(51,51,51); margin-top:0px; margin-bottom:20px; line-height:20px; word-break:break-all; word-wrap:break-word; white-space:pre-wrap'><ol class="linenums" style="padding:0px; margin:0px 0px 0px 35px"><li class="L0" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="lit" style="color:rgb(0,102,102)">16</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="lit" style="color:rgb(0,102,102)">02</span><span class="pun" style="color:rgb(102,102,0)">/</span><span class="lit" style="color:rgb(0,102,102)">24</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="lit" style="color:rgb(0,102,102)">00</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">21</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="lit" style="color:rgb(0,102,102)">07</span><span class="pln" style="color:rgb(0,0,0)"> WARN util</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="typ" style="color:rgb(102,0,102)">Utils</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Service</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">'sparkMaster'</span><span class="pln" style="color:rgb(0,0,0)"> could </span><span class="kwd" style="color:rgb(0,0,136)">not</span><span class="pln" style="color:rgb(0,0,0)"> bind on port </span><span class="lit" style="color:rgb(0,102,102)">7077.</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Attempting</span><span class="pln" style="color:rgb(0,0,0)"> port </span><span class="lit" style="color:rgb(0,102,102)">7078.</span></code></li><li class="L1" style="padding-left:15px"><code style='padding:0px; font-family:Monaco,Menlo,Consolas,"Courier New",monospace; color:inherit; border:0px; background-color:transparent'><span class="typ" style="color:rgb(102,0,102)">Exception</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="kwd" style="color:rgb(0,0,136)">in</span><span class="pln" style="color:rgb(0,0,0)"> thread </span><span class="str" style="color:rgb(0,136,0)">"main"</span><span class="pln" style="color:rgb(0,0,0)"> java</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="pln" style="color:rgb(0,0,0)">net</span><span class="pun" style="color:rgb(102,102,0)">.</span><span class="typ" style="color:rgb(102,0,102)">BindException</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Cannot</span><span class="pln" style="color:rgb(0,0,0)"> assign requested address</span><span class="pun" style="color:rgb(102,102,0)">:</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="typ" style="color:rgb(102,0,102)">Service</span><span class="pln" style="color:rgb(0,0,0)"> </span><span class="str" style="color:rgb(0,136,0)">'sparkMaster'</span><span class="pln" style="color:rgb(0,0,0)"> failed after </span><span class="lit" style="color:rgb(0,102,102)">16</span><span class="pln" style="color:rgb(0,0,0)"> retries</span><span class="pun" style="color:rgb(102,102,0)">!</span></code></li></ol></pre>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
c. start-slaves.sh会在slaves 文件中指定的每个节点上分别调用start-slave.sh来启动worker进程，并尝试注册到特定的master上。这个master通过以下方式获取：首先尝试从spark-env.sh中获取spark_master_ip，获取到的话，该参数对应的节点（可以是当前节点也可以不是当期节点）就是master节点；如果没有获取到的话，则会视当前节点为master节点。该命令不能从命令行接受参数： <br>
d. start-slave.sh: start-slave.sh必须在命令行指定master(s). 该命令会从命令行的第一个参数中取得master节点。 <br>
事实上，该命令常用来在集群中动态添加worker节点，即：整个集群已经启动并正常提供服务，这时有新的节点可用，我们要把它动态添加到集群中，而不必关闭正在运行的集群，就可以使用该命令。 <br>
e. 不论你用哪种方式启动worker（start-slaves.sh 或start-slave.sh）,当对应的Master没有启动或启动了但不是active状态的话，该worker进程仍然可以启动成功（即Jps可见该进程），但由于没能向master注册成功，它并不能提供服务，它会一直尝试向master注册!</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h3 id="45-在部署了zookeeper的一台host上启动spark" style='margin:20px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:21px; background-color:rgb(249,249,245)'>
4.5 在部署了ZooKeeper的一台host上启动spark：</h3>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
通过上面的分析，我们知道当spark_env.sh中没有配置spark_master_ip时，提交命令（start-all.sh, start-master.sh或start-slaves.sh）的host会被视为master节点。在ZooKeeper下，所有的ZooKeeper节点都必须做step4中的修改，即注释掉SPARK_MASTER_IP的配置，并添加SPARK_DAEMON_JAVA_OPTS. <br>
事实上，我们可以在任意一个已经启动了ZooKeeper且ZooKeeper正常提供服务的节点上通过命令start-all.sh来启动spark集群，不管该节点在ZooKeeper中的状态是leader还是follower. (当然你也可以只在该节点上start-master.sh，后续通过start-slaves.sh再启动workers.) <br>
在这里我们在master节点上用start-all.sh来启动spark集群。 <br>
因为spark只是一个计算框架，在这里我们还是使用hadoop的hdfs作为文件系统，故需要首先需要确保hdfs已经启动并正常提供服务： <br>
确保ZooKeeper已经启动并正常提供服务： <br>
Master节点处于follower状态： <br>
Worker1处于leader状态： <br>
Worker2处于follower状态： <br>
在master节点上用start-all.sh来启动spark集群：（当然你也可以在worker1或worker2上使用start-all.sh来启动整个集群，或只是start-master.sh来启动master进程）： <br>
注：若你正确地配置了某个节点使用ZooKeeper,(即配置了SPARK_DAEMON_JAVA_OPTS且注释掉了SPARK_MASTER_IP)，但在没有成功启动ZooKeeper的情况下使用命令start-master.sh来启动master的话，master仍能成功启动，但会处于standby即不能提供服务：</p>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
再次强调：需要在成功地启动了ZooKeeper集群的基础上（至少在一半以上的ZooKeeper节点上成功启动了ZooKeeper进程），才能去启动spark集群！</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h4 id="1jps验证哪些节点有master进程" style='margin:10px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:20px; color:rgb(44,62,80); font-size:18px; background-color:rgb(249,249,245)'>
1、jps验证哪些节点有master进程</h4>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
worker1: jps <br>
worker2: jps <br>
worker3: jps <br>
可见只有手动提交了start-all.sh或start-master.sh的master节点有MASTER进程，其他节点则没有。 <br>
注意：即使有了master进程,也不代表master已经启动并能提供服务,这还要看master的状态是否是ACTIVE.</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h4 id="2-浏览器查看worker18080状态" style='margin:10px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:20px; color:rgb(44,62,80); font-size:18px; background-color:rgb(249,249,245)'>
2. 浏览器查看worker1:8080状态.</h4>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
可见master处于ALIVE状态，在正常提供服务。 <br>
事实上，第一台手动启动了master进程的节点一定是alive状态的，不管该节点在zk上是leader还是follower!</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h4 id="3-在其他zookeeper节点上手动启动master并用jps查看master进程是否启动成功" style='margin:10px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:20px; color:rgb(44,62,80); font-size:18px; background-color:rgb(249,249,245)'>
3. 在其他ZooKeeper节点上手动启动master,并用jps查看Master进程是否启动成功:</h4>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
再次强调: 这些节点的spark-env.sh中一定要正确配置为使用ZooKeeper, 即正确配置了SPARK_DAEMON_JAVA_OPTS，否则的话这些启动了的多个masters不能发觉彼此的存在，从而都将自己视为ACTIVE状态，这将置于个集群于不健康状态（因为这些masters都会独立提供资源调度服务）。这个错误如此常见，以至于在官网上也有说明： <br>
在worker2上启动master并jps查看进程:</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h4 id="4-浏览器查看worker18080状态" style='margin:10px 0px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:20px; color:rgb(44,62,80); font-size:18px; background-color:rgb(249,249,245)'>
4. 浏览器查看worker1:8080状态.</h4>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
worker2 <br>
worker3 <br>
总结：手动启动的第一个master是ACTIVE状态，后续启动的masters是STANDBY状态, 这与哪个节点是leader,哪个节点是follower没有关系。 <br>
注：这些节点有的在zk中可能是leader,但这不影响。</p>
<div class="md-section-divider" style='color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
</div>
<h2 id="练习" style='margin:35px 0px 20px; font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-weight:500; line-height:40px; color:rgb(44,62,80); font-size:26px; background-color:rgb(249,249,245)'>
练习</h2>
<p style='margin-top:0px; margin-bottom:20px; color:rgb(44,62,80); font-family:"PingFang SC","Hiragino Sans GB","Helvetica Neue","Microsoft Yahei","WenQuanYi Micro Hei",sans-serif; font-size:14px; line-height:24px; background-color:rgb(249,249,245)'>
1、spark-submit提交一个简单的程序，参考<a target="_blank" href="http://spark.apache.org/docs/latest/quick-start.html" rel="nofollow" style="color:rgb(0,136,204); text-decoration:none">http://spark.apache.org/docs/latest/quick-start.html</a> <br>
提供操作步骤和运行结果的截图。</p>
            </div>
                </div>