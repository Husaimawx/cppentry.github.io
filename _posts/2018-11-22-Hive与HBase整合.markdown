---
layout:     post
title:      Hive与HBase整合
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h1 id="HBaseIntegration-HiveHBaseIntegration" style="margin:0px; padding:0px; color:rgb(51,51,51); font-size:24px; font-weight:normal; line-height:1.25; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Hive HBase Integration</h1>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
</p>
<div class="toc-macro client-side-toc-macro  hidden-outline" style="margin:0px; padding:0px; font-size:14px; color:rgb(51,51,51); font-family:Arial,sans-serif; line-height:20px">
<ul style="margin:0px">
<li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-HiveHBaseIntegration" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Hive HBase Integration</a></span>
<ul style="margin:0px; list-style-type:disc">
<li class="toc-empty-item" style="list-style-type:none">
<ul style="margin:0px; list-style-type:disc">
<li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-AvroDataStoredinHBaseColumns" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Avro Data Stored in
 HBase Columns</a></span></li></ul>
</li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Introduction" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Introduction</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-StorageHandlers" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Storage Handlers</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Usage" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Usage</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-ColumnMapping" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Column Mapping</a></span>
<ul style="margin:0px; list-style-type:disc">
<li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-MultipleColumnsandFamilies" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Multiple Columns and
 Families</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-HiveMAPtoHBaseColumnFamily" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Hive MAP to HBase Column
 Family</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-HiveMAPtoHBaseColumnPrefix" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Hive MAP to HBase Column
 Prefix</a></span>
<ul style="margin:0px; list-style-type:disc">
<li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-HidingColumnPrefixes" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Hiding Column Prefixes</a></span></li></ul>
</li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Illegal:HivePrimitivetoHBaseColumnFamily" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Illegal:
 Hive Primitive to HBase Column Family</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-ExamplewithBinaryColumns" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Example with Binary Columns</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-SimpleCompositeRowKeys" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Simple Composite Row Keys</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-ComplexCompositeRowKeysandHBaseKeyFactory" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Complex
 Composite Row Keys and HBaseKeyFactory</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-AvroDataStoredinHBaseColumns.1" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Avro Data Stored
 in HBase Columns</a></span></li></ul>
</li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-PutTimestamps" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Put Timestamps</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-KeyUniqueness" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Key Uniqueness</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Overwrite" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Overwrite</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-PotentialFollowups" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Potential Followups</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Build" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Build</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Tests" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Tests</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Links" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Links</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-Acknowledgements" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Acknowledgements</a></span></li><li><span class="toc-item-body"><a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-OpenIssues(JIRA)" rel="nofollow" class="toc-link" style="color:rgb(53,114,176); text-decoration:none">Open Issues (JIRA)</a></span></li></ul>
</li></ul>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
</p>
<div class="confluence-information-macro confluence-information-macro-information" style="margin:10px 0px 1em; padding:10px 10px 10px 36px; border:1px solid rgb(170,184,198); color:rgb(51,51,51); min-height:20px; position:relative; font-family:Arial,sans-serif; font-size:14px; line-height:20px; background:rgb(252,252,252)">
<p class="title" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-weight:bold">
Version information</p>
<span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" style="border:none; display:block; height:16px; margin:0px; padding:0px; text-indent:-999em; vertical-align:text-bottom; width:16px; position:absolute; left:10px; top:12px; color:rgb(74,103,133)"></span>
<div class="confluence-information-macro-body" style="margin:0px; padding:0px">
<h3 id="HBaseIntegration-AvroDataStoredinHBaseColumns" style="margin:0px; padding:0px; font-size:16px; line-height:1.5">
Avro Data Stored in HBase Columns</h3>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">
As of Hive 0.9.0 the HBase integration requires at least HBase 0.92, earlier versions of Hive were working with HBase 0.89/0.90</p>
</div>
</div>
<div class="confluence-information-macro confluence-information-macro-information" style="margin:10px 0px 1em; padding:10px 10px 10px 36px; border:1px solid rgb(170,184,198); color:rgb(51,51,51); min-height:20px; position:relative; font-family:Arial,sans-serif; font-size:14px; line-height:20px; background:rgb(252,252,252)">
<p class="title" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-weight:bold">
Version information</p>
<span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" style="border:none; display:block; height:16px; margin:0px; padding:0px; text-indent:-999em; vertical-align:text-bottom; width:16px; position:absolute; left:10px; top:12px; color:rgb(74,103,133)"></span>
<div class="confluence-information-macro-body" style="margin:0px; padding:0px">
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">
Hive 1.x will remain compatible with HBase 0.98.x and lower versions. Hive 2.x will be compatible with HBase 1.x and higher. (See <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-10990" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-10990</a> for
 details.) Consumers wanting to work with HBase 1.x using Hive 1.x will need to compile Hive 1.x stream code themselves.</p>
</div>
</div>
<h2 id="HBaseIntegration-Introduction" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Introduction</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
This page documents the Hive/HBase integration support originally introduced in <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-705" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-705</a>. This
 feature allows Hive QL statements to access <a target="_blank" href="http://hadoop.apache.org/hbase" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HBase</a> tables for both read (SELECT) and write (INSERT). It is
 even possible to combine access to HBase tables with native Hive tables via joins and unions.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
A presentation is available from the <a target="_blank" href="http://wiki.apache.org/hadoop/Hive/Presentations?action=AttachFile&amp;do=get&amp;target=HiveHBase-HUG10.ppt" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HBase
 HUG10 Meetup</a></p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
This feature is a work in progress, and suggestions for its improvement are very welcome.</p>
<h2 id="HBaseIntegration-StorageHandlers" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Storage Handlers</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Before proceeding, please read <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/StorageHandlers" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">StorageHandlers</a> for an overview of the generic storage handler framework on which
 HBase integration depends.</p>
<h2 id="HBaseIntegration-Usage" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Usage</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The storage handler is built as an independent module, <code>hive-hbase-handler-x.y.z.jar</code>, which must be available on the Hive client auxpath, along with HBase, Guava and ZooKeeper jars. It also requires the correct configuration property to be set in
 order to connect to the right HBase master. See <a target="_blank" href="http://hadoop.apache.org/hbase/docs/current/api/overview-summary.html#overview_description" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">the
 HBase documentation</a> for how to set up an HBase cluster.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's an example using CLI from a source build environment, targeting a single-node HBase server. (Note that the jar locations and names have changed in Hive 0.9.0, so for earlier releases, some changes are needed.)</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">$HIVE_SRC/build/dist/bin/hive --auxpath $HIVE_SRC/build/dist/lib/hive-hbase-handler-0.9.0.jar,$HIVE_SRC/build/dist/lib/hbase-0.92.0.jar,$HIVE_SRC/build/dist/lib/zookeeper-3.3.4.jar,$HIVE_SRC/build/dist/lib/guava-r09.jar --hiveconf hbase.master=hbase.yoyodyne.com:60000
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's an example which instead targets a distributed HBase cluster where a quorum of 3 zookeepers is used to elect the HBase master:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">$HIVE_SRC/build/dist/bin/hive --auxpath $HIVE_SRC/build/dist/lib/hive-hbase-handler-0.9.0.jar,$HIVE_SRC/build/dist/lib/hbase-0.92.0.jar,$HIVE_SRC/build/dist/lib/zookeeper-3.3.4.jar,$HIVE_SRC/build/dist/lib/guava-r09.jar --hiveconf hbase.zookeeper.quorum=zk1.yoyodyne.com,zk2.yoyodyne.com,zk3.yoyodyne.com
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The handler requires Hadoop 0.20 or higher, and has only been tested with dependency versions hadoop-0.20.x, hbase-0.92.0 and zookeeper-3.3.4. If you are not using hbase-0.92.0, you will need to rebuild the handler with the HBase jar matching your version,
 and change the <code>--auxpath</code> above accordingly. Failure to use matching versions will lead to misleading connection failures such as MasterNotRunningException since the HBase RPC protocol changes often.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
In order to create a new HBase table which is to be managed by Hive, use the <code>STORED BY</code> clause on <code>CREATE TABLE</code>:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(key int, value string) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf1:val")
TBLPROPERTIES ("hbase.table.name" = "xyz", "hbase.mapred.output.outputtable" = "xyz");
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The <code>hbase.columns.mapping</code> property is required and will be explained in the next section. The <code>hbase.table.name</code> property is optional; it controls the name of the table as known by HBase, and allows the Hive table to have a different
 name. In this example, the table is known as <code>hbase_table_1</code> within Hive, and as<code>xyz</code> within HBase. If not specified, then the Hive and HBase table names will be identical. The <code>hbase.mapred.output.outputtable</code> property is
 optional; it's needed if you plan to insert data to the table (the property is used by <code>hbase.mapreduce.TableOutputFormat</code>)</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
After executing the command above, you should be able to see the new (empty) table in the HBase shell:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">$ hbase shell
HBase Shell; enter 'help&lt;RETURN&gt;' for list of supported commands.
Version: 0.20.3, r902334, Mon Jan 25 13:13:08 PST 2010
hbase(main):001:0&gt; list
xyz                                                                                                           
1 row(s) in 0.0530 seconds
hbase(main):002:0&gt; describe "xyz"
DESCRIPTION                                                             ENABLED                               
 {NAME =&gt; 'xyz', FAMILIES =&gt; [{NAME =&gt; 'cf1', COMPRESSION =&gt; 'NONE', VE true                                  
 RSIONS =&gt; '3', TTL =&gt; '2147483647', BLOCKSIZE =&gt; '65536', IN_MEMORY =&gt;                                       
  'false', BLOCKCACHE =&gt; 'true'}]}                                                                            
1 row(s) in 0.0220 seconds
hbase(main):003:0&gt; scan "xyz"
ROW                          COLUMN+CELL                                                                      
0 row(s) in 0.0060 seconds
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Notice that even though a column name "val" is specified in the mapping, only the column family name "cf1" appears in the DESCRIBE output in the HBase shell. This is because in HBase, only column families (not columns) are known in the table-level metadata;
 column names within a column family are only present at the per-row level.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's how to move data from Hive into the HBase table (see <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/GettingStarted" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">GettingStarted</a> for how to create the example table <code>pokes</code> in
 Hive first):</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">INSERT OVERWRITE TABLE hbase_table_1 SELECT * FROM pokes WHERE foo=98;
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Use HBase shell to verify that the data actually got loaded:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">hbase(main):009:0&gt; scan "xyz"
ROW                          COLUMN+CELL                                                                      
 98                          column=cf1:val, timestamp=1267737987733, value=val_98                            
1 row(s) in 0.0110 seconds
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
And then query it back via Hive:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">hive&gt; select * from hbase_table_1;
Total MapReduce jobs = 1
Launching Job 1 out of 1
...
OK
98	val_98
Time taken: 4.582 seconds
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Inserting large amounts of data may be slow due to WAL overhead; if you would like to disable this, make sure you have HIVE-1383 (as of Hive 0.6), and then issue this command before the INSERT:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">set hive.hbase.wal.enabled=false;
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<strong>Warning:</strong> disabling WAL may lead to data loss if an HBase failure occurs, so only use this if you have some other recovery strategy available.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
If you want to give Hive access to an existing HBase table, use CREATE EXTERNAL TABLE:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE EXTERNAL TABLE hbase_table_2(key int, value string) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf1:val")
TBLPROPERTIES("hbase.table.name" = "some_existing_table", "hbase.mapred.output.outputtable" = "some_existing_table");
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Again, <code>hbase.columns.mapping</code> is required (and will be validated against the existing HBase table's column families), whereas <code>hbase.table.name</code> is optional. The <code>hbase.mapred.output.outputtable</code> is optional.</p>
<h2 id="HBaseIntegration-ColumnMapping" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Column Mapping</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
There are two <code>SERDEPROPERTIES</code> that control the mapping of HBase columns to Hive:</p>
<ul style="margin:10px 0px 0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<li><code>hbase.columns.mapping</code></li><li><code>hbase.table.default.storage.type</code>: Can have a value of either <code>string</code> (the default) or <code>binary</code>, this option is only available as of Hive 0.9 and the<code>string</code> behavior is the only one available in earlier versions</li></ul>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The column mapping support currently available is somewhat cumbersome and restrictive:</p>
<ul style="margin:10px 0px 0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<li>for each Hive column, the table creator must specify a corresponding entry in the comma-delimited <code>hbase.columns.mapping</code> string (so for a Hive table with <em>n</em> columns, the string should have <em>n</em> entries); whitespace should <strong>not</strong> be
 used in between entries since these will be interperted as part of the column name, which is almost certainly not what you want</li><li>a mapping entry must be either <code>:key</code> or of the form <code>column-family-name:[column-name][#(binary|string)</code> (the type specification that delimited by <em>#</em>was added in Hive <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-1634" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">0.9.0</a>,
 earlier versions interpreted everything as strings)
<ul style="margin:0px; list-style-type:disc">
<li>If no type specification is given the value from <code>hbase.table.default.storage.type</code> will be used</li><li>Any prefixes of the valid values are valid too (i.e. <code>#b</code> instead of <code>#binary</code>)</li><li>If you specify a column as <code>binary</code> the bytes in the corresponding HBase cells are expected to be of the form that HBase's <code>Bytes</code> class yields.</li></ul>
</li><li>there must be exactly one <code>:key</code> mapping (this can be mapped either to a string or struct column–see <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-SimpleCompositeRowKeys" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Simple
 Composite Keys</a> and <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration#HBaseIntegration-ComplexCompositeRowKeysandHBaseKeyFactory" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Complex Composite Keys</a>)</li><li>(note that before <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-1228" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-1228</a> in Hive 0.6, <code>:key</code> was not supported, and the
 first Hive column implicitly mapped to the key; as of Hive 0.6, it is now strongly recommended that you always specify the key explictly; we will drop support for implicit key mapping in the future)</li><li>if no column-name is given, then the Hive column will map to all columns in the corresponding HBase column family, and the Hive MAP datatype must be used to allow access to these (possibly sparse) columns</li><li>there is currently no way to access the HBase timestamp attribute, and queries always access data with the latest timestamp.</li><li>Since HBase does not associate datatype information with columns, the serde converts everything to string representation before storing it in HBase; there is currently no way to plug in a custom serde per column</li><li>it is not necessary to reference every HBase column family, but those that are not mapped will be inaccessible via the Hive table; it's possible to map multiple Hive tables to the same HBase table</li></ul>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The next few sections provide detailed examples of the kinds of column mappings currently possible.</p>
<h3 id="HBaseIntegration-MultipleColumnsandFamilies" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Multiple Columns and Families</h3>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's an example with three Hive columns and two HBase column families, with two of the Hive columns (<code>value1</code> and <code>value2</code>) corresponding to one of the column families (<code>a</code>, with HBase column names <code>b</code> and <code>c</code>),
 and the other Hive column corresponding to a single column (<code>e</code>) in its own column family (<code>d</code>).</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(key int, value1 string, value2 int, value3 int) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = ":key,a:b,a:c,d:e"
);
INSERT OVERWRITE TABLE hbase_table_1 SELECT foo, bar, foo+1, foo+2 
FROM pokes WHERE foo=98 OR foo=100;
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's how this looks in HBase:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">hbase(main):014:0&gt; describe "hbase_table_1"
DESCRIPTION                                                             ENABLED                               
 {NAME =&gt; 'hbase_table_1', FAMILIES =&gt; [{NAME =&gt; 'a', COMPRESSION =&gt; 'N true                                  
 ONE', VERSIONS =&gt; '3', TTL =&gt; '2147483647', BLOCKSIZE =&gt; '65536', IN_M                                       
 EMORY =&gt; 'false', BLOCKCACHE =&gt; 'true'}, {NAME =&gt; 'd', COMPRESSION =&gt;                                        
 'NONE', VERSIONS =&gt; '3', TTL =&gt; '2147483647', BLOCKSIZE =&gt; '65536', IN                                       
 _MEMORY =&gt; 'false', BLOCKCACHE =&gt; 'true'}]}                                                                  
1 row(s) in 0.0170 seconds
hbase(main):015:0&gt; scan "hbase_table_1"
ROW                          COLUMN+CELL                                                                      
 100                         column=a:b, timestamp=1267740457648, value=val_100                               
 100                         column=a:c, timestamp=1267740457648, value=101                                   
 100                         column=d:e, timestamp=1267740457648, value=102                                   
 98                          column=a:b, timestamp=1267740457648, value=val_98                                
 98                          column=a:c, timestamp=1267740457648, value=99                                    
 98                          column=d:e, timestamp=1267740457648, value=100                                   
2 row(s) in 0.0240 seconds
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
And when queried back into Hive:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">hive&gt; select * from hbase_table_1;
Total MapReduce jobs = 1
Launching Job 1 out of 1
...
OK
100	val_100	101	102
98	val_98	99	100
Time taken: 4.054 seconds
</pre>
</div>
</div>
<h3 id="HBaseIntegration-HiveMAPtoHBaseColumnFamily" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Hive MAP to HBase Column Family</h3>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's how a Hive MAP datatype can be used to access an entire column family. Each row can have a different set of columns, where the column names correspond to the map keys and the column values correspond to the map values.</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(value map&lt;string,int&gt;, row_key int) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = "cf:,:key"
);
INSERT OVERWRITE TABLE hbase_table_1 SELECT map(bar, foo), foo FROM pokes 
WHERE foo=98 OR foo=100;
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
(This example also demonstrates using a Hive column other than the first as the HBase row key.)</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Here's how this looks in HBase (with different column names in different rows):</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">hbase(main):012:0&gt; scan "hbase_table_1"
ROW                          COLUMN+CELL                                                                      
 100                         column=cf:val_100, timestamp=1267739509194, value=100                            
 98                          column=cf:val_98, timestamp=1267739509194, value=98                              
2 row(s) in 0.0080 seconds
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
And when queried back into Hive:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">hive&gt; select * from hbase_table_1;
Total MapReduce jobs = 1
Launching Job 1 out of 1
...
OK
{"val_100":100}	100
{"val_98":98}	98
Time taken: 3.808 seconds
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Note that the key of the MAP must have datatype string, since it is used for naming the HBase column, so the following table definition will fail:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(key int, value map&lt;int,int&gt;) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = ":key,cf:"
);
FAILED: Error in metadata: java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException org.apache.hadoop.hive.hbase.HBaseSerDe: hbase column family 'cf:' should be mapped to map&lt;string,?&gt; but is mapped to map&lt;int,int&gt;)
</pre>
</div>
</div>
<h3 id="HBaseIntegration-HiveMAPtoHBaseColumnPrefix" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Hive MAP to HBase Column Prefix</h3>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Also note that starting with <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-3725" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">Hive 0.12</a>, wildcards can also be used to retrieve columns. For
 instance, if you want to retrieve all columns in HBase that start with the prefix "col_prefix", a query like the following should work:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(value map&lt;string,int&gt;, row_key int) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = "cf:col_prefix.*,:key"
);
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The same restrictions apply though. That is, the key of the map should be a string as it maps to the HBase column name and the value can be the type of value that you are retrieving. One other restriction is that all the values under the given prefix should
 be of the same type. That is, all of them should be of type "int" or type "string" and so on.</p>
<h4 id="HBaseIntegration-HidingColumnPrefixes" style="margin:20px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:14px; line-height:20px; font-family:Arial,sans-serif">
Hiding Column Prefixes</h4>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Starting with <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-11329" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">Hive 1.3.0</a>, it is possible to hide column prefixes in select query results.
  There is the SerDe boolean property hbase.columns.mapping.prefix.hide (false by default), which defines if the prefix should be hidden in keys of Hive map:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(tags map&lt;string,int&gt;, row_key string) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = "cf:tag_.*,:key",
"hbase.columns.mapping.prefix.hide" = "true"
);</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Then a value of the column "tags" (<code>select tags from hbase_table_1</code>) will be:</p>
<pre style="margin-top:10px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; color:rgb(51,51,51); font-size:14px; line-height:20px; background-color:rgb(255,255,255)">"x" : 1</pre>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
instead of:</p>
<pre style="margin-top:10px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; color:rgb(51,51,51); font-size:14px; line-height:20px; background-color:rgb(255,255,255)">"tag_x" : 1</pre>
<h3 id="HBaseIntegration-Illegal:HivePrimitivetoHBaseColumnFamily" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Illegal: Hive Primitive to HBase Column Family</h3>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Table definitions such as the following are illegal because a<br>
Hive column mapped to an entire column family must have MAP type:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1(key int, value string) 
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = ":key,cf:"
);
FAILED: Error in metadata: java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException org.apache.hadoop.hive.hbase.HBaseSerDe: hbase column family 'cf:' should be mapped to map&lt;string,?&gt; but is mapped to string)
</pre>
</div>
</div>
<h3 id="HBaseIntegration-ExamplewithBinaryColumns" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Example with Binary Columns</h3>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Relying on the default value of <code>hbase.table.default.storage.type</code>:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1 (key int, value string, foobar double)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = ":key#b,cf:val,cf:foo#b"
);
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Specifying <code>hbase.table.default.storage.type</code>:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE hbase_table_1 (key int, value string, foobar double)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = ":key,cf:val#s,cf:foo",
"hbase.table.default.storage.type" = "binary"
);
</pre>
</div>
</div>
<h3 id="HBaseIntegration-SimpleCompositeRowKeys" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Simple Composite Row Keys</h3>
<div class="confluence-information-macro confluence-information-macro-information" style="margin:10px 0px 1em; padding:10px 10px 10px 36px; border:1px solid rgb(170,184,198); color:rgb(51,51,51); min-height:20px; position:relative; font-family:Arial,sans-serif; font-size:14px; line-height:20px; background:rgb(252,252,252)">
<p class="title" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-weight:bold">
Version information</p>
<span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" style="border:none; display:block; height:16px; margin:0px; padding:0px; text-indent:-999em; vertical-align:text-bottom; width:16px; position:absolute; left:10px; top:12px; color:rgb(74,103,133)"></span>
<div class="confluence-information-macro-body" style="margin:0px; padding:0px">
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">
As of <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-2599" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">Hive 0.13.0</a></p>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Hive can read and write delimited composite keys to HBase by mapping the HBase row key to a Hive struct, and using ROW FORMAT DELIMITED...COLLECTION ITEMS TERMINATED BY. Example:</p>
<div class="code panel pdl" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="codeContent panelContent pdl" style="margin:0px; padding:0px; overflow:hidden">
<div style="margin:0px; padding:0px">
<div id="highlighter_760756" class="syntaxhighlighter nogutter  java" style="padding:0px; width:981px; margin:0px!important; position:relative!important; overflow:auto!important; font-size:1em!important">
<table border="0" cellpadding="0" cellspacing="0" style="width:981px; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:20px!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<tbody style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<tr style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<td class="code" style="width:966px; border:0px!important; overflow:visible!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; padding:0px 0px 0px 15px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<div class="container" title="Hint: double-click to select code" style="margin:15px 0px 0px!important; padding:0px 0px 15px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:pre-wrap!important; background:none!important">
<div class="line number1 index0 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">--
 Create a table with a composite row key consisting of two string fields, delimited by </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'~'</code></div>
<div class="line number2 index1 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">CREATE
 EXTERNAL TABLE delimited_example(key struct&lt;f1:string, f2:string&gt;, value string) </code></div>
<div class="line number3 index2 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">ROW
 FORMAT DELIMITED </code></div>
<div class="line number4 index3 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">COLLECTION
 ITEMS TERMINATED BY </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'~'</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important"> </code></div>
<div class="line number5 index4 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">STORED
 BY </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important"> </code></div>
<div class="line number6 index5 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">WITH
 SERDEPROPERTIES (</code></div>
<div class="line number7 index6 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">  </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'hbase.columns.mapping'</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">=</code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">':key,f:c1'</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">);</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<h3 id="HBaseIntegration-ComplexCompositeRowKeysandHBaseKeyFactory" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Complex Composite Row Keys and HBaseKeyFactory</h3>
<div class="confluence-information-macro confluence-information-macro-information" style="margin:10px 0px 1em; padding:10px 10px 10px 36px; border:1px solid rgb(170,184,198); color:rgb(51,51,51); min-height:20px; position:relative; font-family:Arial,sans-serif; font-size:14px; line-height:20px; background:rgb(252,252,252)">
<span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" style="border:none; display:block; height:16px; margin:0px; padding:0px; text-indent:-999em; vertical-align:text-bottom; width:16px; position:absolute; left:10px; top:12px; color:rgb(74,103,133)"></span>
<div class="confluence-information-macro-body" style="margin:0px; padding:0px">
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">
As of Hive 0.14.0 with <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-6411" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-6411</a> (0.13.0 also supports complex composite keys, but using a
 different interface–see <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-2599" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-2599</a> for that interface)</p>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
For more complex use cases, Hive allows users to specify an HBaseKeyFactory which defines the mapping of a key to fields in a Hive struct. <span style="line-height:1.42857">This can be configured using the property "hbase.composite.key.factory" in the SERDEPROPERTIES
 option:</span></p>
<div class="code panel pdl" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="codeContent panelContent pdl" style="margin:0px; padding:0px; overflow:hidden">
<div style="margin:0px; padding:0px">
<div id="highlighter_312400" class="syntaxhighlighter nogutter  java" style="padding:0px; width:981px; margin:0px!important; position:relative!important; overflow:auto!important; font-size:1em!important">
<table border="0" cellpadding="0" cellspacing="0" style="width:1037px; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:20px!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<tbody style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<tr style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<td class="code" style="width:1022px; border:0px!important; overflow:visible!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; padding:0px 0px 0px 15px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<div class="container" title="Hint: double-click to select code" style="margin:15px 0px 0px!important; padding:0px 0px 15px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:pre-wrap!important; background:none!important">
<div class="line number1 index0 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">--
 Parse a row key with </code><code class="java value" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:rgb(0,153,0)!important; background:none!important">3</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">fixed
 width fields each of width </code><code class="java value" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:rgb(0,153,0)!important; background:none!important">10</code></div>
<div class="line number2 index1 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">--
 Example taken from: https:</code><code class="java comments" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:rgb(0,130,0)!important; background:none!important">//svn.apache.org/repos/asf/hive/trunk/hbase-handler/src/test/queries/positive/hbase_custom_key2.q</code></div>
<div class="line number3 index2 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">CREATE
 TABLE hbase_ck_4(key struct&lt;col1:string,col2:string,col3:string&gt;, value string)</code></div>
<div class="line number4 index3 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">STORED
 BY </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</code></div>
<div class="line number5 index4 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">WITH
 SERDEPROPERTIES (</code></div>
<div class="line number6 index5 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.table.name"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase_custom2"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number7 index6 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.mapred.output.outputtable"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase_custom2"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number8 index7 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.columns.mapping"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">":key,cf:string"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number9 index8 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.composite.key.factory"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">=</code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"org.apache.hadoop.hive.hbase.SampleHBaseKeyFactory2"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">);</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
"hbase.composite.key.factory" should be the fully qualified class name of a class implementing <a target="_blank" href="http://hive.apache.org/javadocs/r1.2.0/api/org/apache/hadoop/hive/hbase/HBaseKeyFactory.html" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HBaseKeyFactory</a>.
 See <a target="_blank" href="https://svn.apache.org/repos/asf/hive/trunk/hbase-handler/src/test/org/apache/hadoop/hive/hbase/SampleHBaseKeyFactory2.java" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">SampleHBaseKeyFactory2</a> for
 a fixed length example in the same package. This class must be on your classpath in order for the above example to work. TODO: place these in an accessible place; they're currently only in test code.</p>
<h3 id="HBaseIntegration-AvroDataStoredinHBaseColumns.1" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:16px; line-height:1.5; font-family:Arial,sans-serif">
Avro Data Stored in HBase Columns</h3>
<div class="confluence-information-macro confluence-information-macro-information" style="margin:10px 0px 1em; padding:10px 10px 10px 36px; border:1px solid rgb(170,184,198); color:rgb(51,51,51); min-height:20px; position:relative; font-family:Arial,sans-serif; font-size:14px; line-height:20px; background:rgb(252,252,252)">
<span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" style="border:none; display:block; height:16px; margin:0px; padding:0px; text-indent:-999em; vertical-align:text-bottom; width:16px; position:absolute; left:10px; top:12px; color:rgb(74,103,133)"></span>
<div class="confluence-information-macro-body" style="margin:0px; padding:0px">
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">
As of Hive 0.14.0 with <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-6147" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-6147</a></p>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Hive 0.14.0 onward supports storing and querying Avro objects in HBase columns by making them visible as structs to Hive. This allows Hive to perform ad hoc analysis of HBase data which can be deeply structured. Prior to 0.14.0, the HBase Hive integration only
 supported querying primitive data types in columns.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
An example HiveQL statement where <code>test_col_fam</code> is the column family and <code>test_col</code> is the column name:</p>
<div class="code panel pdl" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="codeContent panelContent pdl" style="margin:0px; padding:0px; overflow:hidden">
<div style="margin:0px; padding:0px">
<div id="highlighter_658479" class="syntaxhighlighter nogutter  java" style="padding:0px; width:981px; margin:0px!important; position:relative!important; overflow:auto!important; font-size:1em!important">
<table border="0" cellpadding="0" cellspacing="0" style="width:981px; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:20px!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<tbody style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<tr style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<td class="code" style="width:966px; border:0px!important; overflow:visible!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; padding:0px 0px 0px 15px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<div class="container" title="Hint: double-click to select code" style="margin:15px 0px 0px!important; padding:0px 0px 15px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:pre-wrap!important; background:none!important">
<div class="line number1 index0 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">CREATE
 EXTERNAL TABLE test_hbase_avro</code></div>
<div class="line number2 index1 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">ROW
 FORMAT SERDE </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'org.apache.hadoop.hive.hbase.HBaseSerDe'</code></div>
<div class="line number3 index2 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">STORED
 BY </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">'org.apache.hadoop.hive.hbase.HBaseStorageHandler'</code></div>
<div class="line number4 index3 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">WITH
 SERDEPROPERTIES (</code></div>
<div class="line number5 index4 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.columns.mapping"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">":key,test_col_fam:test_col"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number6 index5 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"test_col_fam.test_col.serialization.type"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"avro"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number7 index6 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"test_col_fam.test_col.avro.schema.url"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hdfs://testcluster/tmp/schema.avsc"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">)</code></div>
<div class="line number8 index7 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">TBLPROPERTIES
 (</code></div>
<div class="line number9 index8 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.table.name"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase_avro_table"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number10 index9 alt1" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.mapred.output.outputtable"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase_avro_table"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">,</code></div>
<div class="line number11 index10 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java spaces" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">    </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.struct.autogenerate"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">=</code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"true"</code><code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">);</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The important properties to note are the following three:</p>
<div class="code panel pdl" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="codeContent panelContent pdl" style="margin:0px; padding:0px; overflow:hidden">
<div style="margin:0px; padding:0px">
<div id="highlighter_440375" class="syntaxhighlighter nogutter  java" style="padding:0px; width:981px; margin:0px!important; position:relative!important; overflow:auto!important; font-size:1em!important">
<table border="0" cellpadding="0" cellspacing="0" style="width:981px; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:20px!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<tbody style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<tr style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<td class="code" style="width:966px; border:0px!important; overflow:visible!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; padding:0px 0px 0px 15px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<div class="container" title="Hint: double-click to select code" style="margin:15px 0px 0px!important; padding:0px 0px 15px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:pre-wrap!important; background:none!important">
<div class="line number1 index0 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"test_col_fam.test_col.serialization.type"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"avro"</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
This property tells Hive that the given column under the given column family is an Avro column, so Hive needs to deserialize it accordingly.</p>
<div class="code panel pdl" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="codeContent panelContent pdl" style="margin:0px; padding:0px; overflow:hidden">
<div style="margin:0px; padding:0px">
<div id="highlighter_27967" class="syntaxhighlighter nogutter  java" style="padding:0px; width:981px; margin:0px!important; position:relative!important; overflow:auto!important; font-size:1em!important">
<table border="0" cellpadding="0" cellspacing="0" style="width:981px; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:20px!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<tbody style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<tr style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<td class="code" style="width:966px; border:0px!important; overflow:visible!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; padding:0px 0px 0px 15px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<div class="container" title="Hint: double-click to select code" style="margin:15px 0px 0px!important; padding:0px 0px 15px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:pre-wrap!important; background:none!important">
<div class="line number1 index0 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"test_col_fam.test_col.avro.schema.url"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hdfs://testcluster/tmp/schema.avsc"</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Using this property you specify where the reader schema is for the column that will be used to deserialize. This can be on HDFS like mentioned here, or provided inline using something like <code>"test_col_fam.test_col.avro.schema.literal"</code> property. If
 you have a custom store where you store this schema, you can write a custom implementation of <a target="_blank" href="https://github.com/apache/hive/blob/master/serde/src/java/org/apache/hadoop/hive/serde2/avro/AvroSchemaRetriever.java" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">AvroSchemaRetriever</a> and
 plug that in using the <code>"avro.schema.retriever property"</code> using a property like<code>"test_col_fam.test_col.avro.schema.retriever"</code>. You would need to ensure that the jar with this custom class is on the Hive classpath. For a usage discussion
 and links to other resources, see <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-6147?focusedCommentId=15125117&amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15125117" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HIVE-6147</a>.</p>
<div class="code panel pdl" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="codeContent panelContent pdl" style="margin:0px; padding:0px; overflow:hidden">
<div style="margin:0px; padding:0px">
<div id="highlighter_133608" class="syntaxhighlighter nogutter  java" style="padding:0px; width:981px; margin:0px!important; position:relative!important; overflow:auto!important; font-size:1em!important">
<table border="0" cellpadding="0" cellspacing="0" style="width:981px; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; line-height:20px!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<tbody style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<tr style="border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">
<td class="code" style="width:966px; border:0px!important; overflow:visible!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; padding:0px 0px 0px 15px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; font-size:14px!important; min-height:auto!important; background:none!important">
<div class="container" title="Hint: double-click to select code" style="margin:15px 0px 0px!important; padding:0px 0px 15px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:relative!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:pre-wrap!important; background:none!important">
<div class="line number1 index0 alt2" style="margin:0px!important; padding:0px 1em 0px 0px!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; outline:0px!important; overflow:visible!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; white-space:nowrap!important">
<code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"hbase.struct.autogenerate"</code> <code class="java plain" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; background:none!important">= </code><code class="java string" style="font-family:Consolas,'Bitstream Vera Sans Mono','Courier New',Courier,monospace!important; border:0px!important; bottom:auto!important; float:none!important; height:auto!important; left:auto!important; margin:0px!important; outline:0px!important; overflow:visible!important; padding:0px!important; position:static!important; right:auto!important; top:auto!important; vertical-align:baseline!important; width:auto!important; min-height:auto!important; color:blue!important; background:none!important">"true"</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Specifying this property lets Hive auto-deduce the columns and types using the schema that was provided. This allows you to avoid manually creating the columns and types for Avro schemas, which can be complicated and deeply nested.</p>
<h2 id="HBaseIntegration-PutTimestamps" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Put Timestamps</h2>
<div class="confluence-information-macro confluence-information-macro-information" style="margin:10px 0px 1em; padding:10px 10px 10px 36px; border:1px solid rgb(170,184,198); color:rgb(51,51,51); min-height:20px; position:relative; font-family:Arial,sans-serif; font-size:14px; line-height:20px; background:rgb(252,252,252)">
<p class="title" style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; font-weight:bold">
Version information</p>
<span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" style="border:none; display:block; height:16px; margin:0px; padding:0px; text-indent:-999em; vertical-align:text-bottom; width:16px; position:absolute; left:10px; top:12px; color:rgb(74,103,133)"></span>
<div class="confluence-information-macro-body" style="margin:0px; padding:0px">
<p style="margin-top:0px; margin-bottom:0px; padding-top:0px; padding-bottom:0px">
As of Hive <a target="_blank" href="https://issues.apache.org/jira/browse/HIVE-2781" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">0.9.0</a></p>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
If inserting into a HBase table using Hive the HBase default timestamp is added which is usually the current timestamp. This can be overridden on a per-table basis using the <code>SERDEPROPERTIES</code> option <code>hbase.put.timestamp</code> which must be
 a valid timestamp or <code>-1</code> to reenable the default strategy.</p>
<h2 id="HBaseIntegration-KeyUniqueness" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Key Uniqueness</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
One subtle difference between HBase tables and Hive tables is that HBase tables have a unique key, whereas Hive tables do not. When multiple rows with the same key are inserted into HBase, only one of them is stored (the choice is arbitrary, so do not rely
 on HBase to pick the right one). This is in contrast to Hive, which is happy to store multiple rows with the same key and different values.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
For example, the pokes table contains rows with duplicate keys. If it is copied into another Hive table, the duplicates are preserved:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE pokes2(foo INT, bar STRING);
INSERT OVERWRITE TABLE pokes2 SELECT * FROM pokes;
-- this will return 3
SELECT COUNT(1) FROM POKES WHERE foo=498;
-- this will also return 3
SELECT COUNT(1) FROM pokes2 WHERE foo=498;
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
But in HBase, the duplicates are silently eliminated:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">CREATE TABLE pokes3(foo INT, bar STRING)
STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
WITH SERDEPROPERTIES (
"hbase.columns.mapping" = ":key,cf:bar"
);
INSERT OVERWRITE TABLE pokes3 SELECT * FROM pokes;
-- this will return 1 instead of 3
SELECT COUNT(1) FROM pokes3 WHERE foo=498;
</pre>
</div>
</div>
<h2 id="HBaseIntegration-Overwrite" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Overwrite</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Another difference to note between HBase tables and other Hive tables is that when INSERT OVERWRITE is used, existing rows are not deleted from the table. However, existing rows <strong>are</strong> overwritten if they have keys which match new rows.</p>
<h2 id="HBaseIntegration-PotentialFollowups" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Potential Followups</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
There are a number of areas where Hive/HBase integration could definitely use more love:</p>
<ul style="margin:10px 0px 0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<li>more flexible column mapping (HIVE-806, HIVE-1245)</li><li>default column mapping in cases where no mapping spec is given</li><li>filter pushdown and indexing (see <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/FilterPushdownDev" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">FilterPushdownDev</a> and <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/IndexDev" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">IndexDev</a>)</li><li>expose timestamp attribute, possibly also with support for treating it as a partition key</li><li>allow per-table hbase.master configuration</li><li>run profiler and minimize any per-row overhead in column mapping</li><li>user defined routines for lookups and data loads via HBase client API (HIVE-758 and HIVE-791)</li><li>logging is very noisy, with a lot of spurious exceptions; investigate these and either fix their cause or squelch them</li></ul>
<h2 id="HBaseIntegration-Build" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Build</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Code for the storage handler is located under <code>hive/trunk/hbase-handler</code>.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
HBase and Zookeeper dependencies are fetched via ivy.</p>
<h2 id="HBaseIntegration-Tests" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Tests</h2>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Class-level unit tests are provided under <code>hbase-handler/src/test/org/apache/hadoop/hive/hbase</code>.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
Positive QL tests are under <code>hbase-handler/src/test/queries</code>. These use a HBase+Zookeeper mini-cluster for hosting the fixture tables in-process, so no free-standing HBase installation is needed in order to run them. To avoid failures due to port
 conflicts, don't try to run these tests on the same machine where a real HBase master or zookeeper is running.</p>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
The QL tests can be executed via ant like this:</p>
<div class="preformatted panel" style="margin:10px 0px; padding:0px; color:rgb(51,51,51); border:1px solid rgb(204,204,204); overflow:auto; font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<div class="preformattedContent panelContent" style="margin:0px; padding:10px">
<pre style="margin-top:0px; margin-bottom:0px; padding:0px; font-family:ConfluenceInstalledFont,monospace; line-height:1.3">ant test -Dtestcase=TestHBaseCliDriver -Dqfile=hbase_queries.q
</pre>
</div>
</div>
<p style="margin-top:10px; margin-bottom:0px; padding-top:0px; padding-bottom:0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
An Eclipse launch template remains to be defined.</p>
<h2 id="HBaseIntegration-Links" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Links</h2>
<ul style="margin:10px 0px 0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<li>For information on how to bulk load data from Hive into HBase, see <a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/HBaseBulkLoad" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">HBaseBulkLoad</a>.</li><li>For another project which adds SQL-like query language support on top of HBase, see <a target="_blank" href="http://www.hbql.com/" rel="nofollow" class="external-link" style="color:rgb(53,114,176); text-decoration:none">HBQL</a> (unrelated to Hive).</li></ul>
<h2 id="HBaseIntegration-Acknowledgements" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; border-bottom-color:rgb(204,204,204); font-family:Arial,sans-serif">
Acknowledgements</h2>
<ul style="margin:10px 0px 0px; color:rgb(51,51,51); font-family:Arial,sans-serif; font-size:14px; line-height:20px">
<li>Primary credit for this feature goes to Samuel Guo, who did most of the development work in the early drafts of the patch</li></ul>
            </div>
                </div>