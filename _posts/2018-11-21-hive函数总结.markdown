---
layout:     post
title:      hive函数总结
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<div class="postbody" style="font-family:Verdana,Arial,Helvetica,sans-serif; font-size:14px">
<div id="cnblogs_post_body" style="margin-bottom:20px; word-break:break-word">
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
<strong>hive函数的分类</strong></h3>
<p style="margin:10px auto"><strong><img title="" src="https://img-blog.csdn.net/20150719123618713" alt="技术分享" style="border:0px; max-width:900px"></strong></p>
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
<strong>hive的客户端</strong></h3>
<p style="margin:10px auto"><strong>显示当前会话有多少函数可用 <br>
<code>SHOW FUNCTIONS;</code></strong></p>
<p style="margin:10px auto"><strong>如：</strong></p>
<div><img alt="" style="border:0px; max-width:900px">
<div>hive&gt; show functions ;<br>
OK<br>
!<br>
!=<br>
%</div>
<div> </div>
<div><span id="Label3">显示函数的描述信息 <br>
<code>DESC FUNCTION concat;</code></span></div>
<div>如：</div>
<div>hive&gt; DESC FUNCTION concat;<br>
OK<br>
concat(str1, str2, ... strN) - returns the concatenation of str1, str2, ... strN or concat(bin1, bin2, ... binN) - returns the concatenation of bytes in binary data  bin1, bin2, ... binN<br>
Time taken: 0.005 seconds, Fetched: 1 row(s)</div>
<div> </div>
<div><span id="Label3">显示函数的扩展描述信息 <br>
<code>DESC FUNCTION EXTENDED concat;</code></span></div>
</div>
<h3 id="简单函数" style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
<strong>一.简单函数</strong></h3>
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
1.数学函数</h3>
<p style="margin:10px auto"> <strong>返回对a四舍五入的BIGINT值</strong></p>
<p style="margin:10px auto"> </p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select round(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 3.0
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.093 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>返回DOUBLE型d的保留n位小数的DOUBLW型的近似值 round(DOUBLE a, INT d)</strong></p>
<p style="margin:10px auto"> </p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select round(0.5002,2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 0.5
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.074 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>银行家舍入法（1~4：舍，6~9：进，5-&gt;前位数是偶：舍，5-&gt;前位数是奇：进） bround(DOUBLE a)<br>
</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'>返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span><span style="line-height:1.5!important">
bround(</span>2.5) = 2, bround(3.5) = 4.</pre>
</div>
<p style="margin:10px auto"><strong>银行家舍入法,保留d位小数</strong> bround(DOUBLE a, INT d)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> bround(8.25, 1) = 8.2, bround(8.35, 1) = 8.4</pre>
</div>
<p style="margin:10px auto"><strong>向下取整，最数轴上最接近要求的值的左边的值  如：6.10-&gt;6   -3.4-&gt;-4 floor(DOUBLE a)<br>
</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select floor(6.10<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 6
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.07 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> hive&gt; select floor(-3.4<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">8</span> -4
<span style="color:rgb(0,128,128); line-height:1.5!important">9</span> Time taken: 0.104 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>求其不小于小给定实数的最小整数如：ceil(6) = ceil(6.1)= ceil(6.9) = 6 ceil(DOUBLE a), ceiling(DOUBLE a)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">返回值：BIGINT
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> hive&gt; select ceil(6<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> 6
<span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> Time taken: 0.2 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> hive&gt; select ceil(6.1<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> 7
<span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> Time taken: 0.061 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> hive&gt; select ceil(6.9<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> 7
<span style="color:rgb(0,128,128); line-height:1.5!important">13</span> Time taken: 0.153 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>每行返回一个DOUBLE型随机数seed是随机因子</strong> rand(), rand(INT seed)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：DOUBLE
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select rand(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 0.7311469360199058
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.068 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> hive&gt;<span style="line-height:1.5!important"> select rand();
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">8</span> 0.7859071491095923
<span style="color:rgb(0,128,128); line-height:1.5!important">9</span> Time taken: 0.064 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>返回e的a幂次方， a可为小数</strong> exp(DOUBLE a), exp(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select exp(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 7.38905609893065
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.1 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"> <strong>以自然数为底d的对数，a可为小数</strong> ln(DOUBLE a), ln(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">ln(DOUBLE a), ln(DECIMAL a)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span>    &gt; select ln(3<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> 1.0986122886681098
<span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> Time taken: 0.081 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> hive&gt; select ln(3.2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> 1.1631508098056809
<span style="color:rgb(0,128,128); line-height:1.5!important">10</span> Time taken: 0.067 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>以10为底d的对数，a可为小数</strong> log10(DOUBLE a), log10(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select log10(3.2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 0.505149978319906
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.084 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> hive&gt; select log10(3<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">8</span> 0.47712125471966244
<span style="color:rgb(0,128,128); line-height:1.5!important">9</span> Time taken: 0.075 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"> <strong>以2为底数d的对数，a可为小数</strong>  log2(DOUBLE a), log2(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> hive&gt; 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span>     &gt; select log2(3<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> 1.5849625007211563
<span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> Time taken: 0.083 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> hive&gt; select log2(3.2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> 1.6780719051126378
<span style="color:rgb(0,128,128); line-height:1.5!important">10</span> Time taken: 0.07 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>以base为底的对数，base 与 a都是DOUBLE类型</strong></p>
<p style="margin:10px auto">log(DOUBLE base, DOUBLE a)</p>
<p style="margin:10px auto">log(DECIMAL base, DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select log(2,3.2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 1.6780719051126378
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.084 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> hive&gt; select log(2,3<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">8</span> 1.5849625007211563
<span style="color:rgb(0,128,128); line-height:1.5!important">9</span> Time taken: 0.066 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>计算a的p次幂</strong> pow(DOUBLE a, DOUBLE p), power(DOUBLE a, DOUBLE p)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值:<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select pow(2,4<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 16.0
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.065 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>计算a的平方根</strong> sqrt(DOUBLE a), sqrt(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> select sqrt(2);</pre>
</div>
<p style="margin:10px auto"><strong>计算二进制a的STRING类型，a为BIGINT类型</strong> bin(BIGINT a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="line-height:1.5!important">返回值：string
hive</span>&gt; select bin(2<span style="line-height:1.5!important">);
OK
</span>10<span style="line-height:1.5!important">
Time taken: </span>0.194 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>计算十六进制a的STRING类型，如果a为STRING类型就转换成字符相对应的十六进制 hex(BIGINT a) hex(STRING a) hex(BINARY a)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：STRING
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select hex(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.097 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>hex的逆方法</strong></p>
<p style="margin:10px auto">unhex(STRING a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：BINARY
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select unhex(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="line-height:1.5!important">
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.077 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>将GIGINT/STRING类型的num从from_base进制转换成to_base进制</strong> conv(BIGINT num, INT from_base, INT to_base), conv(STRING num, INT from_base, INT to_base)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：STRING
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select conv(2,10,2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 10
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.075 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>计算a的绝对值</strong> abs(DOUBLE a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：DOUBLE
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select abs(-2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.077 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>a对b取模</strong> pmod(INT a, INT b), pmod(DOUBLE a, DOUBLE b)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select pmod(4,2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 0
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.077 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求a的正弦值</strong> sin(DOUBLE a), sin(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select sin(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 0.5984721441039564
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.092 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求d的反正弦值</strong> asin(DOUBLE a), asin(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select asin(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="line-height:1.5!important">NaN
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.097 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求余弦值</strong> cos(DOUBLE a), cos(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select cos(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> -0.8011436155469337
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.087 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求反余弦值</strong> acos(DOUBLE a), acos(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select acos(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="line-height:1.5!important">NaN
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.091 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求正切值</strong> tan(DOUBLE a), tan(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select tan(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> -0.7470222972386603
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.076 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求反正切值</strong> atan(DOUBLE a), atan(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select atan(2.5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 1.1902899496825317
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.074 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>奖弧度值转换角度值 degrees(DOUBLE a), degrees(DECIMAL a)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：DOUBLE
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select degrees(30<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 1718.8733853924698
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.114 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>将角度值转换成弧度值</strong> radians(DOUBLE a), radians(DOUBLE a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select radians(30<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 0.5235987755982988
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.093 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>返回a</strong> positive(INT a), positive(DOUBLE a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：INT or DOUBLE
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select positive(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.124 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>返回a的相反数</strong> negative(INT a), negative(DOUBLE a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select negative(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> -2
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.066 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>如果a是正数则返回1.0，是负数则返回-1.0，否则返回0.0</strong> sign(DOUBLE a), sign(DECIMAL a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：DOUBLE or INT
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select sign(2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 1.0
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.091 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>数学常数e</strong> e()</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select e();
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2.718281828459045
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.07 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>数学常数pi pi()</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select pi();
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 3.141592653589793
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.082 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求a的阶乘</strong> factorial(INT a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：BIGINT
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> select  factorial(2);</pre>
</div>
<p style="margin:10px auto"><strong>求a的立方根</strong> cbrt(DOUBLE a)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：DOUBLE
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> select cbrt(2);</pre>
</div>
<p style="margin:10px auto"><strong>按位左移</strong></p>
<p style="margin:10px auto">shiftleft(TINYINT|SMALLINT|INT a, INT b)</p>
<p style="margin:10px auto">shiftleft(BIGINT a, INT b)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span><span style="line-height:1.5!important"> bigint
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select shiftleft(2,3);</pre>
</div>
<p style="margin:10px auto"><strong>按拉右移</strong></p>
<p style="margin:10px auto">shiftright(TINYINT|SMALLINT|INT a, INTb)</p>
<p style="margin:10px auto">shiftright(BIGINT a, INT b)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：INT BIGINT
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select shiftrigth(2,3);</pre>
</div>
<p style="margin:10px auto"><strong>无符号按位右移（&lt;&lt;&lt;）</strong></p>
<p style="margin:10px auto">shiftrightunsigned(TINYINT|SMALLINT|INTa, INT b),</p>
<p style="margin:10px auto">shiftrightunsigned(BIGINT a, INT b)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：INT BIGINT
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> select shiftrightunsigned(2,3);</pre>
</div>
<p style="margin:10px auto"><strong>求最大值</strong> greatest(T v1, T v2, ...)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：T
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select greatest(2,3,6,7<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 7
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.072 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>求最小值</strong> least(T v1, T v2, ...)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select least(2,3,6,7<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.079 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto">2.类型转换函数</p>
<p style="margin:10px auto"> <strong>将输入的值转换成二进制</strong>  binary(string|binary)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：binary
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select binary('4'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.08 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>将expr转换成type类型 如：cast("1" as BIGINT) 将字符串1转换成了BIGINT类型，如果转换失败将返回NULL</strong> cast(expr as &lt;type&gt;)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：Expected "=" to follow "type"
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select cast("1"<span style="line-height:1.5!important"> as BIGINT) ;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 1
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.266 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto">3.日期函数</p>
<p style="margin:10px auto"> 日期函数UNIX时间戳转日期函数: from_unixtime语法:   from_unixtime(bigint unixtime[, string format])</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值: string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> 说明: 转化UNIX时间戳（从1970-01-01 00:00:00<span style="line-height:1.5!important"> UTC到指定时间的秒数）到当前时区的时间格式
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select from_unixtime(1323308943,'yyyyMMdd'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 20111208
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.152 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">获取当前UNIX时间戳函数: unix_timestamp语法:   unix_timestamp()</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值:   bigint
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 获得当前时区的UNIX时间戳
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> Time taken: 0.152 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> hive&gt;<span style="line-height:1.5!important">  select unix_timestamp();
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> 1487931871
<span style="color:rgb(0,128,128); line-height:1.5!important">8</span> Time taken: 0.106 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期转UNIX时间戳函数: unix_timestamp语法:   unix_timestamp(string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值:   bigint
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> 说明: 转换格式为“yyyy-MM-<span style="line-height:1.5!important">dd HH:mm:ss“的日期到UNIX时间戳。如果转化失败，则返回0。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select unix_timestamp('2011-12-07 13:01:03'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 1323234063
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.083 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">指定格式日期转UNIX时间戳函数: unix_timestamp语法:   unix_timestamp(string date, string pattern)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值:   bigint
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 转换pattern格式的日期到UNIX时间戳。如果转化失败，则返回0。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select unix_timestamp('20111207 13:01:03','yyyyMMdd HH:mm:ss'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 1323234063
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.079 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期时间转日期函数: to_date语法:   to_date(string timestamp)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值:   string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期时间字段中的日期部分。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select to_date('2011-12-08 10:03:01'<span style="line-height:1.5!important">) ;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 2011-12-08
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.194 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期转年函数: year语法:   year(string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期中的年。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt;  select year('2011-12-08 10:03:01'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 2011
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.168 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期转月函数: month语法: month   (string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期中的月份。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt;  select month('2011-12-08 10:03:01'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 12
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.084 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> hive&gt; select month('2011-08-08'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> 8
<span style="color:rgb(0,128,128); line-height:1.5!important">4</span> Time taken: 0.095 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto">日期转天函数: day语法: day   (string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期中的天。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt;  select day('2011-12-08 10:03:01'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 8
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.115 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> hive&gt; select day('2011-12-24'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> 24
<span style="color:rgb(0,128,128); line-height:1.5!important">4</span> Time taken: 0.294 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto">日期转小时函数: hour语法: hour   (string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期中的小时。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select hour('2011-12-08 10:03:01'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 10
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.082 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期转分钟函数: minute语法: minute   (string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期中的分钟。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt;  select minute('2011-12-08 10:03:01'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 3
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.181 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期转秒函数: second语法: second   (string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期中的秒。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt;  select second('2011-12-08 10:03:01'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 1
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.693 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期转周函数: weekofyear语法:   weekofyear (string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回日期在当前的周数。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select weekofyear('2011-12-08 10:03:01'<span style="line-height:1.5!important">)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span>     &gt;<span style="line-height:1.5!important"> ;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> 49
<span style="color:rgb(0,128,128); line-height:1.5!important">8</span> Time taken: 0.119 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期比较函数: datediff语法:   datediff(string enddate, string startdate)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回结束日期减去开始日期的天数。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select datediff('2012-12-08','2012-05-09'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 213
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.082 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期增加函数: date_add语法:   date_add(string startdate, int days)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值: string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回开始日期startdate增加days天后的日期。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select date_add('2012-12-08',10<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 2012-12-18
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.201 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">日期减少函数: date_sub语法:   date_sub (string startdate, int days)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值: string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 返回开始日期startdate减少days天后的日期。
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select date_sub('2012-12-08',10<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 2012-11-28
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.125 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>返回这个月的最后一天的日期，忽略时分秒部分（HH:mm:ss）</strong> last_day(string date)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select  last_day('2017-02-17 08:34:23'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2017-02-28
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.082 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>返回当前时间的下一个星期X所对应的日期 如：next_day('2015-01-14', 'TU') = 2015-01-20  以2015-01-14为开始时间，其下一个星期二所对应的日期为2015-01-20</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select next_day('2015-01-14', 'TU'<span style="line-height:1.5!important">) ;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2015-01-20
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.319 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>返回当前时间属性哪个季度 如quarter('2015-04-08') = 2</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> quarter(date/timestamp/string)</pre>
</div>
<p style="margin:10px auto"><strong>返回当前时间日期</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="line-height:1.5!important">返回值：date
hive</span>&gt;<span style="line-height:1.5!important"> select current_date;
OK
</span>2017-02-25<span style="line-height:1.5!important">
Time taken: </span>0.087 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>如果给定的时间戳并非UTC，则将其转化成指定的时区下时间戳</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：timestamp
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">from_utc_timestamp(timestamp, string timezone)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> hive&gt; select from_utc_timestamp('1970-01-01 08:00:00','PST'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> 1970-01-01 00:00:00
<span style="color:rgb(0,128,128); line-height:1.5!important">6</span> Time taken: 0.122 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>如果给定的时间戳指定的时区下时间戳，则将其转化成UTC下的时间戳 to_utc_timestamp(timestamp, string timezone)<br>
</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：timestamp
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select to_utc_timestamp('1970-01-01 00:00:00','PST'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 1970-01-01 08:00:00
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.099 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>返回当前时间戳</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：timestamp
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select current_timestamp;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2017-02-25 00:28:46.724
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.069 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"><strong>返回当前时间下再增加num_months个月的日期</strong>  add_months(string start_date, int num_months)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：string
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select add_months('2017-02-10', 2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 2017-04-10
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.061 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto">5.条件函数</p>
<p style="margin:10px auto"> <strong>如果testCondition 为true就返回valueTrue,否则返回valueFalseOrNull ，（valueTrue，valueFalseOrNull为泛型）</strong></p>
<p style="margin:10px auto">if(boolean testCondition, T valueTrue, T valueFalseOrNull)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：T</pre>
</div>
<p style="margin:10px auto"><strong>如果value值为NULL就返回default_value,否则返回value</strong></p>
<p style="margin:10px auto">nvl(T value, T default_value)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：T</pre>
</div>
<p style="margin:10px auto"><strong>返回第一非null的值，如果全部都为NULL就返回NULL  如：COALESCE (NULL,44,55)=44/strong&gt;</strong></p>
<p style="margin:10px auto">COALESCE(T v1, T v2, ...)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：T</pre>
</div>
<p style="margin:10px auto"><strong>如果a=b就返回c,a=d就返回e，否则返回f  如CASE 4 WHEN 5  THEN 5 WHEN 4 THEN 4 ELSE 3 END 将返回4</strong></p>
<p style="margin:10px auto"><strong>CASE a WHEN b THEN c [WHEN d THEN e]* [ELSE f] END</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：T</pre>
</div>
<p style="margin:10px auto"><strong>如果a=ture就返回b,c= ture就返回d，否则返回e  如：CASE WHEN  5&gt;0  THEN 5 WHEN 4&gt;0 THEN 4 ELSE 0 END 将返回5；CASE WHEN  5&lt;0  THEN 5 WHEN 4&lt;0 THEN 4 ELSE 0 END 将返回0</strong></p>
<p style="margin:10px auto"><strong>CASE WHEN a THEN b [WHEN c THEN d]* [ELSE e] END</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：T</pre>
</div>
<p style="margin:10px auto"><strong>如果a为null就返回true，否则返回false</strong></p>
<p style="margin:10px auto"><strong>isnull( a )</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">boolean</span></pre>
</div>
<p style="margin:10px auto"><strong>如果a为非null就返回true，否则返回false</strong></p>
<p style="margin:10px auto"><strong>isnotnull ( a )</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">boolean</span></pre>
</div>
<p style="margin:10px auto">6.字符函数</p>
<p style="margin:10px auto"> <strong>返回str中首个ASCII字符串的整数值</strong></p>
<p style="margin:10px auto">ascii(string str)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span></pre>
</div>
<p style="margin:10px auto"><strong>将二进制bin转换成64位的字符串</strong></p>
<p style="margin:10px auto"><strong>base64(binary bin)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>对二进制字节码或字符串按次序进行拼接</strong></p>
<p style="margin:10px auto"><strong>concat(string|binary A, string|binary B...)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>与ngram类似，但context_ngram()允许你预算指定上下文(数组)来去查找子序列，具体看<a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/StatisticsAndDataMining" rel="nofollow" style="color:rgb(29,88,209)">StatisticsAndDataMining</a>(这里的解释更易懂)</strong></p>
<p style="margin:10px auto"><strong>context_ngrams(array&lt;array&lt;string&gt;&gt;, array&lt;string&gt;, int K, int pf)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：array&lt;struct&lt;string,<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>&gt;&gt;</pre>
</div>
<p style="margin:10px auto"><strong>与concat()类似，但使用指定的分隔符喜进行分隔</strong></p>
<p style="margin:10px auto"><strong>concat_ws(string SEP, string A, string B...)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>拼接Array中的元素并用指定分隔符进行分隔</strong></p>
<p style="margin:10px auto"><strong>concat_ws(string SEP, array&lt;string&gt;)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>使用指定的字符集charset将字符串编码成二进制值，支持的字符集有：'US-ASCII', 'ISO-8859-1', 'UTF-8', 'UTF-16BE', 'UTF-16LE', 'UTF-16'，如果任一输入参数为NULL都将返回NULL</strong></p>
<p style="margin:10px auto"><strong>encode(string src, string charset)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：binary</pre>
</div>
<p style="margin:10px auto"><strong>返回以逗号分隔的字符串中str出现的位置，如果参数str为逗号或查找失败将返回0，如果任一参数为NULL将返回NULL回</strong></p>
<p style="margin:10px auto"><strong>find_in_set(string str, string strList)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span></pre>
</div>
<p style="margin:10px auto"><strong>将数值X转换成"#,###,###.##"格式字符串，并保留d位小数，如果d为0，将进行四舍五入且不保留小数</strong></p>
<p style="margin:10px auto"><strong>format_number(number x, int d)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>从指定路径上的JSON字符串抽取出JSON对象，并返回这个对象的JSON格式，如果输入的JSON是非法的将返回NULL,注意此路径上JSON字符串只能由数字 字母 下划线组成且不能有大写字母和特殊字符，且key不能由数字开头，这是由于Hive对列名的限制</strong></p>
<p style="margin:10px auto">get_json_object(string json_string, string path)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>如果文件名为filename的文件中有一行数据与字符串str匹配成功就返回true</strong></p>
<p style="margin:10px auto"><strong>in_file(string str, string filename)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">boolean</span></pre>
</div>
<p style="margin:10px auto"><strong>查找字符串str中子字符串substr出现的位置，如果查找失败将返回0，如果任一参数为Null将返回null，注意位置为从1开始的</strong></p>
<p style="margin:10px auto">instr(string str, string substr)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span></pre>
</div>
<p style="margin:10px auto"><strong>返回字符串的长度</strong></p>
<p style="margin:10px auto">length(string A)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span></pre>
</div>
<p style="margin:10px auto"><strong>查找字符串str中的pos位置后字符串substr第一次出现的位置</strong></p>
<p style="margin:10px auto">locate(string substr, string str[, int pos])</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span></pre>
</div>
<p style="margin:10px auto"><strong>将字符串A的所有字母转换成小写字母</strong></p>
<p style="margin:10px auto">lower(string A) lcase(string A)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>从左边开始对字符串str使用字符串pad填充，最终len长度为止，如果字符串str本身长度比len大的话，将去掉多余的部分</strong></p>
<p style="margin:10px auto">lpad(string str, int len, string pad)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>去掉字符串A前面的空格</strong></p>
<p style="margin:10px auto">ltrim(string A)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>返回出现次数TOP K的的子序列,n表示子序列的长度，具体看<a target="_blank" href="https://cwiki.apache.org/confluence/display/Hive/StatisticsAndDataMining" rel="nofollow" style="color:rgb(29,88,209)">StatisticsAndDataMining</a> (这里的解释更易懂)</strong></p>
<p style="margin:10px auto">ngrams(array&lt;array&lt;string&gt;&gt;, int N, int K, int pf)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：array&lt;struct&lt;string,<span style="color:rgb(0,0,255); line-height:1.5!important">double</span>&gt;&gt;</pre>
</div>
<p style="margin:10px auto"><strong>返回从URL中抽取指定部分的内容，参数url是URL字符串，而参数partToExtract是要抽取的部分，这个参数包含(HOST, PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, and USERINFO,例如：parse_url('http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1', 'HOST') ='facebook.com'，如果参数partToExtract值为QUERY则必须指定第三个参数key
  如：parse_url('http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1', 'QUERY', 'k1') =‘v1’</strong></p>
<p style="margin:10px auto"><strong>parse_url(string urlString, string partToExtract [, string keyToExtract])</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>按照printf风格格式输出字符串</strong></p>
<p style="margin:10px auto"><strong>printf(String format, Obj... args)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>抽取字符串subject中符合正则表达式pattern的第index个部分的子字符串，注意些预定义字符的使用，如第二个参数如果使用'\s'将被匹配到s,'\\s'才是匹配空格</strong></p>
<p style="margin:10px auto"><strong>regexp_extract(string subject, string pattern, int index)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>按照Java正则表达式PATTERN将字符串INTIAL_STRING中符合条件的部分成REPLACEMENT所指定的字符串，如里REPLACEMENT这空的话，抽符合正则的部分将被去掉  如：regexp_replace("foobar", "oo|ar", "") = 'fb.' 注意些预定义字符的使用，如第二个参数如果使用'\s'将被匹配到s,'\\s'才是匹配空格</strong></p>
<p style="margin:10px auto">regexp_replace(string INITIAL_STRING, string PATTERN, string REPLACEMENT)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>重复输出n次字符串str</strong></p>
<p style="margin:10px auto"><strong>repeat(string str, int n)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>反转字符串</strong></p>
<p style="margin:10px auto">reverse(string A)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>从右边开始对字符串str使用字符串pad填充，最终len长度为止，如果字符串str本身长度比len大的话，将去掉多余的部分</strong></p>
<p style="margin:10px auto">rpad(string str, int len, string pad)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>去掉字符串后面出现的空格</strong></p>
<p style="margin:10px auto">rtrim(string A)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>字符串str将被转换成单词数组，如：sentences('Hello there! How are you?') =( ("Hello", "there"), ("How", "are", "you") )</strong></p>
<p style="margin:10px auto"><strong>sentences(string str, string lang, string locale)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：array&lt;array&lt;string&gt;&gt;</pre>
</div>
<p style="margin:10px auto"><strong>返回n个空格</strong></p>
<p style="margin:10px auto">space(int n)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'>返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>按照正则表达式pat来分割字符串str,并将分割后的数组字符串的形式返回</strong></p>
<p style="margin:10px auto"><strong>split(string str, string pat)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>将字符串str按照指定分隔符转换成Map，第一个参数是需要转换字符串，第二个参数是键值对之间的分隔符，默认为逗号;第三个参数是键值之间的分隔符，默认为"="</strong></p>
<p style="margin:10px auto">str_to_map(text[, delimiter1, delimiter2])</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：map&lt;string,string&gt;</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>对于字符串A,从start位置开始截取字符串并返回</strong></p>
<p style="margin:10px auto">substr(string|binary A, int start) substring(string|binary A, int start)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto"><strong>对于二进制/字符串A,从start位置开始截取长度为length的字符串并返回</strong></p>
<p style="margin:10px auto"><strong>substr(string|binary A, int start, int len) substring(string|binary A, int start, int len)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>截取第count分隔符之前的字符串，如count为正则从左边开始截取，如果为负则从右边开始截取</strong></p>
<p style="margin:10px auto"><strong>substring_index(string A, string delim, int count)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>将input出现在from中的字符串替换成to中的字符串 如：translate("MOBIN","BIN","M")="MOM"</strong></p>
<p style="margin:10px auto">translate(string|char|varchar input, string|char|varchar from, string|char|varchar to)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>将64位的字符串转换二进制值</strong></p>
<p style="margin:10px auto"><strong>unbase64(string str)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：binary</pre>
</div>
<p style="margin:10px auto"><strong>将字符串A中的字母转换成大写字母</strong></p>
<p style="margin:10px auto"><strong>upper(string A) ucase(string A)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>将字符串A转换第一个字母大写其余字母的字符串</strong></p>
<p style="margin:10px auto"><strong>initcap(string A)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"><strong>计算两个字符串之间的差异大小  如：levenshtein('kitten', 'sitting') = 3</strong></p>
<p style="margin:10px auto">levenshtein(string A, string B)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span></pre>
</div>
<p style="margin:10px auto"><strong>将普通字符串转换成soundex字符串</strong></p>
<p style="margin:10px auto"><strong>soundex(string A)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：string</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto">7.字符串函数</p>
<p style="margin:10px auto">分割字符串函数: split</p>
<p style="margin:10px auto">语法:  split(string str, string pat)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值:  array  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明: 按照pat字符串分割str，会返回分割后的字符串数组  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; select split('abtcdtef','t'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> ["ab","cd","ef"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.118 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">与GP，ORACLE不同，pad 不能默认</p>
<p style="margin:10px auto">右补足函数：rpad</p>
<p style="margin:10px auto">语法: rpad(string str, int len, string pad)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明：将str进行用pad进行右补足到len位  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> hive&gt; 
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span>     &gt; select rpad('abc',10,'td'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> <span style="line-height:1.5!important">abctdtdtdt
</span><span style="color:rgb(0,128,128); line-height:1.5!important">8</span> Time taken: 0.077 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">左补足函数：lpad</p>
<p style="margin:10px auto">语法: lpad(string str, int len, string pad)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> hive&gt; 
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span>     &gt; select rpad('abc',10,'td'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="line-height:1.5!important">abctdtdtdt
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> Time taken: 0.077 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto">首字符ascii函数：ascii</p>
<p style="margin:10px auto">语法: ascii(string str)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>  
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明：返回字符串str第一个字符的ascii码  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> 举例：  hive&gt;  select ascii('abcde'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> 97
<span style="color:rgb(0,128,128); line-height:1.5!important">6</span> Time taken: 0.066 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">重复字符串函数：repeat</p>
<p style="margin:10px auto">语法: repeat(string str, int n)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">说明：返回重复n次后的str字符串  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">举例： 
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span>  hive&gt; select repeat('abc',5<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">abcabcabcabcabc
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.064 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">空格字符串函数：space</p>
<p style="margin:10px auto">语法: space(int n)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">说明：返回长度为n的字符串  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> 举例：hive&gt; select space(10<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span>           
<span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> Time taken: 0.101 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> hive&gt; select length(space(10<span style="line-height:1.5!important">));
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> 10
<span style="color:rgb(0,128,128); line-height:1.5!important">10</span> Time taken: 1.905 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串长度函数：length</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">语法: length(string A)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> 返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>  
<span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">说明：返回字符串A的长度  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 举例：hive&gt; select length('abcedfg'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 7
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.065 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串反转函数：reverse</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="line-height:1.5!important">语法: reverse(string A)  
返回值: string  
说明：返回字符串A的反转结果  
举例：  hive</span>&gt; select reverse('abcedfg'<span style="line-height:1.5!important">);
OK
gfdecba
Time taken: </span>0.077 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串连接函数：concat</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">语法: concat(string A, string B…)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">说明：返回输入字符串连接后的结果，支持任意个输入字符串  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 举例：hive&gt;  select concat('abc','def','gh'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">abcdefgh
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.063 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">带分隔符字符串连接函数：concat_ws</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="line-height:1.5!important">语法: concat_ws(string SEP, string A, string B…)  
返回值: string  
说明：返回输入字符串连接后的结果，SEP表示各个字符串间的分隔符  
举例：  hive</span>&gt; select concat_ws('-','abc','def','gh'<span style="line-height:1.5!important">);
OK
abc</span>-def-<span style="line-height:1.5!important">gh
Time taken: </span>0.06 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串截取函数：substr,substring</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> 语法: substr(string A, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span> start),substring(string A, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span><span style="line-height:1.5!important"> start)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">说明：返回字符串A从start位置到结尾的字符串  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> 举例： hive&gt; select substr('abcde',3<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">cde
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> Time taken: 0.062 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> hive&gt; select substring('abcde',3<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> <span style="line-height:1.5!important">cde
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> Time taken: 0.05 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> hive&gt; select substr('abcde',-1<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> <span style="line-height:1.5!important">e
</span><span style="color:rgb(0,128,128); line-height:1.5!important">15</span> Time taken: 0.061 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串截取函数：substr,substring</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> 语法: substr(string A, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span> start, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span> len),substring(string A, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span> start, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span><span style="line-height:1.5!important"> len)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">说明：返回字符串A从start位置开始，长度为len的字符串  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> hive&gt;  select substr('abcde',3,2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> <span style="line-height:1.5!important">cd
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> Time taken: 0.07 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> hive&gt; select substring('abcde',3,2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> <span style="line-height:1.5!important">cd
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> Time taken: 0.062 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> hive&gt; select substring('abcde',-2,2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">15</span> <span style="line-height:1.5!important">de
</span><span style="color:rgb(0,128,128); line-height:1.5!important">16</span> Time taken: 0.113 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串转大写函数：upper,ucase</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">语法: upper(string A) ucase(string A)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">说明：返回字符串A的大写格式  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> 举例：hive&gt; select upper('abSEd'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">ABSED
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> Time taken: 0.059 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> hive&gt; select ucase('abSEd'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> <span style="line-height:1.5!important">ABSED
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> Time taken: 0.058 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">字符串转小写函数：lower,lcase</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">语法: lower(string A) lcase(string A)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">说明：返回字符串A的小写格式  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">举例： 
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> hive&gt; select lower('abSEd'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> <span style="line-height:1.5!important">absed
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> Time taken: 0.068 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> hive&gt; select lcase('abSEd'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> <span style="line-height:1.5!important">absed
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> Time taken: 0.057 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">去空格函数：trim</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">语法: trim(string A)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">说明：去除字符串两边的空格  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 举例：hive&gt; select trim(' abc '<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">abc
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.058 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">左边去空格函数：ltrim</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">语法: ltrim(string A)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">说明：去除字符串左边的空格  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 举例：  hive&gt; select ltrim(' abc '<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important">abc 
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.059 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">右边去空格函数：rtrim</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">语法: rtrim(string A)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">说明：去除字符串右边的空格  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 举例：hive&gt; select rtrim(' abc '<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="line-height:1.5!important"> abc
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.058 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">正则表达式解析函数：regexp_extract</p>
<p style="margin:10px auto">其中的index，是按照正则字符串（）的位置</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> 语法: regexp_extract(string subject, string pattern, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span><span style="line-height:1.5!important"> index)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">说明：将字符串subject按照pattern正则表达式的规则拆分，返回index指定的字符。注意，在有些情况下要使用转义字符  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">举例： 
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span>  hive&gt; select regexp_extract('foothebar', 'foo(.*?)(bar)', 1<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> <span style="line-height:1.5!important">the
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> Time taken: 0.389 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> hive&gt; select regexp_extract('foothebar', 'foo(.*?)(bar)', 2<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> <span style="line-height:1.5!important">bar
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> Time taken: 0.051 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> hive&gt;  select regexp_extract('foothebar', 'foo(.*?)(bar)', 0<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">15</span> <span style="line-height:1.5!important">foothebar
</span><span style="color:rgb(0,128,128); line-height:1.5!important">16</span> Time taken: 0.058 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto">函数parse_url,解析URL字符串</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> parse_url(url, partToExtract[, key]) -<span style="line-height:1.5!important"> extracts a part from a URL  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">解析URL字符串，partToExtract的选项包含[HOST,PATH,QUERY,REF,PROTOCOL,FILE,AUTHORITY,USERINFO]。 
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> hive&gt; select parse_url('http://facebook.com/path/p1.php?query=1', 'HOST'<span style="line-height:1.5!important">) ;
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">facebook.com
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> Time taken: 0.286 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> hive&gt; select parse_url('http://facebook.com/path/p1.php?query=1', 'PATH'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> /path/<span style="line-height:1.5!important">p1.php
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> Time taken: 0.069 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> hive&gt; select parse_url('http://facebook.com/path/p1.php?query=1', 'QUERY'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> query=1
<span style="color:rgb(0,128,128); line-height:1.5!important">15</span> <span style="line-height:1.5!important">可以指定key来返回特定参数，例如 
</span><span style="color:rgb(0,128,128); line-height:1.5!important">16</span> Time taken: 0.21 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">17</span> hive&gt; select parse_url('http://facebook.com/path/p1.php?query=1', 'QUERY','query'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">18</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">19</span> 1
<span style="color:rgb(0,128,128); line-height:1.5!important">20</span> Time taken: 0.057 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">21</span> hive&gt; select parse_url('http://facebook.com/path/p1.php?query=1#Ref', 'REF'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">22</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">23</span> <span style="line-height:1.5!important">Ref
</span><span style="color:rgb(0,128,128); line-height:1.5!important">24</span> Time taken: 0.055 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">25</span> hive&gt; select parse_url('http://facebook.com/path/p1.php?query=1#Ref', 'PROTOCOL'<span style="line-height:1.5!important">);
</span><span style="color:rgb(0,128,128); line-height:1.5!important">26</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">27</span> <span style="line-height:1.5!important">http
</span><span style="color:rgb(0,128,128); line-height:1.5!important">28</span> Time taken: 0.06 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> hive&gt; select parse_url_tuple('http://facebook.com/path1/p.php?k1=v1&amp;k2=v2#Ref1', 'QUERY:k1', 'QUERY:k2'<span style="line-height:1.5!important">); 
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">v1      v2
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> Time taken: 0.2 seconds, Fetched: 1 row(s)</pre>
</div>
<p style="margin:10px auto"> </p>
<p style="margin:10px auto">json解析函数：get_json_object</p>
<p style="margin:10px auto">语法: get_json_object(string json_string, string path)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">返回值: string  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">说明：解析json的字符串json_string,返回path指定的内容。如果输入的json字符串无效，那么返回NULL。  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> 举例： hive&gt; select get_json_object('{"store":{"fruit":\[{"weight":8,"type":"apple"},{"weight":9,"type":"pear"}],"bicycle":{"price":19.95,"color":"red"} }, "email":"amy@only_for_json_udf_test.net","owner":"amy"}','$.store'<span style="line-height:1.5!important">); 
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> {"fruit":[{"weight":8,"type":"apple"},{"weight":9,"type":"pear"}],"bicycle":{"price":19.95,"color":"red"<span style="line-height:1.5!important">}}
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> Time taken: 0.108 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> hive&gt; select get_json_object('{"store":{"fruit":\[{"weight":8,"type":"apple"},{"weight":9,"type":"pear"}],"bicycle":{"price":19.95,"color":"red"} }, "email":"amy@only_for_json_udf_test.net","owner":"amy"}','$.email'<span style="line-height:1.5!important">); 
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> <span style="line-height:1.5!important">amy@only_for_json_udf_test.net
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">12</span> hive&gt; select get_json_object('{"store":{"fruit":\[{"weight":8,"type":"apple"},{"weight":9,"type":"pear"}],"bicycle":{"price":19.95,"color":"red"} }, "email":"amy@only_for_json_udf_test.net","owner":"amy"}','$.owner'<span style="line-height:1.5!important">); 
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> <span style="line-height:1.5!important">amy
</span><span style="color:rgb(0,128,128); line-height:1.5!important">15</span> Time taken: 0.499 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"> 行转列：explode （posexplode Available as of Hive 0.13.0）</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">说明：将输入的一行数组或者map转换成列输出
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">语法：explode(array (or map))
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> hive&gt; select explode(split(concat_ws('-','1','2','3','4','5','6','7','8','9'),'-'<span style="line-height:1.5!important">));  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> 1
<span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> 3
<span style="color:rgb(0,128,128); line-height:1.5!important">10</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">11</span> 5
<span style="color:rgb(0,128,128); line-height:1.5!important">12</span> 6
<span style="color:rgb(0,128,128); line-height:1.5!important">13</span> 7
<span style="color:rgb(0,128,128); line-height:1.5!important">14</span> 8
<span style="color:rgb(0,128,128); line-height:1.5!important">15</span> 9
<span style="color:rgb(0,128,128); line-height:1.5!important">16</span> Time taken: 0.095 seconds, Fetched: 9 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"> </p>
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
二.集合函数</h3>
<p style="margin:10px auto">集合查找函数: find_in_set</p>
<p style="margin:10px auto">语法: find_in_set(string str, string strList)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'>返回值: <span style="color:rgb(0,0,255); line-height:1.5!important">int</span><span style="line-height:1.5!important">  
说明: 返回str在strlist第一次出现的位置，strlist是用逗号分割的字符串。如果没有找该str字符，则返回0  
举例： hive</span>&gt; select find_in_set('ab','ef,ab,de'<span style="line-height:1.5!important">);
OK
</span>2<span style="line-height:1.5!important">
Time taken: </span>2.336 seconds, Fetched: 1<span style="line-height:1.5!important"> row(s)
hive</span>&gt; select find_in_set('at','ef,ab,de'<span style="line-height:1.5!important">);
OK
</span>0<span style="line-height:1.5!important">
Time taken: </span>0.094 seconds, Fetched: 1 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"> </p>
<div style="white-space:pre-wrap; line-height:1.875">hive提供了复合数据类型：</div>
<div style="white-space:pre-wrap; line-height:1.5">Structs： structs内部的数据可以通过DOT（.）来存取，例如，表中一列c的类型为STRUCT{a INT; b INT}，我们可以通过c.a来访问域a</div>
<div style="white-space:pre-wrap; line-height:1.5">Maps（K-V对）：访问指定域可以通过["指定域名称"]进行，例如，一个Map M包含了一个group-》gid的kv对，gid的值可以通过M[' group']来获取</div>
<div style="white-space:pre-wrap; line-height:1.5">Arrays：array中的数据为相同类型，例如，假如array A中元素['a','b','c']，则A[1]的值为'b'</div>
<div style="white-space:pre-wrap; line-height:1.5"><span style="font-weight:bold">Struct使用</span></div>
<div style="white-space:pre-wrap; line-height:1.5">
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> create table qa_test.student_test(id INT, info struct&lt;name:STRING, age:INT&gt;<span style="line-height:1.5!important">)  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
<span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> COLLECTION ITEMS TERMINATED BY ':'<span style="line-height:1.5!important">;
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> hive&gt;<span style="line-height:1.5!important"> desc qa_test.student_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> id                      <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> info                    struct&lt;name:string,age:<span style="color:rgb(0,0,255); line-height:1.5!important">int</span>&gt;
<span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> Time taken: 0.048 seconds, Fetched: 2<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">11</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">12</span> <span style="line-height:1.5!important">$cat test5.txt
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> 1,zhou:30
<span style="color:rgb(0,128,128); line-height:1.5!important">14</span> 2,yan:30
<span style="color:rgb(0,128,128); line-height:1.5!important">15</span> 3,chen:20
<span style="color:rgb(0,128,128); line-height:1.5!important">16</span> 4,li:80
<span style="color:rgb(0,128,128); line-height:1.5!important">17</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">18</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">19</span> LOAD DATA LOCAL INPATH '/home/hadoop/test/test5'<span style="line-height:1.5!important"> INTO TABLE qa_test.student_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">20</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">21</span> hive&gt; select  *<span style="line-height:1.5!important">  from qa_test.student_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">22</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">23</span> 1       {"name":"zhou","age":30<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">24</span> 2       {"name":"yan","age":30<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">25</span> 3       {"name":"chen","age":20<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">26</span> 4       {"name":"li","age":80<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">27</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">28</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">29</span> hive&gt;<span style="line-height:1.5!important"> select info.age from qa_test.student_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">30</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">31</span> 30
<span style="color:rgb(0,128,128); line-height:1.5!important">32</span> 30
<span style="color:rgb(0,128,128); line-height:1.5!important">33</span> 20
<span style="color:rgb(0,128,128); line-height:1.5!important">34</span> 80
<span style="color:rgb(0,128,128); line-height:1.5!important">35</span> Time taken: 0.234 seconds, Fetched: 4<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">36</span> hive&gt;<span style="line-height:1.5!important"> select info.name from qa_test.student_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">37</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">38</span> <span style="line-height:1.5!important">zhou
</span><span style="color:rgb(0,128,128); line-height:1.5!important">39</span> <span style="line-height:1.5!important">yan
</span><span style="color:rgb(0,128,128); line-height:1.5!important">40</span> <span style="line-height:1.5!important">chen
</span><span style="color:rgb(0,128,128); line-height:1.5!important">41</span> <span style="line-height:1.5!important">li
</span><span style="color:rgb(0,128,128); line-height:1.5!important">42</span> Time taken: 0.08 seconds, Fetched: 4 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<div style="line-height:1.5"><span style="font-weight:bold">Array使用</span></div>
<div style="line-height:1.5">
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> create table qa_test.class_test(name string, student_id_list array&lt;INT&gt;<span style="line-height:1.5!important">)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">ROW FORMAT DELIMITED
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> FIELDS TERMINATED BY ','
<span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> COLLECTION ITEMS TERMINATED BY ':'<span style="line-height:1.5!important">;
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> hive&gt;<span style="line-height:1.5!important">desc qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> <span style="line-height:1.5!important">name                    string
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> student_id_list         array&lt;<span style="color:rgb(0,0,255); line-height:1.5!important">int</span>&gt;
<span style="color:rgb(0,128,128); line-height:1.5!important">10</span> Time taken: 0.052 seconds, Fetched: 2<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">12</span> <span style="line-height:1.5!important">$ cat test6.txt   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> 034,1:2:3:4
<span style="color:rgb(0,128,128); line-height:1.5!important">14</span> 035,5:6
<span style="color:rgb(0,128,128); line-height:1.5!important">15</span> 036,7:8:9:10
<span style="color:rgb(0,128,128); line-height:1.5!important">16</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">17</span> LOAD DATA LOCAL INPATH '/home/hadoop/test/test6'<span style="line-height:1.5!important"> INTO TABLE qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">18</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">19</span> hive&gt; select *<span style="line-height:1.5!important"> from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">20</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">21</span> 034     [1,2,3,4<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">22</span> 035     [5,6<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">23</span> 036     [7,8,9,10<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">24</span> Time taken: 0.076 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">25</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">26</span> select student_id_list[3<span style="line-height:1.5!important">] from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">27</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">28</span> hive&gt; select student_id_list[3<span style="line-height:1.5!important">] from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">29</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">30</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">31</span> <span style="line-height:1.5!important">NULL
</span><span style="color:rgb(0,128,128); line-height:1.5!important">32</span> 10
<span style="color:rgb(0,128,128); line-height:1.5!important">33</span> Time taken: 0.12 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">34</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">35</span> hive&gt;<span style="line-height:1.5!important"> select size(student_id_list) from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">36</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">37</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">38</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">39</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">40</span> Time taken: 0.086 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">41</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">42</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">43</span> hive&gt; select array_contains(student_id_list,4<span style="line-height:1.5!important">) from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">44</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">45</span> <span style="color:rgb(0,0,255); line-height:1.5!important">true</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">46</span> <span style="color:rgb(0,0,255); line-height:1.5!important">false</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">47</span> <span style="color:rgb(0,0,255); line-height:1.5!important">false</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">48</span> Time taken: 0.129 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">49</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">50</span> hive&gt; 
<span style="color:rgb(0,128,128); line-height:1.5!important">51</span>     &gt;<span style="line-height:1.5!important"> select   sort_array(student_id_list) from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">52</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">53</span> [1,2,3,4<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">54</span> [5,6<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">55</span> [7,8,9,10<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">56</span> Time taken: 0.085 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<div style="line-height:1.5"><span style="font-weight:bold">Map使用</span></div>
<div style="line-height:1.5">
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> create table qa_test.employee(id string, perf map&lt;string, <span style="color:rgb(0,0,255); line-height:1.5!important">int</span>&gt;<span style="line-height:1.5!important">)
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">ROW FORMAT DELIMITED
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> FIELDS TERMINATED BY '\t'
<span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> COLLECTION ITEMS TERMINATED BY ','
<span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> MAP KEYS TERMINATED BY ':'<span style="line-height:1.5!important">;
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> <span style="line-height:1.5!important">$ cat test7.txt
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> 1    job:80,team:60,person:70
<span style="color:rgb(0,128,128); line-height:1.5!important">10</span> 2    job:60,team:80
<span style="color:rgb(0,128,128); line-height:1.5!important">11</span> 3    job:90,team:70,person:100
<span style="color:rgb(0,128,128); line-height:1.5!important">12</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">13</span> LOAD DATA LOCAL INPATH '/home/hadoop/test/test7'<span style="line-height:1.5!important"> INTO TABLE qa_test.employee;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">15</span> hive&gt; select *<span style="line-height:1.5!important"> from qa_test.employee;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">16</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">17</span> 1       {"job":80,"team":60,"person":70<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">18</span> 2       {"job":60,"team":80<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">19</span> 3       {"job":90,"team":70,"person":100<span style="line-height:1.5!important">}
</span><span style="color:rgb(0,128,128); line-height:1.5!important">20</span> Time taken: 0.075 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">21</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">22</span> hive&gt; select perf['job'] from qa_test.employee where perf['job'] is not <span style="color:rgb(0,0,255); line-height:1.5!important">null</span><span style="line-height:1.5!important">;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">23</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">24</span> 80
<span style="color:rgb(0,128,128); line-height:1.5!important">25</span> 60
<span style="color:rgb(0,128,128); line-height:1.5!important">26</span> 90
<span style="color:rgb(0,128,128); line-height:1.5!important">27</span> Time taken: 0.096 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">28</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">29</span> hive&gt;<span style="line-height:1.5!important"> select size(perf) from qa_test.employee;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">30</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">31</span> 3
<span style="color:rgb(0,128,128); line-height:1.5!important">32</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">33</span> 3
<span style="color:rgb(0,128,128); line-height:1.5!important">34</span> Time taken: 0.091 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">35</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">36</span> hive&gt;<span style="line-height:1.5!important"> select map_keys(perf) from qa_test.employee;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">37</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">38</span> ["job","team","person"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">39</span> ["job","team"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">40</span> ["job","team","person"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">41</span> Time taken: 0.136 seconds, Fetched: 3<span style="line-height:1.5!important"> row(s)
</span><span style="color:rgb(0,128,128); line-height:1.5!important">42</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">43</span> hive&gt;<span style="line-height:1.5!important"> select map_values(perf) from qa_test.employee;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">44</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">45</span> [80,60,70<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">46</span> [60,80<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">47</span> [90,70,100<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">48</span> Time taken: 0.077 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>求map的长度 size(Map&lt;K.V&gt;)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select size(perf) from qa_test.employee;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 3
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 3
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.091 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>求数组的长度</strong> size(Array&lt;T&gt;)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">int</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select size(student_id_list) from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> 2
<span style="color:rgb(0,128,128); line-height:1.5!important">6</span> 4
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.086 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>返回map中的所有key</strong></p>
<p style="margin:10px auto">map_keys(Map&lt;K.V&gt;)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：array&lt;K&gt;
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select map_keys(perf) from qa_test.employee;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> ["job","team","person"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> ["job","team"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> ["job","team","person"<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.136 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>返回map中的所有value</strong> map_values(Map&lt;K.V&gt;)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：array&lt;V&gt;
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select map_values(perf) from qa_test.employee;   
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> [80,60,70<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> [60,80<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> [90,70,100<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.077 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>如该数组Array&lt;T&gt;包含value返回true。，否则返回false</strong> array_contains(Array&lt;T&gt;, value)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：<span style="color:rgb(0,0,255); line-height:1.5!important">boolean</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt; select array_contains(student_id_list,4<span style="line-height:1.5!important">) from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> <span style="color:rgb(0,0,255); line-height:1.5!important">true</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">5</span> <span style="color:rgb(0,0,255); line-height:1.5!important">false</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">6</span> <span style="color:rgb(0,0,255); line-height:1.5!important">false</span>
<span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.129 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"><strong>按自然顺序对数组进行排序并返回 sort_array(Array&lt;T&gt;)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> <span style="line-height:1.5!important">返回值：array
</span><span style="color:rgb(0,128,128); line-height:1.5!important">2</span> hive&gt;<span style="line-height:1.5!important"> select   sort_array(student_id_list) from qa_test.class_test;
</span><span style="color:rgb(0,128,128); line-height:1.5!important">3</span> <span style="line-height:1.5!important">OK
</span><span style="color:rgb(0,128,128); line-height:1.5!important">4</span> [1,2,3,4<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">5</span> [5,6<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">6</span> [7,8,9,10<span style="line-height:1.5!important">]
</span><span style="color:rgb(0,128,128); line-height:1.5!important">7</span> Time taken: 0.085 seconds, Fetched: 3 row(s)</pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"> </p>
</div>
</div>
</div>
<p style="margin:10px auto"><span style="font-size:16px">二.<strong>聚合函数</strong></span></p>
<p style="margin:10px auto"> <strong>统计总行数，包括含有NULL值的行  count(*)</strong></p>
<p style="margin:10px auto"><strong><strong>统计提供非NULL的expr表达式值的行数</strong> count(expr)<br>
</strong></p>
<p style="margin:10px auto"><strong><strong>统计提供非NULL且去重后的expr表达式值的行数</strong>  count(DISTINCT expr[, expr])<br>
</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：BIGINT</pre>
</div>
<p style="margin:10px auto"><strong>sum(col),表示求指定列的和，sum(DISTINCT col)表示求去重后的列的和</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>avg(col),表示求指定列的平均值，avg(DISTINCT col)表示求去重后的列的平均值</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列的最小值</strong> min(col)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列的最大值</strong> max(col)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列数值的方差</strong> variance(col), var_pop(col)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列数值的样本方差</strong></p>
<p style="margin:10px auto">var_samp(col)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列数值的标准偏差</strong></p>
<p style="margin:10px auto">stddev_pop(col)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列数值的样本标准偏差</strong></p>
<p style="margin:10px auto">stddev_samp(col)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列数值的协方差</strong> covar_pop(col1, col2)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>求指定列数值的样本协方差</strong> covar_samp(col1, col2)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>返回两列数值的相关系数</strong> corr(col1, col2)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"><strong>返回col的p%分位数</strong>  percentile(BIGINT col, p)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：DOUBLE</pre>
</div>
<p style="margin:10px auto"> </p>
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
三.<strong>特殊函数</strong></h3>
<h4 id="窗口函数" style="font-size:16px; font-weight:normal; margin:10px; line-height:1.5; padding-left:10px">
<strong>窗口函数</strong></h4>
<p style="margin:10px auto"> </p>
<h4 id="分析函数" style="font-size:16px; font-weight:normal; margin:10px; line-height:1.5; padding-left:10px">
<strong>分析函数</strong></h4>
<p style="margin:10px auto"> </p>
<h4 id="混合函数" style="font-size:16px; font-weight:normal; margin:10px; line-height:1.5; padding-left:10px">
<strong>混合函数</strong></h4>
<p style="margin:10px auto"> </p>
<h4 id="udtf" style="font-size:16px; font-weight:normal; margin:10px; line-height:1.5; padding-left:10px">
<strong>UDTF</strong></h4>
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
多行转换：lateral view</h3>
<p style="margin:10px auto">说明：lateral view用于和json_tuple，parse_url_tuple，split, explode等UDTF一起使用，它能够将一行数据拆成多行数据，在此基础上可以对拆分后的数据进行聚合。<br>
举例：</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> <span style="line-height:1.5!important">说明：lateral view用于和json_tuple，parse_url_tuple，split, explode等UDTF一起使用，它能够将一行数据拆成多行数据，在此基础上可以对拆分后的数据进行聚合。
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">举例：
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span>     hive&gt; select s.x,sp from test.dual s lateral view explode(split(concat_ws(',','1','2','3','4','5','6','7','8','9'),','<span style="line-height:1.5!important">)) t as sp;  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> <span style="line-height:1.5!important">    x sp  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span>     a 1  
<span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span>     b 2  
<span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span>     a 3  
<span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> 解释一下，from后面是你的表名，在表名后面加lateral view explode。。。（你的行转列sql） ，还必须要起一个别名，我这个字段的别名为sp。然后再看看select后面的 s.*<span style="line-height:1.5!important">，就是原表的字段，我这里面只有一个字段，且为X
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">11</span> <span style="line-height:1.5!important">多个lateral view的sql类如：
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important">13</span>     SELECT * FROM exampleTable LATERAL VIEW explode(col1) myTable1 AS myCol1 LATERAL VIEW explode(myCol1) myTable2 AS myCol2; </pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<h3 style="font-size:18px; border-bottom:1px solid rgb(170,170,170); line-height:1.5; margin:10px; padding-left:10px">
抽取一行数据转换到新表的多列样例：</h3>
<p style="margin:10px auto">http_referer是获取的带参数请求路径，其中非法字符用\做了转义，根据路径解析出地址，查询条件等存入新表中，</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important"> 1</span> drop table <span style="color:rgb(0,0,255); line-height:1.5!important">if</span><span style="line-height:1.5!important"> exists t_ods_tmp_referurl;  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 2</span> <span style="line-height:1.5!important">create table t_ ods _tmp_referurl as  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 3</span> SELECT a.*,b.*  
<span style="color:rgb(0,128,128); line-height:1.5!important"> 4</span> FROM ods_origin_weblog a LATERAL VIEW parse_url_tuple(regexp_replace(http_referer, "\"", ""), 'HOST', 'PATH','QUERY', 'QUERY:id'<span style="line-height:1.5!important">) b as host, path, query, query_id; 
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 5</span> 
<span style="color:rgb(0,128,128); line-height:1.5!important"> 6</span> <span style="line-height:1.5!important">复制表，并将时间截取到日：
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 7</span> drop table <span style="color:rgb(0,0,255); line-height:1.5!important">if</span><span style="line-height:1.5!important"> exists t_ods_tmp_detail;  
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 8</span> <span style="line-height:1.5!important">create table t_ods_tmp_detail as   
</span><span style="color:rgb(0,128,128); line-height:1.5!important"> 9</span> select b.*,substring(time_local,0,10<span style="line-height:1.5!important">) as daystr,  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">10</span> substring(time_local,11<span style="line-height:1.5!important">) as tmstr,  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">11</span> substring(time_local,5,2<span style="line-height:1.5!important">) as month,  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">12</span> substring(time_local,8,2<span style="line-height:1.5!important">) as day,  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">13</span> substring(time_local,11,2<span style="line-height:1.5!important">) as hour  
</span><span style="color:rgb(0,128,128); line-height:1.5!important">14</span> From t_ ods _tmp_referurl b;  </pre>
<div class="cnblogs_code_toolbar" style="margin-top:5px"><span class="cnblogs_code_copy" style="padding-right:5px; line-height:1.5!important"><a target="_blank" title="复制代码" style="color:rgb(29,88,209); border:none!important"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="max-width:900px; border:none!important"></a></span></div>
</div>
<p style="margin:10px auto"> <strong><span style="font-size:18pt">表生成函数</span></strong></p>
<p style="margin:10px auto"><strong>对于a中的每个元素，将生成一行且包含该元素</strong></p>
<p style="margin:10px auto"><strong>explode(array&lt;<em>TYPE</em>&gt; a) <br>
</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：Array Type</pre>
</div>
<p style="margin:10px auto"><strong>每行对应数组中的一个元素</strong> explode(ARRAY)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：N rows</pre>
</div>
<p style="margin:10px auto"><strong>每行对应每个map键-值，其中一个字段是map的键，另一个字段是map的值</strong></p>
<p style="margin:10px auto"><strong>explode(MAP)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：N rows</pre>
</div>
<p style="margin:10px auto"><strong>explode类似，不同的是还返回各元素在数组中的位置</strong></p>
<p style="margin:10px auto">posexplode(ARRAY)</p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：N rows</pre>
</div>
<p style="margin:10px auto"><strong>把M列转换成N行，每行有M/N个字段，其中n必须是个常数</strong></p>
<p style="margin:10px auto"><strong>stack(INT n, v_1, v_2, ..., v_k)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：N rows</pre>
</div>
<p style="margin:10px auto"><strong>从一个JSON字符串中获取多个键并作为一个元组返回，与get_json_object不同的是此函数能一次获取多个键值</strong></p>
<p style="margin:10px auto"><strong>json_tuple(jsonStr, k1, k2, ...)</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值：tuple</pre>
</div>
<p style="margin:10px auto"><strong>返回从URL中抽取指定N部分的内容，参数url是URL字符串，而参数p1,p2,....是要抽取的部分，这个参数包含HOST, PATH, QUERY, REF, PROTOCOL, AUTHORITY, FILE, USERINFO, QUERY:&lt;KEY&gt;</strong></p>
<div class="cnblogs_code" style='background-color:rgb(245,245,245); border:1px solid rgb(204,204,204); padding:5px; overflow:auto; margin:5px 0px; font-family:"Courier New"!important; font-size:12px!important'>
<pre style='margin-top:0px; margin-bottom:0px; margin-left:22px; white-space:pre-wrap; word-wrap:break-word; font-family:"Courier New"!important'><span style="color:rgb(0,128,128); line-height:1.5!important">1</span> 返回值；tuple</pre>
</div>
<p style="margin:10px auto"><strong>将结构体数组提取出来并插入到表中</strong> inline(ARRAY&lt;STRUCT[,STRUCT]&gt;)</p>
<p style="margin:10px auto"><br>
</p>
<p style="margin:10px auto">转自：https://www.cnblogs.com/yejibigdata/p/6380744.html</p>
<p style="margin:10px auto"> </p>
</div>
</div>
            </div>
                </div>