---
layout:     post
title:      分布式列式数据库HBase
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/qq_32297447/article/details/79325583				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:18px;"><strong></strong></span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;background-color:rgb(255,255,255);"><strong>本文概述：</strong></span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1、HBase概述</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2、HBase特点</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3、HBase和RDBMS以及HDFS的对比区别</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">4、HBase核心术语</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">5、HBase物理模型</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">6、HBase架构</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">7、HBase容错 </span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">8、HBase环境搭建 </span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase官网：</strong></span><a href="http://hbase.apache.org/" rel="nofollow"><span style="font-size:16px;color:rgb(0,56,132);"><u>http://hbase.apache.org/</u></span></a><span style="font-size:16px;color:rgb(57,57,57);">（</span><span style="font-size:16px;color:rgb(51,51,51);background-color:rgb(255,255,255);">Apache HBase是一个开源，分布式，版本化的非关系型数据库</span><span style="font-size:16px;color:rgb(57,57,57);">）</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase概述</strong></span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）构建在HDFS之上的，分布式、面向列的开源数据库</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2 ) 分布式： 分而治之</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3）面向列：HBase、Hive(ORC/Parquet)</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase特点</strong></span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）大：</span><span style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);">数十亿行*数百万列*数千个版本 = TB级或PB级的存储</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2）面向列：</span><span style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);">面向列(族)的存储和权限控制，列(族)独立检索</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3）稀疏：</span><span style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);">对于为空(null)的列，并不占用存储空间，因此，表可以设计的非常稀疏</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">4）数据类型单一：</span><span style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);">Hbase中的数据都是字符串，没有类型</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">5）无模式: 不同的行所对应的列是可以不同的</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">6）数据多版本：</span><span style="font-size:16px;color:rgb(62,62,62);background-color:rgb(255,255,255);">每个单元中的数据可以有多个版本，默认情况下版本号自动分配，是单元格插入时的时间戳；</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">Cell：一行一列交叉处可以有多个值</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase和RDBMS以及HDFS的对比区别</strong></span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:18px;"><strong></strong></span></div><p><img src="https://img-blog.csdn.net/20180214154729554" alt=""></p><p><img src="https://img-blog.csdn.net/20180214154741297" alt=""><br></p><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"></span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）phoenix、hive&amp;hbase</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2）hbase在上亿条的数据查询可以控制在毫秒或者秒内（rowkey的设计好坏）</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase核心术语</strong></span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）rowkey 主键</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	对应于RDBMS的主键</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	字符串，字典顺序存储，在HBase内存保存为字节数组</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	rowkey查询方式：单个rowkey、range、全表扫描</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2) column family/cf  列族</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	列族是在创建表的时候指定，一个列族包含多个列</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	private_info:age   private_info:tel</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	basic_info:name</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3) column 列</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	术语某个cf</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">4) timestamp 时间戳 &amp; cell</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	hbase中通过row和columns来确定一个cell</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	每个cell里面可以保存同一份数据的多个版本</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	在写入数据时，时间戳可以由hbase自动赋值，也可以手工赋值</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	{rowkey、cf、column、version} ==&gt; Cell</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase物理模型</strong></span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">table中的所有行都按照rowkey的字典序排列</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">table在行的方向上分割为多个Region</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">一个Region在同一时刻只能被同一个RegionServer管理</span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">RegionServer能管理多个Region</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1） Region：hbase中在行的方向上进行切割 </span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	Region1：  rowkey：1-100</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	Region2：  rowkey：101-200</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2） RegionServer： </span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	管理Region</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	一个Region在同一时刻只能被一个RegionServer管理</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	一个RegionServer能够管理多个Region</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">拆分Region？？</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	1）并行化</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	2）理解时可以对比MapReduce并行处理</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase架构</strong></span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:18px;"><strong></strong></span></div><div style="text-align:left;"><img src="https://img-blog.csdn.net/20180214154811183" alt=""></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"></span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）HDFS：存储数据</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2）Client： 客户端</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	与HBase进行读写操作</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	可以有多个client来访问HBase</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3) ZK</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	保证集群中只有一个HMaster</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	监控我们RegionServer的上线或者下线，并实时通知给Master</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">4) HMaster</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	为RegionServer分配Region</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	负责RegionServer的负载均衡</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	发现RegionServer失效了，会把该RegionServer上的Region分配到其他的RegionServer上去</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">5）HRegionServer</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	维护Region，处理对这些Region的IO请求</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	RegionServer负责切分在运行过程中变得过大的Region</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">6）HRegion</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	按行对rowkey对应的数据进行拆分</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">7）HLog</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	记录操作记录，为了容错处理</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">HBase是依赖于ZK的</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	1）ZK是外置的（建议）</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	2）HBase内置的</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase容错 </strong></span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）Master</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	ZK实现Master容错</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2）RegionServer</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	Master会将该RegionServer上管理的Region重新分配到其他的RegionServer上去（负载均衡的算法）</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3）zk</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	一般配置奇数个ZK实例，一个集群中配置7，9，11个实例</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	就不会存在单点故障</span></div><div style="text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase环境搭建 </strong></span></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>下载地址</strong></span><span style="font-size:16px;">：</span><a href="http://archive.cloudera.com/cdh5/cdh/5/" rel="nofollow"><span style="font-size:16px;color:rgb(0,56,132);"><u>http://archive.cloudera.com/cdh5/cdh/5/</u></span></a></div><div style="text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;color:rgb(57,57,57);"><strong>wget下载</strong></span><span style="font-size:16px;color:rgb(57,57,57);">：</span><a href="http://archive.cloudera.com/cdh5/cdh/5/hbase-1.2.0-cdh5.11.0.tar.gz" rel="nofollow"><span style="font-size:16px;color:rgb(0,56,132);"><u>http://archive.cloudera.com/cdh5/cdh/5/hbase-1.2.0-cdh5.11.0.tar.gz</u></span></a></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">1）conf/hbase-env.sh</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">export JAVA_HOME=/home/hadoop/app/jdk</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">export HBASE_MANAGES_ZK=false</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">2）conf/hbase-site.xml</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">&lt;property&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	&lt;name&gt;hbase.rootdir&lt;/name&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	&lt;value&gt;hdfs://master:8020/hbase&lt;/value&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">&lt;/property&gt;</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">hbase.rootdir指的是hbase的存储目录，它的值必须与hadoop/core-site.xml中fs.defaultFS保持一致</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">&lt;property&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	&lt;name&gt;hbase.cluster.distributed&lt;/name&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	&lt;value&gt;true&lt;/value&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">&lt;/property&gt;</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">运行模式，true分布式/伪分布式， false单机</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">&lt;property&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	&lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">	&lt;value&gt;master:2181&lt;/value&gt;</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">&lt;/property&gt;</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">指的是zk节点的主机名和端口，如果有多个，则使用逗号分隔(hadoop000:2181,hadoop001:2181)</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">3） regionservers</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">配置hbase regionserver的机器，多台的话，每行一个hostname</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>将HBASE配置到系统环境变量</strong></span><span style="font-size:16px;">（~/.bashrc ）</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">export HBASE_HOME=/home/hadoop/app/hbase</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">export PATH=$HBASE_HOME/bin:$PATH</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>HBase启动</strong></span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">bin/start-hbase.sh</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>启动成功</strong></span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>JPS会出现</strong></span><span style="font-size:16px;">：HMaster、HReqionServer</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>页面</strong></span><span style="font-size:16px;">：主机名:60010</span></div><div style="margin-left:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"><strong>hbase shell客户端</strong></span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">$HBASE_HOME/bin/hbase  shell</span></div><div style="margin-left:56px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;">help</span></div><div style="margin-left:28px;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:16px;"></span></div>            </div>
                </div>