---
layout:     post
title:      NameNode
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p>    HDFS采用Master/Slave架构。<strong>NameNode就是HDFS的Master架构。HDFS系统包括一个NameNode组件</strong></p><p><strong>    ·负责HDFS文件系统的<span style="font-weight:700;">名称空间(namespace)</span>管理</strong></p><p><strong>    ·执行客户端对文件的访问</strong></p><p><strong>    ·执行文件系统命名空间操作，如打开、关闭、重命名文件/目录</strong></p><p><strong>    ·决定block到DataNode的映射，记录了每个文件中各个块所在的数据节点的位置信息<br></strong></p><p></p><h3><strong><span style="color:#3333ff;">NameNode用于存储文件系统的元数据（Metadata）：</span></strong></h3><strong>    • 文件信息（name、updates、replication factor（副本因子）等）<br>    • 文件块的信息和位置<br>    • 文件的访问权限<br>    • 集群中文件的数量<br>    • 集群中DataNode的数量 <br></strong><p><strong>    在HDFS内部，一个文件被分成一个或多个Block，这些Block存储在DataNode集合里，NameNode就负责管理文件Block的所有元数据信息。</strong></p><p><strong>   <span style="color:#ff0000;"> 元数据信息主要为：</span></strong></p><p><span style="color:rgb(255,0,0);"><strong>    ·</strong>文件系统目录树的信息<br></span></p><p><span style="color:#ff0000;"><strong>    ·</strong> ”文件名-&gt;数据块“映射<br></span></p><p><span style="color:#ff0000;">  <strong>  ·</strong>”数据块-&gt;DataNode列表</span><span style="color:#ff0000;">“映射</span></p><p><span style="color:#333333;">    其中，</span><span style="color:#ff0000;">“文件名-&gt;数据块”保存在磁盘上进行持久化存储，NameNode上不保存“</span><span style="color:rgb(255,0,0);">数据块-&gt;DataNode列表</span><span style="color:rgb(255,0,0);">”</span><span style="color:rgb(255,0,0);">映射，该列表通过DataNode上报给NameNode建立起来的。</span></p><p></p><h3><strong><span style="color:#3366ff;">元数据信息会在硬盘上保存成以下文件：</span></strong></h3><p><span style="color:#333333;">• 镜像文件(FsImage)及修改日志(EditLog)</span></p><p><span style="color:#333333;">• NameNode使用FsImage存储文件系统的命名空间，包含文件的映射、文件</span><span style="color:rgb(51,51,51);">的属性信息等</span></p><span style="color:#333333;">    • <strong>FsImage文件包含文件系统中所有目录和文件inode的序列化形式</strong>。<br>    • <strong>每个inode是一个文件或目录的元数据的内部表示</strong>，并包含此类信息：<strong>文件的复制<br>    等级、修改和访问时间、访问权限、块大小以及组成文件的块。对于目录，则存<br>    储修改时间、权限和配额元数据</strong><br>    • </span><span style="color:#ff0000;"><strong>FsImage文件没有记录文件包含哪些块以及每个块存储在哪个数据节点。而是由名<br>    称节点把这些映射信息保留在内存中，当数据节点加入HDFS集群时，数据节点会<br>    把自己所包含的块列表告知给名称节点</strong></span><span style="color:#333333;">，此后会定期执行这种告知操作，以确保</span><br><p><span style="color:#333333;">    名称节点的块映射是最新的(文件-block映射存储在内存中) </span></p><p><span style="color:#333333;">• NameNode使用EditLog记录HDFS元数据的变化</span></p><span style="color:#333333;">• FsImage和EditLog文件都存储在NameNode的本地文件系统，位置由配置参<br>数dfs.namenode.name.dir指定。</span><br><p><span style="color:#333333;">• NameNode启动时，从磁盘中读取FsImage和EditLog文件，把EditLog的事务都应用到<br>FsImage的内存表现上，然后将新版本的FsImage刷新到本地磁盘的新的FsImage文件中。<br>然后它删除旧的EditLog。这个过程称为</span><span style="color:#3366ff;"><strong>检查点（CheckPoint)</strong></span><br></p><p><span style="color:#333333;">• 在名称节点启动的时候，它会将FsImage文件中的内容加载到内存中，之后再执行<br>EditLog文件中的各项操作，使得内存中的元数据和实际的同步，存在内存中的元数据支<br>持客户端的读操作。</span><br></p><p><span style="color:#333333;">• 当文件系统客户端(client)进行写操作时，首先把它记录在修改日志中(edit log)</span><br></p><p><span style="color:rgb(255,0,0);"><br></span></p><p><span style="color:rgb(255,0,0);"><br></span></p><p><span style="color:rgb(255,0,0);"><br></span></p><p><span style="color:rgb(255,0,0);"><br></span></p><p><span style="color:rgb(255,0,0);"><br></span></p><p><span style="color:rgb(255,0,0);"><br></span></p><p><span style="color:rgb(255,0,0);"><br></span></p>            </div>
                </div>