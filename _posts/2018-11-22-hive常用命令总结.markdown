---
layout:     post
title:      hive常用命令总结
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h2 id="toc0" style="font-size:24px;font-weight:normal;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
hive简介</h2>
<p style="color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;">
hive 是一个大数据仓库分析工具，它可以使用类似sql语句的方式操作集群上的数据文件。 </p>
<p style="color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;">
转述一段官网的描述： <br>
The Apache Hive™ data warehouse software facilitates reading, writing, and managing large datasets residing in distributed storage and queried using SQL syntax. <br>
 <br>
 <br>
Built on top of Apache Hadoop™, Hive provides the following features: <br>
 <br>
Tools to enable easy access to data via SQL, thus enabling data warehousing tasks such as extract/transform/load (ETL), reporting, and data analysis. <br>
A mechanism to impose structure on a variety of data formats <br>
Access to files stored either directly in Apache HDFS™ or in other data storage systems such as Apache HBase™ <br>
Query execution via Apache Tez™, Apache Spark™, or MapReduce <br>
Procedural language with HPL-SQL <br>
Sub-second query retrieval via Hive LLAP, Apache YARN and Apache Slider <br>
 <br>
hive官网wiki <br><a href="https://cwiki.apache.org/confluence/display/Hive/Home" rel="nofollow" style="color:rgb(85,144,204);">https://cwiki.apache.org/confluence/display/Hive/Home</a> <br>
 <br>
hive架构、工作原理 <br><a href="http://blog.csdn.net/u010330043/article/details/51225021" rel="nofollow" style="color:rgb(85,144,204);">http://blog.csdn.net/u010330043/article/details/51225021</a> <br>
 <br>
hive sql语句的解析执行过程 <br><a href="http://blog.csdn.net/jojo52013145/article/details/19206559" rel="nofollow" style="color:rgb(85,144,204);">http://blog.csdn.net/jojo52013145/article/details/19206559</a></p>
<hr style="border-right:0px;border-left:0px;border-top-style:solid;border-top-color:rgb(238,238,238);border-bottom-style:solid;border-bottom-color:rgb(255,255,255);color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;"><h2 id="toc1" style="font-size:24px;font-weight:normal;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
hive sql常见语句</h2>
<h5 id="toc2" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
1、创建表</h5>
<p style="color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;">
内表</p>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">create table aa</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">col1 </span><span class="kwd" style="color:rgb(0,0,136);">string</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);">col2 </span><span class="kwd" style="color:rgb(0,0,136);">int</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> partitioned </span><span class="kwd" style="color:rgb(0,0,136);">by</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate </span><span class="kwd" style="color:rgb(0,0,136);">int</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> ROW FORMAT DELIMITED   FIELDS TERMINATED BY </span><span class="str" style="color:rgb(0,136,0);">'\t'</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li></ol>
<p style="color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;">
<br>
外表</p>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">create external table bb</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">col1 </span><span class="kwd" style="color:rgb(0,0,136);">string</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> col2 </span><span class="kwd" style="color:rgb(0,0,136);">int</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);">  partitioned </span><span class="kwd" style="color:rgb(0,0,136);">by</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate </span><span class="kwd" style="color:rgb(0,0,136);">int</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> ROW FORMAT DELIMITED   FIELDS TERMINATED BY </span><span class="str" style="color:rgb(0,136,0);">'\t'</span><span class="pln" style="color:rgb(0,0,0);">  location </span><span class="str" style="color:rgb(0,136,0);">'/user/gaofei.lu/'</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<h5 id="toc3" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
2、查看表</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">show create table aa</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<h5 id="toc4" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
3、导入表数据</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pun" style="color:rgb(102,102,0);">本地数据：</span><span class="pln" style="color:rgb(0,0,0);">load data </span><span class="kwd" style="color:rgb(0,0,136);">local</span><span class="pln" style="color:rgb(0,0,0);"> inpath </span><span class="str" style="color:rgb(0,136,0);">' /home/gaofei.lu/aa.txt'</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">into</span><span class="pln" style="color:rgb(0,0,0);"> table aa partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170403</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">hdfs</span><span class="pun" style="color:rgb(102,102,0);">上数据：</span><span class="pln" style="color:rgb(0,0,0);">load data inpath </span><span class="str" style="color:rgb(0,136,0);">'/user/gaofei.lu/aa.txt'</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">into</span><span class="pln" style="color:rgb(0,0,0);"> table bb partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170403</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li></ol>
<h5 id="toc5" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
4、修改表属性</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table aa </span><span class="kwd" style="color:rgb(0,0,136);">set</span><span class="pln" style="color:rgb(0,0,0);"> tblproperties </span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="str" style="color:rgb(0,136,0);">'EXTERNAL'</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">'TRUE'</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table bb </span><span class="kwd" style="color:rgb(0,0,136);">set</span><span class="pln" style="color:rgb(0,0,0);"> tblproperties </span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="str" style="color:rgb(0,136,0);">'EXTERNAL'</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">'FALSE'</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li></ol>
<h5 id="toc6" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
5、修改列</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pun" style="color:rgb(102,102,0);">修改列名和列数据类型：</span><span class="pln" style="color:rgb(0,0,0);">alter table aa change col2 name </span><span class="kwd" style="color:rgb(0,0,136);">string</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pun" style="color:rgb(102,102,0);">修改位置放置第一位：</span><span class="pln" style="color:rgb(0,0,0);">alter table aa change col2 name </span><span class="kwd" style="color:rgb(0,0,136);">string</span><span class="pln" style="color:rgb(0,0,0);"> first</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pun" style="color:rgb(102,102,0);">修改位置指定某一列后面：</span><span class="pln" style="color:rgb(0,0,0);">alter table aa change col1 dept </span><span class="kwd" style="color:rgb(0,0,136);">string</span><span class="pln" style="color:rgb(0,0,0);"> after name</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<h5 id="toc7" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
6、添加列(慎用)</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table aa add columns</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">col3 </span><span class="kwd" style="color:rgb(0,0,136);">string</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li></ol>
<h5 id="toc8" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
7、表的重命名</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table aa rename to aa_test</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<h5 id="toc9" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
8、添加分区</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table aa add partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170404</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table bb add partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170404</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> location </span><span class="str" style="color:rgb(0,136,0);">'/user/gaofei.lu/20170404.txt'</span></code></li></ol>
<h5 id="toc10" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
9、显示分区</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">show partitions aa</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<h5 id="toc11" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
10、修改分区</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table aa partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170404</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> rename to partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170405</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table bb partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170404</span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">set</span><span class="pln" style="color:rgb(0,0,0);"> location </span><span class="str" style="color:rgb(0,136,0);">'/user/gaofei.lu/aa.txt'</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<h5 id="toc12" style="font-size:14px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
11、删除分区</h5>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">alter table aa drop </span><span class="kwd" style="color:rgb(0,0,136);">if</span><span class="pln" style="color:rgb(0,0,0);"> exists partition</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">statdate</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">20170404</span><span class="pun" style="color:rgb(102,102,0);">);</span></code></li></ol>
<h4 id="toc13" style="font-size:16px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
12、beeline连接</h4>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">beeline</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pun" style="color:rgb(102,102,0);">!</span><span class="pln" style="color:rgb(0,0,0);">connect jdbc</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);">hive2</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="com" style="color:rgb(136,0,0);">//192.168.1.17:10000</span></code></li></ol>
<h4 id="toc14" style="font-size:16px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
13、设置hive on spark</h4>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">set</span><span class="pln" style="color:rgb(0,0,0);"> hive</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">execution</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">engine</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);">spark</span></code></li></ol>
<h4 id="toc15" style="font-size:16px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
14、终止任务</h4>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">yarn application </span><span class="pun" style="color:rgb(102,102,0);">-</span><span class="pln" style="color:rgb(0,0,0);">kill job_id</span></code></li></ol>
<h4 id="toc16" style="font-size:16px;line-height:1.5;font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;color:rgb(73,83,95);">
15、指定分隔符导出文件</h4>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">insert overwrite </span><span class="kwd" style="color:rgb(0,0,136);">local</span><span class="pln" style="color:rgb(0,0,0);"> directory </span><span class="str" style="color:rgb(0,136,0);">'/home/hadoop/gaofeilu/test_delimited.txt'</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">row format delimited</span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">fields terminated </span><span class="kwd" style="color:rgb(0,0,136);">by</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">'\t'</span></code></li><li class="L3" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">select</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="pun" style="color:rgb(102,102,0);">*</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">from</span><span class="pln" style="color:rgb(0,0,0);"> test</span><span class="pun" style="color:rgb(102,102,0);">;</span></code></li></ol>
<p style="color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;">
 <br><strong>分区与表的常见操作</strong> <br><a href="https://www.iteblog.com/archives/1537.html" rel="nofollow" style="color:rgb(85,144,204);">https://www.iteblog.com/archives/1537.html</a> <br>
 <br><strong>hive常见函数</strong> <br><a href="http://www.mamicode.com/info-detail-933740.html" rel="nofollow" style="color:rgb(85,144,204);">http://www.mamicode.com/info-detail-933740.html</a> <br>
 <br><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF" rel="nofollow" style="color:rgb(85,144,204);">https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF</a></p>
<p style="color:rgb(54,59,66);font-family:'Helvetica Neue', 'Helvetica Neue', Helvetica, Arial, 'Lantinghei SC', 'Hiragino Sans GB', 'Microsoft Yahei', sans-serif;font-size:14px;">
 <br>
 <br>
python连接hiveserver2</p>
<pre class="prettyprint linenums prettyprinted" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:13px;color:rgb(51,51,51);background-color:rgb(246,246,246);"></pre><ol class="linenums" style="color:rgb(153,153,153);"><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">import</span><span class="pln" style="color:rgb(0,0,0);"> time</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">import</span><span class="pln" style="color:rgb(0,0,0);"> sys </span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">import</span><span class="pln" style="color:rgb(0,0,0);"> os</span></code></li><li class="L3" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">import</span><span class="pln" style="color:rgb(0,0,0);"> pyhs2</span></code></li><li class="L4" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">from</span><span class="pln" style="color:rgb(0,0,0);"> pyhs2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">error </span><span class="kwd" style="color:rgb(0,0,136);">import</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Pyhs2Exception</span></code></li><li class="L5" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">try_limit</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">2</span></code></li><li class="L6" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"></code></li><li class="L7" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">class</span><span class="pln" style="color:rgb(0,0,0);"> lib_hive2_query</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="kwd" style="color:rgb(0,0,136);">object</span><span class="pun" style="color:rgb(102,102,0);">):</span></code></li><li class="L8" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">    </span><span class="kwd" style="color:rgb(0,0,136);">def</span><span class="pln" style="color:rgb(0,0,0);"> __init__</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="kwd" style="color:rgb(0,0,136);">self</span><span class="pun" style="color:rgb(102,102,0);">):</span><span class="pln" style="color:rgb(0,0,0);">    </span></code></li><li class="L9" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="kwd" style="color:rgb(0,0,136);">global</span><span class="pln" style="color:rgb(0,0,0);"> conn</span></code></li><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="kwd" style="color:rgb(0,0,136);">global</span><span class="pln" style="color:rgb(0,0,0);"> cur       </span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        conn </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> pyhs2</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">connect</span><span class="pun" style="color:rgb(102,102,0);">(</span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                               host</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">'192.168.1.17'</span><span class="pun" style="color:rgb(102,102,0);">,</span></code></li><li class="L3" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                               port</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="lit" style="color:rgb(0,102,102);">10000</span><span class="pun" style="color:rgb(102,102,0);">,</span></code></li><li class="L4" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                               authMechanism</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">"PLAIN"</span><span class="pun" style="color:rgb(102,102,0);">,</span></code></li><li class="L5" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                               user</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">'hadoop'</span><span class="pun" style="color:rgb(102,102,0);">,</span></code></li><li class="L6" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                               password</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">''</span><span class="pun" style="color:rgb(102,102,0);">,</span></code></li><li class="L7" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                               </span><span class="pun" style="color:rgb(102,102,0);">)</span><span class="pln" style="color:rgb(0,0,0);">    </span></code></li><li class="L8" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="kwd" style="color:rgb(0,0,136);">print</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"init ok"</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li><li class="L9" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        cur </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> conn</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">cursor</span><span class="pun" style="color:rgb(102,102,0);">()</span><span class="pln" style="color:rgb(0,0,0);">  </span></code></li><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">    </span><span class="kwd" style="color:rgb(0,0,136);">def</span><span class="pln" style="color:rgb(0,0,0);"> hiveExe</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="kwd" style="color:rgb(0,0,136);">self</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">):</span><span class="pln" style="color:rgb(0,0,0);">         </span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        try_time </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li><li class="L3" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        succ </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">False</span></code></li><li class="L4" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="kwd" style="color:rgb(0,0,136);">while</span><span class="pln" style="color:rgb(0,0,0);"> try_time </span><span class="pun" style="color:rgb(102,102,0);">&lt;=</span><span class="pln" style="color:rgb(0,0,0);"> try_limit </span><span class="kwd" style="color:rgb(0,0,136);">and</span><span class="pln" style="color:rgb(0,0,0);"> succ </span><span class="pun" style="color:rgb(102,102,0);">==</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">False</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li><li class="L5" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">            </span><span class="kwd" style="color:rgb(0,0,136);">try</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li><li class="L6" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                try_time </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> try_time </span><span class="pun" style="color:rgb(102,102,0);">+</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">1</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li><li class="L7" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                cur</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">execute</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">sql</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L8" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="kwd" style="color:rgb(0,0,136);">for</span><span class="pln" style="color:rgb(0,0,0);"> i </span><span class="kwd" style="color:rgb(0,0,136);">in</span><span class="pln" style="color:rgb(0,0,0);"> cur</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">fetch</span><span class="pun" style="color:rgb(102,102,0);">():</span></code></li><li class="L9" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                    </span><span class="kwd" style="color:rgb(0,0,136);">print</span><span class="pln" style="color:rgb(0,0,0);"> i</span></code></li><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                succ </span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="kwd" style="color:rgb(0,0,136);">True</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="kwd" style="color:rgb(0,0,136);">return</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">0</span><span class="pln" style="color:rgb(0,0,0);">   </span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">            </span><span class="kwd" style="color:rgb(0,0,136);">except</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="typ" style="color:rgb(102,0,102);">Pyhs2Exception</span><span class="pun" style="color:rgb(102,102,0);">,</span><span class="pln" style="color:rgb(0,0,0);"> ex</span><span class="pun" style="color:rgb(102,102,0);">:</span><span class="pln" style="color:rgb(0,0,0);">          </span></code></li><li class="L3" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="kwd" style="color:rgb(0,0,136);">print</span><span class="pln" style="color:rgb(0,0,0);"> str</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">ex</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L4" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="kwd" style="color:rgb(0,0,136);">if</span><span class="pln" style="color:rgb(0,0,0);"> try_time </span><span class="pun" style="color:rgb(102,102,0);">&gt;</span><span class="pln" style="color:rgb(0,0,0);"> try_limit</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li><li class="L5" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                    </span><span class="kwd" style="color:rgb(0,0,136);">return</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="lit" style="color:rgb(0,102,102);">1</span></code></li><li class="L6" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                time</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">sleep</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="lit" style="color:rgb(0,102,102);">10</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li><li class="L7" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">            </span><span class="kwd" style="color:rgb(0,0,136);">finally</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li><li class="L8" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">                </span><span class="kwd" style="color:rgb(0,0,136);">print</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">"end query"</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li><li class="L9" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"></code></li><li class="L0" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">    </span><span class="kwd" style="color:rgb(0,0,136);">def</span><span class="pln" style="color:rgb(0,0,0);"> __del__</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="kwd" style="color:rgb(0,0,136);">self</span><span class="pun" style="color:rgb(102,102,0);">):</span></code></li><li class="L1" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        </span><span class="kwd" style="color:rgb(0,0,136);">if</span><span class="pln" style="color:rgb(0,0,0);"> conn</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li><li class="L2" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">            conn</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">close</span><span class="pun" style="color:rgb(102,102,0);">()</span></code></li><li class="L3" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"></code></li><li class="L4" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"></code></li><li class="L5" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="kwd" style="color:rgb(0,0,136);">if</span><span class="pln" style="color:rgb(0,0,0);"> __name__ </span><span class="pun" style="color:rgb(102,102,0);">==</span><span class="pln" style="color:rgb(0,0,0);"> </span><span class="str" style="color:rgb(0,136,0);">'__main__'</span><span class="pun" style="color:rgb(102,102,0);">:</span></code></li><li class="L6" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        hiveClient</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="pln" style="color:rgb(0,0,0);">lib_hive2_query</span><span class="pun" style="color:rgb(102,102,0);">()</span></code></li><li class="L7" style="list-style:decimal;line-height:1.8;background:rgb(238,238,238);"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        hive_sql</span><span class="pun" style="color:rgb(102,102,0);">=</span><span class="str" style="color:rgb(0,136,0);">"select * from db_model.s_request_d limit 10"</span><span class="pln" style="color:rgb(0,0,0);"> </span></code></li><li class="L8" style="list-style:decimal;line-height:1.8;"><code class="language-" style="font-family:Monaco, Menlo, Consolas, 'Courier New', monospace;font-size:14px;color:rgb(221,17,68);border:0px;"><span class="pln" style="color:rgb(0,0,0);">        hiveClient</span><span class="pun" style="color:rgb(102,102,0);">.</span><span class="pln" style="color:rgb(0,0,0);">hiveExe</span><span class="pun" style="color:rgb(102,102,0);">(</span><span class="pln" style="color:rgb(0,0,0);">hive_sql</span><span class="pun" style="color:rgb(102,102,0);">)</span></code></li></ol>
            </div>
                </div>