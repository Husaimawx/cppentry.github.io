---
layout:     post
title:      Hive的API操作
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">基于hadoop的Hive数据仓库JavaAPI简单调用的实例，关于Hive的简介在此不赘述。hive提供了三种用户接口：CLI，JDBC/ODBC和 WebUI</span></p>
<ol style="font-size:14px;font-family:Helvetica, Tahoma, Arial, sans-serif;color:rgb(57,57,57);line-height:24.5px;"><li style="font-size:1em;background-color:inherit;"><span style="color:rgb(0,128,0);background-color:inherit;">CLI，即Shell命令行</span></li><li style="font-size:1em;background-color:inherit;"><span style="color:rgb(0,128,0);background-color:inherit;">JDBC/ODBC 是 Hive 的Java，与使用传统数据库JDBC的方式类似</span></li><li style="font-size:1em;background-color:inherit;"><span style="color:rgb(0,128,0);background-color:inherit;">WebGUI是通过浏览器访问 Hive</span></li></ol><p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">本文主要介绍的就是第二种用户接口，直接进入正题。</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">1、Hive 安装：</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">1）hive的安装请参考网上的相关文章，测试时只在hadoop一个节点上安装hive即可。</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">2）测试数据data文件'\t'分隔：</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">1 zhangsan</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">2 lisi</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">3 wangwu</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">3）将测试数据data上传到linux目录下，我放置在：/home/hadoop01/data</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">2、在使用 JDBC 开发 Hive 程序时, 必须首先开启 Hive 的远程服务接口。使用下面命令进行开启:</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;"></span></p>
<div style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;">
<div style="font-weight:bold;background-color:inherit;">Java代码 <img alt="收藏代码" src="http://note.youdao.com/yws/public/resource/53fb2887c69311b05bfbd30d7cd94189/9924D3943924456688A034FB89F65212" style="display:inline-block;background-color:inherit;"><div class="img-title" style="background-color:inherit;">收藏代码</div>
</div>
<ol start="1" style="font-size:1em;color:rgb(43,145,175);line-height:1.75;"><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">hive --service hiveserver &gt;/dev/<span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span> <span style="color:rgb(192,0,0);background-color:inherit;">2</span>&gt;/dev/<span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span> &amp;</span></li></ol></div>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
</p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
</p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">3、测试代码：</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
</p>
<div style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;">
<div style="font-weight:bold;background-color:inherit;">Java代码 <img alt="收藏代码" src="http://note.youdao.com/yws/public/resource/53fb2887c69311b05bfbd30d7cd94189/9924D3943924456688A034FB89F65212" style="display:inline-block;background-color:inherit;"><div class="img-title" style="background-color:inherit;">收藏代码</div>
</div>
<ol start="1" style="font-size:1em;color:rgb(43,145,175);line-height:1.75;"><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>import</strong></span> java.sql.Connection;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>import</strong></span> java.sql.DriverManager;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>import</strong></span> java.sql.ResultSet;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>import</strong></span> java.sql.SQLException;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>import</strong></span> java.sql.Statement;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>import</strong></span> org.apache.log4j.Logger;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><br style="background-color:inherit;"></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>public</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>class</strong></span> HiveJdbcCli
 {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> String
 driverName = <span style="color:#0000FF;background-color:inherit;">"org.apache.hadoop.hive.jdbc.HiveDriver"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> String
 url = <span style="color:#0000FF;background-color:inherit;">"jdbc:hive://hadoop3:10000/default"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> String
 user = <span style="color:#0000FF;background-color:inherit;">"hive"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> String
 password = <span style="color:#0000FF;background-color:inherit;">"mysql"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> String
 sql = <span style="color:#0000FF;background-color:inherit;">""</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> ResultSet
 res;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>final</strong></span> Logger
 log = Logger.getLogger(HiveJdbcCli.<span style="color:rgb(127,0,85);background-color:inherit;"><strong>class</strong></span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>public</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> main(String[]
 args) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">Connection conn = <span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">Statement stmt = <span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>try</strong></span> {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">conn = getConn();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">stmt = conn.createStatement();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 第一步:存在就先删除</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">String tableName = dropTable(stmt);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 第二步:不存在就创建</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">createTable(stmt, tableName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 第三步:查看创建的表</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">showTables(stmt, tableName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 执行describe table操作</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">describeTables(stmt, tableName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 执行load data into table操作</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">loadData(stmt, tableName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 执行 select * query 操作</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">selectData(stmt, tableName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 执行 regular hive query 统计操作</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">countData(stmt, tableName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">} <span style="color:rgb(127,0,85);background-color:inherit;"><strong>catch</strong></span> (ClassNotFoundException e) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">e.printStackTrace();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">log.error(driverName + <span style="color:#0000FF;background-color:inherit;">" not found!"</span>, e);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.exit(<span style="color:rgb(192,0,0);background-color:inherit;">1</span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">} <span style="color:rgb(127,0,85);background-color:inherit;"><strong>catch</strong></span> (SQLException e) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">e.printStackTrace();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">log.error(<span style="color:#0000FF;background-color:inherit;">"Connection error!"</span>, e);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.exit(<span style="color:rgb(192,0,0);background-color:inherit;">1</span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">} <span style="color:rgb(127,0,85);background-color:inherit;"><strong>finally</strong></span> {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>try</strong></span> {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>if</strong></span> (conn != <span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span>)
 {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">conn.close();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">conn = <span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>if</strong></span> (stmt != <span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span>)
 {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">stmt.close();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">stmt = <span style="color:rgb(127,0,85);background-color:inherit;"><strong>null</strong></span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">} <span style="color:rgb(127,0,85);background-color:inherit;"><strong>catch</strong></span> (SQLException e) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">e.printStackTrace();</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> countData(Statement
 stmt, String tableName)</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"select count(1) from "</span> + tableName;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"Running:"</span> + sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">res = stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"执行“regular hive query”运行结果:"</span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>while</strong></span> (res.next()) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"count ------&gt;"</span> + res.getString(<span style="color:rgb(192,0,0);background-color:inherit;">1</span>));</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> selectData(Statement
 stmt, String tableName)</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"select * from "</span> + tableName;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"Running:"</span> + sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">res = stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"执行 select * query 运行结果:"</span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>while</strong></span> (res.next()) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(res.getInt(<span style="color:rgb(192,0,0);background-color:inherit;">1</span>) + <span style="color:#0000FF;background-color:inherit;">"\t"</span> +
 res.getString(<span style="color:rgb(192,0,0);background-color:inherit;">2</span>));</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> loadData(Statement
 stmt, String tableName)</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">String filepath = <span style="color:#0000FF;background-color:inherit;">"/home/hadoop01/data"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"load data local inpath '"</span> + filepath + <span style="color:#0000FF;background-color:inherit;">"'
 into table "</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">+ tableName;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"Running:"</span> + sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">res = stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> describeTables(Statement
 stmt, String tableName)</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"describe "</span> + tableName;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"Running:"</span> + sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">res = stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"执行 describe table 运行结果:"</span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>while</strong></span> (res.next()) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(res.getString(<span style="color:rgb(192,0,0);background-color:inherit;">1</span>) + <span style="color:#0000FF;background-color:inherit;">"\t"</span> +
 res.getString(<span style="color:rgb(192,0,0);background-color:inherit;">2</span>));</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> showTables(Statement
 stmt, String tableName)</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"show tables '"</span> + tableName + <span style="color:#0000FF;background-color:inherit;">"'"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"Running:"</span> + sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">res = stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(<span style="color:#0000FF;background-color:inherit;">"执行 show tables 运行结果:"</span>);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>if</strong></span> (res.next()) {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">System.out.println(res.getString(<span style="color:rgb(192,0,0);background-color:inherit;">1</span>));</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>void</strong></span> createTable(Statement
 stmt, String tableName)</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"create table "</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">+ tableName</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">+ <span style="color:#0000FF;background-color:inherit;">" (key int, value string) row format delimited fields terminated by '\t'"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> String
 dropTable(Statement stmt) <span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(0,130,0);background-color:inherit;">// 创建的表名</span></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">String tableName = <span style="color:#0000FF;background-color:inherit;">"testHive"</span>;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">sql = <span style="color:#0000FF;background-color:inherit;">"drop table "</span> + tableName;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">stmt.executeQuery(sql);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>return</strong></span> tableName;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>private</strong></span> <span style="color:rgb(127,0,85);background-color:inherit;"><strong>static</strong></span> Connection
 getConn() <span style="color:rgb(127,0,85);background-color:inherit;"><strong>throws</strong></span> ClassNotFoundException,</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">SQLException {</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">Class.forName(driverName);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">Connection conn = DriverManager.getConnection(url, user, password);</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"><span style="color:rgb(127,0,85);background-color:inherit;"><strong>return</strong></span> conn;</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;"></span></li><li style="font-size:1em;background-color:rgb(250,250,250);"><span style="color:#000000;background-color:inherit;">}</span></li></ol></div>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
</p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">4、测试结果</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<img height="393" width="700" src="http://note.youdao.com/yws/public/resource/53fb2887c69311b05bfbd30d7cd94189/750ACC0AA7314CD99EB1A9A27BDE0BE4" title="点击查看原始大小图片" alt="" style="display:inline-block;background-color:inherit;"></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
</p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">5、终端查询结果：</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">hive&gt; select * from testHive;</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">OK</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">1 zhangsan</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">2 lisi</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">3 wangwu</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">Time taken: 11.232 seconds</span></p>
<p style="font-size:14px;line-height:24.5px;font-family:Helvetica, Tahoma, Arial, sans-serif;">
<span style="color:rgb(0,128,0);background-color:inherit;">hive&gt;</span></p>
            </div>
                </div>