---
layout:     post
title:      hadoop federation 与hadoop HA
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><span style="font-size:18px;">Hadoop Federation</span></p>
<p><span style="font-size:18px;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">的内存中存储了每个文件在文件系统中的块的引用，如果文件的数量巨大，则内存会成为集群扩展的关键因素。</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">Hadoop
 2.x</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">版本中引入</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">HDFS federation</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">，此机制允许集群添加多个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">扩展集群，每一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">管理文件系统中的部分命名空间，且各个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">之间不会通信，一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">的宕机或出错不会影响其他</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">的可用性。比如，一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">管理以</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">/user</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">为根的文件，另一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">管理以</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">/share</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">为根的文件。在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hadoop
 federation</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">集群中的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">datanode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">会向集群中每个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">发送块列表等信息。</span></span></p>
<p lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><span style="font-size:18px;"> </span></p>
<p lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><span style="font-size:18px;">Hadoop HA</span></p>
<p><span style="font-size:18px;"><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">因为</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hadoop</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">集群中仅仅存在一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">，当</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">出现故障时，客户端将无法读、写文件列表，整个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hadoop</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">集群将停止服务，直到新的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">使用。因为</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">是唯一的元数据存储库，也是唯一的记录文件到块映射的节点。如果要在唯一一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">宕机的情况下恢复集群服务，管理员可以使用新的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">，等到新</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">将</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">fsimage</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">加载到内存中、加载</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">edis
 log</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">、接受完成所有</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">datanode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">的块报告而退出安全模式时，才可以继续提供客户端的服务。由此可见，处理</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">宕机需要花费较长的时间。</span></span></p>
<p><span style="font-size:18px;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">Hadoop HA</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">解决了唯一</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">宕机时停止服务的问题。</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">Hadoop
 HA</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">中配置一对</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">，一个为</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">active</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">，另一个作为备用。如果</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">active</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">出现问题则集群自动将备用的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">调整为</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">active</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">状态，从而继续为客户提供服务，不会造成集群的重大中断。</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">datanode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">需要向两个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">发送块报告，因为文件与块的映射是存储在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">namenode</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">的内存中的。</span></span></p>
            </div>
                </div>