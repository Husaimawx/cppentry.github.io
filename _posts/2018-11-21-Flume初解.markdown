---
layout:     post
title:      Flume初解
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <div style="white-space:pre-wrap;text-align:center;text-indent:252px;line-height:1.75;font-size:14px;"><span style="font-size:26px;"><strong>Flume</strong></span></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*Flume OG --&gt;Flume NG  是Cloudera 提供的一个分布式、可靠、可用的系统(两个版本不兼容)；Flume NG更像是一个轻量的小工具，非常简单，容易适应各种方式日志手机，并支持failover和负载均衡</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*Flume使用Java编写，需运行在java1.6或以上版本</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*Hadoop离线计算开发流程图：</div><div style="text-align:center;float:none;"><div style="text-align:center;float:none;"><div style="text-align:center;float:none;"><img src="https://img-blog.csdn.net/20180529081608461" style="font-size:14px;text-align:left;text-indent:28px;white-space:pre-wrap;" alt=""></div></div></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*js埋点、爬虫都可收集页面数据</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*MR也可以称为ETL，数据清洗转换过程</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*数据处理就是在玩字符串</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*存入到哪里，由架构师根据实际情况决定</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*Hive统计、分析：业务指标的分析</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*利用Sqoop将Hive数据导入到Mysql</div><div style="white-space:pre-wrap;text-indent:56px;text-align:left;line-height:1.75;font-size:14px;">Hive是数据仓库，查询速度慢，异构数据库用Sqoop导</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">Flume架构概念图</div><div style="text-align:center;float:none;"></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"> 	*Flume是分布式的日志收集系统</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><img src="https://img-blog.csdn.net/20180529081635158" alt=""><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*Event</div><div style="text-align:center;float:none;"><img src="https://img-blog.csdn.net/20180529081659209" alt=""></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="text-align:center;float:none;"><img src="https://img-blog.csdn.net/20180529081719724" alt=""></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*假如监控的是文本数据，那么每一行数据就是一个Event，Event是Flume传输数据的基本单位，也是事物的基本单元，是流动的</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*一套source、channel、sink组成了agent，是Flume的运行的基本单元</div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;">*channer是为了保证数据传输的安全</div><div style="text-align:center;float:none;"></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><img src="https://img-blog.csdn.net/20180529081737849" alt=""><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><img src="https://img-blog.csdn.net/20180529081807936" alt=""><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><img src="https://img-blog.csdn.net/20180529081825104" alt=""><br></div><div style="white-space:pre-wrap;text-indent:28px;text-align:left;line-height:1.75;font-size:14px;"><img src="https://img-blog.csdn.net/20180529081848691" alt=""><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="text-align:center;float:none;"></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">*avro:两个Agent交互的时候才会用</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">*Exec Source:监控一个文件内部的变化，利用底层的Linux命令</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">*Spooling Dircetory Source:检测指定目录内数据变化，只能监控到添加删除</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">*NetCat Source:监控一个端口数据的变化</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">*HTTP Source:能检测到post,get等变化</div><div style="text-align:center;float:none;"><img src="https://img-blog.csdn.net/20180529081909199" alt=""></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><img src="https://img-blog.csdn.net/20180529081939155" alt=""><br></div><div style="text-align:left;float:none;"></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">*内存溢出：堆内存(大块内存)、栈内存(小块内存) 一般情况下是堆内存溢出</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><span style="font-size:18px;">例：</span></div><img src="https://img-blog.csdn.net/20180529082001746" alt=""><p></p><div style="text-align:left;float:none;"></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">先定义agent的名称、三个子配置</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">进入sources配置，为a1这个agent的配置类型为netcat，监控某个端口号，配置端口号IP地址，</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">然后进入sink 定义sink的类型为logger，</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">然后定义channel类型为memory,设置最大存储的channels为1000，收集100条的时候再传出，</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;">最后定义a1的sources指定的存放channels=c1 下一步将sinks指定取出的地点c1</div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><div style="white-space:pre-wrap;text-align:left;line-height:1.75;font-size:14px;"><br></div><p></p><p><br></p><p><br></p>            </div>
                </div>