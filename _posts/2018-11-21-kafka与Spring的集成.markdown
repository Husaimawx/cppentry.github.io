---
layout:     post
title:      kafka与Spring的集成
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h1 class="postTitle" style="font-size:28px;font-weight:400;line-height:1.8;color:rgb(51,51,51);font-family:Verdana, Arial, Helvetica, sans-serif;">
<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/wangb0402/p/6187796.html" rel="nofollow" style="color:rgb(51,51,51);text-decoration:none;">kafka与Spring的集成</a></h1>
<div class="clear" style="clear:both;color:rgb(125,139,141);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:25px;">
</div>
<div class="postBody" style="color:rgb(125,139,141);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;line-height:25px;">
<div id="cnblogs_post_body" style="color:rgb(51,51,51);line-height:1.8;">
<h1 style="font-size:28px;line-height:1.5;">准备工作</h1>
<p>kafka版本：kafka_2.10-0.10.1.0</p>
<p>spring版本：spring4.3</p>
<h1 style="font-size:28px;line-height:1.5;">配置文件</h1>
<h2 style="font-size:21px;line-height:1.5;">pom文件配置（也可以直接下载jar包）</h2>
<p><span style="color:rgb(51,102,255);">Kafka<span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">spring</span><span style="font-family:'宋体';">集成的支持类库，</span><span style="font-family:Calibri;">spring</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">kafka</span><span style="font-family:'宋体';">通信监听</span></span></p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;">1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">2</span> 　　<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>org.springframework.integration<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">3</span> 　　<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>spring-integration-kafka<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">4</span> 　　<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>1.3.0.RELEASE<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">5</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span></pre>
</div>
<p><span style="color:rgb(51,102,255);">kafka<span style="font-family:'宋体';">发送消息以及接受消息使用的类库</span></span></p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;">1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">2</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>org.apache.kafka<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">3</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>kafka-clients<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">4</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>0.10.1.0<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">5</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span></pre>
</div>
<p><span style="color:rgb(51,102,255);"><span style="font-family:'宋体';">使用高版本是因为低版本无法支持</span>kafka<span style="font-family:'宋体';">监听，</span><span style="font-family:Calibri;">spring</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">kafka</span><span style="font-family:'宋体';">集成不好</span></span></p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;">1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">2</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>org.springframework<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">3</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>spring-webmvc<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">4</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>4.3.0.RELEASE<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">5</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span></pre>
</div>
<p><span style="color:rgb(51,102,255);">kafka<span style="font-family:'宋体';">自带监听器，依赖于</span><span style="font-family:Calibri;">spring</span><span style="font-family:'宋体';">，所以需要和</span><span style="font-family:Calibri;">pring-integration-kafka</span><span style="font-family:'宋体';">结合使用</span></span></p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;">1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">2</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>org.springframework.kafka<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">groupId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">3</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>spring-kafka<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">artifactId</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">4</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>1.0.0.RC1<span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">version</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">5</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">dependency</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span></pre>
</div>
<h2 style="font-size:21px;line-height:1.5;">producer配置</h2>
<p><span style="color:rgb(255,0,0);">　　1.如果你的topic没有设置名称，按照默认的topic的名字生成对应的数据文件夹。</span></p>
<p><span style="color:rgb(255,0,0);">　　2.producerListener用来判断kafka发送数据是否成功以及发送反馈信息。</span></p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;?</span><span style="color:rgb(255,0,255);line-height:1.5 !important;">xml version="1.0" encoding="UTF-8"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">?&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 2</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">beans </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">xmlns</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.springframework.org/schema/beans"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 3</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">    xmlns:xsi</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.w3.org/2001/XMLSchema-instance"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> xmlns:context</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.springframework.org/schema/context"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 4</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">    xsi:schemaLocation</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.springframework.org/schema/beans
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 5</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">         http://www.springframework.org/schema/beans/spring-beans.xsd
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 6</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">         http://www.springframework.org/schema/context
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 7</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">         http://www.springframework.org/schema/context/spring-context.xsd"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 8</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 9</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 定义producer的参数 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">10</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerProperties"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="java.util.HashMap"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">11</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">12</span>             <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">map</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">13</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="bootstrap.servers"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="localhost:7000"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">14</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="group.id"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="0"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">15</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="retries"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="1"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">16</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="batch.size"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="16384"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">17</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="linger.ms"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="1"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">18</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="buffer.memory"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="33554432"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">19</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="key.serializer"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">20</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">                value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.apache.kafka.common.serialization.StringSerializer"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">21</span>                 <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="value.serializer"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">22</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">                value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.apache.kafka.common.serialization.StringSerializer"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">23</span>             <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">map</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">24</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">25</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">26</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">27</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 创建kafkatemplate需要使用的producerfactory bean </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">28</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerFactory"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">29</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">        class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.core.DefaultKafkaProducerFactory"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">30</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">31</span>             <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">ref </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerProperties"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">32</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">33</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">34</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">35</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 创建kafkatemplate bean，使用的时候，只需要注入这个bean，即可使用template的send消息方法 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">36</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="KafkaTemplate"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.core.KafkaTemplate"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">37</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerFactory"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">38</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">name</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="autoFlush"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="true"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">39</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">property </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">name</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="defaultTopic"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="defaultTopic"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">40</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">property </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">name</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerListener"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerListener"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">41</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">42</span>     
<span style="color:rgb(0,128,128);line-height:1.5 !important;">43</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="producerListener"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="com.git.kafka.producer.KafkaProducerListener"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">44</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">beans</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;<br></span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<h2 style="font-size:21px;line-height:1.5;">consumer配置</h2>
<p>　　<span style="color:rgb(255,0,0);">1.使用kafka的listener进行消息消费监听，如果有消费消息进入会自动调用OnMessage方法进行消息消费以及后续业务处理。</span></p>
<p><span style="color:rgb(255,0,0);">　　2.<span style="font-family:Consolas;">如果要配置多个</span>topic，需要创建新的消费者容器，然后统一指向listner的消息处理类，统一让这个类进行后续业务处理。</span></p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;?</span><span style="color:rgb(255,0,255);line-height:1.5 !important;">xml version="1.0" encoding="UTF-8"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">?&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 2</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">beans </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">xmlns</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.springframework.org/schema/beans"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 3</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">     xmlns:xsi</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.w3.org/2001/XMLSchema-instance"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 4</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">     xmlns:context</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.springframework.org/schema/context"</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 5</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">     xsi:schemaLocation</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="http://www.springframework.org/schema/beans 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 6</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">     http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 7</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">     http://www.springframework.org/schema/tx 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 8</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">     http://www.springframework.org/schema/tx/spring-tx-3.0.xsd 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 9</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">     http://www.springframework.org/schema/jee 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">10</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">     http://www.springframework.org/schema/jee/spring-jee-3.0.xsd 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">11</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">     http://www.springframework.org/schema/context 
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">12</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">      http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">13</span>        
<span style="color:rgb(0,128,128);line-height:1.5 !important;">14</span>     
<span style="color:rgb(0,128,128);line-height:1.5 !important;">15</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 定义consumer的参数 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">16</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="consumerProperties"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="java.util.HashMap"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">17</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">18</span>              <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">map</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">19</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="bootstrap.servers"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="127.0.0.1:7000"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">20</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="group.id"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="0"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">21</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="enable.auto.commit"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="false"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">22</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="auto.commit.interval.ms"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="1000"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">23</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="session.timeout.ms"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="15000"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">24</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="key.deserializer"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.apache.kafka.common.serialization.StringDeserializer"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">25</span>                  <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">entry </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">key</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="value.deserializer"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.apache.kafka.common.serialization.StringDeserializer"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">26</span>              <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">map</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">27</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">28</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">29</span>      
<span style="color:rgb(0,128,128);line-height:1.5 !important;">30</span>      <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 创建consumerFactory bean </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">31</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="consumerFactory"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.core.DefaultKafkaConsumerFactory"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">32</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">33</span>              <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">ref </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="consumerProperties"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">34</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">35</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">36</span>      
<span style="color:rgb(0,128,128);line-height:1.5 !important;">37</span>      <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 实际执行消息消费的类 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">38</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListernerConsumerService"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="com.git.kafka.consumer.KafkaConsumerServer"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">39</span>      
<span style="color:rgb(0,128,128);line-height:1.5 !important;">40</span>      <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 消费者容器配置信息 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">41</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="containerProperties_trade"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.listener.config.ContainerProperties"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">42</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="order_test_topic"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">43</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">property </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">name</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListener"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListernerConsumerService"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">44</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">45</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="containerProperties_other"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.listener.config.ContainerProperties"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">46</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">value</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="other_test_topic"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">47</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">property </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">name</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListener"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListernerConsumerService"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">48</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">49</span>      
<span style="color:rgb(0,128,128);line-height:1.5 !important;">50</span>      <span style="color:rgb(0,128,0);line-height:1.5 !important;">&lt;!--</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> 创建messageListenerContainer bean，使用的时候，只需要注入这个bean </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">--&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">51</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListenerContainer_trade"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.listener.KafkaMessageListenerContainer"</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">52</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">         init-method</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="doStart"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">53</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="consumerFactory"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">54</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="containerProperties_trade"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">55</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">56</span>      
<span style="color:rgb(0,128,128);line-height:1.5 !important;">57</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">id</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="messageListenerContainer_other"</span><span style="color:rgb(255,0,0);line-height:1.5 !important;"> class</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="org.springframework.kafka.listener.KafkaMessageListenerContainer"</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">58</span> <span style="color:rgb(255,0,0);line-height:1.5 !important;">         init-method</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="doStart"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">59</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="consumerFactory"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">60</span>          <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">constructor-arg </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">ref</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="containerProperties_other"</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">61</span>      <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">bean</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">62</span>      
<span style="color:rgb(0,128,128);line-height:1.5 !important;">63</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;/</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">beans</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">&gt;</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<h2 style="font-size:21px;line-height:1.5;">applicationContext配置</h2>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;">1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">import </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">resource</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="classpath:kafkaConsumer.xml"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">2</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">&lt;</span><span style="color:rgb(128,0,0);line-height:1.5 !important;">import </span><span style="color:rgb(255,0,0);line-height:1.5 !important;">resource</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">="classpath:kafkaProducer.xml"</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">/&gt;</span></pre>
</div>
<h1 style="font-size:28px;line-height:1.5;">具体实现</h1>
<p>constant.java　　//常量类</p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">package</span><span style="line-height:1.5 !important;"> com.git.kafka.constant;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 3</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 4</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> * kafkaMessageConstant
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 5</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@author</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> wangb
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 6</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> *
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 7</span>  <span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 8</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">class</span><span style="line-height:1.5 !important;"> KafkaMesConstant {
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 9</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">10</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String SUCCESS_CODE = "00000"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">11</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String SUCCESS_MES = "成功"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">12</span>     
<span style="color:rgb(0,128,128);line-height:1.5 !important;">13</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">/*</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">kakfa-code</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">14</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String KAFKA_SEND_ERROR_CODE = "30001"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">15</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String KAFKA_NO_RESULT_CODE = "30002"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">16</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String KAFKA_NO_OFFSET_CODE = "30003"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">17</span>     
<span style="color:rgb(0,128,128);line-height:1.5 !important;">18</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">/*</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">kakfa-mes</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">19</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String KAFKA_SEND_ERROR_MES = "发送消息超时,联系相关技术人员"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">20</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String KAFKA_NO_RESULT_MES = "未查询到返回结果,联系相关技术人员"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">21</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> String KAFKA_NO_OFFSET_MES = "未查到返回数据的offset,联系相关技术人员"<span style="line-height:1.5 !important;">;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">22</span>     
<span style="color:rgb(0,128,128);line-height:1.5 !important;">23</span>     
<span style="color:rgb(0,128,128);line-height:1.5 !important;">24</span> }</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<p>KafkaConsumerServer.java　　//消费者监听</p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 1</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">package</span><span style="line-height:1.5 !important;"> com.git.kafka.consumer;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 2</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 3</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.apache.kafka.clients.consumer.ConsumerRecord;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 4</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.slf4j.Logger;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 5</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.slf4j.LoggerFactory;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 6</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.kafka.listener.MessageListener;
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;"> 7</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 8</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;"> 9</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> * kafka监听器启动
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">10</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> * 自动监听是否有消息需要消费
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">11</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@author</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> wangb
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">12</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;"> *
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">13</span>  <span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">14</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">class</span> KafkaConsumerServer <span style="color:rgb(0,0,255);line-height:1.5 !important;">implements</span> MessageListener&lt;String, String&gt;<span style="line-height:1.5 !important;"> {
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">15</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">protected</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> Logger LOG = LoggerFactory.getLogger("kafkaConsumer"<span style="line-height:1.5 !important;">);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">16</span>     <span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">17</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">     * 监听器自动执行该方法
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">18</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">     *     消费消息
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">19</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">     *     自动提交offset
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">20</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">     *     执行业务代码
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">21</span> <span style="color:rgb(0,128,0);line-height:1.5 !important;">     *     （high level api 不提供offset管理，不能指定offset进行消费）
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">22</span>      <span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
<span style="color:rgb(0,128,128);line-height:1.5 !important;">23</span> <span style="line-height:1.5 !important;">    @Override
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">24</span>     <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">void</span> onMessage(ConsumerRecord&lt;String, String&gt;<span style="line-height:1.5 !important;"> record) {
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">25</span>         LOG.info("=============kafkaConsumer开始消费============="<span style="line-height:1.5 !important;">);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">26</span>         String topic =<span style="line-height:1.5 !important;"> record.topic();
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">27</span>         String key =<span style="line-height:1.5 !important;"> record.key();
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">28</span>         String value =<span style="line-height:1.5 !important;"> record.value();
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">29</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">long</span> offset =<span style="line-height:1.5 !important;"> record.offset();
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">30</span>         <span style="color:rgb(0,0,255);line-height:1.5 !important;">int</span> partition =<span style="line-height:1.5 !important;"> record.partition();
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">31</span>         LOG.info("-------------topic:"+<span style="line-height:1.5 !important;">topic);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">32</span>         LOG.info("-------------value:"+<span style="line-height:1.5 !important;">value);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">33</span>         LOG.info("-------------key:"+<span style="line-height:1.5 !important;">key);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">34</span>         LOG.info("-------------offset:"+<span style="line-height:1.5 !important;">offset);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">35</span>         LOG.info("-------------partition:"+<span style="line-height:1.5 !important;">partition);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">36</span>         LOG.info("~~~~~~~~~~~~~kafkaConsumer消费结束~~~~~~~~~~~~~"<span style="line-height:1.5 !important;">);
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">37</span> <span style="line-height:1.5 !important;">    }
</span><span style="color:rgb(0,128,128);line-height:1.5 !important;">38</span> 
<span style="color:rgb(0,128,128);line-height:1.5 !important;">39</span> }</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<p>kafkaProducerListener.java　　//生产者监听-打印日志</p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,0,255);line-height:1.5 !important;">package</span><span style="line-height:1.5 !important;"> com.git.kafka.producer;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.apache.kafka.clients.producer.RecordMetadata;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.slf4j.Logger;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.slf4j.LoggerFactory;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.kafka.support.ProducerListener;

</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
 * kafkaProducer监听器，在producer配置文件中开启
 * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@author</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> wangb
 *
 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
@SuppressWarnings(</span>"rawtypes"<span style="line-height:1.5 !important;">)
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">class</span> KafkaProducerListener <span style="color:rgb(0,0,255);line-height:1.5 !important;">implements</span><span style="line-height:1.5 !important;"> ProducerListener{
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">protected</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">final</span> Logger LOG = LoggerFactory.getLogger("kafkaProducer"<span style="line-height:1.5 !important;">);
    </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
     * 发送消息成功后调用
     </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
    @Override
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">void</span><span style="line-height:1.5 !important;"> onSuccess(String topic, Integer partition, Object key,
            Object value, RecordMetadata recordMetadata) {
        LOG.info(</span>"==========kafka发送数据成功（日志开始）=========="<span style="line-height:1.5 !important;">);
        LOG.info(</span>"----------topic:"+<span style="line-height:1.5 !important;">topic);
        LOG.info(</span>"----------partition:"+<span style="line-height:1.5 !important;">partition);
        LOG.info(</span>"----------key:"+<span style="line-height:1.5 !important;">key);
        LOG.info(</span>"----------value:"+<span style="line-height:1.5 !important;">value);
        LOG.info(</span>"----------RecordMetadata:"+<span style="line-height:1.5 !important;">recordMetadata);
        LOG.info(</span>"~~~~~~~~~~kafka发送数据成功（日志结束）~~~~~~~~~~"<span style="line-height:1.5 !important;">);
    }

    </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
     * 发送消息错误后调用
     </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
    @Override
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">void</span><span style="line-height:1.5 !important;"> onError(String topic, Integer partition, Object key,
            Object value, Exception exception) {
        LOG.info(</span>"==========kafka发送数据错误（日志开始）=========="<span style="line-height:1.5 !important;">);
        LOG.info(</span>"----------topic:"+<span style="line-height:1.5 !important;">topic);
        LOG.info(</span>"----------partition:"+<span style="line-height:1.5 !important;">partition);
        LOG.info(</span>"----------key:"+<span style="line-height:1.5 !important;">key);
        LOG.info(</span>"----------value:"+<span style="line-height:1.5 !important;">value);
        LOG.info(</span>"----------Exception:"+<span style="line-height:1.5 !important;">exception);
        LOG.info(</span>"~~~~~~~~~~kafka发送数据错误（日志结束）~~~~~~~~~~"<span style="line-height:1.5 !important;">);
        exception.printStackTrace();
    }

    </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
     * 方法返回值代表是否启动kafkaProducer监听器
     </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
    @Override
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">boolean</span><span style="line-height:1.5 !important;"> isInterestedInSuccess() {
        LOG.info(</span>"///kafkaProducer监听器启动///"<span style="line-height:1.5 !important;">);
        </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">true</span><span style="line-height:1.5 !important;">;
    }

}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<p>KafkaProducerServer.java　　//生产者</p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,0,255);line-height:1.5 !important;">package</span><span style="line-height:1.5 !important;"> com.git.kafka.producer;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> java.util.HashMap;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> java.util.Map;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> java.util.Random;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> java.util.concurrent.ExecutionException;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.beans.factory.annotation.Autowired;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.kafka.core.KafkaTemplate;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.kafka.support.SendResult;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.stereotype.Component;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> org.springframework.util.concurrent.ListenableFuture;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> com.alibaba.fastjson.JSON;
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> com.git.kafka.constant.KafkaMesConstant;

</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
 * kafkaProducer模板
 *     使用此模板发送消息
 * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@author</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> wangb
 *
 </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
@Component
</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">class</span><span style="line-height:1.5 !important;"> KafkaProducerServer{

    @Autowired
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">private</span> KafkaTemplate&lt;String, String&gt;<span style="line-height:1.5 !important;"> kafkaTemplate;
    
    </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
     * kafka发送消息模板
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> topic 主题
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> value    messageValue
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> ifPartition 是否使用分区 0是\1不是
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> partitionNum 分区数 如果是否使用分区为0,分区数必须大于0
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> role 角色:bbc app erp...
     </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
    <span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> Map&lt;String,Object&gt;<span style="line-height:1.5 !important;"> sndMesForTemplate(String topic, Object value, String ifPartition, 
            Integer partitionNum, String role){
        String key </span>= role+"-"+<span style="line-height:1.5 !important;">value.hashCode();
        String valueString </span>=<span style="line-height:1.5 !important;"> JSON.toJSONString(value);
        </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">if</span>(ifPartition.equals("0"<span style="line-height:1.5 !important;">)){
            </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">//</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">表示使用分区</span>
            <span style="color:rgb(0,0,255);line-height:1.5 !important;">int</span> partitionIndex =<span style="line-height:1.5 !important;"> getPartitionIndex(key, partitionNum);
            ListenableFuture</span>&lt;SendResult&lt;String, String&gt;&gt; result =<span style="line-height:1.5 !important;"> kafkaTemplate.send(topic, partitionIndex, key, valueString);
            Map</span>&lt;String,Object&gt; res =<span style="line-height:1.5 !important;"> checkProRecord(result);
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> res;
        }</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">else</span><span style="line-height:1.5 !important;">{
            ListenableFuture</span>&lt;SendResult&lt;String, String&gt;&gt; result =<span style="line-height:1.5 !important;"> kafkaTemplate.send(topic, key, valueString);
            Map</span>&lt;String,Object&gt; res =<span style="line-height:1.5 !important;"> checkProRecord(result);
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> res;
        }
    }

    </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
     * 根据key值获取分区索引
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> key
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> partitionNum
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@return</span>
     <span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span>
    <span style="color:rgb(0,0,255);line-height:1.5 !important;">private</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">int</span> getPartitionIndex(String key, <span style="color:rgb(0,0,255);line-height:1.5 !important;">int</span><span style="line-height:1.5 !important;"> partitionNum){
        </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">if</span> (key == <span style="color:rgb(0,0,255);line-height:1.5 !important;">null</span><span style="line-height:1.5 !important;">) {
            Random random </span>= <span style="color:rgb(0,0,255);line-height:1.5 !important;">new</span><span style="line-height:1.5 !important;"> Random();
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> random.nextInt(partitionNum);
        }
        </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">else</span><span style="line-height:1.5 !important;"> {
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">int</span> result = Math.abs(key.hashCode())%<span style="line-height:1.5 !important;">partitionNum;
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> result;
        }
    }
    
    </span><span style="color:rgb(0,128,0);line-height:1.5 !important;">/**</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">
     * 检查发送返回结果record
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@param</span><span style="color:rgb(0,128,0);line-height:1.5 !important;"> res
     * </span><span style="color:rgb(128,128,128);line-height:1.5 !important;">@return</span>
     <span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
    @SuppressWarnings(</span>"rawtypes"<span style="line-height:1.5 !important;">)
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">private</span> Map&lt;String,Object&gt; checkProRecord(ListenableFuture&lt;SendResult&lt;String, String&gt;&gt;<span style="line-height:1.5 !important;"> res){
        Map</span>&lt;String,Object&gt; m = <span style="color:rgb(0,0,255);line-height:1.5 !important;">new</span> HashMap&lt;String,Object&gt;<span style="line-height:1.5 !important;">();
        </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">if</span>(res!=<span style="color:rgb(0,0,255);line-height:1.5 !important;">null</span><span style="line-height:1.5 !important;">){
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">try</span><span style="line-height:1.5 !important;"> {
                SendResult r </span>= res.get();<span style="color:rgb(0,128,0);line-height:1.5 !important;">//</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">检查result结果集</span>
                <span style="color:rgb(0,128,0);line-height:1.5 !important;">/*</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">检查recordMetadata的offset数据，不检查producerRecord</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">*/</span><span style="line-height:1.5 !important;">
                Long offsetIndex </span>=<span style="line-height:1.5 !important;"> r.getRecordMetadata().offset();
                </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">if</span>(offsetIndex!=<span style="color:rgb(0,0,255);line-height:1.5 !important;">null</span> &amp;&amp; offsetIndex&gt;=0<span style="line-height:1.5 !important;">){
                    m.put(</span>"code"<span style="line-height:1.5 !important;">, KafkaMesConstant.SUCCESS_CODE);
                    m.put(</span>"message"<span style="line-height:1.5 !important;">, KafkaMesConstant.SUCCESS_MES);
                    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> m;
                }</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">else</span><span style="line-height:1.5 !important;">{
                    m.put(</span>"code"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_NO_OFFSET_CODE);
                    m.put(</span>"message"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_NO_OFFSET_MES);
                    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> m;
                }
            } </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">catch</span><span style="line-height:1.5 !important;"> (InterruptedException e) {
                e.printStackTrace();
                m.put(</span>"code"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_SEND_ERROR_CODE);
                m.put(</span>"message"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_SEND_ERROR_MES);
                </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> m;
            } </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">catch</span><span style="line-height:1.5 !important;"> (ExecutionException e) {
                e.printStackTrace();
                m.put(</span>"code"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_SEND_ERROR_CODE);
                m.put(</span>"message"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_SEND_ERROR_MES);
                </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> m;
            }
        }</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">else</span><span style="line-height:1.5 !important;">{
            m.put(</span>"code"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_NO_RESULT_CODE);
            m.put(</span>"message"<span style="line-height:1.5 !important;">, KafkaMesConstant.KAFKA_NO_RESULT_MES);
            </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">return</span><span style="line-height:1.5 !important;"> m;
        }
    }
    

}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<p>KafkaProducerTest.java　　//kafka生产者测试（消费者使用spring启动监听，自动执行onMessage方法）</p>
<div class="cnblogs_code" style="border:1px solid rgb(204,204,204);overflow:auto;color:rgb(0,0,0);font-family:'Courier New' !important;font-size:12px !important;background-color:rgb(245,245,245);">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
<pre style="font-family:'Courier New' !important;"><span style="color:rgb(0,0,255);line-height:1.5 !important;">package</span><span style="line-height:1.5 !important;"> com.git.test;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> java.util.Map;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">import</span><span style="line-height:1.5 !important;"> com.git.kafka.producer.KafkaProducerServer;

</span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">class</span><span style="line-height:1.5 !important;"> KafkaProducerTest {
    </span><span style="color:rgb(0,0,255);line-height:1.5 !important;">public</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">static</span> <span style="color:rgb(0,0,255);line-height:1.5 !important;">void</span><span style="line-height:1.5 !important;"> main(String[] args) {
        
        KafkaProducerServer kafkaProducer </span>= <span style="color:rgb(0,0,255);line-height:1.5 !important;">new</span><span style="line-height:1.5 !important;"> KafkaProducerServer();
        String topic </span>= "orderTopic"<span style="line-height:1.5 !important;">;
        String value </span>= "test"<span style="line-height:1.5 !important;">;
        String ifPartition </span>= "0"<span style="line-height:1.5 !important;">;
        Integer partitionNum </span>= 3<span style="line-height:1.5 !important;">;
        String role </span>= "test";<span style="color:rgb(0,128,0);line-height:1.5 !important;">//</span><span style="color:rgb(0,128,0);line-height:1.5 !important;">用来生成key</span>
        Map&lt;String,Object&gt; res =<span style="line-height:1.5 !important;"> kafkaProducer.sndMesForTemplate
                (topic, value, ifPartition, partitionNum, role);
        
        System.out.println(</span>"测试结果如下：==============="<span style="line-height:1.5 !important;">);
        String message </span>= (String)res.get("message"<span style="line-height:1.5 !important;">);
        String code </span>= (String)res.get("code"<span style="line-height:1.5 !important;">);
        
        System.out.println(</span>"code:"+<span style="line-height:1.5 !important;">code);
        System.out.println(</span>"message:"+<span style="line-height:1.5 !important;">message);
    }
}</span></pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy" style="line-height:1.5 !important;"><a title="复制代码" style="text-decoration:underline;border:none !important;"><img src="http://common.cnblogs.com/images/copycode.gif" alt="复制代码" style="border:none !important;"></a></span></div>
</div>
<h1 style="font-size:28px;line-height:1.5;">具体项目代码</h1>
<p>项目地址:https://git.oschina.net/wsmd/kafka-0.10-demo</p>
</div>
</div>
            </div>
                </div>