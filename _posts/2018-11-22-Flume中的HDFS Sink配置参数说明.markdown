---
layout:     post
title:      Flume中的HDFS Sink配置参数说明
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p>原文链接：http://lxw1234.com/archives/2015/10/527.htm</p>
<p><br></p>
<p></p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
Flume中的HDFS Sink应该是非常常用的，其中的配置参数也比较多，在这里记录备忘一下。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);"><strong>channel</strong></span></li><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);"><strong>type</strong></span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
hdfs</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);"><strong>path</strong></span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
写入hdfs的路径，需要包含文件系统标识，比如：hdfs://namenode/flume/webdata/</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
可以使用flume提供的日期及%{host}表达式。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">filePrefix</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：FlumeData</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
写入hdfs的文件名前缀，可以使用flume提供的日期及%{host}表达式。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">fileSuffix</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
写入hdfs的文件名后缀，比如：.lzo .log等。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">inUsePrefix</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
临时文件的文件名前缀，hdfs sink会先往目标目录中写临时文件，再根据相关规则重命名成最终目标文件；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">inUseSuffix</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：.tmp</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
临时文件的文件名后缀。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">rollInterval</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：30</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
hdfs sink间隔多长将临时文件滚动成最终目标文件，单位：秒；</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
如果设置成0，则表示不根据时间来滚动文件；</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
<span style="color:rgb(255,0,0);"><strong>注：滚动（roll）指的是，hdfs sink将临时文件重命名成最终目标文件，并新打开一个临时文件来写入数据；</strong></span></p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">rollSize</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：1024</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
当临时文件达到该大小（单位：bytes）时，滚动成目标文件；</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
如果设置成0，则表示不根据临时文件大小来滚动文件；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">rollCount</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：10</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
当events数据达到该数量时候，将临时文件滚动成目标文件；</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
如果设置成0，则表示不根据events数据来滚动文件；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">idleTimeout</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：0<br>
当目前被打开的临时文件在该参数指定的时间（秒）内，没有任何数据写入，则将该临时文件关闭并重命名成目标文件；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">batchSize</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：100</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
每个批次刷新到HDFS上的events数量；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">codeC</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
文件压缩格式，包括：gzip, bzip2, lzo, lzop, snappy</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">fileType</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：SequenceFile</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
文件格式，包括：SequenceFile, DataStream,CompressedStream</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
当使用DataStream时候，文件不会被压缩，不需要设置hdfs.codeC;</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
当使用CompressedStream时候，必须设置一个正确的hdfs.codeC值；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">maxOpenFiles</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：5000</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
最大允许打开的HDFS文件数，当打开的文件数达到该值，最早打开的文件将会被关闭；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">minBlockReplicas</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：HDFS副本数</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
写入HDFS文件块的最小副本数。</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
该参数会影响文件的滚动配置，一般将该参数配置成1，才可以按照配置正确滚动文件。</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
<span style="color:rgb(255,0,0);">待研究</span>。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">writeFormat</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
写sequence文件的格式。包含：Text, Writable（默认）</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">callTimeout</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：10000</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
       执行HDFS操作的超时时间（单位：毫秒）；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">threadsPoolSize</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：10</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
hdfs sink启动的操作HDFS的线程数。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">rollTimerPoolSize</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：1</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
hdfs sink启动的根据时间滚动文件的线程数。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">kerberosPrincipal</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
HDFS安全认证kerberos配置；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">kerberosKeytab</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
HDFS安全认证kerberos配置；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">proxyUser</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
代理用户</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">round</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：false</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
是否启用时间上的”舍弃”，这里的”舍弃”，类似于”四舍五入”，后面再介绍。如果启用，则会影响除了%t的其他所有时间表达式；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">roundValue</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：1</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
时间上进行“舍弃”的值；</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">roundUnit</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：seconds</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
时间上进行”舍弃”的单位，包含：second,minute,hour</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
 </p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
<span style="color:rgb(255,0,255);">示例：</span></p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
a1.sinks.k1.hdfs.path = /flume/events/%y-%m-%d/%H%M/%S</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
a1.sinks.k1.hdfs.round = true</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
a1.sinks.k1.hdfs.roundValue = 10</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
a1.sinks.k1.hdfs.roundUnit = minute</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
当时间为2015-10-16 17:38:59时候，hdfs.path依然会被解析为：</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
/flume/events/20151016/17:30/00</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
因为设置的是舍弃10分钟内的时间，因此，该目录每10分钟新生成一个。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">timeZone</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：Local Time</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
时区。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">useLocalTimeStamp</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：flase</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
是否使用当地时间。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">closeTries</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：0</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
hdfs sink关闭文件的尝试次数；</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
如果设置为1，当一次关闭文件失败后，hdfs sink将不会再次尝试关闭文件，这个未关闭的文件将会一直留在那，并且是打开状态。</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
设置为0，当一次关闭失败后，hdfs sink会继续尝试下一次关闭，直到成功。</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">retryInterval</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：180（秒）</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
hdfs sink尝试关闭文件的时间间隔，如果设置为0，表示不尝试，相当于于将hdfs.closeTries设置成1.</p>
<ul style="list-style:none;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;"><li style="line-height:30px;text-indent:0px;"><span style="color:rgb(255,0,255);">serializer</span></li></ul><p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
默认值：TEXT</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
序列化类型。其他还有：avro_event或者是实现了EventSerializer.Builder的类名。</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
 </p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
下面的配置中，在HDFS的/tmp/lxw1234/目录下，每天生成一个格式为20151016的目录，</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
目标文件每5分钟生成一个，文件名格式为：log_20151016_13.1444973768543.lzo</p>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
目标文件采用lzo压缩。</p>
<pre class="prettyprint linenums" style="color:rgb(68,68,68);font-size:14px;line-height:20px;background-color:rgb(248,248,248);border:1px solid rgb(238,238,238);overflow:hidden;text-indent:30px;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;"></pre><ol class="linenums" style="list-style:none;"><li class="L0" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">type </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> hdfs</span></li><li class="L1" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">path </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> hdfs</span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="com" style="color:rgb(102,102,102);">//cdh5/tmp/lxw1234/%Y%m%d</span></li><li class="L2" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">filePrefix </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> log_</span><span class="pun" style="color:rgb(0,170,0);">%</span><span class="pln" style="color:rgb(0,0,255);">Y</span><span class="pun" style="color:rgb(0,170,0);">%</span><span class="pln" style="color:rgb(0,0,255);">m</span><span class="pun" style="color:rgb(0,170,0);">%</span><span class="pln" style="color:rgb(0,0,255);">d_</span><span class="pun" style="color:rgb(0,170,0);">%</span><span class="pln" style="color:rgb(0,0,255);">H</span></li><li class="L3" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">fileSuffix </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">lzo</span></li><li class="L4" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">useLocalTimeStamp </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="kwd" style="color:rgb(249,38,89);">true</span></li><li class="L5" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">writeFormat </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Text</span></li><li class="L6" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">fileType </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">CompressedStream</span></li><li class="L7" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">rollCount </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">0</span></li><li class="L8" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">rollSize </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">0</span></li><li class="L9" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">rollInterval </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">600</span></li><li class="L0" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">codeC </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> lzop</span></li><li class="L1" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">batchSize </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">100</span></li><li class="L2" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">threadsPoolSize </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">10</span></li><li class="L3" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">idleTimeout </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">0</span></li><li class="L4" style="line-height:20px;text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">agent_lxw1234</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sinks</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">sink1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">hdfs</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">minBlockReplicas </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="lit" style="color:rgb(204,0,204);">1</span></li></ol>
<h5 style="line-height:35px;color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;text-indent:30px;">
您可以关注 <a title="" href="http://lxw1234.com/" rel="nofollow" style="color:rgb(0,166,124);">lxw的大数据田地</a> ，或者 <a title="" href="http://163.fm/YHfRFnF" rel="nofollow" style="color:rgb(0,166,124);">加入邮件列表</a> ，随时接收博客更新的通知邮件。</h5>
<p style="color:rgb(85,85,85);font-family:'Microsoft Yahei', 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:15px;text-indent:30px;">
 </p>
<br>            </div>
                </div>