---
layout:     post
title:      HDFS JAVA常用操作函数
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <h1 style="text-align:center;">HDFS JAVA常用操作函数</h1><p>            </p><p>       Hdfs的操作一般是围绕"增、删、改、查"操作来进行，其接入口为<span style="background-color:rgb(255,255,255);"><span style="color:#ff9900;">FileSystem</span></span>类，在这里主要说明通过FileSystem类的几个常用的方法</p><p></p><table border="1" width="200" cellspacing="1" cellpadding="1"><tbody><tr><td><span style="color:#ff9900;">函数名称<br></span></td><td><span style="color:#ff9900;"><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">参数说明</span><br></span></td><td><span style="color:#ff9900;"><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;background-color:rgb(255,255,255);">返回值</span><br></span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:#ff9900;">作用</span></span></td></tr><tr><td>create(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">path指的是hdfs上面的路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">FSDataOutputStream<span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">字节写入流</span></span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">在hdfs上创建一个文件，</span><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">并写入数据到hdfs上</span></td></tr><tr><td>createNewFile(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">path指的是hdfs上面的文件路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">boolean布尔类型</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">创建成功返回true,</span><br style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">创建失败返回false</span></td></tr><tr><td>append(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">path指的是hdfs上面存在的文件路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">FSDataOutputStream字节写入流</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">对hdfs上面已经存在的文件</span><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">进行追加数据</span></td></tr><tr><td>deleteOnExit(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">path指的是hdfs上面存在的文件路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">boolean布尔类型</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">如果hdfs上文件存在，则删除，删除成功返回true,删除不成功返回false</span></td></tr><tr><td>exists(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">path指的是hdfs上面的路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">boolean布尔类型</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">判断此文件或文件夹是否存在，存在返回true,不存在返回false</span></td></tr><tr><td>isDirectory(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">path指的是hdfs上面的路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">boolean布尔类型</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">判断此hdfs路径是否是目录，是目录返回true,不是目录返回false</span></td></tr><tr><td>isFile(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">path指的是hdfs上面的路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">boolean布尔类型</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(247,247,247);">判断此hdfs路径是否是文件，是文件返回true,不是文件返回false</span></td></tr><tr><td>open(Path path)</td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">path指的是hdfs上面的路径</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">FSDataInputStream字节读取流</span></td><td><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">获取一个读取流，</span><span style="font-family:Arial, Verdana, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);">读取hdfs上的文件</span></td></tr></tbody></table><br><span style="color:#3366ff;">注：在eclipse上调用文件添加</span><span style="color:#ff0000;">append</span><span style="color:#3366ff;">方法的时候容易报如下错误</span><br><span style="color:#ff0000;">    Exception in thread "main" java.io.IOException:<br>    Failed to replace a bad datanode on the existing pipeline due to no more good datanodes being available to try</span><br><p>    </p><p>    这个错误表示是在追加数据过程中有副本写入失败时进行验证检测，但一般我们在开发调试时无需考虑此问题</p><p><br></p><p>    <span style="color:#33cc00;">解决方法：</span></p>    通过<span style="color:#ff0000;">Configuration</span>这个类设置如下方式的参数<br><p><span style="color:#3333ff;"><span style="background-color:rgb(255,255,255);">       </span><span style="background-color:rgb(51,204,255);"> conf.set("dfs.client.block.write.replace-datanode-on-failure.policy","NEVER");</span></span></p><p><span style="color:#3333ff;"><span style="background-color:rgb(255,255,255);">       </span><span style="background-color:rgb(51,204,255);"> conf.set("dfs.client.block.write.replace-datanode-on-failure.enable","true");</span></span></p>            </div>
                </div>