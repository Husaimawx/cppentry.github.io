---
layout:     post
title:      Dstream DstreamGraph详解
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<span style="font-weight:600;"><span>[酷玩 Spark] Spark Streaming 源码解析系列</span></span> ，返回目录请 <a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/readme.md" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;">猛戳这里</a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="http://e.qq.com/" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;">「腾讯·广点通」</a>技术团队荣誉出品</p>
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;color:rgb(51,51,51);background-color:rgb(247,247,247);"><code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;border:0px;display:inline;overflow:visible;line-height:inherit;background:transparent;">本系列内容适用范围：

* 2016.12.28 update, Spark 2.1 全系列 √ (2.1.0)
* 2016.11.14 update, Spark 2.0 全系列 √ (2.0.0, 2.0.1, 2.0.2)
* 2016.11.07 update, Spark 1.6 全系列 √ (1.6.0, 1.6.1, 1.6.2, 1.6.3)
</code></pre>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<br><br></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
阅读本文前，请一定先阅读 <a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/0.1%20Spark%20Streaming%20%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF%E4%B8%8E%E6%A8%A1%E5%9D%97%E6%A6%82%E8%BF%B0.md" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;">Spark
 Streaming 实现思路与模块概述</a> 一文，其中概述了 Spark Streaming 的 4 大模块的基本作用，有了全局概念后再看本文对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">模块 1 DAG 静态定义</code> 细节的解释。</p>
<h2 style="line-height:1.25;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(238,238,238);color:rgb(51,51,51);">
<a id="user-content-引言" class="anchor" href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md#%E5%BC%95%E8%A8%80" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;margin-left:-20px;line-height:1;background-color:transparent;"></a>引言</h2>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
我们在前面的文章讲过，Spark Streaming 的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">模块 1 DAG 静态定义</code> 要解决的问题就是如何把计算逻辑描述为一个 RDD DAG 的“模板”，在后面 Job 动态生成的时候，针对每个 batch，都将根据这个“模板”生成一个 RDD DAG
 的实例。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/0.imgs/032.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/0.imgs/032.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
在 Spark Streaming 里，这个 RDD “模板”对应的具体的类是 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code>，RDD DAG “模板”对应的具体类是 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStreamGraph</code>。</p>
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;color:rgb(51,51,51);background-color:rgb(247,247,247);"><code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;border:0px;display:inline;overflow:visible;line-height:inherit;background:transparent;">DStream      的全限定名是：org.apache.spark.streaming.dstream.DStream
DStreamGraph 的全限定名是：org.apache.spark.streaming.DStreamGraph
</code></pre>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/005.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/005.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
本文涉及的类在 Spark Streaming 中的位置如上图所示；下面详解 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStreamGraph</code>。</p>
<h2 style="line-height:1.25;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(238,238,238);color:rgb(51,51,51);">
<a id="user-content-dstream-transformation-output-operation-解析" class="anchor" href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md#dstream-transformation-output-operation-%E8%A7%A3%E6%9E%90" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;margin-left:-20px;line-height:1;background-color:transparent;"></a>DStream, <span>transformation</span>, <span>output
 operation</span> 解析</h2>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
回想一下，RDD 的定义是一个只读、分区的数据集（<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">an RDD is a read-only, partitioned collection of records</code>），而 DStream 又是 RDD 的模板，所以我们把 Dstream 也视同数据集。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
我们先看看定义在这个 DStream 数据集上的<span>转换</span>（<span style="font-weight:600;"><span>transformation</span></span>）和 <span>输出</span>（<span style="font-weight:600;"><span>output</span></span>）。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
现在假设我们有一个 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 数据集 a：</p>
<div class="highlight highlight-source-scala" style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;background-color:rgb(247,247,247);"><span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">a</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">DStream</span>()</pre>
</div>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
那么通过 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">filter()</code> 操作就可以从 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a</code> 生成一个新的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 数据集 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">b</code>：</p>
<div class="highlight highlight-source-scala" style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;background-color:rgb(247,247,247);"><span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">b</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> a.filter(func)</pre>
</div>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
这里能够由已有的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 产生新 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 的操作统称 <span style="font-weight:600;"><span>transformation</span></span>。一些典型的 <span>tansformation</span> 包括 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">map()</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">filter()</code>,<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">reduce()</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">join()</code> 等
 。</p>
<blockquote style="color:rgb(119,119,119);border-left-width:.25em;border-left-style:solid;border-left-color:rgb(221,221,221);font-size:16px;line-height:24px;">
<p>Transformation Meaning map(func) Return a new DStream by passing each element of the source DStream through a function func. flatMap(func) Similar to map, but each input item can be mapped to 0 or more output items.
 filter(func) Return a new DStream by selecting only the records of the source DStream on which func returns true. repartition(numPartitions) Changes the level of parallelism in this DStream by creating more or fewer partitions.</p>
</blockquote>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
另一些不产生新 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 数据集，而是只在已有 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 数据集上进行的操作和输出，统称为 <span style="font-weight:600;"><span>output</span></span>。比如 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a.print()</code> 就不会产生新的数据集，而是只是将 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a</code> 的内容打印出来，所以 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">print()</code> 就是一种 <span>output</span> 操作。一些典型的 <span>output</span> 包括<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">print()</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">saveAsTextFiles()</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">saveAsHadoopFiles()</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">foreachRDD()</code> 等。</p>
<blockquote style="color:rgb(119,119,119);border-left-width:.25em;border-left-style:solid;border-left-color:rgb(221,221,221);font-size:16px;line-height:24px;">
<p>print() Prints the first ten elements of every batch of data in a DStream on the driver node running the streaming application. This is useful for development and debugging. Python API This is called pprint() in
 the Python API. saveAsTextFiles(prefix, [suffix]) Save this DStream's contents as text files. The file name at each batch interval is generated based on prefix and suffix: "prefix-TIME_IN_MS[.suffix]". saveAsObjectFiles(prefix, [suffix]) Save this DStream's
 contents as SequenceFiles of serialized Java objects. The file name at each batch interval is generated based on prefix and suffix: "prefix-TIME_IN_MS[.suffix]". Python API This is not available in the Python API. saveAsHadoopFiles(prefix, [suffix]) Save this
 DStream's contents as Hadoop files. The file name at each batch interval is generated based on prefix and suffix: "prefix-TIME_IN_MS[.suffix]". Python API This is not available in the Python API. foreachRDD(func) The most generic output operator that applies
 a function, func, to each RDD generated from the stream. This function should push the data in each RDD to an external system, such as saving the RDD to files, or writing it over the network to a database. Note that the function func is executed in the driver
 process running the streaming application, and will usually have RDD actions in it that will force the computation of the streaming RDDs.</p>
</blockquote>
<h2 style="line-height:1.25;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(238,238,238);color:rgb(51,51,51);">
<a id="user-content-一段-quick-example-的-transformation-output-解析" class="anchor" href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md#%E4%B8%80%E6%AE%B5-quick-example-%E7%9A%84-transformation-output-%E8%A7%A3%E6%9E%90" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;margin-left:-20px;line-height:1;background-color:transparent;"></a>一段
 quick example 的 <span>transformation</span>, <span>output</span> 解析</h2>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
我们看一下 <a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/0.imgs/http:/spark.apache.org/docs/latest/streaming-programming-guide.html#a-quick-example" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;">Spark
 Streaming 官方的 quick example</a> 的这段对 DStream DAG 的定义，注意看代码中的注释讲解内容：</p>
<div class="highlight highlight-source-scala" style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;background-color:rgb(247,247,247);"><span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> ssc.socketTextStream() 将创建一个 SocketInputDStream；这个 InputDStream 的 SocketReceiver 将监听本机 9999 端口</span>
<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">lines</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> ssc.socketTextStream(<span class="pl-s" style="color:rgb(24,54,145);"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1" style="color:rgb(0,134,179);">9999</span>)

<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">words</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> lines.flatMap(_.split(<span class="pl-s" style="color:rgb(24,54,145);"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span>))      <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> DStream transformation</span>
<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">pairs</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> words.map(word <span class="pl-k" style="color:rgb(167,29,93);">=&gt;</span> (word, <span class="pl-c1" style="color:rgb(0,134,179);">1</span>))     <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> DStream transformation</span>
<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">wordCounts</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> pairs.reduceByKey(_ <span class="pl-k" style="color:rgb(167,29,93);">+</span> _)    <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> DStream transformation</span>
wordCounts.print()                           <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> DStream output</span></pre>
</div>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
这里我们找到 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ssc.socketTextStream("localhost", 9999)</code> 的源码实现：</p>
<div class="highlight highlight-source-scala" style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;background-color:rgb(247,247,247);"><span class="pl-k" style="color:rgb(167,29,93);">def</span> <span class="pl-en" style="color:rgb(121,93,163);">socketStream</span>[<span class="pl-en" style="color:rgb(121,93,163);">T</span><span class="pl-k" style="color:rgb(167,29,93);">:</span> <span class="pl-en" style="color:rgb(121,93,163);">ClassTag</span>](
  <span class="pl-v" style="color:rgb(237,106,67);">hostname</span>: <span class="pl-k" style="color:rgb(167,29,93);">String</span>,
  <span class="pl-v" style="color:rgb(237,106,67);">port</span>: <span class="pl-k" style="color:rgb(167,29,93);">Int</span>, 
  <span class="pl-v" style="color:rgb(237,106,67);">converter</span>: (<span class="pl-en" style="color:rgb(121,93,163);">InputStream</span>) <span class="pl-k" style="color:rgb(167,29,93);">=&gt;</span> <span class="pl-en" style="color:rgb(121,93,163);">Iterator</span>[<span class="pl-en" style="color:rgb(121,93,163);">T</span>],
  <span class="pl-v" style="color:rgb(237,106,67);">storageLevel</span>: <span class="pl-en" style="color:rgb(121,93,163);">StorageLevel</span>)
  <span class="pl-k" style="color:rgb(167,29,93);">:</span> <span class="pl-en" style="color:rgb(121,93,163);">ReceiverInputDStream</span>[<span class="pl-en" style="color:rgb(121,93,163);">T</span>] <span class="pl-k" style="color:rgb(167,29,93);">=</span> {
    <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">SocketInputDStream</span>[<span class="pl-en" style="color:rgb(121,93,163);">T</span>](<span class="pl-c1" style="color:rgb(0,134,179);">this</span>, hostname, port, converter, storageLevel)
  }</pre>
</div>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
也就是 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ssc.socketTextStream()</code> 将 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">new</code> 出来一个 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 具体子类 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">SocketInputDStream</code> 的实例。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
然后我们继续找到下一行 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">lines.flatMap(_.split(" "))</code> 的源码实现：</p>
<div class="highlight highlight-source-scala" style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;background-color:rgb(247,247,247);"><span class="pl-k" style="color:rgb(167,29,93);">def</span> <span class="pl-en" style="color:rgb(121,93,163);">flatMap</span>[<span class="pl-en" style="color:rgb(121,93,163);">U</span><span class="pl-k" style="color:rgb(167,29,93);">:</span> <span class="pl-en" style="color:rgb(121,93,163);">ClassTag</span>](<span class="pl-v" style="color:rgb(237,106,67);">flatMapFunc</span>: <span class="pl-en" style="color:rgb(121,93,163);">T</span> <span class="pl-k" style="color:rgb(167,29,93);">=&gt;</span> <span class="pl-en" style="color:rgb(121,93,163);">Traversable</span>[<span class="pl-en" style="color:rgb(121,93,163);">U</span>])<span class="pl-k" style="color:rgb(167,29,93);">:</span> <span class="pl-en" style="color:rgb(121,93,163);">DStream</span>[<span class="pl-en" style="color:rgb(121,93,163);">U</span>] <span class="pl-k" style="color:rgb(167,29,93);">=</span> ssc.withScope {
    <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">FlatMappedDStream</span>(<span class="pl-c1" style="color:rgb(0,134,179);">this</span>, context.sparkContext.clean(flatMapFunc))
  }</pre>
</div>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
也就是 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">lines.flatMap(_.split(" "))</code> 将 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">new</code> 出来一个 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 具体子类 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">FlatMappedDStream</code> 的实例。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
后面几行也是如此，所以我们如果用 DStream DAG 图来表示之前那段 quick example 的话，就是这个样子：</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/010.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/010.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
也即，我们给出的那段代码，用具体的实现来替换的话，结果如下：</p>
<div class="highlight highlight-source-scala" style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<pre style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;line-height:1.45;overflow:auto;background-color:rgb(247,247,247);"><span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">lines</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">SocketInputDStream</span>(<span class="pl-s" style="color:rgb(24,54,145);"><span class="pl-pds">"</span>localhost<span class="pl-pds">"</span></span>, <span class="pl-c1" style="color:rgb(0,134,179);">9999</span>)   <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> 类型是 SocketInputDStream</span>

<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">words</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">FlatMappedDStream</span>(lines, _.split(<span class="pl-s" style="color:rgb(24,54,145);"><span class="pl-pds">"</span> <span class="pl-pds">"</span></span>))  <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> 类型是 FlatMappedDStream</span>
<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">pairs</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">MappedDStream</span>(words, word <span class="pl-k" style="color:rgb(167,29,93);">=&gt;</span> (word, <span class="pl-c1" style="color:rgb(0,134,179);">1</span>)) <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> 类型是 MappedDStream</span>
<span class="pl-k" style="color:rgb(167,29,93);">val</span> <span class="pl-en" style="color:rgb(121,93,163);">wordCounts</span> <span class="pl-k" style="color:rgb(167,29,93);">=</span> <span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">ShuffledDStream</span>(pairs, _ <span class="pl-k" style="color:rgb(167,29,93);">+</span> _)      <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> 类型是 ShuffledDStream</span>
<span class="pl-k" style="color:rgb(167,29,93);">new</span> <span class="pl-en" style="color:rgb(121,93,163);">ForeachDStream</span>(wordCounts, cnt <span class="pl-k" style="color:rgb(167,29,93);">=&gt;</span> cnt.print())      <span class="pl-c" style="color:rgb(150,152,150);"><span class="pl-c">//</span> 类型是 ForeachDStream</span></pre>
</div>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
总结一下：</p>
<ul style="color:rgb(51,51,51);font-size:16px;line-height:24px;"><li><span>transformation</span>：可以看到基本上 1 种 <span>transformation</span> 将对应产生一个新的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 子类实例，如：
<ul><li><code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">.flatMap()</code> 将产生 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">FaltMappedDStream</code> 实例</li><li><code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">.map()</code> 将产生 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">MappedDStream</code> 实例</li></ul></li><li><span>output</span>：将只产生一种 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ForEachDStream</code> 子类实例，用一个函数 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">func</code> 来记录需要做的操作
<ul><li>如对于 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">print()</code> 就是：<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">func</code> = <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">cnt
 =&gt; cnt.print()</code></li></ul></li></ul><p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
我们将有另一篇文章具体对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 所有 <span>transformation</span> 的列举和分析，本文不展开。</p>
<h2 style="line-height:1.25;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(238,238,238);color:rgb(51,51,51);">
<a id="user-content-dstream-类继承体系" class="anchor" href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md#dstream-%E7%B1%BB%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;margin-left:-20px;line-height:1;background-color:transparent;"></a>DStream
 类继承体系</h2>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
上面我们看到的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">SocketInputDStream</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">FlatMappedDStream</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ForeachDStream</code> 等都是 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 的具体子类。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 的所有子类如下：</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/040.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/040.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
一会我们要对其这些 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 子类进行一个分类。</p>
<h2 style="line-height:1.25;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(238,238,238);color:rgb(51,51,51);">
<a id="user-content-dependency-dstreamgraph-解析" class="anchor" href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.1%20DStream%2C%20DStreamGraph%20%E8%AF%A6%E8%A7%A3.md#dependency-dstreamgraph-%E8%A7%A3%E6%9E%90" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;margin-left:-20px;line-height:1;background-color:transparent;"></a>Dependency,
 DStreamGraph 解析</h2>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
先再次回过头来看一下 <span>transformation</span> 操作。当我们写代码 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c = a.join(b), d = c.filter()</code> 时， 它们的 DAG 逻辑关系是<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a/b
 → c，c → d</code>，但在 Spark Streaming 在进行物理记录时却是反向的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a/b ← c, c ← d</code>，如下图：</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/020.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/020.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
那物理上为什么不顺着 DAG 来正向记录，却用反向记录？</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
这里背后的原因是，在 Spark Core 的 RDD API 里，RDD 的计算是被触发了以后才进行 lazy 求值的，即当真正求 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code> 的值的时候，先计算上游 dependency <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c</code>；而计算 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c</code> 则先进一步计算 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c</code> 的上游
 dependency <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a</code> 和 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">b</code>。Spark
 Streaming 里则与 RDD DAG 的反向表示保持了一致，对 DStream 也采用的反向表示。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
所以，这里 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code> 对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c</code> 的引用（即指针），表达的是一个上游<span>依赖</span>（<span style="font-weight:600;"><span>dependency</span></span>）的关系；也就是说，不求值则已，一旦<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d.print()</code> 这个 <span>output</span> 操作触发了对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code> 的求值，那么就需要从 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code> 开始往上游进行追溯计算。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
具体的过程是，<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d.print()</code> 将 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">new</code> 一个 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code> 的一个下游 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ForEachDStream
 x</code> —— <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">x</code> 中记明了需要做的操作 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">func
 = print()</code>—— 然后在每个 batch 动态生成 RDD 实例时，以 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">x</code> 为根节点、进行一次 BFS（宽度优先遍历），就可以快速得到需要进行实际计算的最小集合。如下图所示，这个最小集合就是 {<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">b</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code>}。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/025.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/025.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
再看一个例子。如下图所示，如果对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">f</code> 分别调用 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">print()</code> 的 <span>output</span> 操作，那么将在 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">f</code> 的下游分别产生新的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream
 x, y</code>，分别记录了具体操作 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">func = print()</code>。在每个 batch 动态生成 RDD 实例时，就会分别对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">x</code> 和 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">y</code> 进行
 BFS 遍历，分别得到上游集合 {<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">a</code>,<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">b</code>,<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">c</code>,<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">d</code>}
 和 {<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">b</code>,<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">e</code>,<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">f</code>}。作为对比，这里我们不对 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">h</code> 进行 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">print()</code> 的 <span>output</span> 操作，所以 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">g</code>, <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">h</code> 将得不到遍历。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/030.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/030.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
通过以上分析，我们总结一下：</p>
<ul style="color:rgb(51,51,51);font-size:16px;line-height:24px;"><li>
<p>(1) DStream 逻辑上通过 <span>transformation</span> 来形成 DAG，但在物理上却是通过与 <span>transformation</span> 反向的<span>依赖</span>（<span style="font-weight:600;"><span>dependency</span></span>）来构成表示的</p>
</li><li>
<p>(2) 当某个节点调用了 <span>output</span> 操作时，就产生一个新的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ForEachDStream</code> ，这个新的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">ForEachDStream</code> 记录了具体的 <span>output</span>操作是什么</p>
</li><li>
<p>(3) 在每个 batch 动态生成 RDD 实例时，就对 (2) 中新生成的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 进行 BFS 遍历</p>
</li></ul><p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
我们将在 (2) 中，由 <span>output</span> 操作新生成的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 称为 <span>output stream</span>。</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
最后，我们给出：</p>
<ul style="color:rgb(51,51,51);font-size:16px;line-height:24px;"><li>
<p>(4) <span style="font-weight:600;">Spark Streaming 记录整个 DStream DAG 的方式，就是通过一个 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStreamGraph</code> 实例记录了到所有的 <span>output
 stream</span>节点的引用</span></p>
<ul><li>通过对所有 <span>output stream</span> 节点进行遍历，就可以得到所有上游依赖的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code></li><li>不能被遍历到的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 节点 —— 如 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">g</code> 和 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">h</code> ——
 则虽然出现在了逻辑的 DAG 中，但是并不属于物理的<code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStreamGraph</code>，也将在 Spark Streaming 的实际运行过程中不产生任何作用</li></ul></li><li>
<p>(5) <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStreamGraph</code> 实例同时也记录了到所有 <span>input stream</span> 节点的引用</p>
<ul><li>DStreamGraph 时常需要遍历没有上游依赖的 <code style="font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:14px;">DStream</code> 节点 —— 称为 <span>input stream</span> —— 记录一下就可以避免每次为查找 <span>input
 stream</span> 而对 <span>output steam</span> 进行 BFS 的消耗</li></ul></li></ul><p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
我们本节所描述的内容，用下图就能够总结了：</p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/035.png" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;"><img src="https://github.com/lw-lin/CoolplaySpark/raw/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/1.imgs/035.png" alt="image" style="border-style:none;"></a></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
<br><br></p>
<p style="color:rgb(51,51,51);font-size:16px;line-height:24px;">
（本文完，参与本文的讨论请 <a href="https://github.com/proflin/CoolplaySpark/issues/2" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;">猛戳这里</a>，返回目录请 <a href="https://github.com/lw-lin/CoolplaySpark/blob/master/Spark%20Streaming%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90%E7%B3%BB%E5%88%97/readme.md" rel="nofollow" style="color:rgb(64,120,192);text-decoration:none;background-color:transparent;">猛戳这里</a>）</p>
            </div>
                </div>