---
layout:     post
title:      Hive java api示例
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">基于hadoop的Hive数据仓库JavaAPI简单调用的实例，关于Hive的简介在此不赘述。hive提供了三种用户接口：CLI，JDBC/ODBC和 WebUI</span></p><ol style="font-size:14px;line-height:1.4em;color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;text-align:left;background-color:rgb(255,255,255);"><li style="font-size:1em;"><span style="color:rgb(0,128,0);">CLI，即Shell命令行</span></li><li style="font-size:1em;"><span style="color:rgb(0,128,0);">JDBC/ODBC 是 Hive 的Java，与使用传统数据库JDBC的方式类似</span></li><li style="font-size:1em;"><span style="color:rgb(0,128,0);">WebGUI是通过浏览器访问 Hive</span></li></ol><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">本文主要介绍的就是第二种用户接口，直接进入正题。</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);"> 1、Hive 安装：</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">        1）hive的安装请参考网上的相关文章，测试时只在hadoop一个节点上安装hive即可。</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">        2）测试数据data文件'\t'分隔：</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">              1   zhangsan</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">              2    lisi</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">              3   wangwu</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">        3）将测试数据data上传到linux目录下，我放置在：/home/hadoop01/data </span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);"> 2、在使用 JDBC 开发 Hive 程序时,  必须首先开启 Hive 的远程服务接口。使用下面命令进行开启:</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);">  </span></p><div class="dp-highlighter" style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;font-size:12px;background-color:rgb(255,255,255);width:679px;margin-left:9px;color:rgb(0,0,0);text-align:left;"><div class="bar"><div class="tools" style="font-weight:bold;">Java代码  <a title="收藏这段代码" style="color:rgb(0,102,0);text-decoration:underline;"><img class="star" src="http://787141854-qq-com.iteye.com/images/icon_star.png" alt="收藏代码" style="border:0px;"></a></div></div><ol start="1" class="dp-j" style="font-size:1em;line-height:1.4em;border:1px solid rgb(209,215,220);color:rgb(43,145,175);"><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">hive --service hiveserver &gt;/dev/<span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span> <span class="number" style="color:rgb(192,0,0);">2</span>&gt;/dev/<span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span> &amp;  </span></li></ol></div><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"> </p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"> </p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"><span style="color:rgb(0,128,0);"> 3、测试代码：</span></p><p style="color:rgb(0,0,0);font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;text-align:left;background-color:rgb(255,255,255);"> </p><div class="dp-highlighter" style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;font-size:12px;background-color:rgb(255,255,255);width:679px;margin-left:9px;color:rgb(0,0,0);text-align:left;"><div class="bar"><div class="tools" style="font-weight:bold;">Java代码  <a title="收藏这段代码" style="color:rgb(0,102,0);text-decoration:underline;"><img class="star" src="http://787141854-qq-com.iteye.com/images/icon_star.png" alt="收藏代码" style="border:0px;"></a></div></div><ol start="1" class="dp-j" style="font-size:1em;line-height:1.4em;border:1px solid rgb(209,215,220);color:rgb(43,145,175);"><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">import</span> java.sql.Connection;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">import</span> java.sql.DriverManager;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">import</span> java.sql.ResultSet;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">import</span> java.sql.SQLException;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">import</span> java.sql.Statement;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">import</span> org.apache.log4j.Logger;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;">/**</span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> * Hive的JavaApi</span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> * </span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> * 启动hive的远程服务接口命令行执行：hive --service hiveserver &gt;/dev/null 2&gt;/dev/null &amp;</span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> * </span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> * @author 吖大哥</span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> * </span> </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="comment" style="color:rgb(0,130,0);border:0px;"> */</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;"><span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">public</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">class</span> HiveJdbcCli {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> String driverName = <span class="string" style="color:#0000FF;">"org.apache.hadoop.hive.jdbc.HiveDriver"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> String url = <span class="string" style="color:#0000FF;">"jdbc:hive://hadoop3:10000/default"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> String user = <span class="string" style="color:#0000FF;">"hive"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> String password = <span class="string" style="color:#0000FF;">"mysql"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> String sql = <span class="string" style="color:#0000FF;">""</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> ResultSet res;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">final</span> Logger log = Logger.getLogger(HiveJdbcCli.<span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">class</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">public</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> main(String[] args) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        Connection conn = <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        Statement stmt = <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">try</span> {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            conn = getConn();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            stmt = conn.createStatement();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 第一步:存在就先删除</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            String tableName = dropTable(stmt);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 第二步:不存在就创建</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            createTable(stmt, tableName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 第三步:查看创建的表</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            showTables(stmt, tableName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 执行describe table操作</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            describeTables(stmt, tableName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 执行load data into table操作</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            loadData(stmt, tableName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 执行 select * query 操作</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            selectData(stmt, tableName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="comment" style="color:rgb(0,130,0);border:0px;">// 执行 regular hive query 统计操作</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            countData(stmt, tableName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        } <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">catch</span> (ClassNotFoundException e) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            e.printStackTrace();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            log.error(driverName + <span class="string" style="color:#0000FF;">" not found!"</span>, e);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            System.exit(<span class="number" style="color:rgb(192,0,0);">1</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        } <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">catch</span> (SQLException e) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            e.printStackTrace();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            log.error(<span class="string" style="color:#0000FF;">"Connection error!"</span>, e);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            System.exit(<span class="number" style="color:rgb(192,0,0);">1</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        } <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">finally</span> {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">try</span> {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">if</span> (conn != <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span>) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                    conn.close();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                    conn = <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">if</span> (stmt != <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span>) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                    stmt.close();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                    stmt = <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">null</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            } <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">catch</span> (SQLException e) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                e.printStackTrace();  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> countData(Statement stmt, String tableName)  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"select count(1) from "</span> + tableName;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"Running:"</span> + sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        res = stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"执行“regular hive query”运行结果:"</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">while</span> (res.next()) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            System.out.println(<span class="string" style="color:#0000FF;">"count ------&gt;"</span> + res.getString(<span class="number" style="color:rgb(192,0,0);">1</span>));  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> selectData(Statement stmt, String tableName)  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"select * from "</span> + tableName;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"Running:"</span> + sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        res = stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"执行 select * query 运行结果:"</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">while</span> (res.next()) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            System.out.println(res.getInt(<span class="number" style="color:rgb(192,0,0);">1</span>) + <span class="string" style="color:#0000FF;">"\t"</span> + res.getString(<span class="number" style="color:rgb(192,0,0);">2</span>));  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> loadData(Statement stmt, String tableName)  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        String filepath = <span class="string" style="color:#0000FF;">"/home/hadoop01/data"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"load data local inpath '"</span> + filepath + <span class="string" style="color:#0000FF;">"' into table "</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                + tableName;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"Running:"</span> + sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        res = stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> describeTables(Statement stmt, String tableName)  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"describe "</span> + tableName;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"Running:"</span> + sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        res = stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"执行 describe table 运行结果:"</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">while</span> (res.next()) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            System.out.println(res.getString(<span class="number" style="color:rgb(192,0,0);">1</span>) + <span class="string" style="color:#0000FF;">"\t"</span> + res.getString(<span class="number" style="color:rgb(192,0,0);">2</span>));  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> showTables(Statement stmt, String tableName)  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"show tables '"</span> + tableName + <span class="string" style="color:#0000FF;">"'"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"Running:"</span> + sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        res = stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        System.out.println(<span class="string" style="color:#0000FF;">"执行 show tables 运行结果:"</span>);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">if</span> (res.next()) {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            System.out.println(res.getString(<span class="number" style="color:rgb(192,0,0);">1</span>));  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">void</span> createTable(Statement stmt, String tableName)  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"create table "</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                + tableName  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">                + <span class="string" style="color:#0000FF;">" (key int, value string)  row format delimited fields terminated by '\t'"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> String dropTable(Statement stmt) <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="comment" style="color:rgb(0,130,0);border:0px;">// 创建的表名</span>  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        String tableName = <span class="string" style="color:#0000FF;">"testHive"</span>;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        sql = <span class="string" style="color:#0000FF;">"drop table "</span> + tableName;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        stmt.executeQuery(sql);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">return</span> tableName;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">private</span> <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">static</span> Connection getConn() <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">throws</span> ClassNotFoundException,  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">            SQLException {  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        Class.forName(driverName);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        Connection conn = DriverManager.getConnection(url, user, password);  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">        <span class="keyword" style="color:rgb(127,0,85);font-weight:bold;">return</span> conn;  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">    }  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">  </span></li><li style="font-size:1em;border-left:1px solid rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;"><span style="color:#000000;">}  </span></li></ol></div>            </div>
                </div>