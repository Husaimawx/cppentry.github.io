---
layout:     post
title:      Centos 6.5 hadoop 2.2.0 全分布式安装
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p align="left"><br></p>
<p align="left"><br></p>
<p align="left"><span style="color:#E8E8E8;"><span style="font-size:14px;">hadoop 2.2.0 cluster setup</span></span></p>
<p align="left"><span style="font-size:14px;">环境：</span></p>
<p align="left"><span style="font-size:14px;">操作系统:Centos 6.5<br>
jdk:jdk1.7.0_51<br>
hadoop版本:2.2.0</span></p>
<p align="left"><em><span style="font-size:14px;">hostname    ip</span></em></p>
<p align="left"><em><span style="font-size:14px;">master 192.168.1.180</span></em></p>
<p align="left"><em><span style="font-size:14px;">slave1 192.168.1.181</span></em></p>
<p align="left"><em><span style="font-size:14px;">slave2 192.168.1.182</span></em></p>
<p align="left"><em><span style="font-size:14px;">slave3 192.168.1.183</span></em></p>
<p align="left"><span style="font-size:14px;"><a name="outline_0"></a><span style="color:#E8E8E8;">一、前期系统环境配置</span></span></p>
<p align="left"><span style="font-size:14px;">设置主机名<br>
临时生效修改主机名，重启失效</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ hostnamemaster</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">永久生效修改主机名,需重启.</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ vim/etc/sysconfig/network</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">NETWORKING=yes</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HOSTNAME=master</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">2.设置ip</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ vim/etc/sysconfig/network-scripts/ifcfg-eth0</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">DEVICE=eth0</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">TYPE=Ethernet</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">UUID=390e4922-0d95-4c34-9dde-897fb8acef0f</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">ONBOOT=yes</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">NM_CONTROLLED=yes</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">BOOTPROTO=none</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HWADDR=08:00:27:1C:57:24</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">IPADDR=192.168.1.180</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">PREFIX=24</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">GATEWAY=192.168.1.1</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">DNS1=192.168.1.1</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">DOMAIN=114.114.114.114</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">DEFROUTE=yes</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">IPV4_FAILURE_FATAL=yes</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">IPV6INIT=no</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">NAME="Systemeth0"</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">LAST_CONNECT=1393996666</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">3.host 映射</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ vim/etc/hosts</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">127.0.0.1   localhost</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">192.168.1.180 master</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">192.168.1.181 slave1</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">192.168.1.182 slave2</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">192.168.1.183 slave3</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">其他节点hosts改成这样。</span></p>
<p align="left"><span style="font-size:14px;">4.关闭防火墙<br>
开机启动关闭</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ sudoservice iptables stop</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ sudochkconfig iptables off</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">5.ssh 无密码登录，master 需要启动slave节点的相关进程</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ssh-keygen -t rsa -P '' -f ~/.ssh/id_rsa</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ cat~/.ssh/id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">测试是否能无密码登录了</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ sshlocalhost</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">如果以上操作完成后 还需要输入密码 请做一下操作<br>
/home/用户名/.ssh 目录权限 700<br>
/home/用户名/.ssh/authorized_keys 文件权限 600</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ chmod 700/home/lxj/.ssh</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ chmod 600/home/lxj/.ssh/authorized_keys</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">6.拷贝公钥到其他slave节点<br>
由于master主机公钥已写入authorized_keys授权文件，所以只要拷贝授权文件到其他slave节点即可</span></p>
<p align="left"><em><span style="font-size:14px;">注意节点.ssh目录和authorized_keys文件权限也分别要是700,600。</span></em></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ scp/home/lxj/.ssh/authorized_keys lxj@slave1:/home/lxj/.ssh/</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ scp/home/lxj/.ssh/authorized_keys lxj@slave2:/home/lxj/.ssh/</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ scp/home/lxj/.ssh/authorized_keys lxj@slave3:/home/lxj/.ssh/</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">测试是否可以无密码登录slave节点了</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ sshslave1</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ exit</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ sshslave2</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ exit</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ sshslave3</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">可以的话，这样master无密码登录其他slave节点就配配置好了！</span></p>
<p align="left"><span style="font-size:14px;"><a name="outline_1"></a><span style="color:#E8E8E8;">二、hadoop
</span>配置文件</span></p>
<p align="left"><span style="font-size:14px;">先设置下环境变量</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">JAVA_HOME=/home/lxj/jdk1.7.0_51</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#AAAAAA;">CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$</span><span style="color:#EFEFEF;">JAVA_HOME/lib/tools.jar</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HADOOP_HOME=/home/lxj/hadoop-2.2.0</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HADOOP_MAPRED_HOME=$HADOOP_HOME</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HADOOP_COMMON_HOME=$HADOOP_HOME</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HADOOP_HDFS_HOME=$HADOOP_HOME</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">YARN_HOME=$HADOOP_HOME</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">YARN_CONF_DIR=$HADOOP_HOME/etc/hadoop</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#AAAAAA;">PATH=$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$</span><span style="color:#EFEFEF;">PATH</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">export JAVA_HOME CLASSPATHHADOOP_HOME HADOOP_MAPRED_HOME HADOOP_COMMON_HOME HADOOP_HDFS_HOME YARN_HOMEHADOOP_CONF_DIR YARN_CONF_DIR  PATH</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">主要需修改的配置文件<br>
我们先在master机器上修改这些配置文件，然后传到各个节点hadoop 目录在~/hadoop-2.2.0</span></p>
<p align="left"><em><span style="font-size:14px;">hadoop-env.sh、core-site.xml、hdfs-site.xml、mapred-site.xml、yarn-env.sh、yarn-site.xml、masters、slaves</span></em></p>
<p align="left"><span style="font-size:14px;">以上配置文件，如果没有则自己新建</span></p>
<p align="left"><em><span style="font-size:14px;">节点信息<br>
NameNode: master,slave1<br>
SecondaryNameNode: master,slave1<br>
DataNode:slave1,slave2,slave3</span></em></p>
<p align="left"><span style="font-size:14px;"><a name="outline_2"></a><span style="color:#E8E8E8;">三、master
</span>机器配置</span></p>
<p align="left"><span style="font-size:14px;">1.hadoop-env.sh 修改JAVA_HOME</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$  cd ~/hadoop-2.2.0/etc/hadoop</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master hadoop]$ vimhadoop-env.sh</span></span></p>
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;"># The onlyrequired environment variable is JAVA_HOME. All others are</span></span></em></p>
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;">#optional.  When running a distributedconfiguration it is best to</span></span></em></p>
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;"># setJAVA_HOME in this file, so that it is correctly defined on</span></span></em></p>
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;"># remotenodes.</span></span></em></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;"># The javaimplementation to use.</span></span></em></p>
<p align="left"><span style="font-size:14px;"><span style="color:#24909D;">export </span>
<span style="color:#40FFFF;">JAVA_HOME</span><span style="color:#D0D0D0;">=</span><span style="color:#EFEFEF;">/home/lxj/jdk-1.7.0_15</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">2.core-site.xml</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xmlversion="1.0" encoding="UTF-8"?&gt;</span></span></p>
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xml-stylesheettype="text/xsl" href="configuration.xsl"?&gt;</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;configuration&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">      </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">fs.default.name</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">       </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">hdfs://master:9000</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">       </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">hadoop.tmp.dir</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">       </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">/home/lxj/hadoop/tmp</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;/configuration&gt;</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">3.hdfs-site.xml</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xmlversion="1.0" encoding="UTF-8"?&gt;</span></span></p>
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xml-stylesheettype="text/xsl" href="configuration.xsl"?&gt;</span></span></p>
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;">&lt;!--Put site-specific property overrides in this file. --&gt;</span></span></em></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;configuration&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">dfs.namenode.secondary.http-address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:50090</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">fs.checkpoint.period</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">600</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">fs.checkpoint.size</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">67108894</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">dfs.namenode.name.dir</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">file:/home/lxj/hadoop/hdfs/namenode</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">dfs.datanode.data.dir</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">file:/home/lxj/hadoop/hdfs/datanode</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">dfs.permissions</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">false</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">dfs.replication</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">3</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">dfs.webhdfs.enabled</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">true</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;/configuration&gt;</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">4.mapred-site.xml</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xmlversion="1.0"?&gt;</span></span></p>
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xml-stylesheettype="text/xsl" href="configuration.xsl"?&gt;</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;configuration&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">mapreduce.framework.name</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">yarn</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">mapred.job.tracker</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:9001</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">mapreduce.jobhistory.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:10020</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">mapreduce.jobhistory.webapp.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:19888</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">    </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;/configuration&gt;</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">5.yarn-env.sh 修改JAVA_HOME</span></p>
<div style="background:#191919;">
<p align="left"><em><span style="color:#999999;"><span style="font-size:14px;"># someJava parameters</span></span></em></p>
<p align="left"><span style="font-size:14px;"><span style="color:#24909D;">export </span>
<span style="color:#40FFFF;">JAVA_HOME</span><span style="color:#D0D0D0;">=</span><span style="color:#EFEFEF;">/home/lxj/jdk1.7.0_51</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#6AB825;">if</span><span style="color:#D0D0D0;">[</span><span style="color:#9DD5F1;">"$JAVA_HOME"</span><span style="color:#EFEFEF;"> !</span><span style="color:#D0D0D0;">=</span><span style="color:#9DD5F1;">""</span><span style="color:#D0D0D0;">];</span><span style="color:#6AB825;">then</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">  </span>
<em><span style="color:#999999;">#echo "run java in$JAVA_HOME"</span></em></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">  </span>
<span style="color:#40FFFF;">JAVA_HOME</span><span style="color:#D0D0D0;">=</span><span style="color:#40FFFF;">$JAVA_HOME</span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">fi</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">6.yarn-site.xml</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CD2828;"><span style="font-size:14px;">&lt;?xmlversion="1.0"?&gt;</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;"> </span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;configuration&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.nodemanager.aux-services</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">mapreduce_shuffle</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.nodemanager.aux-servicex.mapreduce.shuffle.class</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">org.apache.hadoop.mapred.ShuffleHandler</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.resourcemanager.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:8032</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.resourcemanager.scheduler.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:8030</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.resourcemanager.resource-tracker.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:8031</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.resourcemanager.admin.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:8033</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;property&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;name&gt;</span><span style="color:#EFEFEF;">yarn.resourcemanager.webapp.address</span><span style="color:#6AB825;">&lt;/name&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">           
</span><span style="color:#6AB825;">&lt;value&gt;</span><span style="color:#EFEFEF;">master:8088</span><span style="color:#6AB825;">&lt;/value&gt;</span></span></p>
<p align="left"><span style="font-size:14px;"><span style="color:#EFEFEF;">        </span>
<span style="color:#6AB825;">&lt;/property&gt;</span></span></p>
<p align="left"><span style="color:#6AB825;"><span style="font-size:14px;">&lt;/configuration&gt;</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">7.masters 添加master主机 多个换行写</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;">master</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">8.slaves 添加slave节点 当加入master时，master即当作NameNode又当作DataNode节点</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;">slave1  </span>
</span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;">slave2</span></span></p>
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;">slave3</span></span></p>
</div>
<p align="left"><span style="font-size:14px;"><a name="outline_3"></a><span style="color:#E8E8E8;">四、slave
</span>节点配置</span></p>
<p align="left"><span style="font-size:14px;">其他节点各拷贝一份。</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ scp -r~/hadoop-2.2.0 lxj@slave1:/home/lxj/</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ scp -r~/hadoop-2.2.0 lxj@slave2:/home/lxj/</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ scp -r~/hadoop-2.2.0 lxj@slave3:/home/lxj/</span></span></p>
</div>
<p align="left"><em><span style="font-size:14px;">slave节点的hadoop路径需和master的路径一样，当然系统环境需要保持一致。<br>
只要将master主机的配置好的文件拷贝到各个节点即可。</span></em></p>
<p align="left"><span style="font-size:14px;"><a name="outline_4"></a><span style="color:#E8E8E8;">五、 hadoop
</span>启动</span></p>
<p align="left"><span style="font-size:14px;">1.格式化一个新的分布式文件系统<br>
需要在master和slave1都要执行</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ hdfsnamenode -format</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">2.启动hdfs和yarn 只需在master执行</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$start-dfs.sh</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$start-yarn.sh</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$mr-jobhistory-daemon.sh start historyserver</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">或者</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#EFEFEF;"><span style="font-size:14px;">[lxj@mater ~]$start-all.sh</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">start-all.sh已废弃，不推荐使用！<br>
3.测试<br>
master 进程</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ jps</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">11597 JobHistoryServer</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">4529 Jps</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">4460 ResourceManager</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">4293 NameNode</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">4377 SecondaryNameNode</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">slaves进程</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ jps</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">1941 DataNode</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">2176 Jps</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">2046 NodeManager</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">创建输入目录和文件</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ hdfs dfs-mkdir /input</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ vim./test</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">hello hadoop test</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">拷贝文件到hdfs文系统，运行wordcount程序计算输入文件的单词出现次数</span></p>
<div style="background:#191919;">
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ hdfs dfs-copyFromLocal ./test /input
</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ hadoopjar/home/lxj/hadoop-2.2.0/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.2.0.jarwordcount /input/ /out</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">[lxj@master ~]$ hdfs dfs-cat /out/*</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">hadoop  1</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">hello   1</span></span></p>
<p align="left"><span style="color:#CCCCCC;"><span style="font-size:14px;">test    1</span></span></p>
</div>
<p align="left"><span style="font-size:14px;">搞了下ha federationqjm 配置，没起来，还是从基础配置开始吧，以后在扩展。</span></p>
<p align="left"><span style="font-size:14px;">其他主题:<a href="http://xjliao.me/2014/03/31/hadoop-2.2.0-eclipse-plugin-setup.html" rel="nofollow"><span style="color:#FFCC00;">eclipse</span><span style="color:#FFCC00;">安装hadoop-2.2.0</span><span style="color:#FFCC00;">插件</span></a></span></p>
<p><span style="font-size:14px;"> </span></p>
            </div>
                </div>