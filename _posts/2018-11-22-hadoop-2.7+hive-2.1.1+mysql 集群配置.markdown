---
layout:     post
title:      hadoop-2.7+hive-2.1.1+mysql 集群配置
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/qq_28743951/article/details/70666830				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h2 id="h2_0">前期工作</h2>
<ol><li>安装JDK</li><li>安装Hadoop</li><li>安装MySQL</li></ol><hr><h2 id="h2_1">安装Hive</h2>
<h3 id="h3_2">下载Hive安装包</h3>
<p>可以从 Apache 其中一个<a href="https://hive.apache.org/downloads.html" rel="nofollow">镜像站点</a>中下载最新稳定版的 Hive, apache-hive-2.1.1-bin.tar.gz。</p>
<h3 id="h3_3">解压安装Hive</h3>
<p>使用以下命令安装 Hive:</p>
<pre class="hljs bash"><code class="hljs bash">sudo mv apache-hive-2.1.1-bin.tar.gz /opt
<span class="hljs-built_in">cd</span> /opt
sudo tar -xzvf apache-hive-2.1.1-bin.tar.gz    <span class="hljs-comment">##解压</span>
sudo ln <span class="hljs-_">-s</span> apache-hive-2.1.1-bin hive    <span class="hljs-comment">##创建软链接</span>
</code></pre>
<h3 id="h3_4">设置 Hive环境变量</h3>
<p>编辑 .bash_profile 文件, 在其中添加以下内容:</p>
<pre class="hljs bash"><code class="hljs bash"><span class="hljs-comment"># Hive Env</span>
<span class="hljs-built_in">export</span> HIVE_HOME=/opt/hive
<span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PATH</span>:<span class="hljs-variable">$HIVE_HOME</span>/bin
</code></pre>
<p>使环境变量生效:</p>
<pre class="hljs bash"><code class="hljs bash"><span class="hljs-built_in">source</span> .bash_profile
</code></pre>
<hr><h2 id="h2_5">配置Hive</h2>
<h3 id="h3_6">配置文件重命名</h3>
<p>在运行 Hive 之前需要使用以下命令修改配置文件:</p>
<pre><code class="language-cpp"><code class="hljs cpp">cd /opt/hive/conf
cp hive-env.sh.<span class="hljs-keyword">template</span> hive-env.sh
cp hive-<span class="hljs-keyword">default</span>.xml.<span class="hljs-keyword">template</span> hive-site.xml
cp hive-log4j2.properties.<span class="hljs-keyword">template</span> hive-log4j2.properties
cp hive-exec-log4j2.properties.<span class="hljs-keyword">template</span> hive-exec-log4j2.properties
</code></code></pre>
<h3 id="h3_7">修改hive-env.sh</h3>
<p>因为 Hive 使用了 Hadoop, 需要在 hive-env.sh 文件中指定 Hadoop 安装路径：</p>
<pre class="hljs bash"><code class="hljs bash"><span class="hljs-built_in">export</span> JAVA_HOME=/opt/java    <span class="hljs-comment">##Java路径</span>
<span class="hljs-built_in">export</span> HADOOP_HOME=/opt/hadoop   <span class="hljs-comment">##Hadoop安装路径</span>
<span class="hljs-built_in">export</span> HIVE_HOME=/opt/hive    <span class="hljs-comment">##Hive安装路径</span>
<span class="hljs-built_in">export</span> HIVE_CONF_DIR=/opt/hive/conf    <span class="hljs-comment">##Hive配置文件路径</span>
</code></pre>
<h3 id="h3_8">创建HDFS目录</h3>
<p>在 Hive 中创建表之前需要创建以下 HDFS 目录并给它们赋相应的权限。</p>
<pre class="hljs perl"><code class="hljs perl">hdfs dfs -<span class="hljs-keyword">mkdir</span> -p /user/hive/warehouse
hdfs dfs -<span class="hljs-keyword">mkdir</span> -p /user/hive/tmp
hdfs dfs -<span class="hljs-keyword">mkdir</span> -p /user/hive/<span class="hljs-keyword">log</span>
hdfs dfs -<span class="hljs-keyword">chmod</span> g+w /user/hive/warehouse
hdfs dfs -<span class="hljs-keyword">chmod</span> g+w /usr/hive/tmp
hdfs dfs -<span class="hljs-keyword">chmod</span> g+w /usr/hive/<span class="hljs-keyword">log</span>
</code></pre>
<h3 id="h3_9">修改hive-site.xml</h3>
<p>将 hive-site.xml 文件中以下几个配置项的值设置成上一步中创建的几个路径。</p>
<pre class="hljs dust"><code class="hljs dust"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">hive.exec.scratchdir</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">/user/hive/tmp</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">HDFS root scratch dir for Hive jobs which gets created with write all (733) permission. For each connecting user, an HDFS scratch dir: $</span></span></span></span><span class="hljs-template-variable">{hive.exec.scratchdir}</span><span class="xml">/&amp;lt;username&amp;gt; is created, with $</span><span class="hljs-template-variable">{hive.scratch.dir.permission}</span><span class="xml"><span class="xml"><span class="xml"><span class="xml">.</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
  </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
  </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">hive.metastore.warehouse.dir</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">/user/hive/warehouse</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">location of default database for the warehouse</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
  </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">hive.querylog.location</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">/user/hive/log</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
    </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">Location of Hive run time structured log file</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
  </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span></span></span></span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></span></span></span><span class="xml"><span class="xml"><span class="xml">
</span></span></span></span></code></pre>
<hr><h2 id="h2_10">Hive Metastore</h2>
<p>默认情况下, Hive 的元数据保存在内嵌的 Derby 数据库里, 但一般情况下生产环境会使用 MySQL 来存放 Hive 元数据。</p>
<h3 id="h3_11">创建数据库和用户</h3>
<p>假定你已经安装好 MySQL。下面创建一个 hive 数据库用来存储 Hive 元数据，且数据库访问的用户名和密码都为 hive。</p>
<pre><code class="language-php"><code class="hljs php">mysql&gt; CREATE DATABASE hive; 
mysql&gt; <span class="hljs-keyword">USE</span> <span class="hljs-title">hive</span>; 
mysql&gt; CREATE USER <span class="hljs-string">'hive'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED BY <span class="hljs-string">'hive'</span>;
mysql&gt; GRANT ALL ON hive.* TO <span class="hljs-string">'hive'</span>@<span class="hljs-string">'localhost'</span> IDENTIFIED BY <span class="hljs-string">'hive'</span>; 
mysql&gt; GRANT ALL ON hive.* TO <span class="hljs-string">'hive'</span>@<span class="hljs-string">'%'</span> IDENTIFIED BY <span class="hljs-string">'hive'</span>; 
mysql&gt; FLUSH PRIVILEGES; 
mysql&gt; quit;
</code></code></pre>
<h3 id="h3_12">修改hive-site.xml</h3>
<p>需要在 hive-site.xml 文件中配置 MySQL 数据库连接信息。</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>javax.jdo.option.ConnectionURL<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true&amp;amp;characterEncoding=UTF-8&amp;amp;useSSL=false<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>javax.jdo.option.ConnectionDriverName<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>com.mysql.jdbc.Driver<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>javax.jdo.option.ConnectionUserName<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>hive<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>javax.jdo.option.ConnectionPassword<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>hive<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
</code></pre>
<hr><h2 id="h2_13">运行Hive</h2>
<p>在命令行运行 hive 命令时必须保证以下两点：</p>
<ol><li>HDFS 已经启动。可以使用 start-dfs.sh 脚本来启动 HDFS。</li><li>MySQL Java 连接器添加到 $HIVE_HOME/lib 目录下。我安装时使用的是 mysql-connector-java-5.1.39.jar。</li></ol><p>从 Hive 2.1 版本开始, 我们需要先运行 schematool 命令来执行初始化操作。</p>
<pre class="hljs nginx"><code class="hljs nginx"><span class="hljs-attribute">schematool</span> -dbType mysql -initSchema
</code></pre>
<p>终端输出信息如下：</p>
<p><img src="https://static.oschina.net/uploads/img/201704/07090934_EbCo.png" alt="输入图片说明" title="在这里输入图片标题"></p>
<p>执行成功后，可以使用 Sequel Pro 查看元数据库 hive 是否已经创建成功。</p>
<p><img src="https://static.oschina.net/uploads/img/201608/20114523_2Txo.png" alt="hive-metastore" title="hive-metastore"></p>
<p>要使用 Hive CLI（Hive command line interface）, 可以在终端输入以下命令：</p>
<pre class="hljs nginx"><code class="hljs nginx"><span class="hljs-attribute">hive</span>
</code></pre>
<p>启动信息如下:</p>
<p><img src="https://static.oschina.net/uploads/img/201704/07084552_87Vp.png" alt="hive-start" title="hive-start"></p>
<p>使用 show tables 来显示所有的表:</p>
<p><img src="https://static.oschina.net/uploads/img/201608/20115428_CELl.png" alt="hive-sql" title="hive-sql"></p>
<hr><h2 id="h2_14">问题总结</h2>
<h3 id="h3_15">SSL问题</h3>
<p>启动 hive 时，提示以下信息：</p>
<pre><code class="language-sql"><code class="hljs sql">Sat May 21 10:25:12 CST 2016 WARN: Establishing SSL connection without server's identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL
connection must be established by default if explicit option isn't set. <span class="hljs-keyword">For</span> compliance <span class="hljs-keyword">with</span> existing applications <span class="hljs-keyword">not</span> <span class="hljs-keyword">using</span> SSL the verifyServerCertificate property <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">to</span> <span class="hljs-string">'false'</span>. You need either <span class="hljs-keyword">to</span> explicitly <span class="hljs-keyword">disable</span> SSL <span class="hljs-keyword">by</span> setting useSSL=<span class="hljs-literal">false</span>, <span class="hljs-keyword">or</span> <span class="hljs-keyword">set</span> useSSL=<span class="hljs-literal">true</span> <span class="hljs-keyword">and</span> provide truststore <span class="hljs-keyword">for</span> <span class="hljs-keyword">server</span> certificate verification.
</code></code></pre>
<p>解决方法：在 hive-site.xml 配置文件中 javax.jdo.option.ConnectionURL 配置项的值上加上 useSSL=false。即最后的配置如下：</p>
<pre class="hljs xml"><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>javax.jdo.option.ConnectionURL<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>jdbc:mysql://localhost:3306/hive?createDatabaseIfNotExist=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=UTF-8&amp;amp;useSSL=false<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
    <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>JDBC connect string for a JDBC metastore<span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
  <span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span></span></span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">property</span></span></span></span></span></span></span><span class="hljs-tag"><span class="hljs-tag"><span class="hljs-tag">&gt;</span></span></span></span>
</code></pre>
<h3 id="h3_16">initSchema问题</h3>
<p>启动 hive 时，提示以下信息：</p>
<pre class="hljs rust"><code class="hljs rust">Exception <span class="hljs-keyword">in</span> thread <span class="hljs-string">"main"</span> java.lang.RuntimeException: Hive metastore database is not initialized. Please <span class="hljs-keyword">use</span> schematool (e.g. ./schematool -initSchema -dbType ...) to create the schema. If needed, don<span class="hljs-symbol">'t</span> forget to include the option to auto-create the underlying database <span class="hljs-keyword">in</span> your JDBC connection string (e.g. ?createDatabaseIfNotExist=<span class="hljs-literal">true</span> <span class="hljs-keyword">for</span> mysql)
</code></pre>
<p>解决方法：执行 schematool -initSchema -dbType mysql。即安装 Hive 后，在首次运行 hive 之前要执行以上命令。</p>
<h3 id="h3_17">相对路径问题</h3>
<p>启动Hive时报以下错误:</p>
<pre class="hljs groovy"><code class="hljs groovy">Exception <span class="hljs-keyword">in</span> thread <span class="hljs-string">"main"</span>java.lang.<span class="hljs-string">RuntimeException:</span> java.lang.<span class="hljs-string">IllegalArgumentException:</span>java.net.<span class="hljs-string">URISyntaxException:</span> Relative path <span class="hljs-keyword">in</span> absolute <span class="hljs-string">URI:</span>${<span class="hljs-string">system:</span>java.io.tmpdir%<span class="hljs-number">7</span>D/$%<span class="hljs-number">7</span><span class="hljs-string">Bsystem:</span>user.name%<span class="hljs-number">7</span>D
        atorg.apache.hadoop.hive.ql.session.SessionState.start(SessionState.<span class="hljs-string">java:</span><span class="hljs-number">444</span>)
        atorg.apache.hadoop.hive.cli.CliDriver.run(CliDriver.<span class="hljs-string">java:</span><span class="hljs-number">672</span>)
        atorg.apache.hadoop.hive.cli.CliDriver.main(CliDriver.<span class="hljs-string">java:</span><span class="hljs-number">616</span>)
        atsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        atsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">57</span>)
        atsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">43</span>)
        atjava.lang.reflect.Method.invoke(Method.<span class="hljs-string">java:</span><span class="hljs-number">606</span>)
        atorg.apache.hadoop.util.RunJar.main(RunJar.<span class="hljs-string">java:</span><span class="hljs-number">160</span>)
Caused <span class="hljs-string">by:</span> java.lang.<span class="hljs-string">IllegalArgumentException:</span>java.net.<span class="hljs-string">URISyntaxException:</span> Relative path <span class="hljs-keyword">in</span> absolute <span class="hljs-string">URI:</span>${<span class="hljs-string">system:</span>java.io.tmpdir%<span class="hljs-number">7</span>D/$%<span class="hljs-number">7</span><span class="hljs-string">Bsystem:</span>user.name%<span class="hljs-number">7</span>D
        atorg.apache.hadoop.fs.Path.initialize(Path.<span class="hljs-string">java:</span><span class="hljs-number">148</span>)
        atorg.apache.hadoop.fs.Path.&lt;init&gt;(Path.<span class="hljs-string">java:</span><span class="hljs-number">126</span>)
        atorg.apache.hadoop.hive.ql.session.SessionState.createSessionDirs(SessionState.<span class="hljs-string">java:</span><span class="hljs-number">487</span>)
        atorg.apache.hadoop.hive.ql.session.SessionState.start(SessionState.<span class="hljs-string">java:</span><span class="hljs-number">430</span>)
        ... <span class="hljs-number">7</span>more
</code></pre>
<p>解决方案：将 hive-site.xml 中的 ${system:java.io.tmpdir} 和 ${system:user.name} 分别替换成 /tmp 和 ${user.name}</p>
<p><br></p>
<h3 id="h3_18">mysql-connector-java版本问题</h3>
<p>启动Hive时报以下错误：</p>
<pre class="hljs groovy"><code class="hljs groovy">Exception <span class="hljs-keyword">in</span> thread <span class="hljs-string">"main"</span> java.lang.<span class="hljs-string">RuntimeException:</span> org.apache.hadoop.hive.ql.metadata.<span class="hljs-string">HiveException:</span> java.lang.<span class="hljs-string">RuntimeException:</span> Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient
    at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.<span class="hljs-string">java:</span><span class="hljs-number">578</span>)
    at org.apache.hadoop.hive.ql.session.SessionState.beginStart(SessionState.<span class="hljs-string">java:</span><span class="hljs-number">518</span>)
    at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.<span class="hljs-string">java:</span><span class="hljs-number">705</span>)
    at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.<span class="hljs-string">java:</span><span class="hljs-number">641</span>)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">62</span>)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">43</span>)
    at java.lang.reflect.Method.invoke(Method.<span class="hljs-string">java:</span><span class="hljs-number">498</span>)
    at org.apache.hadoop.util.RunJar.run(RunJar.<span class="hljs-string">java:</span><span class="hljs-number">221</span>)
    at org.apache.hadoop.util.RunJar.main(RunJar.<span class="hljs-string">java:</span><span class="hljs-number">136</span>)
Caused <span class="hljs-string">by:</span> org.apache.hadoop.hive.ql.metadata.<span class="hljs-string">HiveException:</span> java.lang.<span class="hljs-string">RuntimeException:</span> Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient
    at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.<span class="hljs-string">java:</span><span class="hljs-number">226</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.&lt;init&gt;(Hive.<span class="hljs-string">java:</span><span class="hljs-number">366</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.create(Hive.<span class="hljs-string">java:</span><span class="hljs-number">310</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.getInternal(Hive.<span class="hljs-string">java:</span><span class="hljs-number">290</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.get(Hive.<span class="hljs-string">java:</span><span class="hljs-number">266</span>)
    at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.<span class="hljs-string">java:</span><span class="hljs-number">545</span>)
    ... <span class="hljs-number">9</span> more
Caused <span class="hljs-string">by:</span> java.lang.<span class="hljs-string">RuntimeException:</span> Unable to instantiate org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient
    at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.<span class="hljs-string">java:</span><span class="hljs-number">1627</span>)
    at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.&lt;init&gt;(RetryingMetaStoreClient.<span class="hljs-string">java:</span><span class="hljs-number">80</span>)
    at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.<span class="hljs-string">java:</span><span class="hljs-number">130</span>)
    at org.apache.hadoop.hive.metastore.RetryingMetaStoreClient.getProxy(RetryingMetaStoreClient.<span class="hljs-string">java:</span><span class="hljs-number">101</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.createMetaStoreClient(Hive.<span class="hljs-string">java:</span><span class="hljs-number">3317</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.<span class="hljs-string">java:</span><span class="hljs-number">3356</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.getMSC(Hive.<span class="hljs-string">java:</span><span class="hljs-number">3336</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.getAllFunctions(Hive.<span class="hljs-string">java:</span><span class="hljs-number">3590</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.reloadFunctions(Hive.<span class="hljs-string">java:</span><span class="hljs-number">236</span>)
    at org.apache.hadoop.hive.ql.metadata.Hive.registerAllFunctionsOnce(Hive.<span class="hljs-string">java:</span><span class="hljs-number">221</span>)
    ... <span class="hljs-number">14</span> more
Caused <span class="hljs-string">by:</span> java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">62</span>)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">45</span>)
    at java.lang.reflect.Constructor.newInstance(Constructor.<span class="hljs-string">java:</span><span class="hljs-number">423</span>)
    at org.apache.hadoop.hive.metastore.MetaStoreUtils.newInstance(MetaStoreUtils.<span class="hljs-string">java:</span><span class="hljs-number">1625</span>)
    ... <span class="hljs-number">23</span> more
Caused <span class="hljs-string">by:</span> javax.jdo.<span class="hljs-string">JDODataStoreException:</span> Exception thrown obtaining schema column information from datastore
<span class="hljs-string">NestedThrowables:</span>
java.sql.<span class="hljs-string">SQLException:</span> Column name pattern can not be NULL or empty.
    at org.datanucleus.api.jdo.NucleusJDOHelper.getJDOExceptionForNucleusException(NucleusJDOHelper.<span class="hljs-string">java:</span><span class="hljs-number">543</span>)
    at org.datanucleus.api.jdo.JDOPersistenceManager.jdoMakePersistent(JDOPersistenceManager.<span class="hljs-string">java:</span><span class="hljs-number">720</span>)
    at org.datanucleus.api.jdo.JDOPersistenceManager.makePersistent(JDOPersistenceManager.<span class="hljs-string">java:</span><span class="hljs-number">740</span>)
    at org.apache.hadoop.hive.metastore.ObjectStore.setMetaStoreSchemaVersion(ObjectStore.<span class="hljs-string">java:</span><span class="hljs-number">7763</span>)
    at org.apache.hadoop.hive.metastore.ObjectStore.checkSchema(ObjectStore.<span class="hljs-string">java:</span><span class="hljs-number">7657</span>)
    at org.apache.hadoop.hive.metastore.ObjectStore.verifySchema(ObjectStore.<span class="hljs-string">java:</span><span class="hljs-number">7632</span>)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">62</span>)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.<span class="hljs-string">java:</span><span class="hljs-number">43</span>)
    at java.lang.reflect.Method.invoke(Method.<span class="hljs-string">java:</span><span class="hljs-number">498</span>)
    at org.apache.hadoop.hive.metastore.RawStoreProxy.invoke(RawStoreProxy.<span class="hljs-string">java:</span><span class="hljs-number">101</span>)
    at com.sun.proxy.$Proxy21.verifySchema(Unknown Source)
    at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.getMS(HiveMetaStore.<span class="hljs-string">java:</span><span class="hljs-number">547</span>)
    at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.createDefaultDB(HiveMetaStore.<span class="hljs-string">java:</span><span class="hljs-number">612</span>)
    at org.apache.hadoop.hive.metastore.HiveMetaStore$HMSHandler.init(HiveMetaStore.<span class="hljs-string">java:</span><span class="hljs-number">398</span>)
    at org.apache.hadoop.hive.metastore.RetryingHMSHandler.&lt;init&gt;(RetryingHMSHandler.<span class="hljs-string">java:</span><span class="hljs-number">78</span>)
    at org.apache.hadoop.hive.metastore.RetryingHMSHandler.getProxy(RetryingHMSHandler.<span class="hljs-string">java:</span><span class="hljs-number">84</span>)
    at org.apache.hadoop.hive.metastore.HiveMetaStore.newRetryingHMSHandler(HiveMetaStore.<span class="hljs-string">java:</span><span class="hljs-number">6396</span>)
    at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.&lt;init&gt;(HiveMetaStoreClient.<span class="hljs-string">java:</span><span class="hljs-number">236</span>)
    at org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient.&lt;init&gt;(SessionHiveMetaStoreClient.<span class="hljs-string">java:</span><span class="hljs-number">70</span>)
    ... <span class="hljs-number">28</span> more
</code></pre>
<p>解决方案：将 $HIVE_HOME/lib 下 的 mysql-connector-java-6.0.3.jar 替换成 mysql-connector-java-5.1.39.jar。 原因分析：mysql-connector-java 6.x 版本 和 5.1.x 版本不兼容 , nullNamePatternMatchesAll 连接属性的默认值在 mysql-connector-java 5.1 和 6.0 之间发生了改变. 在 5.1 版本中默认值是 true, 而 6.0
 版本中默认值是 false。可以参考文章 <a href="https://liquibase.jira.com/browse/CORE-2723%E3%80%82" rel="nofollow">https://liquibase.jira.com/browse/CORE-2723。</a></p>
<p><br></p>
<p>启动hive报错：</p>
<p>Logging initialized using configuration in file:/usr/local/hive-2.1.1/conf/hive-log4j2.properties Async: true<br>
Exception in thread "main" java.lang.IllegalArgumentException: java.net.URISyntaxException: Relative path in absolute URI: ${system:java.io.tmpdir%7D/$%7Bsystem:user.name%7D<br>
        at org.apache.hadoop.fs.Path.initialize(Path.java:205)<br>
        at org.apache.hadoop.fs.Path.&lt;init&gt;(Path.java:171)<br>
        at org.apache.hadoop.hive.ql.session.SessionState.createSessionDirs(SessionState.java:644)<br>
        at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:563)<br>
        at org.apache.hadoop.hive.ql.session.SessionState.beginStart(SessionState.java:531)<br>
        at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:705)<br>
        at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:641)<br>
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br>
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)<br>
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)<br>
        at java.lang.reflect.Method.invoke(Method.java:498)<br>
        at org.apache.hadoop.util.RunJar.run(RunJar.java:221)<br>
        at org.apache.hadoop.util.RunJar.main(RunJar.java:136)<br>
Caused by: java.net.URISyntaxException: Relative path in absolute URI: ${system:java.io.tmpdir%7D/$%7Bsystem:user.name%7D<br>
        at java.net.URI.checkPath(URI.java:1823)<br>
        at java.net.URI.&lt;init&gt;(URI.java:745)<br>
        at org.apache.hadoop.fs.Path.initialize(Path.java:202)<br>
        ... 12 more<br></p>
<p><br></p>
<p>解决方法：</p>
<p></p>
<p style="color:rgb(85,85,85);font-family:'microsoft yahei';font-size:24px;">
配置文件修改如下属性：（主要是设置目录）</p>
<p style="color:rgb(85,85,85);font-family:'microsoft yahei';font-size:24px;">
</p>
<div style="color:rgb(85,85,85);font-family:'microsoft yahei';font-size:24px;">
<div>  &lt;property&gt;<br>
    &lt;name&gt;hive.exec.scratchdir&lt;/name&gt;<br>
    &lt;value&gt;/tmp/hive&lt;/value&gt;<br>
    &lt;description&gt;HDFS root scratch dir for Hive jobs which gets created with write all (733) permission. For each connecting user, an HDFS scratch dir: ${hive.exec.scratchdir}/&amp;lt;username&amp;gt; is created, with ${hive.scratch.dir.permission}.&lt;/description&gt;<br>
  &lt;/property&gt;</div>
<div><br></div>
<div>  &lt;property&gt;<br>
    &lt;name&gt;hive.exec.local.scratchdir&lt;/name&gt;<br>
    &lt;value&gt;/tmp/hive/local&lt;/value&gt;<br>
    &lt;description&gt;Local scratch space for Hive jobs&lt;/description&gt;<br>
  &lt;/property&gt;</div>
<div><br></div>
<div>  &lt;property&gt;<br>
    &lt;name&gt;hive.downloaded.resources.dir&lt;/name&gt;<br>
    &lt;value&gt;/tmp/hive/resources&lt;/value&gt;<br>
    &lt;description&gt;Temporary local directory for added resources in the remote file system.&lt;/description&gt;<br>
  &lt;/property&gt;</div>
</div>
<br>            </div>
                </div>