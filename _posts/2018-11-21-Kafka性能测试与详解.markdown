---
layout:     post
title:      Kafka性能测试与详解
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h1 style="font-size:1.25em;line-height:1.36em;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(240,240,240);font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';">
Kafka原理和集群测试</h1>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<span style="font-size:16.9599990844727px;line-height:27.1359977722168px;">Kafka的关键设计决策</span>Kafka是一个消息系统，由LinkedIn贡献给Apache基金会，称为Apache的一个顶级项目。Kafka最初用作LinkedIn的活动流（activity stream）和运营数据处理管道（pipeline）的基础。它具有可扩展、吞吐量大和可持久化等特征，以及非常好的分区、复制和容错特征。</p>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>1).</strong> Kafka在设计之时为就将持久化消息作为通常的使用情况进行了考虑。<br><strong>2).</strong> Kafka主要的设计约束是吞吐量，而不是功能。<br><strong>3).</strong> Kafka有关哪些数据已经被使用了的状态信息保存为数据使用者（consumer）的一部分，而不是保存在服务器之上。<br><strong>4).</strong> Kafka是一种显式的分布式系统。它假设，数据生产者（producer）、代理（brokers）和数据使用者（consumer）分散于多台机器之上。<br>
而相比而言，传统的消息队列不能很好的支持（如超长的未处理数据、不能有效持久化)。对于数据的可用性，Kafka提供了两个保证：<br><strong>(1). </strong>生产者发送到Topic的分区上消息将会按照它们发送的顺序，而消费者收到的消息也是此顺序<br><strong>(2). </strong>如果一个Topic配置了复制因子( replication facto)为N， 那么可以允许N-1服务器当掉而不丢失任何已经增加的消息</p>
<h4 style="font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;line-height:27.1359977722168px;">
Kafka中几个关键术语</h4>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>Topic</strong>：Kafka将消息种子(Feed)分门别类， 每一类的消息称之为话题(Topic).<br><strong>Producer</strong>：发布消息的对象称之为话题生产者(Kafka topic producer)<br><strong>Consumer</strong>：订阅消息并处理发布的消息的种子的对象称之为话题消费者(consumers)<br><strong>Broker</strong>：已发布的消息保存在一组服务器中，称之为Kafka集群。集群中的每一个服务器都是一个代理(Broker). 消费者可以订阅一个或多个话题，并从Broker拉数据，从而消费这些已发布的消息。</p>
<h4 style="font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;line-height:27.1359977722168px;">
Kafka中的Topic</h4>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<a href="http://debugo.com/wp-content/uploads/2014/12/topic.png" rel="nofollow" style="text-decoration:none;"><img alt="topic" class="alignnone size-full wp-image-1056" height="267" src="http://debugo.com/wp-content/uploads/2014/12/topic.png" width="416"></a><br>
Topic是发布的消息的类别或者种子Feed名。对于每一个Topic, Kafka集群维护这一个分区的log,就像下图中的示例：Kafka集群<br>
每一个分区都是一个顺序的、不可变的消息队列， 并且可以持续的添加。分区中的消息都被分配了一个序列号，称之为偏移量(offset),在每个分区中此偏移量都是唯一的。<br>
Kafka集群保持所有的消息，直到它们过期，无论消息是否被消费了。<br>
实际上消费者所持有的仅有的元数据就是这个偏移量，也就是消费者在这个log中的位置。 这个偏移量由消费者控制：正常情况当消费者消费消息的时候，偏移量也线性的的增加。但是实际偏移量由消费者控制，消费者可以将偏移量重置为更老的一个偏移量，重新读取消息。<br>
可以看到这种设计对消费者来说操作自如， 一个消费者的操作不会影响其它消费者对此log的处理。<br>
再说说分区。Kafka中采用分区的设计有几个目的。<br><strong>一</strong>、可以处理更多的消息，不受单台服务器的限制。Topic拥有多个分区意味着它可以进行扩展，并处理更多的数据。<br><strong>二</strong>、分区可以作为并行处理的单元。<br>
Topic的分区Log被分布到集群中的多个服务器上。每个服务器处理它持有的分区。 根据配置每个分区还可以复制到其它服务器作为备份容错。<br>
每个分区有一个leader，零或多个replica。Leader处理此分区的所有的读写请求而replica被动的复制数据。如果leader当机，其它的一个replica会被推举为新的leader。<br>
一台服务器可能同时是一个分区的leader，另一个分区的replica。 这样可以平衡负载，避免所有的请求都只让一台或者某几台服务器处理。<br>
关于复制原理，参考下面官档翻译：<br><a href="http://www.oschina.net/translate/kafka-replication" rel="nofollow" style="text-decoration:none;">Kafka 的集群复制设计</a></p>
<h4 style="font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;line-height:27.1359977722168px;">
Kafka的集群部署</h4>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
Kafka中主要有三种模式，<br>
单机broker模式<br>
单机多broker模式（伪分布式）<br>
多机多broker模式（集群)<br>
和hadoop一样，前两种多用于开发测试。第三种才是实际生产中可用的部署模式，下面介绍一下三节点kafka集群的部署流程<br>
软件的安装直接解压缩即可：</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">tar xzvf kafka_2</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">10</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0.8</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1.1</span><span class="pun">.</span><span class="pln">tgz
mkdir </span><span class="pun">/</span><span class="kwd" style="color:rgb(0,0,139);">var</span><span class="pun">/</span><span class="pln">kafka </span><span class="pun">&amp;&amp;</span><span class="pln"> mkdir </span><span class="pun">/</span><span class="kwd" style="color:rgb(0,0,139);">var</span><span class="pun">/</span><span class="pln">zookeeper</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
关键参数的解释，可以参考<a href="http://ju.outofmemory.cn/entry/103018" rel="nofollow" style="text-decoration:none;">http://debugo.com/kafka-params/</a><br>
vim kafka_2.10-0.8.1.1/config/server.properties</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="com" style="color:#808080;">#在默认的配置上，我只修改了3个地方。三个主机debugo01,debugo02,debugo03分别对应id为1，2，3</span><span class="pln">
broker</span><span class="pun">.</span><span class="pln">id</span><span class="pun">=</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">
log</span><span class="pun">.</span><span class="pln">dirs</span><span class="pun">=</span><span class="str" style="color:rgb(128,0,0);">/var/</span><span class="pln">kafka
zookeeper</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">=</span><span class="pln">debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pun">,</span><span class="pln">debugo03</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pln">
</span><span class="pun">配置</span><span class="pln">zookeeper</span><span class="pun">，修改</span><span class="typ" style="color:rgb(43,145,175);">DataDir</span><span class="pun">并加入集群参数</span><span class="pln">
vim kafka_2</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">10</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0.8</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1.1</span><span class="pun">/</span><span class="pln">config</span><span class="pun">/</span><span class="pln">zookeeper</span><span class="pun">.</span><span class="pln">properties
initLimit</span><span class="pun">=</span><span class="lit" style="color:rgb(128,0,0);">5</span><span class="pln">
syncLimit</span><span class="pun">=</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">
server</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">=</span><span class="pln">debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2888</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">3888</span><span class="pln">  
server</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pun">=</span><span class="pln">debugo02</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2888</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">3888</span><span class="pln">  
server</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pun">=</span><span class="pln">debugo03</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2888</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">3888</span><span class="pln">
dataDir</span><span class="pun">=</span><span class="str" style="color:rgb(128,0,0);">/var/</span><span class="pln">zookeeper
</span><span class="com" style="color:#808080;">#分别将1，2，3写入三个主机的myid文件</span><span class="pln">
echo </span><span class="str" style="color:rgb(128,0,0);">"1"</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="str" style="color:rgb(128,0,0);">/var/</span><span class="pln">zookeeper</span><span class="pun">/</span><span class="pln">myid</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
在debugo01,debugo02,debugo03上分别启动zookeeper和kafka Server</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">zookeeper</span><span class="pun">-</span><span class="pln">server</span><span class="pun">-</span><span class="pln">start</span><span class="pun">.</span><span class="pln">sh config</span><span class="pun">/</span><span class="pln">zookeeper</span><span class="pun">.</span><span class="pln">properties
</span><span class="com" style="color:#808080;"># 启动kafka Server</span><span class="pln">
bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">server</span><span class="pun">-</span><span class="pln">start</span><span class="pun">.</span><span class="pln">sh config</span><span class="pun">/</span><span class="pln">server</span><span class="pun">.</span><span class="pln">properties</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
这时可以在log中找到，新的broker已经将数据注册到znode中。</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="com" style="color:#808080;">#####debugo01#####</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">506</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Awaiting</span><span class="pln"> socket connections on debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">network</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">Acceptor</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">521</span><span class="pun">]</span><span class="pln"> INFO </span><span class="pun">[</span><span class="typ" style="color:rgb(43,145,175);">Socket</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Server</span><span class="pln"> on </span><span class="typ" style="color:rgb(43,145,175);">Broker</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">],</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Started</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">network</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">SocketServer</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">649</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Will</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">not</span><span class="pln"> load MX4J</span><span class="pun">,</span><span class="pln"> mx4j</span><span class="pun">-</span><span class="pln">tools</span><span class="pun">.</span><span class="pln">jar </span><span class="kwd" style="color:rgb(0,0,139);">is</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">not</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pln"> the classpath </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">Mx4jLoader$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">725</span><span class="pun">]</span><span class="pln"> INFO </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> successfully elected </span><span class="kwd" style="color:rgb(0,0,139);">as</span><span class="pln"> leader </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">server</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZookeeperLeaderElector</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">876</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Registered</span><span class="pln"> broker </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> at path </span><span class="pun">/</span><span class="pln">brokers</span><span class="pun">/</span><span class="pln">ids</span><span class="pun">/</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">with</span><span class="pln"> address debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZkUtils$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">907</span><span class="pun">]</span><span class="pln"> INFO </span><span class="pun">[</span><span class="typ" style="color:rgb(43,145,175);">Kafka</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Server</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">],</span><span class="pln"> started </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">server</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">KafkaServer</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">993</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">New</span><span class="pln"> leader </span><span class="kwd" style="color:rgb(0,0,139);">is</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">server</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZookeeperLeaderElector$LeaderChangeListener</span><span class="pun">)</span><span class="pln">
</span><span class="com" style="color:#808080;">#####debugo02#####</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">35</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">896</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Awaiting</span><span class="pln"> socket connections on </span><span class="lit" style="color:rgb(128,0,0);">0.0</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">0.0</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">network</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">Acceptor</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">35</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">913</span><span class="pun">]</span><span class="pln"> INFO </span><span class="pun">[</span><span class="typ" style="color:rgb(43,145,175);">Socket</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Server</span><span class="pln"> on </span><span class="typ" style="color:rgb(43,145,175);">Broker</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pun">],</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Started</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">network</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">SocketServer</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">36</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">073</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Will</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">not</span><span class="pln"> load MX4J</span><span class="pun">,</span><span class="pln"> mx4j</span><span class="pun">-</span><span class="pln">tools</span><span class="pun">.</span><span class="pln">jar </span><span class="kwd" style="color:rgb(0,0,139);">is</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">not</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pln"> the classpath </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">Mx4jLoader$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">36</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">179</span><span class="pun">]</span><span class="pln"> INFO conflict </span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pln"> </span><span class="pun">/</span><span class="pln">controller data</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str" style="color:rgb(128,0,0);">"version"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"brokerid"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"timestamp"</span><span class="pun">:</span><span class="str" style="color:rgb(128,0,0);">"1417956876081"</span><span class="pun">}</span><span class="pln"> stored data</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str" style="color:rgb(128,0,0);">"version"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"brokerid"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"timestamp"</span><span class="pun">:</span><span class="str" style="color:rgb(128,0,0);">"1417956860689"</span><span class="pun">}</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZkUtils$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">36</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">398</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Registered</span><span class="pln"> broker </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> at path </span><span class="pun">/</span><span class="pln">brokers</span><span class="pun">/</span><span class="pln">ids</span><span class="pun">/</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">with</span><span class="pln"> address debugo02</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZkUtils$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">36</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">420</span><span class="pun">]</span><span class="pln"> INFO </span><span class="pun">[</span><span class="typ" style="color:rgb(43,145,175);">Kafka</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Server</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pun">],</span><span class="pln"> started </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">server</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">KafkaServer</span><span class="pun">)</span><span class="pln">
</span><span class="com" style="color:#808080;">#####debugo03#####</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">43</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">535</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Awaiting</span><span class="pln"> socket connections on </span><span class="lit" style="color:rgb(128,0,0);">0.0</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">0.0</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">network</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">Acceptor</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">43</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">549</span><span class="pun">]</span><span class="pln"> INFO </span><span class="pun">[</span><span class="typ" style="color:rgb(43,145,175);">Socket</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Server</span><span class="pln"> on </span><span class="typ" style="color:rgb(43,145,175);">Broker</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pun">],</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Started</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">network</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">SocketServer</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">43</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">728</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Will</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">not</span><span class="pln"> load MX4J</span><span class="pun">,</span><span class="pln"> mx4j</span><span class="pun">-</span><span class="pln">tools</span><span class="pun">.</span><span class="pln">jar </span><span class="kwd" style="color:rgb(0,0,139);">is</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">not</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pln"> the classpath </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">Mx4jLoader$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">43</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">783</span><span class="pun">]</span><span class="pln"> INFO conflict </span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pln"> </span><span class="pun">/</span><span class="pln">controller data</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str" style="color:rgb(128,0,0);">"version"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"brokerid"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"timestamp"</span><span class="pun">:</span><span class="str" style="color:rgb(128,0,0);">"1417956883737"</span><span class="pun">}</span><span class="pln"> stored data</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str" style="color:rgb(128,0,0);">"version"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"brokerid"</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="str" style="color:rgb(128,0,0);">"timestamp"</span><span class="pun">:</span><span class="str" style="color:rgb(128,0,0);">"1417956860689"</span><span class="pun">}</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZkUtils$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">43</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">999</span><span class="pun">]</span><span class="pln"> INFO </span><span class="typ" style="color:rgb(43,145,175);">Registered</span><span class="pln"> broker </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln"> at path </span><span class="pun">/</span><span class="pln">brokers</span><span class="pun">/</span><span class="pln">ids</span><span class="pun">/</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">with</span><span class="pln"> address debugo03</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092.</span><span class="pln"> </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">utils</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZkUtils$</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">54</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">44</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">018</span><span class="pun">]</span><span class="pln"> INFO </span><span class="pun">[</span><span class="typ" style="color:rgb(43,145,175);">Kafka</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Server</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pun">],</span><span class="pln"> started </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">server</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">KafkaServer</span><span class="pun">)</span></code></pre>
<h4 style="font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;line-height:27.1359977722168px;">
Topic的分区和复制</h4>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>1. 创建debugo01</strong>，这个topic分区数为3，复制为1（不复制）。该topic跨越全部broker。下面管理命令在任意kafka节点上执行即可</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">create </span><span class="pun">--</span><span class="pln">zookeeper debugo01</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">,</span><span class="pln">debugo03 </span><span class="pun">--</span><span class="pln">replication</span><span class="pun">-</span><span class="pln">factor </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> </span><span class="pun">--</span><span class="pln">partitions </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo01
</span><span class="typ" style="color:rgb(43,145,175);">Created</span><span class="pln"> topic </span><span class="str" style="color:rgb(128,0,0);">"debugo01"</span><span class="pun">.</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>2. 创建debugo02</strong>，这个topic分区数为1，复制为3（每个主机都有一份）。该topic跨越全部broker。下面管理命令在任意kafka节点上执行即可</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">create </span><span class="pun">--</span><span class="pln">zookeeper debugo01</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">,</span><span class="pln">debugo03 </span><span class="pun">--</span><span class="pln">replication</span><span class="pun">-</span><span class="pln">factor </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln"> </span><span class="pun">--</span><span class="pln">partitions </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo02</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>3. 列出topic信息</strong></p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pun">[</span><span class="pln">root@debugo01 kafka_2</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">10</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0.8</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1.1</span><span class="pun">]#</span><span class="pln"> bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">list </span><span class="pun">--</span><span class="pln">zookeeper localhost</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pln">
debugo01
debugo02</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>4. 列出topic描述信息</strong></p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pun">[</span><span class="pln">root@debugo01 kafka_2</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">10</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0.8</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1.1</span><span class="pun">]#</span><span class="pln"> bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">describe </span><span class="pun">--</span><span class="pln">zookeeper localhost</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo01
</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln">debugo01	</span><span class="typ" style="color:rgb(43,145,175);">PartitionCount</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">ReplicationFactor</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Configs</span><span class="pun">:</span><span class="pln">
	</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln"> debugo01	</span><span class="typ" style="color:rgb(43,145,175);">Partition</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Leader</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Replicas</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Isr</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">
	</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln"> debugo01	</span><span class="typ" style="color:rgb(43,145,175);">Partition</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Leader</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Replicas</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Isr</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">
	</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln"> debugo01	</span><span class="typ" style="color:rgb(43,145,175);">Partition</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Leader</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Replicas</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Isr</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>5. 检查log目录</strong>，对于topic debugo01，debugo01为0号分区，debugo02为1号分区。而topic debugo02则复制了3份，都为0号分区</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pun">[</span><span class="pln">root@debugo01 kafka</span><span class="pun">]#</span><span class="pln"> ll
total </span><span class="lit" style="color:rgb(128,0,0);">24</span><span class="pln">
drwxr</span><span class="pun">-</span><span class="pln">xr</span><span class="pun">-</span><span class="pln">x </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> root root </span><span class="lit" style="color:rgb(128,0,0);">4096</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">15</span><span class="pln"> debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">
drwxr</span><span class="pun">-</span><span class="pln">xr</span><span class="pun">-</span><span class="pln">x </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> root root </span><span class="lit" style="color:rgb(128,0,0);">4096</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">16</span><span class="pln"> debugo02</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">
</span><span class="pun">[</span><span class="pln">root@debugo02 kafka</span><span class="pun">]#</span><span class="pln"> ll
total </span><span class="lit" style="color:rgb(128,0,0);">24</span><span class="pln">
drwxr</span><span class="pun">-</span><span class="pln">xr</span><span class="pun">-</span><span class="pln">x </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> root root </span><span class="lit" style="color:rgb(128,0,0);">4096</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">15</span><span class="pln"> debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">
drwxr</span><span class="pun">-</span><span class="pln">xr</span><span class="pun">-</span><span class="pln">x </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> root root </span><span class="lit" style="color:rgb(128,0,0);">4096</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">16</span><span class="pln"> debugo02</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">
</span><span class="com" style="color:#808080;">#而每个分区下面都生成了index和log文件</span><span class="pln">
</span><span class="pun">[</span><span class="pln">root@debugo01 debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pun">]#</span><span class="pln"> ls
</span><span class="lit" style="color:rgb(128,0,0);">000000000000.index</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">00000000000000000000.log</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
<strong>6. 下面topic debugo03</strong>，replication-factor为2，partition为3.那么broker id为1的debugo01会如下面describe所示，保存0号分区和1号分区。<br>
而0号分区的repica leader为broker id = 3，包含3和1两个replicas。</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">create </span><span class="pun">--</span><span class="pln">zookeeper debugo01</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">,</span><span class="pln">debugo03 </span><span class="pun">--</span><span class="pln">replication</span><span class="pun">-</span><span class="pln">factor </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> </span><span class="pun">--</span><span class="pln">partitions </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo03
</span><span class="typ" style="color:rgb(43,145,175);">Created</span><span class="pln"> topic </span><span class="str" style="color:rgb(128,0,0);">"debugo03"</span><span class="pun">.</span><span class="pln">
bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">describe </span><span class="pun">--</span><span class="pln">zookeeper localhost</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo03
</span><span class="pun">[</span><span class="pln">root@debugo01 kafka_2</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">10</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0.8</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1.1</span><span class="pun">]#</span><span class="pln"> bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">topics</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">describe </span><span class="pun">--</span><span class="pln">zookeeper localhost</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2181</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo03
</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln">debugo03	</span><span class="typ" style="color:rgb(43,145,175);">PartitionCount</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">ReplicationFactor</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Configs</span><span class="pun">:</span><span class="pln">
	</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln"> debugo03	</span><span class="typ" style="color:rgb(43,145,175);">Partition</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Leader</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Replicas</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Isr</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">
	</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln"> debugo03	</span><span class="typ" style="color:rgb(43,145,175);">Partition</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Leader</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Replicas</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Isr</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">
	</span><span class="typ" style="color:rgb(43,145,175);">Topic</span><span class="pun">:</span><span class="pln"> debugo03	</span><span class="typ" style="color:rgb(43,145,175);">Partition</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Leader</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Replicas</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">	</span><span class="typ" style="color:rgb(43,145,175);">Isr</span><span class="pun">:</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">

</span><span class="pun">[</span><span class="pln">root@debugo01 kafka_2</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">10</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0.8</span><span class="pun">.</span><span class="lit" style="color:rgb(128,0,0);">1.1</span><span class="pun">]#</span><span class="pln"> ll </span><span class="pun">/</span><span class="kwd" style="color:rgb(0,0,139);">var</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">/</span><span class="pln">debugo03</span><span class="pun">*</span><span class="pln">
</span><span class="str" style="color:rgb(128,0,0);">/var/</span><span class="pln">kafka</span><span class="pun">/</span><span class="pln">debugo03</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pun">:</span><span class="pln">
total </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">
</span><span class="pun">-</span><span class="pln">rw</span><span class="pun">-</span><span class="pln">r</span><span class="pun">--</span><span class="pln">r</span><span class="pun">--</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> root root </span><span class="lit" style="color:rgb(128,0,0);">10485760</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">34</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">00000000000000000000.index</span><span class="pln">
</span><span class="pun">-</span><span class="pln">rw</span><span class="pun">-</span><span class="pln">r</span><span class="pun">--</span><span class="pln">r</span><span class="pun">--</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> root root        </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">34</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">00000000000000000000.log</span><span class="pln">
</span><span class="pun">/</span><span class="kwd" style="color:rgb(0,0,139);">var</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">/</span><span class="pln">debugo03</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pun">:</span><span class="pln">
total </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln">
</span><span class="pun">-</span><span class="pln">rw</span><span class="pun">-</span><span class="pln">r</span><span class="pun">--</span><span class="pln">r</span><span class="pun">--</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> root root </span><span class="lit" style="color:rgb(128,0,0);">10485760</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">34</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">00000000000000000000.index</span><span class="pln">
</span><span class="pun">-</span><span class="pln">rw</span><span class="pun">-</span><span class="pln">r</span><span class="pun">--</span><span class="pln">r</span><span class="pun">--</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> root root        </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">Dec</span><span class="pln">  </span><span class="lit" style="color:rgb(128,0,0);">7</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">34</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">00000000000000000000.log</span></code></pre>
<h4 style="font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;line-height:27.1359977722168px;">
消息的产生和消费</h4>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
两个终端分别打开producer和consumer进行测试</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="tag" style="color:rgb(128,0,0);">&lt;terminal</span><span class="pln"> 1</span><span class="tag" style="color:rgb(128,0,0);">&gt;</span><span class="pln">
bin/kafka-console-producer.sh --broker-list debugo01:9092 --topic debugo03
hello kafka
hello debugo
</span><span class="tag" style="color:rgb(128,0,0);">&lt;terminal</span><span class="pln"> 2</span><span class="tag" style="color:rgb(128,0,0);">&gt;</span><span class="pln">
bin/kafka-console-consumer.sh --zookeeper debugo01:2181 --from-beginning --topic debugo03
hello kafka
hello debugo</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
下面使用perf命令来测试几个topic的性能，需要先下载kafka-perf_2.10-0.8.1.1.jar，并拷贝到kafka/libs下面。<br>
50W条消息，每条1000字节，batch大小1000，topic为debugo01，4个线程（message size设置太大需要调整相关参数，否则容易OOM）。只用了13秒完成，kafka在多分区支持下吞吐量是非常给力的。</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">producer</span><span class="pun">-</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">test</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">messages </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">message</span><span class="pun">-</span><span class="pln">size </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pln">  </span><span class="pun">--</span><span class="pln">batch</span><span class="pun">-</span><span class="pln">size </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topics debugo01 </span><span class="pun">--</span><span class="pln">threads </span><span class="lit" style="color:rgb(128,0,0);">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">broker</span><span class="pun">-</span><span class="pln">list debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pun">,</span><span class="pln">debugo03</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pln">
start</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">end</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> compression</span><span class="pun">,</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> batch</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">sent</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">MB</span><span class="pun">,</span><span class="pln"> MB</span><span class="pun">.</span><span class="pln">sec</span><span class="pun">,</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">sent</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">nMsg</span><span class="pun">,</span><span class="pln"> nMsg</span><span class="pun">.</span><span class="pln">sec
</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">56</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">038</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">08</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">09</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">413</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">476.84</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">35.6514</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">37383.1776</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
同样的参数测试debugo02, 由于但分区加复制（replicas-factor=3），用时39秒。所以，适当加大partition数量和broker相关线程数量会极大的提高性能。</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">producer</span><span class="pun">-</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">test</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">messages </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">message</span><span class="pun">-</span><span class="pln">size </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pln">  </span><span class="pun">--</span><span class="pln">batch</span><span class="pun">-</span><span class="pln">size </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topics debugo02 </span><span class="pun">--</span><span class="pln">threads </span><span class="lit" style="color:rgb(128,0,0);">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">broker</span><span class="pun">-</span><span class="pln">list debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pun">,</span><span class="pln">debugo03</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pln">
start</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">end</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> compression</span><span class="pun">,</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> batch</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">sent</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">MB</span><span class="pun">,</span><span class="pln"> MB</span><span class="pun">.</span><span class="pln">sec</span><span class="pun">,</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">sent</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">nMsg</span><span class="pun">,</span><span class="pln"> nMsg</span><span class="pun">.</span><span class="pln">sec
</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">13</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">28</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">840</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">14</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">819</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">476.84</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">12.2332</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">12827.4199</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
同样的参数测试debugo03，用时30秒。</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">producer</span><span class="pun">-</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">test</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">messages </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">message</span><span class="pun">-</span><span class="pln">size </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pln">  </span><span class="pun">--</span><span class="pln">batch</span><span class="pun">-</span><span class="pln">size </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topics debugo03 </span><span class="pun">--</span><span class="pln">threads </span><span class="lit" style="color:rgb(128,0,0);">4</span><span class="pln"> </span><span class="pun">--</span><span class="pln">broker</span><span class="pun">-</span><span class="pln">list debugo01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pun">,</span><span class="pln">debugo03</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">9092</span><span class="pln">
start</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">end</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> compression</span><span class="pun">,</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> batch</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">sent</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">MB</span><span class="pun">,</span><span class="pln"> MB</span><span class="pun">.</span><span class="pln">sec</span><span class="pun">,</span><span class="pln"> total</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">sent</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">nMsg</span><span class="pun">,</span><span class="pln"> nMsg</span><span class="pun">.</span><span class="pln">sec
</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">16</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">04</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">895</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">16</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">34</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">715</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">476.84</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">15.9905</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">16767.2703</span></code></pre>
<p style="line-height:27.1359977722168px;font-family:'Helvetica Neue', Helvetica, STHeiTi, 'Microsoft YaHei';font-size:16.9599990844727px;">
同理，测试comsumer的性能。</p>
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;overflow:auto;font-size:.8em;line-height:1.5em;background-color:rgb(225,225,225);"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;display:block;overflow:auto;background-color:rgb(247,247,247);"><span class="pln">bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">test</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">zookeeper debugo01</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">,</span><span class="pln">debugo03 </span><span class="pun">--</span><span class="pln">messages </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo01 </span><span class="pun">--</span><span class="pln">threads </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">
start</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">end</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> fetch</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">consumed</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">MB</span><span class="pun">,</span><span class="pln"> MB</span><span class="pun">.</span><span class="pln">sec</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">consumed</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">nMsg</span><span class="pun">,</span><span class="pln"> nMsg</span><span class="pun">.</span><span class="pln">sec
</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">19</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">04</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">527</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">19</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">17</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">184</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1048576</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">476.8372</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">62.2747</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">65299.7257</span><span class="pln">
bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">test</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">zookeeper debugo01</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">,</span><span class="pln">debugo03 </span><span class="pun">--</span><span class="pln">messages </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo02 </span><span class="pun">--</span><span class="pln">threads </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">
start</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">end</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> fetch</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">consumed</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">MB</span><span class="pun">,</span><span class="pln"> MB</span><span class="pun">.</span><span class="pln">sec</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">consumed</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">nMsg</span><span class="pun">,</span><span class="pln"> nMsg</span><span class="pun">.</span><span class="pln">sec
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">19</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">59</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">938</span><span class="pun">]</span><span class="pln"> WARN </span><span class="pun">[</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">78853</span><span class="pln">_debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1417961999315</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">4a5941ef</span><span class="pun">],</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">No</span><span class="pln"> broker partitions consumed </span><span class="kwd" style="color:rgb(0,0,139);">by</span><span class="pln"> consumer thread perf</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">78853</span><span class="pln">_debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1417961999315</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">4a5941ef</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">for</span><span class="pln"> topic debugo02 </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">consumer</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZookeeperConsumerConnector</span><span class="pun">)</span><span class="pln">
</span><span class="pun">[</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">19</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">59</span><span class="pun">,</span><span class="lit" style="color:rgb(128,0,0);">938</span><span class="pun">]</span><span class="pln"> WARN </span><span class="pun">[</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">78853</span><span class="pln">_debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1417961999315</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">4a5941ef</span><span class="pun">],</span><span class="pln"> </span><span class="typ" style="color:rgb(43,145,175);">No</span><span class="pln"> broker partitions consumed </span><span class="kwd" style="color:rgb(0,0,139);">by</span><span class="pln"> consumer thread perf</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">78853</span><span class="pln">_debugo01</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">1417961999315</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">4a5941ef</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">2</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">for</span><span class="pln"> topic debugo02 </span><span class="pun">(</span><span class="pln">kafka</span><span class="pun">.</span><span class="pln">consumer</span><span class="pun">.</span><span class="typ" style="color:rgb(43,145,175);">ZookeeperConsumerConnector</span><span class="pun">)</span><span class="pln">
</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">01</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">008</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">20</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">08</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">971</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1048576</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">476.8372</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">160.9305</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">168747.8907</span><span class="pln">
bin</span><span class="pun">/</span><span class="pln">kafka</span><span class="pun">-</span><span class="pln">consumer</span><span class="pun">-</span><span class="pln">perf</span><span class="pun">-</span><span class="pln">test</span><span class="pun">.</span><span class="pln">sh </span><span class="pun">--</span><span class="pln">zookeeper debugo01</span><span class="pun">,</span><span class="pln">debugo02</span><span class="pun">,</span><span class="pln">debugo03 </span><span class="pun">--</span><span class="pln">messages </span><span class="lit" style="color:rgb(128,0,0);">500000</span><span class="pln"> </span><span class="pun">--</span><span class="pln">topic debugo03 </span><span class="pun">--</span><span class="pln">threads </span><span class="lit" style="color:rgb(128,0,0);">3</span><span class="pln">
start</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> </span><span class="kwd" style="color:rgb(0,0,139);">end</span><span class="pun">.</span><span class="pln">time</span><span class="pun">,</span><span class="pln"> fetch</span><span class="pun">.</span><span class="pln">size</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">consumed</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">MB</span><span class="pun">,</span><span class="pln"> MB</span><span class="pun">.</span><span class="pln">sec</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">consumed</span><span class="pun">.</span><span class="kwd" style="color:rgb(0,0,139);">in</span><span class="pun">.</span><span class="pln">nMsg</span><span class="pun">,</span><span class="pln"> nMsg</span><span class="pun">.</span><span class="pln">sec
</span><span class="pun">​</span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">27</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">421</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">2014</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">12</span><span class="pun">-</span><span class="lit" style="color:rgb(128,0,0);">07</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">22</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">21</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">39</span><span class="pun">:</span><span class="lit" style="color:rgb(128,0,0);">918</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">1048576</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">476.8372</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">63.6037</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">500002</span><span class="pun">,</span><span class="pln"> </span><span class="lit" style="color:rgb(128,0,0);">66693.6108</span></code></pre>
            </div>
                </div>