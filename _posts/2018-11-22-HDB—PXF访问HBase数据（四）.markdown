---
layout:     post
title:      HDB—PXF访问HBase数据（四）
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <h1><span style="font-family:'宋体';font-size:22pt;">1 </span><strong><span style="font-family:Calibri;font-size:22pt;"><span style="font-family:'宋体';">访问</span>HBase<span style="font-family:'宋体';">数据</span></span><span style="font-family:'宋体';font-size:22pt;"></span></strong></h1><p><strong></strong></p><strong></strong><h2 style="margin-left:21.3pt;text-indent:-21.3pt;"><span style="font-family:'黑体';font-size:16pt;">1.1 </span><strong><span style="font-family:Arial;font-size:16pt;"><span style="font-family:'黑体';">先决条件</span></span><span style="font-family:'黑体';font-size:16pt;"></span></strong></h2><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">在尝试使用</span>PXF<span style="font-family:'宋体';">访问</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">数据之前，请验证以下内容：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:21pt;text-indent:-21pt;background:rgb(255,255,255);"><span style="font-family:Wingdings;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">Ø </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">/etc/hbase/conf/hbase-env.sh<span style="font-family:'宋体';">配置文件必须引用</span><span style="font-family:Verdana;">pxf-hbase.jar </span><span style="font-family:'宋体';">。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">例如，</span><span style="font-family:Verdana;">/ /etc/hbase/conf/hbase-env.sh</span><span style="font-family:'宋体';">应包含以下行：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;text-align:left;background:rgb(240,240,240);"><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"> </span><span style="font-family:Consolas;color:rgb(0,119,34);letter-spacing:0pt;font-size:12pt;">export </span><span style="font-family:Consolas;color:rgb(0,51,102);letter-spacing:0pt;font-size:12pt;">HBASE_CLASSPATH</span><span style="font-family:Consolas;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;">=</span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">${</span></strong><span style="font-family:Consolas;color:rgb(0,51,102);letter-spacing:0pt;font-size:12pt;">HBASE_CLASSPATH</span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">}</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">:/usr/lib/pxf/pxf-hbase.jar</span><span style="font-family:'宋体';font-size:12pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><strong><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">注意：</span></span></strong><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">在对</span>HBase<span style="font-family:'宋体';">配置进行任何更改后，您必须重新启动</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">。</span></span><span style="font-family:Calibri;font-size:12pt;"></span></p><p></p><p class="p" style="margin-left:21pt;text-indent:-21pt;background:rgb(255,255,255);"><span style="font-family:Wingdings;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">Ø </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">PXF HBase<span style="font-family:'宋体';">插件安装在所有群集节点上。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:21pt;text-indent:-21pt;background:rgb(255,255,255);"><span style="font-family:Wingdings;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">Ø </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">HBase<span style="font-family:'宋体';">和</span><span style="font-family:Verdana;">ZooKeeper jars</span><span style="font-family:'宋体';">安装在所有群集节点上。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><h2 style="margin-left:21.3pt;text-indent:-21.3pt;"><span style="font-family:'黑体';font-size:16pt;">1.2 </span><strong><span style="font-family:Arial;font-size:16pt;"><span style="font-family:'黑体';">句法</span></span><span style="font-family:Arial;font-size:16pt;"></span></strong></h2><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">要创建外部</span>HBase<span style="font-family:'宋体';">表，请使用以下语法：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">CREATE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">READABLE</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">EXTERNAL</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">TABLE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">table_name</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">    </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">(</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">column_name</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">data_type</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">[,</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">...]</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;">|</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">LIKE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">other_table</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">)</span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">LOCATION</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">('pxf://host[:port]/hbase-table-name?Profile=HBase')FORMAT</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">'CUSTOM'</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">(Formatter</span><span style="font-family:Consolas;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;">=</span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">'pxfwritable_import');</span><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">HBase<span style="font-family:'宋体';">配置文件相当于以下</span><span style="font-family:Verdana;">PXF</span><span style="font-family:'宋体';">参数：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:21pt;text-indent:-21pt;background:rgb(255,255,255);"><span style="font-family:Wingdings;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">Ø </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">分段器</span>= org.apache.hawq.pxf.plugins.hbase.HBaseDataFragmenter</span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:21pt;text-indent:-21pt;background:rgb(255,255,255);"><span style="font-family:Wingdings;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">Ø </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">访问</span>= org.apache.hawq.pxf.plugins.hbase.HBaseAccessor</span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:21pt;text-indent:-21pt;background:rgb(255,255,255);"><span style="font-family:Wingdings;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">Ø </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">解析器</span>= org.apache.hawq.pxf.plugins.hbase.HBaseResolver</span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><strong><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">注意</span> <span style="font-family:'宋体';">：</span></span></strong><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">您使用</span>HBase<span style="font-family:'宋体';">配置文件创建的外部表不支持</span><span style="font-family:Verdana;">ANALYZE</span><span style="font-family:'宋体';">命令。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><h2 style="margin-left:21.3pt;text-indent:-21.3pt;"><span style="font-family:'黑体';font-size:16pt;">1.3 </span><strong><span style="font-family:Arial;font-size:16pt;"><span style="font-family:'黑体';">列映射</span></span><span style="font-family:Arial;font-size:16pt;"></span></strong></h2><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">大多数</span>HAWQ<span style="font-family:'宋体';">外部表（</span><span style="font-family:Verdana;">PXF</span><span style="font-family:'宋体';">或其他）要求</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">表属性与源数据记录布局相匹配，并包含所有可用属性。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">但是，使用</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">，您可以使用</span><span style="font-family:Verdana;">PXF HBase</span><span style="font-family:'宋体';">插件指定定义</span><span style="font-family:Verdana;">HAWQ PXF</span><span style="font-family:'宋体';">表的</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">限定符的子集。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">要在</span><span style="font-family:Verdana;">PXF</span><span style="font-family:'宋体';">表中的每个属性与</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">表中的特定限定符之间建立清晰映射，可以使用直接映射或间接映射。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">另外，</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">行键以特殊方式处理。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><h3 style="margin-left:28.35pt;text-indent:-28.35pt;"><span style="font-family:'宋体';font-size:13.5pt;">1.3.1 </span><strong><span style="font-family:'宋体';font-size:13.5pt;">行键</span><span style="font-family:'宋体';font-size:13.5pt;"></span></strong></h3><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">您可以通过多种方式使用</span>HBase<span style="font-family:'宋体';">表格行键。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">例如，您可以使用查询结果查看它们，也可以对一系列行键值运行</span><span style="font-family:Verdana;">WHERE</span><span style="font-family:'宋体';">子句过滤器。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">要使用</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">查询中的行键，请使用保留的</span><span style="font-family:Verdana;">PXF</span><span style="font-family:'宋体';">属性</span><span style="font-family:Verdana;">recordkey.</span><span style="font-family:'宋体';">定义</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">表</span><span style="font-family:Verdana;">recordkey. </span><span style="font-family:'宋体';">此属性名称告诉</span><span style="font-family:Verdana;">PXF</span><span style="font-family:'宋体';">在任何基于键值的系统和</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">中返回记录密钥。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><strong><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">注意：</span></span></strong><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">因为</span>HBase<span style="font-family:'宋体';">是字节而不是基于字符的，所以您应该将</span><span style="font-family:Verdana;">recordkey</span><span style="font-family:'宋体';">定义为</span><span style="font-family:Verdana;">bytea</span><span style="font-family:'宋体';">类型。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">这可能会更好地过滤数据并提高性能。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">CREATE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">EXTERNAL</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">TABLE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;">&lt;</span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">tname</span><span style="font-family:Consolas;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;">&gt;</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">(recordkey</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">bytea,</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">...</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">)</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">LOCATION</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">('pxf:// ...')</span><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"></span></p><p></p><h3 style="margin-left:28.35pt;text-indent:-28.35pt;"><span style="font-family:'宋体';font-size:13.5pt;">1.3.2 </span><strong><span style="font-family:'宋体';font-size:13.5pt;">直接映射</span><span style="font-family:'宋体';font-size:13.5pt;"></span></strong></h3><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">使用直接映射将</span>HAWQ<span style="font-family:'宋体';">表格属性映射到</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">限定符。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">您可以将感兴趣的</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">限定符名称（包括列名称）指定为带引号的值。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">例如，您已经定义了一个名为</span>hbase_sales<span style="font-family:'宋体';">的</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">表，</span><span style="font-family:Verdana;"> hbase_sales</span><span style="font-family:'宋体';">包含多个列族和许多限定符。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">用这些属性创建一个</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">表：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="MsoNormal" style="margin-left:42pt;text-indent:-18pt;"><span style="font-family:Symbol;color:rgb(0,0,0);letter-spacing:0pt;font-size:10pt;background:rgb(255,255,255);">· </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">rowkey</span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"></span></p><p></p><p class="MsoNormal" style="margin-left:42pt;text-indent:-18pt;"><span style="font-family:Symbol;color:rgb(0,0,0);letter-spacing:0pt;font-size:10pt;background:rgb(255,255,255);">· </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"><span style="font-family:'宋体';">列家族</span>cf1</span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"></span></p><p></p><p class="MsoNormal" style="margin-left:42pt;text-indent:-18pt;"><span style="font-family:Symbol;color:rgb(0,0,0);letter-spacing:0pt;font-size:10pt;background:rgb(255,255,255);">· </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"><span style="font-family:'宋体';">列族</span>cf8<span style="font-family:'宋体';">中的限定符</span><span style="font-family:Verdana;">comments</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">使用以下</span>CREATE EXTERNAL TABLE<span style="font-family:'宋体';">语法：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">CREATE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">EXTERNAL</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">TABLE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">hbase_sales</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">(</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">  </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">recordkey</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">bytea,</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">  </span><span style="font-family:Consolas;color:rgb(0,51,102);letter-spacing:0pt;font-size:12pt;">"cf1:saleid"</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">int,</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">  </span><span style="font-family:Consolas;color:rgb(0,51,102);letter-spacing:0pt;font-size:12pt;">"cf8:comments"</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">varchar)</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">...</span><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:0pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;">PXF HBase<span style="font-family:'宋体';">插件按原样使用这些属性名称，并返回这些</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">限定符的值。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><h3 style="margin-left:28.35pt;text-indent:-28.35pt;"><span style="font-family:'宋体';font-size:13.5pt;">1.3.3 </span><strong><span style="font-family:'宋体';font-size:13.5pt;">间接映射（通过查找表）</span><span style="font-family:'宋体';font-size:13.5pt;"></span></strong></h3><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">直接映射方法既快速又直观，但使用间接映射有助于将</span>HBase<span style="font-family:'宋体';">限定符名称与</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">行为进行协调：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="MsoNormal" style="margin-left:42pt;text-indent:-18pt;"><span style="font-family:Symbol;color:rgb(0,0,0);letter-spacing:0pt;font-size:10pt;background:rgb(255,255,255);">· </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">HBase<span style="font-family:'宋体';">限定符名称可能长于</span><span style="font-family:Verdana;">32</span><span style="font-family:'宋体';">个字符。</span><span style="font-family:Verdana;"> HAWQ</span><span style="font-family:'宋体';">对属性名称大小有</span><span style="font-family:Verdana;">32</span><span style="font-family:'宋体';">个字符的限制。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"></span></p><p></p><p class="MsoNormal" style="margin-left:42pt;text-indent:-18pt;"><span style="font-family:Symbol;color:rgb(0,0,0);letter-spacing:0pt;font-size:10pt;background:rgb(255,255,255);">· </span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);">HBase<span style="font-family:'宋体';">限定符名称可以是二进制或不可打印的。</span><span style="font-family:Verdana;"> HAWQ</span><span style="font-family:'宋体';">属性名称是基于字符的。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;background:rgb(255,255,255);"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">无论哪种情况，间接映射都使用</span>HBase<span style="font-family:'宋体';">上的查找表。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">您可以创建查找表来存储所有必要的查找信息。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">这可以作为任何未来查询的模板。</span><span style="font-family:Verdana;"> </span><span style="font-family:'宋体';">查找表的名称必须是</span><span style="font-family:Verdana;">pxflookup</span><span style="font-family:'宋体';">并且必须包含名为</span><span style="font-family:Verdana;">mapping</span><span style="font-family:'宋体';">的列族。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">使用直接映射中的销售示例，如果我们的</span>rowkey<span style="font-family:'宋体';">表示</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">表名，并且</span><span style="font-family:Verdana;">mapping</span><span style="font-family:'宋体';">列族包含</span><span style="font-family:Verdana;">&lt;hawq attr name&gt;=&lt;hbase cf:qualifier&gt;</span><span style="font-family:'宋体';">的键值形式的实际属性映射。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><h3 style="margin-left:28.35pt;text-indent:-28.35pt;"><span style="font-family:'宋体';font-size:13.5pt;">1.3.4 </span><strong><span style="font-family:'宋体';font-size:13.5pt;">举</span><span style="font-family:'宋体';font-size:13.5pt;">例</span><span style="font-family:'宋体';font-size:13.5pt;"></span></strong></h3><p><strong></strong></p><strong></strong><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">本示例将</span>cf1<span style="font-family:'宋体';">列族中的</span><span style="font-family:Verdana;">saleid</span><span style="font-family:'宋体';">限定符映射到</span><span style="font-family:Verdana;">HAWQ id</span><span style="font-family:'宋体';">列，并将</span><span style="font-family:Verdana;">cf8</span><span style="font-family:'宋体';">族中的</span><span style="font-family:Verdana;">comments</span><span style="font-family:'宋体';">限定符</span><span style="font-family:Verdana;">cf8</span><span style="font-family:'宋体';">到</span><span style="font-family:Verdana;">HAWQ cmts</span><span style="font-family:'宋体';">列。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><table style="width:492pt;margin-left:.15pt;"><tbody><tr><td width="328" style="width:246pt;border-left-width:1pt;border-left-color:rgb(181,181,181);border-top-width:1pt;border-top-color:rgb(181,181,181);background:rgb(248,248,248);"><p class="MsoNormal" style="margin-left:0pt;text-indent:0pt;"><strong><span style="font-family:'微软雅黑';color:rgb(75,100,117);letter-spacing:0pt;font-size:10.5pt;">(row key)</span><span style="font-family:'微软雅黑';color:rgb(75,100,117);letter-spacing:0pt;font-size:10.5pt;"></span></strong></p><p><strong></strong></p><strong></strong></td><td width="328" style="width:246pt;border-right-width:1pt;border-right-color:rgb(181,181,181);border-top-width:1pt;border-top-color:rgb(181,181,181);background:rgb(248,248,248);"><p class="MsoNormal" style="margin-left:0pt;text-indent:0pt;"><strong><span style="font-family:'微软雅黑';color:rgb(75,100,117);letter-spacing:0pt;font-size:10.5pt;">mapping</span><span style="font-family:'微软雅黑';color:rgb(75,100,117);letter-spacing:0pt;font-size:10.5pt;"></span></strong></p><p><strong></strong></p><strong></strong></td></tr><tr><td width="328" style="width:246pt;border-left-width:1pt;border-left-color:rgb(181,181,181);background:rgb(255,255,255);"><p class="MsoNormal" style="margin-left:0pt;text-indent:0pt;"><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;">sales</span><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;"></span></p><p></p></td><td width="328" style="width:246pt;border-right-width:1pt;border-right-color:rgb(181,181,181);background:rgb(255,255,255);"><p class="MsoNormal" style="margin-left:0pt;text-indent:0pt;"><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;">id=cf1:saleid</span><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;"></span></p><p></p></td></tr><tr><td width="328" style="width:246pt;border-left-width:1pt;border-left-color:rgb(181,181,181);border-bottom-width:1pt;border-bottom-color:rgb(181,181,181);"><p class="MsoNormal" style="margin-left:0pt;text-indent:0pt;"><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;">sales</span><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;"></span></p><p></p></td><td width="328" style="width:246pt;border-right-width:1pt;border-right-color:rgb(181,181,181);border-bottom-width:1pt;border-bottom-color:rgb(181,181,181);"><p class="MsoNormal" style="margin-left:0pt;text-indent:0pt;"><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;">cmts=cf8:comments</span><span style="font-family:'微软雅黑';color:rgb(104,104,104);letter-spacing:0pt;font-size:12pt;"></span></p><p></p></td></tr></tbody></table><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">该映射为每个限定符分配了新名称。</span> <span style="font-family:'宋体';">您可以在</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">表定义中使用这些名称：</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">CREATE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">EXTERNAL</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><strong><span style="font-family:Consolas;color:rgb(34,136,153);letter-spacing:0pt;font-size:12pt;">TABLE</span></strong><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">hbase_sales</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">(</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">  </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">recordkey</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">bytea</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">  </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">id</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">int,</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"></span></p><p></p><p class="pre" style="margin-left:0pt;text-indent:0pt;background:rgb(240,240,240);"><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;">  </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">cmts</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">varchar)</span><span class="15" style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:10pt;"> </span><span style="font-family:Consolas;color:rgb(66,66,66);letter-spacing:0pt;font-size:12pt;">...</span><span style="font-family:monospace;color:rgb(51,51,51);letter-spacing:0pt;font-size:12pt;"></span></p><p></p><p class="p" style="margin-left:0pt;text-indent:21pt;background:rgb(255,255,255);"><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"><span style="font-family:'宋体';">在</span>HBase<span style="font-family:'宋体';">中存在</span><span style="font-family:Verdana;">pxflookup</span><span style="font-family:'宋体';">表时，</span><span style="font-family:Verdana;">PXF</span><span style="font-family:'宋体';">自动将</span><span style="font-family:Verdana;">HAWQ</span><span style="font-family:'宋体';">与</span><span style="font-family:Verdana;">HBase</span><span style="font-family:'宋体';">列名匹配。</span></span><span style="font-family:Verdana;color:rgb(0,0,0);letter-spacing:0pt;font-size:10.5pt;"></span></p><p></p>            </div>
                </div>