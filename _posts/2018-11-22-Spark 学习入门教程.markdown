---
layout:     post
title:      Spark 学习入门教程
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<p style="font-family:SimSun;font-size:16pt;color:#17365D;"><span style="font-weight:bold;">一、环境准备</span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><a href="http://lib.csdn.net/base/softwaretest" rel="nofollow" class="replace_word" title="软件测试知识库" style="color:#df3434;font-weight:bold;">测试</a>环境使用的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">cdh</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">提供的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">quickstart
 vm</span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><a href="http://lib.csdn.net/base/hadoop" rel="nofollow" class="replace_word" title="Hadoop知识库" style="color:#df3434;font-weight:bold;">Hadoop</a></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">版本：</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">2.5.0-cdh5.2.0</span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><a href="http://lib.csdn.net/base/spark" rel="nofollow" class="replace_word" title="Apache Spark知识库" style="color:#df3434;font-weight:bold;">Spark</a></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">版本：</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">1.1.0</span></p>
<p style="font-family:SimSun;font-size:16pt;color:#17365D;"><span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">二、</span><span lang="en-us" style="font-weight:bold;" xml:lang="en-us">Hello Spark</span></p>
<ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">将</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">/u</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">sr/lib/spark/examples/lib</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">/</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">spark-examples-1.1.0-cdh5.2.0-hadoop2.5.0-cdh5.2.0.jar</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"></span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">移动到</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">/usr/lib/spark/lib</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">/</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">spark-examples-1.1.0-cdh5.2.0-hadoop2.5.0-cdh5.2.0.jar</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="2" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">执行程序</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"> </span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">.</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">/bin</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">/run-example
 SparkPi 10</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="3" style="vertical-align:middle;"><span style="font-family:SimSun;font-size:10.5pt;">日志分析：</span>
<ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">程序检查</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">ip,host,</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">SecurityManager</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="2" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">启动</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">sparkDriver</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">。通过</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">akka</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">工具启动一个</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">tcp</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">监听</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"> </span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">[akka.tcp://sparkDriver@192.168.128.131:42960]</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="3" style="vertical-align:middle;"><span style="font-family:SimSun;font-size:10.5pt;">启动</span><span style="font-size:10.5pt;">MapOutputTracker</span><span style="font-family:SimSun;font-size:10.5pt;">，</span><span style="font-size:10.5pt;">BlockManagerMaster</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="4" style="vertical-align:middle;"><span style="font-family:SimSun;font-size:10.5pt;">启动一个</span><span style="font-size:10.5pt;">block manager</span><span style="font-family:SimSun;font-size:10.5pt;">，也就是</span><span style="font-size:10.5pt;">ConnectionManagerId(192.168.128.131,41898)</span><span style="font-family:SimSun;font-size:10.5pt;">，其中包含一个</span><span style="font-size:10.5pt;">MemoryStore</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="5" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">通过</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">netty</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">启动一个</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">HTTP
 file server</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">：</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">SocketConnector@0.0.0.0:55161</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="6" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">启动一个</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">sparkUI</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">：</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">http://192.168.128.131:4040</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">通过</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">http</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">上传本地程序运行</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Jar</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">包</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="8" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">连接</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"></span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">HeartbeatReceiver:
 akka.tcp://sparkDriver@192.168.128.131:42960/user/HeartbeatReceiver</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="9" style="vertical-align:middle;"><span style="font-size:10.5pt;">Starting job: reduce</span>
<ol type="i" style="margin-left:.375in;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">分析中</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">job</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">，有</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">stage
 0 </span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">(MappedRDD[1])</span> </li></ol><ol type="i" style="margin-left:.375in;font-size:10.5pt;"><li value="2" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">添加并启动运行</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">task </span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">Submitting
 10 missing tasks from Stage 0</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"></span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">通过</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">http</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">协议获取程序</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">jar</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">包，并添加到</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">classloader</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">完成</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">task</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">后，将结果发送到</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">driver</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">scheduler.DAGScheduler</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">完成</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Stage</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">的所有</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">task</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">在</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">localhost</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">的</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">scheduler.TaskSetManager</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">收集完成的</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">task</span></li></ol><ol type="i" style="margin-left:.375in;font-size:10.5pt;"><li value="7" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;">job finished</span> </li></ol></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="10" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;">Stop Spark Web UI</span> </li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="11" style="vertical-align:middle;"><span style="font-size:10.5pt;">Stop DAGScheduler</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="12" style="vertical-align:middle;"><span style="font-size:10.5pt;">MapOutputTrackerActor stopped</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="13" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">stop</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">ConnectionManager
</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="14" style="vertical-align:middle;"><span style="font-size:10.5pt;">MemoryStore cleared</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="15" style="vertical-align:middle;"><span style="font-size:10.5pt;">BlockManager stopped</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="16" style="vertical-align:middle;"><span style="font-size:10.5pt;">Shutting down remote daemon.</span></li></ol><ol type="a" style="margin-left:.375in;font-size:10.5pt;"><li value="17" style="vertical-align:middle;"><span style="font-size:10.5pt;">Successfully stopped SparkContext</span></li></ol></li></ol><p style="margin-left:.75in;font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:16pt;color:#17365D;"><span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">三、</span><span lang="en-us" style="font-weight:bold;" xml:lang="en-us">cluster mode</span><span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">运行模式</span></p>
<p style="margin-left:.375in;"><img src="https://img-blog.csdn.net/20141202101950367?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2Fua3VuZGU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></p>
<p style="font-family:SimSun;font-size:11pt;color:#366092;"><span style="font-weight:bold;">运行流程：：</span></p>
<ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Spa</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">rkContext </span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">连接</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">cluster
 Manager </span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">(either Spark’s own standalone cluster manager or Mesos/YARN),</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="2" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">spark Application</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">向</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Cluster
 Manager</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">请求资源</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"> executors (</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">运行计算和存储数据的线程</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">)</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="3" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">将程序</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Jar</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">包或者</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">python</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">程序分发到</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">executors</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="4" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">SparkContext</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">发送</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">tasks</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">到</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">executors</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">上运行</span></li></ol><p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="font-family:SimSun;font-size:11pt;color:#366092;"><span lang="en-us" style="font-weight:bold;" xml:lang="en-us">Cluster Manager</span><span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">类型：</span></p>
<ul type="disc" style="margin-left:.375in;"><li style="vertical-align:middle;line-height:15pt;color:#0088CC;">
<a href="http://spark.apache.org/docs/latest/spark-standalone.html" rel="nofollow"><span lang="zh-cn" style="font-family:'Helvetica Neue';font-size:10.5pt;" xml:lang="zh-cn">Standalone</span></a><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">
 Spark </span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">内置的</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">cluster manager</span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">，可以快速启动一个集群</span></li><li style="vertical-align:middle;color:#0088CC;"><a href="http://spark.apache.org/docs/latest/running-on-mesos.html" rel="nofollow"><span lang="zh-cn" style="font-family:'Helvetica Neue';font-size:10.5pt;" xml:lang="zh-cn">Apache
 Mesos</span></a><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">一个通用的</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">Cluster
 manger</span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">，可以运行</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">hadoop</span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">的</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">Mapreduce</span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">和其他</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">Service
 applications</span> </li><li style="vertical-align:middle;color:#0088CC;"><a href="http://spark.apache.org/docs/latest/running-on-yarn.html" rel="nofollow"><span lang="zh-cn" style="font-family:'Helvetica Neue';font-size:10.5pt;" xml:lang="zh-cn">Hadoop
 YARN</span></a><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> Hadoop 2</span><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">中的</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">Clustger
 Manager</span></li></ul><p lang="en-us" style="font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;" xml:lang="en-us">
 </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:11pt;color:#366092;"><span style="font-weight:bold;">主要概念</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Term</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Meaning</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Application</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">User program built on Spark. Consists of a</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">driver program</span><span lang="en-us" xml:lang="en-us"> and </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">executors</span><span lang="en-us" xml:lang="en-us"> on
 the cluster.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Application jar</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>A jar containing the user's Spark application. In some cases users will want to create an "uber jar" containing their application along with its dependencies. The user's jar should never include
<a href="http://lib.csdn.net/base/hadoop" rel="nofollow" class="replace_word" title="Hadoop知识库" style="color:#df3434;font-weight:bold;">
hadoop</a> or Spark libraries, however, these will be added at runtime.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Driver program</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>The process running the main() function of the application and creating the SparkContext</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Cluster manager</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>An external service for acquiring resources on the cluster (e.g. standalone manager, Mesos, YARN)</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Deploy mode</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Distinguishes where the driver process runs. In "cluster" mode, the framework launches the driver inside of the cluster. In "client" mode, the submitter launches the driver outside of the cluster.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Worker node</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Any node that can run application code in the cluster</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Executor</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>A process launched for an application on a worker node, that runs tasks and keeps data in memory or disk storage across them. Each application has its own executors.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Task</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>A unit of work that will be sent to one executor</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Job</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">A parallel computation consisting of multiple tasks that gets spawned in response to a Spark action (e.g.</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">save</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">, </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">collect</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">);
 you'll see this term used in the driver's logs.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.8916in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Stage</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.8486in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Each job gets divided into smaller sets of tasks called</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">stages</span><span lang="en-us" xml:lang="en-us"> that depend on each other (similar to the map
 and reduce stages in MapReduce); you'll see this term used in the driver's logs.</span></p>
</td>
</tr></tbody></table></div>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-size:8pt;color:#595959;"><span style="font-family:'宋体';">源文档</span><span style="font-family:Calibri;"> &lt;</span><a href="http://spark.apache.org/docs/latest/cluster-overview.html" rel="nofollow"><span style="font-family:Calibri;">http://spark.apache.org/docs/latest/cluster-overview.html</span></a><span style="font-family:Calibri;">&gt;</span></p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-size:16pt;color:#17365D;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>四、</strong></span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>yarn</strong></span><span lang="en-us" style="font-family:SimSun;" xml:lang="en-us"><strong>
 mode </strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>运行模式</strong></span></p>
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us"> </p>
<p style="font-size:12pt;color:#366092;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>yarn</strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>集群方式运行</strong></span></p>
<p style="font-family:Calibri;font-size:10.5pt;">spark-submit </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
--classcom.wankun.sparktest.WordCount </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
--masteryarn-cluster </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
target/sparktest-1.0.0.jar/tmp/test1 2</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="font-family:SimSun;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:12pt;color:#366092;"><span style="font-weight:bold;">运行命令：</span></p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">
yarn-cluster </p>
<p style="font-family:Calibri;font-size:10.5pt;">spark-submit --classcom.wankun.sparktest.WordCount --master yarn-cluster --driver-memory 385m--executor-memory 410m target/sparktest-1.0.0.jar /tmp/test1 2</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="font-family:SimSun;font-size:10.5pt;">特点：</p>
<ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span style="font-family:SimSun;font-size:10.5pt;">运行成功后，无任何输出，输出都在日志中</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="2" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">程序的运行有</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">yarn</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">来控制，</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">spark</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">只是检测程序的状态，状态为</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">success</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">，即运行成功</span></li></ol><p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">
yarn-client</p>
<p style="font-family:Calibri;font-size:10.5pt;"><span lang="zh-cn" xml:lang="zh-cn">spark-submit--class com.wankun.sparktest.WordCount --master yarn-</span><span lang="en-us" xml:lang="en-us">client</span><span lang="zh-cn" xml:lang="zh-cn"> --driver-memory 385m --executor-memory 410m  target/sparktest-1.0.0.jar
 /tmp/test1 2</span></p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>yarn-cluster</strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>的</strong></span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>driver
 programcontainer</strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>是在集群里的，</strong></span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>yarn-client</strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>的</strong></span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>driver
 programcontainer</strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>是</strong></span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>spark</strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>在集群外自己启动的</strong></span></p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:12pt;color:#366092;"><span style="font-weight:bold;">运行原理：</span></p>
<p style="margin-left:.375in;font-size:10pt;color:#366092;"><span style="font-family:Calibri;"><strong><em>scheduler.DAGScheduler</em></strong></span><span style="font-family:SimSun;"><strong><em>，</em></strong></span><span style="font-family:Calibri;"><strong><em>scheduler.TaskSetManager</em></strong></span><span style="font-family:SimSun;"><strong><em>，</em></strong></span><span style="font-family:Calibri;"><strong><em>cluster.YarnClusterScheduler</em></strong></span></p>
<ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">spark</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">向</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">RM</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">申请一个</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Container</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">作为调度</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">container</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">（此时启动的</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">SparkUI</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">端口随机）</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">请求</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Executors</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">（默认</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">2</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">个，</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">
 Container request (host: Any, priority: 1, capability: &lt;memory:1408, vCores:1&gt;</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">）</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="3" style="vertical-align:middle;"><span style="font-size:10.5pt;">Received new token for : quickstart.cloudera:48622</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="4" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">根据</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">resources and environment and commands, open proxy</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="5" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;">start progress reporter</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="6" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">在</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">YarnClusterSchedulerBackend</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">,</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">BlockManagerMasterActor</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">,</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">MemoryStore</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">等服务启动</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">在</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">SparkContext</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">中</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Starting
 job</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="8" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">TasksetManager</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">中</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">starting
 task with TID 0,1</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="9" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">任务调度由</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">scheduler.DAGScheduler</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">执行，根据</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">job</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">和</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">job</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">中</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">tasks</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">进行任务执行，</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">Taskset
 will be removed ,when completed</span></li></ol><ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="10" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">job</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">全部执行结束，</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">Stopped
 Spark web UI</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">,</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">Stopping DAGScheduler</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">,</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">Shutting down all
 executors</span></li></ol><p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10pt;color:#366092;">
<span style="font-weight:bold;font-style:italic;">executors</span></p>
<ol type="a" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">executors</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">应该是可以重用</span></li><li style="vertical-align:middle;"><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">executors</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">通过</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">CoarseGrainedExecutorBackend</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"></span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">获取分配的任务，关闭的时候，</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">Driver
 commanded a shutdown</span></li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">在关闭</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">http file server</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">进程时，遇到错误</span></li></ol><div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;margin-left:.3333in;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:7.2826in;">
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:40 WARN thread.QueuedThreadPool: 1 threads could not be stopped</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:40 INFO thread.QueuedThreadPool: Couldn't stop Thread[qtp26737473-36 Acceptor0 SocketConnector@0.0.0.0:39213,5,main]</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at
<a href="http://lib.csdn.net/base/java" rel="nofollow" class="replace_word" title="Java 知识库" style="color:#df3434;font-weight:bold;">
Java</a><a href="http://lib.csdn.net/base/dotnet" rel="nofollow" class="replace_word" title=".NET知识库" style="color:#df3434;font-weight:bold;">.NET</a>.PlainSocketImpl.socketAccept(Native Method)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at java<a href="http://lib.csdn.net/base/dotnet" rel="nofollow" class="replace_word" title=".NET知识库" style="color:#df3434;font-weight:bold;">.net</a>.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:398)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at java<a href="http://lib.csdn.net/base/dotnet" rel="nofollow" class="replace_word" title=".NET知识库" style="color:#df3434;font-weight:bold;">.Net</a>.ServerSocket.implAccept(ServerSocket.java:530)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at java.net.ServerSocket.accept(ServerSocket.java:498)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at org.eclipse.jetty.server.bio.SocketConnector.accept(SocketConnector.java:117)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at org.eclipse.jetty.server.AbstractConnector$Acceptor.run(AbstractConnector.java:938)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO thread.QueuedThreadPool:  at java.lang.Thread.run(Thread.java:745)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO network.ConnectionManager: Key not valid ? sun.nio.ch.SelectionKeyImpl@2cc51248</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO spark.MapOutputTrackerMasterActor: MapOutputTrackerActor stopped!</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO network.ConnectionManager: Removing SendingConnection to ConnectionManagerId(quickstart.cloudera,48234)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:41 INFO network.ConnectionManager: Removing SendingConnection to ConnectionManagerId(quickstart.cloudera,52620)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:42 INFO network.ConnectionManager: key already cancelled ? sun.nio.ch.SelectionKeyImpl@2cc51248</p>
<p style="font-family:Calibri;font-size:10.5pt;">java.nio.channels.CancelledKeyException</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
at org.apache.spark.network.ConnectionManager.run(ConnectionManager.<a href="http://lib.csdn.net/base/scala" rel="nofollow" class="replace_word" title="Scala知识库" style="color:#df3434;font-weight:bold;">Scala</a>:386)</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
at org.apache.spark.network.ConnectionManager$$anon$4.run(ConnectionManager.<a href="http://lib.csdn.net/base/scala" rel="nofollow" class="replace_word" title="Scala知识库" style="color:#df3434;font-weight:bold;">scala</a>:139)</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:42 INFO network.ConnectionManager: Key not valid ? sun.nio.ch.SelectionKeyImpl@69aaccdf</p>
<p style="font-family:Calibri;font-size:10.5pt;">14/11/05 20:17:42 INFO network.ConnectionManager: key already cancelled ? sun.nio.ch.SelectionKeyImpl@69aaccdf</p>
<p style="font-family:Calibri;font-size:10.5pt;">java.nio.channels.CancelledKeyException</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
at org.apache.spark.network.ConnectionManager.run(ConnectionManager.scala:386)</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
at org.apache.spark.network.ConnectionManager$$anon$4.run(ConnectionManager.scala:139)</p>
</td>
</tr></tbody></table></div>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">
 </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="font-family:SimSun;font-size:12pt;color:#366092;"><span style="font-weight:bold;">日志查看</span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span style="font-family:SimSun;">方式一：</span><span style="font-family:Calibri;">yarnlogs -applicationId application_1415100770125_0002</span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">方式二：通过</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">Rm:8088</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">端口进入</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">Spark
 history Server:18088</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">端口查看</span></p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<ol type="1" style="margin-left:.75in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">配置</span><span lang="zh-cn" style="font-size:10.5pt;" xml:lang="zh-cn">spark-defaults.conf</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"></span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">中</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">jobhistory</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">中的配置</span></li></ol><p style="font-family:Calibri;font-size:10.5pt;">spark.eventLog.enabled=true</p>
<p style="font-family:Calibri;font-size:10.5pt;">spark.eventLog.dir=hdfs:///user/spark/applicationHistory</p>
<p style="font-family:Calibri;font-size:10.5pt;">spark.yarn.historyServer.address=http://quickstart.cloudera:18088</p>
<ol type="1" style="margin-left:.75in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">启动</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us"> spark-history-server</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">服务</span>
</li><li style="vertical-align:middle;"><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">此时，在</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">yarn</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">集群中提交的服务日志会上传的</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">hdfs</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">上，在</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">RM:8088</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">页面中可以直接调整到</span><span lang="en-us" style="font-size:10.5pt;" xml:lang="en-us">spark</span><span lang="zh-cn" style="font-family:SimSun;font-size:10.5pt;" xml:lang="zh-cn">页面进行查看</span></li></ol><p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:12pt;color:#366092;"><span style="font-weight:bold;">提交参数：</span></p>
<ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="1" style="vertical-align:middle;"><span style="font-size:10.5pt;">spark-submit --class com.wankun.sparktest.WordCount --master yarn-cluster --driver-memory 385m --executor-memory 410m  target/sparktest-1.0.0.jar /tmp/test1
 2</span></li></ol><p style="margin-left:.375in;"><img src="https://img-blog.csdn.net/20141202102017605?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2Fua3VuZGU=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""><br></p>
<p style="font-family:Calibri;font-size:10.5pt;">  </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
实际上，driverExecutor和task Executor 占用那个的内存显示并没有这么多，不清楚什么原因</p>
<p style="font-family:SimSun;font-size:10.5pt;"> </p>
<ol type="1" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;"><li value="2" style="vertical-align:middle;"><span style="font-family:SimSun;font-size:10.5pt;">支持参数</span></li></ol><p style="font-family:Calibri;font-size:10.5pt;">14/11/05 11:56:14ERROR yarn.Client: Error: Executor memory sizemust be greater than: 384</p>
<p style="font-family:Calibri;font-size:10.5pt;">Exception in thread"main" java.lang.IllegalArgumentException: Usage:org.apache.spark.deploy.yarn.Client [options]</p>
<p style="font-family:Calibri;font-size:10.5pt;">Options:</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --jar JAR_PATH             Path to your application's JARfile (required in yarn-cluster mode)</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --class CLASS_NAME         Name of your application's main class(required)</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --arg ARGS                 Argument to be passed to yourapplication's main class.</p>
<p style="font-family:Calibri;font-size:10.5pt;">                             Multipleinvocations are possible, each will be passed in order.</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --num-executors NUM        Number of executors to start (Default:2)</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --executor-cores NUM       Number of cores for the executors(Default: 1).</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --driver-memory MEM        Memory for driver (e.g. 1000M, 2G)(Default: 512 Mb)</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --executor-memory MEM      Memory per executor (e.g. 1000M, 2G)(Default: 1G)</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --name NAME                The name of your application(Default: Spark)</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --queue QUEUE              The hadoop queue to use forallocation requests (Default: 'default')</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --addJars jars             Comma separated list of local jarsthat want SparkContext.addJar to work with.</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --files files              Comma separated list of files tobe distributed with the job.</p>
<p style="font-family:Calibri;font-size:10.5pt;">  --archives archives        Comma separated list of archives to bedistributed with the job.</p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:12pt;color:#366092;"><span style="font-weight:bold;">优化配置</span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">将</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hadoop</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">类库上传到</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hdfs</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">上，省的每次都上传</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;">
<p style="font-family:SimSun;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;">hdfs dfs -mkdir -p /user/spark/share/lib</p>
<p style="font-family:Calibri;font-size:10.5pt;">hadoop dfs -put /usr/lib/spark/assembly/lib/spark-assembly-1.1.0-cdh5.2.0-hadoop2.5.0-cdh5.2.0.jar /user/spark/share/lib/spark-assembly.jar</p>
<p style="font-family:Calibri;font-size:10.5pt;"> hadoop dfs -chmod -R 777 /user/spark/</p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-size:10.5pt;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark-env.sh</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">中配置</span></p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_JAR=hdfs://quickstart.cloudera:8020/user/spark/share/lib/spark-assembly.jar</p>
</td>
</tr></tbody></table></div>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="font-size:16pt;color:#17365D;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>五、</strong></span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"><strong>spark cluster</strong></span><span lang="en-us" style="font-family:SimSun;" xml:lang="en-us"><strong>
 mode </strong></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn"><strong>运行模式</strong></span></p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">服务</span></p>
<p style="margin-left:.75in;font-size:10.5pt;"><span style="font-family:SimSun;">启动服务：</span><span style="font-family:Calibri;">spark-history-server  spark-master          spark-worker</span></p>
<p style="margin-left:.75in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark-master</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">监控页面：</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"></span></p>
<p style="margin-left:1.125in;font-family:Calibri;font-size:10.5pt;">
<a href="http://192.168.128.131:18080/" rel="nofollow">http://192.168.128.131:18080/</a></p>
<p style="margin-left:1.125in;font-size:10.5pt;"><a href="http://192.168.128.131:4040/" rel="nofollow"><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">http://192.168.128.131:</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">4040</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">/</span></a><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"> application
 detail </span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">页面，如果有多个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">sparkContext</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">，端口依次递增（如</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">4041,4042…)</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">，程序结束后，关闭。页面主要内容</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"></span></p>
<ol type="a" style="margin-left:1.875in;font-family:Calibri;font-size:10.5pt;"><li value="1" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;">stages and tasks, </span></li></ol><ol type="a" style="margin-left:1.875in;font-family:Calibri;font-size:10.5pt;"><li value="2" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;"> RDD sizes and memory usage </span></li></ol><ol type="a" style="margin-left:1.875in;font-family:Calibri;font-size:10.5pt;"><li value="3" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;">Environmental </span></li></ol><ol type="a" style="margin-left:1.875in;font-family:Calibri;font-size:10.5pt;"><li value="4" lang="en-us" style="vertical-align:middle;" xml:lang="en-us">
<span style="font-size:10.5pt;">executors</span></li></ol><p lang="en-us" style="margin-left:1.125in;font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">
 </p>
<p style="margin-left:1.125in;font-size:10.5pt;"><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">192.168.128.131</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"> 7077 master</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">通信端口</span></p>
<p style="margin-left:.75in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark-worker</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">监控页面：</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"></span></p>
<p style="margin-left:1.125in;font-size:10.5pt;"><a href="http://192.168.128.131:18081" rel="nofollow"><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">http://192.168.128.131:18081</span></a><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">监控页面</span></p>
<p style="margin-left:1.125in;font-size:10.5pt;"><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">192.168.128.131</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"> 7078 worker</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">通信端口</span></p>
<p style="margin-left:.75in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark-history-server</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">监控页面：</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"></span></p>
<p style="margin-left:1.125in;font-family:Calibri;font-size:10.5pt;">
<a href="http://192.168.128.131:18088" rel="nofollow">http://192.168.128.131:18088</a></p>
<p style="margin-left:.75in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark master</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">和</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">worker</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">之间的通信使用的是</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">akka</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">，</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">tcp</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">协议。例如：</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">[akka.tcp://sparkWorker@192.168.128.131:7078]</span></p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">备注：测试时，因为</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">master</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">绑定在了</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">192.168.128.131
 ip</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">上了，所以必须在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">/etc/spark/con/spark-env.sh</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">配置文件配置上</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">exportSPARK_MASTER_IP=192.168.128.131</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us"></span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">参数</span></p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-size:10.5pt;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">spark-env.sh</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">主要配置</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;margin-left:.3333in;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:5.602in;">
<p style="font-family:Calibri;font-size:10.5pt;">export STANDALONE_SPARK_MASTER_HOST="192.168.128.131"</p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_MASTER_IP=$STANDALONE_SPARK_MASTER_HOST</p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;">### Let's run everything with JVM runtime, instead of Scala</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_LAUNCH_WITH_SCALA=0</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_LIBRARY_PATH=${SPARK_HOME}/lib</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SCALA_LIBRARY_PATH=${SPARK_HOME}/lib</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_MASTER_WEBUI_PORT=18080</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_MASTER_IP="192.168.128.131"</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_MASTER_PORT=7077</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_WORKER_CORES=1</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_WORKER_MEMORY=100m</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_WORKER_PORT=7078</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_WORKER_INSTANCES=1</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_WORKER_WEBUI_PORT=18081</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_WORKER_DIR=/var/run/spark/work</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_LOG_DIR=/var/log/spark</p>
<p style="font-family:Calibri;font-size:10.5pt;">export SPARK_PID_DIR='/var/run/spark/'</p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;">if [ -n "$HADOOP_HOME" ]; then</p>
<p style="font-family:Calibri;font-size:10.5pt;">  export SPARK_LIBRARY_PATH=$SPARK_LIBRARY_PATH:${HADOOP_HOME}/lib/native</p>
<p style="font-family:Calibri;font-size:10.5pt;">fi</p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;">export HADOOP_CONF_DIR=${HADOOP_CONF_DIR:-/etc/hadoop/conf}</p>
</td>
</tr></tbody></table></div>
<p style="margin-left:.75in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-size:10.5pt;color:#FF0000;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">注意在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">cloudera</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">提供的虚拟机中的配置文件有如下问题：</span></p>
<p style="margin-left:.375in;font-size:10.5pt;color:#FF0000;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">第一、</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">master</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">的</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">7077</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">端口并未绑定在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">0.0.0.0</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">上，第二，</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">HADOOP_CONF_DIR</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">写错了，写成了</span><span lang="zh-cn" style="font-family:Calibri;" xml:lang="zh-cn">etc/hadoop/conf</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">。</span></p>
<p style="margin-left:.375in;font-size:10.5pt;color:#FF0000;"><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">第二、在</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">/etc/hosts</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">中将</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hostname</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">配置上外网口</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">ip,</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">否则会造成</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">master</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">和</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">worker</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">通信失败，或者</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">job</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">无法正常提交的问题，提交</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">job</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">时也要使用</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">hostname</span><span lang="zh-cn" style="font-family:SimSun;" xml:lang="zh-cn">提交</span></p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="font-size:16pt;color:#17365D;"><span style="font-family:SimSun;"><strong>六、</strong></span><span style="font-family:Calibri;"><strong>spark-submit</strong></span></p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
spark-submit</p>
<p style="margin-left:.75in;font-family:Calibri;font-size:10.5pt;">--classcom.wankun.sparktest.JavaWordCount</p>
<p style="margin-left:.75in;font-family:Calibri;font-size:10.5pt;">--masterspark://quickstart.cloudera:7077</p>
<p style="margin-left:.75in;font-family:Calibri;font-size:10.5pt;">target/sparktest-1.0.0.jar/tmp/test1 2</p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;">其余常用参数：</p>
<p style="margin-left:.375in;font-family:Menlo;font-size:9pt;color:#333333;">
<span>  --executor-memory 20G</span></p>
<p style="margin-left:.375in;font-family:Menlo;font-size:9pt;color:#333333;">
<span>  --total-executor-cores 100</span></p>
<p style="margin-left:.375in;font-family:Menlo;font-size:9pt;color:#333333;">
 </p>
<p style="margin-left:.375in;font-family:Menlo;font-size:9pt;"><span style="color:#333333;"> --master yarn-cluster</span><span style="color:#4070A0;"><strong>\
</strong></span><span style="color:#333333;"> </span><span style="color:#60A0B0;"><em># can also be `yarn-client` for clientmode</em></span></p>
<p style="margin-left:.375in;font-family:Menlo;font-size:9pt;"><span style="color:#333333;"> --master</span><span style="color:#007020;">local</span><span style="color:#666666;">[</span><span style="color:#333333;">8</span><span style="color:#666666;">]</span><span style="color:#333333;"></span><span style="color:#4070A0;"><strong>\</strong></span><span style="color:#60A0B0;"><em>#
 Run application locally on 8 cores</em></span></p>
<p style="margin-left:.375in;font-family:Menlo;font-size:9pt;"><span style="color:#333333;"> --master yarn-cluster</span><span style="color:#4070A0;"><strong>\
</strong></span><span style="color:#333333;"> </span><span style="color:#60A0B0;"><em># can also be `yarn-client` for clientmode</em></span></p>
<p style="font-family:Menlo;font-size:9pt;color:#333333;"> </p>
<p style="margin-left:0pt;line-height:30pt;font-family:'Helvetica Neue';font-size:21pt;color:#333333;">
<span style="font-weight:bold;">Master URLs</span></p>
<p style="margin-left:0pt;line-height:16pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>The master URL passed to Spark can be in one of thefollowing formats:</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Master URL</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Meaning</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>local</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Run Spark locally with one worker thread (i.e. no parallelism at all).</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>local[K]</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Run Spark locally with K worker threads (ideally, set this to the number of cores on your machine).</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>local[*]</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Run Spark locally with as many worker threads as logical cores on your machine.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>spark://HOST:PORT</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;">
<span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">Connect to the given</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/spark-standalone.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Spark standalone
 cluster</span></a><span lang="en-us" style="color:#333333;" xml:lang="en-us"> master. The port must be whichever one your master is configured to use, which is 7077 by default.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>mesos://HOST:PORT</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">Connect to the given</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/running-on-mesos.html" rel="nofollow"><span lang="en-us" style="font-family:'Helvetica Neue';font-size:10.5pt;" xml:lang="en-us">Mesos</span></a><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> cluster.
 The port must be whichever one your is configured to use, which is 5050 by default. Or, for a Mesos cluster using ZooKeeper, use </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">mesos://zk://...</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>yarn-client</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;">
<span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">Connect to a</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/running-on-yarn.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">YARN </span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">cluster
 in client mode. The cluster location will be found based on the HADOOP_CONF_DIR variable.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1027in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>yarn-cluster</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.6375in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;">
<span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">Connect to a</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/running-on-yarn.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">YARN </span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">cluster
 in cluster mode. The cluster location will be found based on HADOOP_CONF_DIR.</span></p>
</td>
</tr></tbody></table></div>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-size:8pt;color:#595959;"><span style="font-family:'宋体';">源文档</span><span style="font-family:Calibri;"> &lt;</span><a href="http://spark.apache.org/docs/latest/submitting-applications.html" rel="nofollow"><span style="font-family:Calibri;">http://spark.apache.org/docs/latest/submitting-applications.html</span></a><span style="font-family:Calibri;">&gt;</span></p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:16pt;color:#17365D;"> </p>
<p style="margin-left:0pt;line-height:30pt;font-family:'Helvetica Neue';font-size:15.75pt;color:#333333;">
<span style="font-weight:bold;">Transformations</span></p>
<p style="margin-left:0pt;line-height:16pt;font-family:'Helvetica Neue';font-size:10.5pt;">
<span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">The following table listssome of the common transformations supported by Spark. Refer to the RDD API doc(</span><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.RDD" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">Scala</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">,</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/api/java/index.html?org/apache/spark/api/java/JavaRDD.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Java</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">,</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/api/python/pyspark.rdd.RDD-class.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Python</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">)
 and pair RDD functions doc (</span><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.PairRDDFunctions" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">Scala</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">,</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/api/java/index.html?org/apache/spark/api/java/JavaPairRDD.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Java</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">)
 for details.</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Transformation</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Meaning</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">map</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Return a new distributed dataset formed by passing each element of the source through a function</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us">.</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.7819in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">a1 --&gt; b1</p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.7819in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">a2 --&gt; b2</p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.7819in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">a3 --&gt; b3</p>
</td>
</tr></tbody></table></div>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">filter</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Return a new dataset formed by selecting those elements of the source on which</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> returns true.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">flatMap</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Similar to map, but each input item can be mapped to 0 or more output items (so</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> should return a Seq rather
 than a single item).</span></p>
<p lang="en-us" style="font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;" xml:lang="en-us">
 </p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">mapPartitions</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Similar to map, but runs separately on each partition (block) of the RDD, so</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> must be of type Iterator&lt;T&gt;
 =&gt; Iterator&lt;U&gt; when running on an RDD of type T.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">mapPartitionsWithIndex</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Similar to mapPartitions, but also provides</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> with an integer value representing the index of the partition,
 so </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> must be of type (Int, Iterator&lt;T&gt;) =&gt; Iterator&lt;U&gt; when running on an RDD of type T.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">sample</span><span lang="zh-cn" xml:lang="zh-cn">(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">withReplacement</span><span lang="zh-cn" xml:lang="zh-cn">,</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">fraction</span><span lang="zh-cn" xml:lang="zh-cn">,</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">seed</span><span lang="en-us" xml:lang="en-us">)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Sample a fraction</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">fraction</span><span lang="en-us" xml:lang="en-us"> of the data, with or without replacement, using a given random number generator
 seed.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">union</span><span>(</span><span style="font-style:italic;">otherDataset</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Return a new dataset that contains the union of the elements in the source dataset and the argument.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">intersection</span><span>(</span><span style="font-style:italic;">otherDataset</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Return a new RDD that contains the intersection of elements in the source dataset and the argument.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">distinct</span><span>([</span><span style="font-style:italic;">numTasks</span><span>]))</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Return a new dataset that contains the distinct elements of the source dataset.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">groupByKey</span><span>([</span><span style="font-style:italic;">numTasks</span><span>])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">When called on a dataset of (K, V) pairs, returns a dataset of (K, Iterable&lt;V&gt;) pairs.</span><span lang="en-us" xml:lang="en-us"> </span></p>
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn"><strong>Note:</strong></span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> If you are
 grouping in order to perform an aggregation (such as a sum or average) over each key, using </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">reduceByKey</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> or </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">combineByKey</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> will
 yield much better performance. </span></p>
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn"><strong>Note:</strong></span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> By default,
 the level of parallelism in the output depends on the number of partitions of the parent RDD. You can pass an optional </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">numTasks</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> argument
 to set a different number of tasks.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">reduceByKey</span><span>(</span><span style="font-style:italic;">func</span><span>, [</span><span style="font-style:italic;">numTasks</span><span>])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">When called on a dataset of (K, V) pairs, returns a dataset of (K, V) pairs where the values for each key are aggregated using the
 given reduce function</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"><em>func</em></span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">,
 which must be of type (V,V) =&gt; V. Like in</span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">groupByKey</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">, the number of reduce tasks
 is configurable through an optional second argument.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">aggregateByKey</span><span lang="zh-cn" xml:lang="zh-cn">(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">zeroValue</span><span lang="zh-cn" xml:lang="zh-cn">)(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">seqOp</span><span lang="zh-cn" xml:lang="zh-cn">,</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">combOp</span><span lang="en-us" xml:lang="en-us">,
 [</span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">numTasks</span><span lang="en-us" xml:lang="en-us">])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">When called on a dataset of (K, V) pairs, returns a dataset of (K, U) pairs where the values for each key are aggregated using the
 given combine functions and a neutral "zero" value. Allows an aggregated value type that is different than the input value type, while avoiding unnecessary allocations. Like in</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">groupByKey</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">,
 the number of reduce tasks is configurable through an optional second argument.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">sortByKey</span><span>([</span><span style="font-style:italic;">ascending</span><span>], [</span><span style="font-style:italic;">numTasks</span><span>])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">When called on a dataset of (K, V) pairs where K implements Ordered, returns a dataset of (K, V) pairs sorted by keys in ascending
 or descending order, as specified in the boolean</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">ascending</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> argument.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">join</span><span>(</span><span style="font-style:italic;">otherDataset</span><span>, [</span><span style="font-style:italic;">numTasks</span><span>])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">When called on datasets of type (K, V) and (K, W), returns a dataset of (K, (V, W)) pairs with all pairs of elements for each key.
 Outer joins are also supported through</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">leftOuterJoin</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> and </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">rightOuterJoin</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">cogroup</span><span>(</span><span style="font-style:italic;">otherDataset</span><span>, [</span><span style="font-style:italic;">numTasks</span><span>])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;"><span lang="zh-cn" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="zh-cn">When called on datasets of type (K, V) and (K, W), returns a dataset of (K, Iterable&lt;V&gt;, Iterable&lt;W&gt;) tuples. This operation is
 also called</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us"> </span><span lang="en-us" style="font-family:Menlo;color:#444444;font-size:9pt;" xml:lang="en-us">groupWith</span><span lang="en-us" style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;" xml:lang="en-us">.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">cartesian</span><span>(</span><span style="font-style:italic;">otherDataset</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>When called on datasets of types T and U, returns a dataset of (T, U) pairs (all pairs of elements).</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">pipe</span><span lang="zh-cn" xml:lang="zh-cn">(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">command</span><span lang="zh-cn" xml:lang="zh-cn">,</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">[envVars]</span><span lang="en-us" xml:lang="en-us">)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Pipe each partition of the RDD through a shell command, e.g. a Perl or bash script. RDD elements are written to the process's stdin and lines output to its stdout are returned as an RDD of strings.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">coalesce</span><span>(</span><span style="font-style:italic;">numPartitions</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Decrease the number of partitions in the RDD to numPartitions. Useful for running operations more efficiently after filtering down a large dataset.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">repartition</span><span>(</span><span style="font-style:italic;">numPartitions</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Reshuffle the data in the RDD randomly to create either more or fewer partitions and balance it across them. This always shuffles all data over the network.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.3569in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us"><span style="font-weight:bold;">mapToPair</span></p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.384in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">JavaPairRDD ---&gt; JavaPairRDD</p>
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us"> </p>
<p style="font-family:Calibri;font-size:10.5pt;"><span lang="zh-cn" xml:lang="zh-cn">JavaPairRDD&lt;Integer, Integer&gt; tc</span><span lang="en-us" xml:lang="en-us">;</span></p>
<p style="font-family:Calibri;font-size:10.5pt;">JavaPairRDD&lt;Integer, Integer&gt; edges = tc.mapToPair(</p>
<p style="font-family:Calibri;font-size:10.5pt;">      new PairFunction&lt;Tuple2&lt;Integer, Integer&gt;, Integer, Integer&gt;() {</p>
<p style="font-family:Calibri;font-size:10.5pt;">        @Override</p>
<p style="font-family:Calibri;font-size:10.5pt;">        public Tuple2&lt;Integer, Integer&gt; call(Tuple2&lt;Integer, Integer&gt; e) {</p>
<p style="font-family:Calibri;font-size:10.5pt;">          return new Tuple2&lt;Integer, Integer&gt;(e._2(), e._1());</p>
<p style="font-family:Calibri;font-size:10.5pt;">        }</p>
<p style="font-family:Calibri;font-size:10.5pt;">    });</p>
</td>
</tr></tbody></table></div>
<p style="margin-left:0pt;line-height:30pt;font-family:'Helvetica Neue';font-size:15.75pt;color:#333333;">
<span style="font-weight:bold;">Actions</span></p>
<p style="margin-left:0pt;line-height:16pt;font-family:'Helvetica Neue';font-size:10.5pt;">
<span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">The following table listssome of the common actions supported by Spark. Refer to the RDD API doc (</span><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.RDD" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">Scala</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">,</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/api/java/index.html?org/apache/spark/api/java/JavaRDD.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Java</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">,</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/api/python/pyspark.rdd.RDD-class.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Python</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">)
 and pair RDD functions doc (</span><a href="http://spark.apache.org/docs/latest/api/scala/index.html#org.apache.spark.rdd.PairRDDFunctions" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">Scala</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">,</span><span lang="en-us" style="color:#333333;" xml:lang="en-us"> </span><a href="http://spark.apache.org/docs/latest/api/java/index.html?org/apache/spark/api/java/JavaPairRDD.html" rel="nofollow"><span lang="en-us" xml:lang="en-us">Java</span></a><span lang="zh-cn" style="color:#333333;" xml:lang="zh-cn">)
 for details.</span></p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Action</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">Meaning</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">reduce</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Aggregate the elements of the dataset using a function</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> (which takes two arguments and returns one). The
 function should be commutative and associative so that it can be computed correctly in parallel.</span></p>
<p lang="en-us" style="font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;" xml:lang="en-us">
 </p>
<div>
<table cellspacing="0" cellpadding="0" border="1" style="border-collapse:collapse;border-style:solid;border-color:#A3A3A3;border-width:1pt;"><tbody><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.9625in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">a1,a2 --&gt; b1</p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.9625in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">a2,a3 --&gt; b2</p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:.9625in;">
<p lang="en-us" style="font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">a3,a4 --&gt; b3</p>
</td>
</tr></tbody></table></div>
<p lang="en-us" style="font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;" xml:lang="en-us">
 </p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">collect</span><span>()</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Return all the elements of the dataset as an array at the driver program. This is usually useful after a filter or other operation that returns a sufficiently small subset of the data.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">count</span><span>()</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Return the number of elements in the dataset.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">first</span><span>()</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Return the first element of the dataset (similar to take(1)).</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">take</span><span>(</span><span style="font-style:italic;">n</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Return an array with the first</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">n</span><span lang="en-us" xml:lang="en-us"> elements of the dataset. Note that this is currently not executed in parallel.
 Instead, the driver program computes all the elements.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">takeSample</span><span>(</span><span style="font-style:italic;">withReplacement</span><span>,</span><span style="font-style:italic;">num</span><span>, [</span><span style="font-style:italic;">seed</span><span>])</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Return an array with a random sample of</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">num</span><span lang="en-us" xml:lang="en-us"> elements of the dataset, with or without replacement, optionally
 pre-specifying a random number generator seed.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">takeOrdered</span><span lang="zh-cn" xml:lang="zh-cn">(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">n</span><span lang="zh-cn" xml:lang="zh-cn">,</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">[ordering]</span><span lang="en-us" xml:lang="en-us">)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Return the first</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">n</span><span lang="en-us" xml:lang="en-us"> elements of the RDD using either their natural order or a custom comparator.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">saveAsTextFile</span><span>(</span><span style="font-style:italic;">path</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Write the elements of the dataset as a text file (or set of text files) in a given directory in the local filesystem, HDFS or any other Hadoop-supported file system. Spark will call toString on each element to convert it to a line of text in
 the file.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">saveAsSequenceFile</span><span lang="zh-cn" xml:lang="zh-cn">(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">path</span><span lang="zh-cn" xml:lang="zh-cn">)</span><span lang="en-us" xml:lang="en-us"> </span></p>
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>(<a href="http://lib.csdn.net/base/java" rel="nofollow" class="replace_word" title="Java 知识库" style="color:#df3434;font-weight:bold;">Java
</a>and Scala)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Write the elements of the dataset as a Hadoop SequenceFile in a given path in the local filesystem, HDFS or any other Hadoop-supported file system. This is available on RDDs of key-value pairs that either implement Hadoop's Writable interface.
 In Scala, it is also available on types that are implicitly convertible to Writable (Spark includes conversions for basic types like Int, Double, String, etc).</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" style="font-weight:bold;" xml:lang="zh-cn">saveAsObjectFile</span><span lang="zh-cn" xml:lang="zh-cn">(</span><span lang="zh-cn" style="font-style:italic;" xml:lang="zh-cn">path</span><span lang="zh-cn" xml:lang="zh-cn">)</span><span lang="en-us" xml:lang="en-us"> </span></p>
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>(<a href="http://lib.csdn.net/base/java" rel="nofollow" class="replace_word" title="Java 知识库" style="color:#df3434;font-weight:bold;">java
</a>and Scala)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;"><span style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;">Write the elements of the dataset in a simple format using Java serialization, which can then be loaded using</span><span style="font-family:Menlo;color:#444444;font-size:9pt;">SparkContext.objectFile()</span><span style="font-family:'Helvetica Neue';color:#333333;font-size:10.5pt;">.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">countByKey</span><span>()</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span>Only available on RDDs of type (K, V). Returns a hashmap of (K, Int) pairs with the count of each key.</span></p>
</td>
</tr><tr><td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:1.1513in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span style="font-weight:bold;">foreach</span><span>(</span><span style="font-style:italic;">func</span><span>)</span></p>
</td>
<td style="border-style:solid;border-color:#A3A3A3;border-width:1pt;vertical-align:top;width:6.5888in;">
<p style="line-height:15pt;font-family:'Helvetica Neue';font-size:10.5pt;color:#333333;">
<span lang="zh-cn" xml:lang="zh-cn">Run a function</span><span lang="en-us" xml:lang="en-us"> </span><span lang="en-us" style="font-style:italic;" xml:lang="en-us">func</span><span lang="en-us" xml:lang="en-us"> on each element of the dataset. This is usually done for side effects such as updating
 an accumulator variable (see below) or interacting with external storage systems.</span></p>
</td>
</tr></tbody></table></div>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-size:8pt;color:#595959;"><span style="font-family:'宋体';">源文档</span><span style="font-family:Calibri;"> &lt;</span><a href="http://spark.apache.org/docs/latest/programming-guide.html" rel="nofollow"><span style="font-family:Calibri;">http://spark.apache.org/docs/latest/programming-guide.html</span></a><span style="font-family:Calibri;">&gt;</span></p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-size:9pt;color:#333333;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">action</span><span lang="zh-cn" style="font-family:Menlo;" xml:lang="zh-cn">结果是一个数据，例如，正数，数组，对象等</span></p>
<p style="font-size:9pt;color:#333333;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">transformation</span><span lang="zh-cn" style="font-family:Menlo;" xml:lang="zh-cn">结果是一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">RDD</span><span lang="zh-cn" style="font-family:Menlo;" xml:lang="zh-cn">，完成从一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">RDD</span><span lang="zh-cn" style="font-family:Menlo;" xml:lang="zh-cn">到另一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">RDD</span><span lang="zh-cn" style="font-family:Menlo;" xml:lang="zh-cn">的转换</span></p>
<p style="font-family:Menlo;font-size:9pt;color:#333333;"> </p>
<p style="font-family:Menlo;font-size:9pt;color:#333333;"><span>常用工具类说明：</span></p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:9pt;color:#333333;" xml:lang="en-us">
<span>JavaRDD&lt;D&gt;</span></p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:9pt;color:#333333;" xml:lang="en-us">
<span>JavaPairRDD&lt;K,V&gt;</span></p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:9pt;color:#333333;" xml:lang="en-us">
 </p>
<p style="margin-left:.375in;font-size:9pt;color:#333333;"><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">Tuple2(K,V&gt; </span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">类似与</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">map</span><span lang="zh-cn" style="font-family:'宋体';" xml:lang="zh-cn">中的一个</span><span lang="en-us" style="font-family:Calibri;" xml:lang="en-us">entry e._1() 
 e._2()</span></p>
<p style="margin-left:.375in;font-family:'宋体';font-size:9pt;color:#333333;">
 </p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:9pt;color:#333333;" xml:lang="en-us">
 </p>
<p style="margin-left:.375in;font-family:SimSun;font-size:10.5pt;"> </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:Calibri;font-size:10.5pt;"> </p>
<p style="font-family:SimSun;font-size:10.5pt;">相关资料</p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
<a href="http://spark.apache.org/docs/latest/api/scala/index.html" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">http://spark.apache.org/docs/latest/api/scala/index.html</span></a><span lang="en-us" xml:lang="en-us"> Scala API doc</span></p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">
 </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
<a href="http://mail-archives.apache.org/mod_mbox/incubator-spark-user/" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">http://mail-archives.apache.org/mod_mbox/incubator-spark-user/</span></a><span lang="en-us" xml:lang="en-us"> 
<a href="http://lib.csdn.net/base/spark" rel="nofollow" class="replace_word" title="Apache Spark知识库" style="color:#df3434;font-weight:bold;">
Apache Spark</a> mailing list</span></p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
<a href="http://apache-spark-user-list.1001560.n3.nabble.com/" rel="nofollow">http://apache-spark-user-list.1001560.n3.nabble.com/</a></p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
<a href="http://community.cloudera.com/t5/Advanced-Analytics-Apache-Spark/bd-p/Spark" rel="nofollow">http://community.cloudera.com/t5/Advanced-Analytics-Apache-Spark/bd-p/Spark</a></p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
 </p>
<p style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;">
<a href="https://github.com/apache/spark/tree/master/examples/src/main/java/org/apache/spark/examples" rel="nofollow"><span lang="zh-cn" xml:lang="zh-cn">https://github.com/apache/spark/tree/master/examples/src/main/java/org/apache/spark/examples</span></a><span lang="en-us" xml:lang="en-us"> 
 spark examples </span></p>
<p lang="en-us" style="margin-left:.375in;font-family:Calibri;font-size:10.5pt;" xml:lang="en-us">
 <br></p>
            </div>
                </div>