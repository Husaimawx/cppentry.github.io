---
layout:     post
title:      hive导入es6.x
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">这是在开发环境中测试的hive到es的数据导入方法</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><div>[root@sage-bigdata-01 es6]# pwd</div><div>/opt/es6</div></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">1、上传到hdfs中</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hdfs&gt; hdfs dfs -mkdir /hive</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hdfs&gt; hdfs dfs -chown hive:hive /hive</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hive&gt; hdfs dfs -put commons-httpclient-3.1.jar /hive</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hive&gt; hdfs dfs -put elasticsearch-hadoop-6.3.0.jar /hive</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">2、将jar添加到hive中</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hive&gt; add jar hdfs://bigdata-01:8020/hive/elasticsearch-hadoop-6.3.0.jar;</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hive&gt; add jar hdfs://bigdata-01:8020/hive/commons-httpclient-3.1.jar;</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">3、创建外部表</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hive&gt; CREATE EXTERNAL TABLE persons_es (id STRING, age INT, name STRING) </div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"> STORED BY 'org.elasticsearch.hadoop.hive.EsStorageHandler'</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"> TBLPROPERTIES('es.nodes'='172.16.2.115', 'es.resource' = 'hive/persons');</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">4、执行导入</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">hive&gt; INSERT OVERWRITE TABLE persons_es select * from bigdata.persons;</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Logs like this:</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Query ID = hive_20180625172002_058cad13-89a3-4bad-aabd-abad5e105fb3</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Total jobs = 1</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Launching Job 1 out of 1</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Status: Running (Executing on YARN cluster with App id application_1526267537875_0112)</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">--------------------------------------------------------------------------------</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">--------------------------------------------------------------------------------</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Map 1 ..........   SUCCEEDED      1          1        0        0       2       0</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">--------------------------------------------------------------------------------</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">VERTICES: 01/01  [==========================&gt;&gt;] 100%  ELAPSED TIME: 16.94 s    </div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">--------------------------------------------------------------------------------</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">OK</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">Time taken: 19.925 seconds</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">5、help</div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);"><br></div><div style="color:rgb(0,0,0);font-family:'微软雅黑', Tahoma;font-size:14px;line-height:normal;background-color:rgb(255,255,255);">TBLPROPERTIES Settings: https://www.elastic.co/guide/en/elasticsearch/hadoop/current/configuration.html</div>            </div>
                </div>