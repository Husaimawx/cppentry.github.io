---
layout:     post
title:      Flume部署
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p></p><h1 style="background:#FFFFFF;"><sub><span style="color:#333333;">flume</span></sub></h1><p style="background:#FFFFFF;"><span style="color:#333333;"> </span></p><h2 style="background:#FFFFFF;"><a></a><sub><span style="color:#333333;">（日志收集系统）</span></sub></h2><p style="background:#FFFFFF;"><span style="color:#333333;"> </span><span style="color:#333333;">编辑</span></p><p style="background:#FFFFFF;"><span style="color:#333333;">Flume</span><span style="color:#333333;">是</span><span style="color:#333333;">Cloudera</span><span style="color:#333333;">提供的一个高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统，</span><span style="color:#333333;">Flume</span><span style="color:#333333;">支持在日志系统中定制各类数据发送方，用于收集数据；同时，</span><span style="color:#333333;">Flume</span><span style="color:#333333;">提供对数据进行简单处理，并写到各种数据接受方（可定制）的能力。</span></p><br><p>Flume版本：</p><p style="background:#FFFFFF;"><span style="color:#ff0000;"> apache-flume-1.8.0-bin.tar.gz</span></p><p style="background:#FFFFFF;"><span style="color:#ff0000;">把解压包放在HADOOP 的opt/下</span></p><p><span style="color:#000000;">解压 apache_flume-1.8.0-bin.tar.gz:</span></p><p></p><p style="background:#FFFFFF;"><span style="color:#ff0000;">tar    -zxvf     apache-flume-1.8.0-bin.tar.gz</span></p><p style="background:#FFFFFF;"><span style="color:#333333;">然后进入到opt下 放flume文件中的conf目录下，创建一个a1.conf文件</span></p><p style="background:#FFFFFF;"><span style="color:#333333;">进去之后定义：</span><span style="color:#ff0000;"><span lang="en-us" style="font-family:'微软雅黑', sans-serif;" xml:lang="en-us">sinks</span><span style="font-family:'微软雅黑', sans-serif;">，</span><span lang="en-us" style="font-family:'微软雅黑', sans-serif;" xml:lang="en-us">channels</span><span style="font-family:'微软雅黑', sans-serif;">，</span><span lang="en-us" style="font-family:'微软雅黑', sans-serif;" xml:lang="en-us">sources</span></span></p>#定义agent的source channel sinks<br><span style="color:#ff0000;">a1.sources = sr1<br>a1.channels = ch1<br>a1.sinks = log1</span><br>#设置source的参数<br><div style="background:#F8F8F8;"><p align="left"><span style="color:#FF0000;">a1.sources.sr1.type</span><span style="color:#000000;"> = </span><span style="color:#0000FF;">netcat</span><span style="color:#000000;">   #</span><span style="color:#000000;">对网络监听</span><span style="color:#000000;">  </span></p><p align="left"><span style="color:#FF0000;">a1.sources.sr1.bind</span><span style="color:#000000;"> = </span><span style="color:#0000ff;">python5 </span><span style="color:#000000;">#</span><span style="color:#000000;">主机名</span><span style="color:#000000;">  </span></p><p align="left"><span style="color:#FF0000;">a1.sources.sr1.port</span><span style="color:#000000;"> = </span><span style="color:#0000FF;">44444</span><span style="color:#000000;">  </span></p></div><br><br>#设置sink参数<br><span style="color:#ff0000;">a1.sinks.log1.type = logger</span><br><br><br>#设置channel的参数<br><span style="color:#ff0000;">a1.channels.ch1.type = memory</span><br>#把source和sink 通过channel连接在一起<br><span style="color:#ff0000;">a1.sources.sr1.channels = ch1<br></span><p><span style="color:#ff0000;">a1.sinks.log1.channel = ch1</span></p><p>然后启动agent,复制这段代码： ./bin/flume-ng agent -c conf -f conf/a1.conf -n a1-Dflume.root.logger=INFO,console然后回车</p><p><img src="https://img-blog.csdn.net/20180527144353474?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>然后新建一个新的选项卡 ，输入telnet python5 44444</p><p>就可以随便输入进行网络监听，如果时间过长会自动断开</p><p>接下来文件监听：</p><p>1.在hadoop下创建一个目录，我的目录叫zhangsong:</p><p><img src="https://img-blog.csdn.net/20180527145244463?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>2.在conf 里打开a1.conf</p><p>修改成以下：</p><p>会发现我们只修改了 sources</p><p><img src="https://img-blog.csdn.net/20180527145011651?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>3.回到flume目录下然后启动agent还是执行刚才的代码：</p><p><img src="https://img-blog.csdn.net/20180527150207868?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>4复制一个ssh通道，拷贝一个文件到 zhangsong目录下</p><p><img src="https://img-blog.csdn.net/2018052715013960?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>5监听文件成功：</p><p><img src="https://img-blog.csdn.net/20180527150332301?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>去zhangsong目录下会发现 t8这个文件：</p><p>监听目录：</p><p>监听目录和以上不一样，需要我们在conf里新建一个文件  a2.conf</p><p>1 复制a1.conf里的代码过去，然后修改sink:</p><p><img src="https://img-blog.csdn.net/20180527150617700?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x0MDMxOGFh/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt=""><br></p><p>2重新启动agent,启动的时候注意名字 我们现在叫a2.conf</p><p>3拷贝一个文件到zhangsong目录下，打开python/50070，去user/hadoop/会发现多了一个flumedir的目录</p><p><br></p>            </div>
                </div>