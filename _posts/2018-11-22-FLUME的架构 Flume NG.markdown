---
layout:     post
title:      FLUME的架构 Flume NG
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：作者：韩亚飞_yue31313_韩梦飞沙 QQ:313134555 					https://blog.csdn.net/yue31313/article/details/79855869				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><a href="https://blog.csdn.net/a2011480169/article/details/51544664" rel="nofollow" style="color:rgb(0,0,0);font-family:'microsoft yahei';font-size:18px;font-weight:bold;background-color:rgb(255,255,255);">Flume架构以及应用介绍</a><br></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">先给大家看一下Hadoop业务的整体开发流程： </span></p><img src="https://img-blog.csdn.net/20160530152554920" alt="这里写图片描述" title="" style="border:none;font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"> </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">从Hadoop的业务开发流程图中可以看出，在大数据的业务处理过程中，对于数据的采集是十分重要的一步，也是不可避免的一步，从而引出我们本文的主角—Flume。本文将围绕Flume的架构、Flume的应用(日志采集)进行详细的介绍。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">（一）Flume架构介绍 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">1、Flume的概念 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><p><img src="https://img-blog.csdn.net/20160530153940611" alt="这里写图片描述" title="" style="border:none;font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"> </span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">flume是分布式的日志收集系统，它将各个服务器中的数据收集起来并送到指定的地方去，比如说送到图中的HDFS，简单来说flume就是收集日志的。 </span><br></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">2、Event的概念 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">在这里有必要先介绍一下flume中event的相关概念：flume的核心是把数据从数据源(source)收集过来，在将收集到的数据送到指定的目的地(sink)。为了保证输送的过程一定成功，在送到目的地(sink)之前，会先缓存数据(channel),待数据真正到达目的地(sink)后，flume在删除自己缓存的数据。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">在整个数据的传输的过程中，流动的是event，即事务保证是在event级别进行的。那么什么是event呢？—–event将传输的数据进行封装，是flume传输数据的基本单位，如果是文本文件，通常是一行记录，event也是事务的基本单位。event从source，流向channel，再到sink，本身为一个字节数组，并可携带headers(头信息)信息。event代表着一个数据的最小完整单元，从外部数据源来，向外部的目的地去。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">为了方便大家理解，给出一张event的数据流向图： </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><img src="https://img-blog.csdn.net/20160530163300022" alt="这里写图片描述" title="" style="border:none;font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"> </span></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">==</span></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">3、flume架构介绍 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">flume之所以这么神奇，是源于它自身的一个设计，这个设计就是agent，agent本身是一个java进程，运行在日志收集节点—所谓日志收集节点就是服务器节点。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">agent里面包含3个核心的组件：source—-&gt;channel—–&gt;sink,类似生产者、仓库、消费者的架构。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">source：source组件是专门用来收集数据的，可以处理各种类型、各种格式的日志数据,包括avro、thrift、exec、jms、spooling directory、netcat、sequence generator、syslog、http、legacy、自定义。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">channel：source组件把数据收集来以后，临时存放在channel中，即channel组件在agent中是专门用来存放临时数据的——对采集到的数据进行简单的缓存，可以存放在memory、jdbc、file等等。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"></span></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">sink：sink组件是用于把数据发送到目的地的组件，目的地包括hdfs、logger、avro、thrift、ipc、file、null、hbase、solr、自定义。 </span></span></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">==</span></span></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"></span></span></span></span></p><p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">（二）flume应用—日志采集 <br>对于flume的原理其实很容易理解，我们更应该掌握flume的具体使用方法，flume提供了大量内置的Source、Channel和Sink类型。而且不同类型的Source、Channel和Sink可以自由组合—–组合方式基于用户设置的配置文件，非常灵活。比如：Channel可以把事件暂存在内存里，也可以持久化到本地硬盘上。Sink可以把日志写入HDFS, HBase，甚至是另外一个Source等等。下面我将用具体的案例详述flume的具体用法。 <br>其实flume的用法很简单—-书写一个配置文件，在配置文件当中描述source、channel与sink的具体实现，而后运行一个agent实例，在运行agent实例的过程中会读取配置文件的内容，这样flume就会采集到数据。 <br>配置文件的编写原则： <br>1&gt;从整体上描述代理agent中sources、sinks、channels所涉及到的组件</p><pre class="prettyprint" style="font-size:14px;line-height:22px;"><code class="hljs avrasm has-numbering">    <span class="hljs-preprocessor"># Name the components on this agent</span>
    a1<span class="hljs-preprocessor">.sources</span> = <span class="hljs-built_in">r1</span>
    a1<span class="hljs-preprocessor">.sinks</span> = k1
    a1<span class="hljs-preprocessor">.channels</span> = c1</code></pre><ul class="pre-numbering" style="border-right:1px solid rgb(221,221,221);"><li>1</li><li>2</li><li>3</li><li>4</li></ul><p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">2&gt;详细描述agent中每一个source、sink与channel的具体实现：即在描述source的时候，需要 <br>指定source到底是什么类型的，即这个source是接受文件的、还是接受http的、还是接受thrift <br>的；对于sink也是同理，需要指定结果是输出到HDFS中，还是Hbase中啊等等；对于channel <br>需要指定是内存啊，还是数据库啊，还是文件啊等等。</p><pre class="prettyprint" style="font-size:14px;line-height:22px;"><code class="hljs avrasm has-numbering">    <span class="hljs-preprocessor"># Describe/configure the source</span>
    a1<span class="hljs-preprocessor">.sources</span><span class="hljs-preprocessor">.r</span>1<span class="hljs-preprocessor">.type</span> = netcat
    a1<span class="hljs-preprocessor">.sources</span><span class="hljs-preprocessor">.r</span>1<span class="hljs-preprocessor">.bind</span> = localhost
    a1<span class="hljs-preprocessor">.sources</span><span class="hljs-preprocessor">.r</span>1<span class="hljs-preprocessor">.port</span> = <span class="hljs-number">44444</span>

    <span class="hljs-preprocessor"># Describe the sink</span>
    a1<span class="hljs-preprocessor">.sinks</span><span class="hljs-preprocessor">.k</span>1<span class="hljs-preprocessor">.type</span> = logger

    <span class="hljs-preprocessor"># Use a channel which buffers events in memory</span>
    a1<span class="hljs-preprocessor">.channels</span><span class="hljs-preprocessor">.c</span>1<span class="hljs-preprocessor">.type</span> = memory
    a1<span class="hljs-preprocessor">.channels</span><span class="hljs-preprocessor">.c</span>1<span class="hljs-preprocessor">.capacity</span> = <span class="hljs-number">1000</span>
    a1<span class="hljs-preprocessor">.channels</span><span class="hljs-preprocessor">.c</span>1<span class="hljs-preprocessor">.transactionCapacity</span> = <span class="hljs-number">100</span></code></pre><ul class="pre-numbering" style="border-right:1px solid rgb(221,221,221);"><li>1</li><li>2</li><li>3</li><li>4</li><li>5</li><li>6</li><li>7</li><li>8</li><li>9</li><li>10</li><li>11</li><li>12</li></ul><p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">3&gt;通过channel将source与sink连接起来</p><pre class="prettyprint" style="font-size:14px;line-height:22px;"><code class="hljs avrasm has-numbering">    <span class="hljs-preprocessor"># Bind the source and sink to the channel</span>
    a1<span class="hljs-preprocessor">.sources</span><span class="hljs-preprocessor">.r</span>1<span class="hljs-preprocessor">.channels</span> = c1
    a1<span class="hljs-preprocessor">.sinks</span><span class="hljs-preprocessor">.k</span>1<span class="hljs-preprocessor">.channel</span> = c1</code></pre><ul class="pre-numbering" style="border-right:1px solid rgb(221,221,221);"><li>1</li><li>2</li><li>3</li></ul><p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">启动agent的shell操作：</p><pre class="prettyprint" style="font-size:14px;line-height:22px;"><code class="hljs lasso has-numbering">    flume<span class="hljs-attribute">-ng</span>  agent <span class="hljs-attribute">-n</span> a1  <span class="hljs-attribute">-c</span>  <span class="hljs-built_in">..</span>/conf   <span class="hljs-attribute">-f</span>  <span class="hljs-built_in">..</span>/conf/example<span class="hljs-built_in">.</span>file  
    <span class="hljs-attribute">-Dflume</span><span class="hljs-built_in">.</span>root<span class="hljs-built_in">.</span>logger<span class="hljs-subst">=</span>DEBUG,console  </code></pre><ul class="pre-numbering" style="border-right:1px solid rgb(221,221,221);"><li>1</li><li>2</li></ul><p style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">参数说明： -n 指定agent名称(与配置文件中代理的名字相同) <br>-c 指定flume中配置文件的目录 <br>-f 指定配置文件 <br></p><p>-Dflume.root.logger=DEBUG,console 设置日志等级</p><p>==</p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">几个flume source进行适当总结： </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">① NetCat Source：监听一个指定的网络端口，即只要应用程序向这个端口里面写数据，这个source组件 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">就可以获取到信息。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">②Spooling Directory Source：监听一个指定的目录，即只要应用程序向这个指定的目录中添加新的文 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">件，source组件就可以获取到该信息，并解析该文件的内容，然后写入到channle。写入完成后，标记 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">该文件已完成或者删除该文件。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">③Exec Source：监听一个指定的命令，获取一条命令的结果作为它的数据源 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">常用的是tail -F file指令，即只要应用程序向日志(文件)里面写数据，source组件就可以获取到日志(文件)中最新的内容 。 </span><br style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">④Avro Source：监听一个指定的Avro 端口，通过Avro 端口可以获取到Avro client发送过来的文件 。即只要应用程序通过Avro 端口发送文件，source组件就可以获取到该文件中的内容。</span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">==</span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"></span></p><ul style="border:0px;font-size:15px;vertical-align:baseline;background:rgb(242,242,242);list-style:none outside;line-height:1.5;color:rgb(68,68,68);font-family:Verdana, Geneva, sans-serif;"><li style="margin-left:0px;border:0px;vertical-align:baseline;background:transparent;line-height:1;">Flume Source</li></ul><table border="1" cellpadding="2" cellspacing="0" width="100%" style="border:thin solid rgb(134,134,134);font-size:15px;vertical-align:baseline;background:rgb(242,242,242);border-spacing:0px;color:rgb(68,68,68);font-family:Verdana, Geneva, sans-serif;"><tbody style="vertical-align:baseline;background:transparent;"><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;text-align:center;"><span style="border:0px;vertical-align:baseline;background:transparent;">Source类型</span></td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;text-align:center;"><span style="border:0px;vertical-align:baseline;background:transparent;">说明</span></td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Avro Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">支持Avro协议（实际上是Avro RPC），内置支持</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Thrift Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">支持Thrift协议，内置支持</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Exec Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">基于Unix的command在标准输出上生产数据</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">JMS Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">从JMS系统（消息、主题）中读取数据，ActiveMQ已经测试过</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Spooling Directory Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">监控指定目录内数据变更</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Twitter 1% firehose Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">通过API持续下载Twitter数据，试验性质</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Netcat Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">监控某个端口，将流经端口的每一个文本行数据作为Event输入</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Sequence Generator Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">序列生成器数据源，生产序列数据</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Syslog Sources</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">读取syslog数据，产生Event，支持UDP和TCP两种协议</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">HTTP Source</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">基于HTTP POST或GET方式的数据源，支持JSON、BLOB表示形式</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Legacy Sources</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">兼容老的Flume OG中Source（0.9.x版本）</td></tr></tbody></table><ul style="border:0px;font-size:15px;vertical-align:baseline;background:rgb(242,242,242);list-style:none outside;line-height:1.5;color:rgb(68,68,68);font-family:Verdana, Geneva, sans-serif;"><li style="margin-left:0px;border:0px;vertical-align:baseline;background:transparent;line-height:1;">Flume Channel</li></ul><table border="1" cellpadding="2" cellspacing="0" width="100%" style="border:thin solid rgb(134,134,134);font-size:15px;vertical-align:baseline;background:rgb(242,242,242);border-spacing:0px;color:rgb(68,68,68);font-family:Verdana, Geneva, sans-serif;"><tbody style="vertical-align:baseline;background:transparent;"><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;text-align:center;"><span style="border:0px;vertical-align:baseline;background:transparent;">Channel类型</span></td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;text-align:center;"><span style="border:0px;vertical-align:baseline;background:transparent;">说明</span></td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Memory Channel</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">Event数据存储在内存中</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">JDBC Channel</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">Event数据存储在持久化存储中，当前Flume Channel内置支持Derby</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">File Channel</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">Event数据存储在磁盘文件中</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Spillable Memory Channel</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">Event数据存储在内存中和磁盘上，当内存队列满了，会持久化到磁盘文件（当前试验性的，不建议生产环境使用）</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Pseudo Transaction Channel</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">测试用途</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Custom Channel</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">自定义Channel实现</td></tr></tbody></table><ul style="border:0px;font-size:15px;vertical-align:baseline;background:rgb(242,242,242);list-style:none outside;line-height:1.5;color:rgb(68,68,68);font-family:Verdana, Geneva, sans-serif;"><li style="margin-left:0px;border:0px;vertical-align:baseline;background:transparent;line-height:1;">Flume Sink</li></ul><table border="1" cellpadding="2" cellspacing="0" width="100%" style="border:thin solid rgb(134,134,134);font-size:15px;vertical-align:baseline;background:rgb(242,242,242);border-spacing:0px;color:rgb(68,68,68);font-family:Verdana, Geneva, sans-serif;"><tbody style="vertical-align:baseline;background:transparent;"><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;text-align:center;"><span style="border:0px;vertical-align:baseline;background:transparent;">Sink类型</span></td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;text-align:center;"><span style="border:0px;vertical-align:baseline;background:transparent;">说明</span></td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">HDFS Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据写入HDFS</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Logger Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据写入日志文件</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Avro Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据被转换成Avro Event，然后发送到配置的RPC端口上</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Thrift Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据被转换成Thrift Event，然后发送到配置的RPC端口上</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">IRC Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据在IRC上进行回放</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">File Roll Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">存储数据到本地文件系统</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Null Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">丢弃到所有数据</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">HBase Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据写入HBase数据库</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Morphline Solr Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据发送到Solr搜索服务器（集群）</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">ElasticSearch Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">数据发送到Elastic Search搜索服务器（集群）</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Kite Dataset Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">写数据到Kite Dataset，试验性质的</td></tr><tr style="border-top:0px;vertical-align:baseline;background:transparent;"><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:145px;">Custom Sink</td><td valign="top" style="border-width:thin;border-color:rgb(134,134,134);font-size:15px;vertical-align:top;background:transparent;width:610px;">自定义Sink实现</td></tr></tbody></table><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">==</span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:left;background-color:rgb(250,247,239);"><span style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:left;background-color:rgb(250,247,239);">Flume NG：Flume next generation ，即Flume 1.x版本，它由Agent、Client等组件构成。 </span></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);"><span style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:left;background-color:rgb(250,247,239);"><span style="color:rgb(57,57,57);font-family:Verdana, Arial, Helvetica, sans-serif;font-size:14px;text-align:left;background-color:rgb(250,247,239);">Flume OG：Flume original generation 即Flume 0.9.x版本，它由agent、collector、master等组件构成。 </span><br></span></span></p><p><span style="font-family:'-apple-system', 'SF UI Text', Arial, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'WenQuanYi Micro Hei', sans-serif, SimHei, SimSun;background-color:rgb(255,255,255);">==</span></p>            </div>
                </div>