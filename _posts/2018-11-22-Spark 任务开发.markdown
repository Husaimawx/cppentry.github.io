---
layout:     post
title:      Spark 任务开发
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=26154461#page-metadata-end" rel="nofollow" class="assistive" style=""><br>
转至元数据结尾</a>
<div class="page-metadata" style="">
<ul style="margin:0px; overflow:hidden; padding:0px; list-style-type:none; line-height:16px">
<li class="page-metadata-modification-info" style="list-style:none; float:left; padding:0px 5px 0px 0px; margin:0px; line-height:1.5">
由<span class="author"><span> </span><a target="_blank" href="http://wiki.n.miui.com/display/~wangke3" rel="nofollow" class="url fn confluence-userlink userlink-0" title="" style="color:rgb(112,112,112); text-decoration:none; font-size:12px; line-height:1.5">Ke3 Wang 王柯</a></span>创建于<a target="_blank" class="last-modified" href="http://wiki.n.miui.com/pages/viewpreviousversions.action?pageId=26154461" rel="nofollow" style="color:rgb(112,112,112); text-decoration:none; font-size:12px; line-height:1.5">十月
 11, 2016</a></li></ul>
</div>
<a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=26154461#page-metadata-start" rel="nofollow" class="assistive" style="">转至元数据起始</a>
<div id="main-content" class="wiki-content" style="">
<div class="toc-macro rbtoc1462413347251" style="margin:0px; padding:0px; font-size:14px">
<ul class="toc-indentation" style="margin:0px; list-style-type:disc">
<li style="margin-left:0px"><a target="_blank" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Spark 任务开发：</a></li><li style="margin-left:0px"><a target="_blank" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Spark 任务-- WordCount （从编写到运行）</a></li><li style="margin-left:0px"><a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=21229617#Spark%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8-Spark%E8%AF%BB%E5%86%99HBase" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Spark 读写 HBase</a></li><li style="margin-left:0px"><a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=21229617#Spark%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8-Spark%E8%AF%BB%E5%8F%96%E5%85%B6%E4%BB%96%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Spark 读取其他格式文件</a></li><li style="margin-left:0px"><a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=21229617#Spark%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8-%E4%BD%BF%E7%94%A8Spark%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">使用 Spark 过程中可能遇到的坑</a></li><li style="margin-left:0px"><a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=21229617#Spark%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8-Spark%E8%B5%84%E6%96%99" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Spark 资料</a></li></ul>
</div>
<p style="margin:10px 0px 0px; padding:0px"> </p>
<h2 id="spark使用入门-Spark任务开发：" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; text-transform:none; border-bottom-color:rgb(204,204,204)">
Spark 任务开发：</h2>
<p style="margin:10px 0px 0px; padding:0px">开发语言：Spark 支持 Java、Scala、Python等多张语言，Spark 任务编写上，Scala 是最推荐使用的语言。</p>
<p style="margin:10px 0px 0px; padding:0px">步骤：</p>
<ol style="margin:10px 0px 0px; list-style-type:decimal">
<li>本地开发，以local模式跑通。</li><li>提交到公司 yarn 集群，以 yarn-cluster 模式运行。（yarn-cluster模式适合production环境, yarn-client模式适合debug环境. 如果采用Yarn-Client请记住保留本地的Driver日志）</li></ol>
<p style="margin:10px 0px 0px; padding:0px"> </p>
<p style="margin:10px 0px 0px; padding:0px">Spark 任务提交到yarn步骤：</p>
<ol style="margin:10px 0px 0px; list-style-type:decimal">
<li>本地生成jar包</li><li>拷贝到线上机器 lg09</li><li>在线上机器 lg09 上提交任务</li></ol>
<p style="margin:10px 0px 0px; padding:0px"> </p>
<h2 id="spark使用入门-Spark任务--WordCount（从编写到运行）" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; text-transform:none; border-bottom-color:rgb(204,204,204)">
Spark 任务-- WordCount （从编写到运行）</h2>
<ol style="margin:10px 0px 0px; list-style-type:decimal">
<li>clone 项目：git clone <a target="_blank" class="external-link" href="http://git.xiaomi.com:8088/miuicloud/sec/miui-sec/miui-sec-hadoop" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">http://git.xiaomi.com:8088/miuicloud/sec/miui-sec/miui-sec-hadoop</a> &amp;&amp;
 scp -p -P 29418 <a target="_blank" class="external-link" href="mailto:liujianquan@git.xiaomi" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">liujianquan@git.xiaomi</a>.<a target="_blank" class="external-link" href="http://comhooks/" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">com:hooks/commit-msg</a> miui-sec-hadoop/.git/hooks/</li><li>导入 IDEA，IDEA 安装 Scala 插件 <a target="_blank" class="external-link" href="https://www.jetbrains.com/help/idea/2016.1/creating-and-running-your-scala-application.html?origin=old_help" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">creating-and-running-your-scala-application</a></li><li>
<p style="margin:0px; padding:0px">新建 Scala 文件 WordCount.scala， 编辑 pom.xml 文件，添加依赖（已添加）。</p>
<div style="margin:0px; padding:0px">
<div class="syntaxhighlighter nogutter  scala" style="margin:1em 0px; padding:0px; width:1415px; position:relative; overflow:auto; font-size:1em">
<p style="margin:0px; padding:0px"> </p>
<div class="table-wrap" style='margin:0px; padding:0px; overflow:visible; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<table class="confluenceTable " style='border-collapse:collapse; margin:0px; overflow:visible; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:1415px; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<tbody style='background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<tr style='background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<td class="confluenceTd" style='border:0px; padding:0px; vertical-align:baseline; text-align:left; min-width:8px; background:0px center; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; position:static; right:auto; top:auto; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<div class="container" title="Hint: double-click to select code" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<div class="line number1 index0 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>package</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>com.xiaomi.miui.sec.example</code></div>
<div class="line number2 index1 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number3 index2 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>import</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>java.net.URI</code></div>
<div class="line number4 index3 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number5 index4 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>import</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>org.apache.hadoop.conf.Configuration</code></div>
<div class="line number6 index5 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>import</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>org.apache.hadoop.fs.{FileSystem,
 Path}</code></div>
<div class="line number7 index6 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>import</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>org.apache.spark.{SparkConf,
 SparkContext}</code></div>
<div class="line number8 index7 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number9 index8 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>/**</code></div>
<div class="line number10 index9 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'> </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>*
 统计文件中单词出现的个数</code></div>
<div class="line number11 index10 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'> </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>*
 Created by Liu on 16/5/3.</code></div>
<div class="line number12 index11 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'> </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>*/</code></div>
<div class="line number13 index12 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>object</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>WordCount
 {</code></div>
<div class="line number14 index13 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>def</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>main(args</code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>:</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>Array[String])
 {</code></div>
<div class="line number15 index14 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number16 index15 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>if</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>(args.length
 !</code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>2</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)
 {</code></div>
<div class="line number17 index16 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>            </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>System.err.println(</code><code class="scala string" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>"Usage:
 WordCount &lt;input&gt; &lt;output&gt;"</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)</code></div>
<div class="line number18 index17 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>            </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>System.exit(</code><code class="scala value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>1</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)</code></div>
<div class="line number19 index18 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>}</code></div>
<div class="line number20 index19 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number21 index20 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 传入命令行参数, input 输入文件地址, output 输出文件地址</code></div>
<div class="line number22 index21 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>Array(input,
 output) </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>args</code></div>
<div class="line number23 index22 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number24 index23 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 创建 Spark 配置并设置 AppName 为 WordCount</code></div>
<div class="line number25 index24 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>sparkConf </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>new</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>SparkConf().setAppName(</code><code class="scala string" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>"WordCount"</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)</code></div>
<div class="line number26 index25 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>sparkConf.setIfMissing(</code><code class="scala string" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>"spark.master"</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>, </code><code class="scala string" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>"local[2]"</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)</code></div>
<div class="line number27 index26 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 创建 SparkContext</code></div>
<div class="line number28 index27 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>sc </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>new</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>SparkContext(sparkConf)</code></div>
<div class="line number29 index28 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number30 index29 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 如果输出文件存在, 则先删除</code></div>
<div class="line number31 index30 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>fs </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>FileSystem.get(</code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>new</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>URI(output), </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>new</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>Configuration())</code></div>
<div class="line number32 index31 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>fs.delete(</code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>new</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>Path(output), </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>true</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)</code></div>
<div class="line number33 index32 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number34 index33 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 Split each line into words and flatten the result.</code></div>
<div class="line number35 index34 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>lines </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>sc.textFile(input)</code></div>
<div class="line number36 index35 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>words </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>lines.flatMap(</code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>_</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>.split(</code><code class="scala string" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>"
 "</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>))</code></div>
<div class="line number37 index36 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 Map each word into a pair and count them by word (key).</code></div>
<div class="line number38 index37 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>wc </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>words.map(w </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>=</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;
 (w, </code><code class="scala value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>1</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)).reduceByKey(</code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>_</code> <code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>+ </code><code class="scala keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>_</code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)</code></div>
<div class="line number39 index38 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala comments" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>//
 Save the result into text files - one per partition.</code></div>
<div class="line number40 index39 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>wc.saveAsTextFile(output)</code></div>
<div class="line number41 index40 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code> </div>
<div class="line number42 index41 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>sc.stop()</code></div>
<div class="line number43 index42 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>}</code></div>
<div class="line number44 index43 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
 </div>
<div class="line number45 index44 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="scala plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>}</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</li><li>打包 jar 。<br>
mvn package -P wordCount<br>
target 目录下生成 miui-sec-spark-wordCount-1.1.12-pom-SNAPSHOT.jar</li><li>复制 jar 到 线上机器 lg09。<br>
scp liu@10.235.134.9:/Users/Liu/Projects/Xiaomi/src/miui-sec-hadoop/miui-sec-spark/target/miui-sec-spark-wordCount-1.1.12-pom-SNAPSHOT.jar    /home/work/dev/jars/</li><li>在 lg09 上运行 WordCount 任务<br>
<strong>local 模式</strong><br>
输入文件 input.txt<br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2015%3A25%3A46.png?version=1&amp;modificationDate=1462345939000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
local 模式运行任务，$INFRA_CLIENT/bin/spark-submit --class com.xiaomi.miui.sec.example.WordCount --master local /home/work/dev/jars/miui-sec-spark-wordCount-1.1.12-pom-SNAPSHOT.jar <a target="_blank" class="external-link" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">file:///$PWD/input.txt</a><a target="_blank" class="external-link" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">file:///$PWD/output</a><br>
其中，spark-submit 参数请查阅 <a target="_blank" class="external-link" href="http://spark.apache.org/docs/latest/submitting-applications.html" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">submitting-applications </a>，infra client 使用参考<a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=15472963" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">infra-client使用</a><br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2015%3A27%3A36.png?version=1&amp;modificationDate=1462346049000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
输出结果 output<br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2015%3A30%3A7.png?version=1&amp;modificationDate=1462346200000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
<strong><br>
<br>
yarn-cluster 模式</strong><br>
把 WordCount 提交到公司的 yarn 集群（由于lg机房逐步淘汰，现在都提交到 c3 机房的集群 c3prc-hadoop，办公网访问C3集群需要设置代理，方法见 <a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=18978406" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">办公网访问IDC代理指南</a>）<br>
输入文件是 HDFS 上的 input.txt<br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2015%3A42%3A21.png?version=1&amp;modificationDate=1462346934000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2015%3A43%3A11.png?version=1&amp;modificationDate=1462346984000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
提交任务到 yarn<br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2016%3A37%3A12.png?version=1&amp;modificationDate=1462350225000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
查看 yarn 上的任务执行情况：<a target="_blank" class="external-link" href="http://c3-hadoop-prc-ct04.bj:22301/cluster/app/application_1447144693824_1536961" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">http://c3-hadoop-prc-ct04.bj:22301/cluster/app/application_1447144693824_1536961</a><br>
查看 SparkUI 上任务执行情况：<a target="_blank" class="external-link" href="http://c3hadoopproxy.d.xiaomi.net:18900/history/application_1447144693824_1536961/1/jobs/" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">http://c3hadoopproxy.d.xiaomi.net:18900/history/application_1447144693824_1536961/1/jobs/</a><br>
（办公网需要设置代理访问）<br>
<br>
查看 output 结果<br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2016%3A35%3A12.png?version=1&amp;modificationDate=1462350105000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span><br>
<span class="confluence-embedded-file-wrapper" style="position:relative; display:inline-block; max-width:100%"><img class="confluence-embedded-image confluence-external-resource" src="http://wiki.n.miui.com/download/attachments/21229617/image2016-5-4%2016%3A36%3A2.png?version=1&amp;modificationDate=1462350155000&amp;api=v2" alt="" style="margin:0px 2px; padding:0px; border:0px; display:block"></span></li></ol>
<h2 id="spark使用入门-Spark读写HBase" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; text-transform:none; border-bottom-color:rgb(204,204,204)">
Spark 读写 HBase</h2>
<p style="margin:10px 0px 0px; padding:0px">HBase 使用参考 <a target="_blank" class="external-link" href="http://infra.d.xiaomi.net/hbase-user/index.html" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Xiaomi HBase BookXiaomi（0.98）</a>和 <a target="_blank" class="external-link" href="http://infra.d.xiaomi.net/hbase/index.html" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">Xiaomi
 HBase Book（0.94）</a></p>
<p style="margin:10px 0px 0px; padding:0px">Spark 支持从多种数据源读取数据，进行处理，并支持输出到多种数据源中。Spark 读写 HBase 的方法，在现有的项目中有，可以直接参考。</p>
<p style="margin:10px 0px 0px; padding:0px">需要注意：</p>
<p style="margin:10px 0px 0px; padding:0px">公司维护的HBase有两个版本，0.94 和 0.98 版，两个版本的依赖不一样。</p>
<p style="margin:10px 0px 0px; padding:0px">spark-submit 提交时需要指定--hbase 参数</p>
<p style="margin:10px 0px 0px; padding:0px"> </p>
<h2 id="spark使用入门-Spark读取其他格式文件" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; text-transform:none; border-bottom-color:rgb(204,204,204)">
Spark 读取其他格式文件</h2>
<p style="margin:10px 0px 0px; padding:0px">读取 Paruqet 文件，有两种方法</p>
<ol style="margin:10px 0px 0px; list-style-type:decimal">
<li>使用数据工厂的包<span style="color:#333399">com.xiaomi.<a target="_blank" class="external-link" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">data:commons-spark:0.0.1-SNAPSHOT</a></span><br>
具体参考 <a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=16810497" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">MapReduce/Spark读写Thrift+Paruqet/SequenceFile</a></li><li>
<p style="margin:0px; padding:0px">使用Spark SQL<br>
添加spark-sql依赖</p>
<div style="margin:0px; padding:0px">
<div class="syntaxhighlighter nogutter  xml" style="margin:1em 0px; padding:0px; width:1415px; position:relative; overflow:auto; font-size:1em">
<p style="margin:0px; padding:0px"> </p>
<div class="table-wrap" style='margin:0px; padding:0px; overflow:visible; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<table class="confluenceTable " style='border-collapse:collapse; margin:0px; overflow:visible; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:1415px; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<tbody style='background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<tr style='background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<td class="confluenceTd" style='border:0px; padding:0px; vertical-align:baseline; text-align:left; min-width:8px; background:0px center; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; position:static; right:auto; top:auto; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<div class="container" title="Hint: double-click to select code" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<div class="line number1 index0 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&lt;</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>dependency</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;</code></div>
<div class="line number2 index1 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="xml spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&lt;</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>groupId</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;org.apache.spark&lt;/</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>groupId</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;</code></div>
<div class="line number3 index2 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="xml spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&lt;</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>artifactId</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;spark-sql_2.10&lt;/</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>artifactId</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;</code></div>
<div class="line number4 index3 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="xml spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&lt;</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>version</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;1.5.2&lt;/</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>version</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;</code></div>
<div class="line number5 index4 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="xml spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&lt;</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>scope</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;provided&lt;/</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>scope</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;</code></div>
<div class="line number6 index5 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&lt;/</code><code class="xml keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>dependency</code><code class="xml plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>&gt;</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p style="margin:10px 0px 0px; padding:0px"> </p>
</div>
</div>
<p style="margin:10px 0px 0px; padding:0px">读parquet文件</p>
<div style="margin:0px; padding:0px">
<div class="syntaxhighlighter nogutter  java" style="margin:1em 0px; padding:0px; width:1415px; position:relative; overflow:auto; font-size:1em">
<p style="margin:0px; padding:0px"> </p>
<div class="table-wrap" style='margin:0px; padding:0px; overflow:visible; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<table class="confluenceTable " style='border-collapse:collapse; margin:0px; overflow:visible; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:1415px; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<tbody style='background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<tr style='background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<td class="confluenceTd" style='border:0px; padding:0px; vertical-align:baseline; text-align:left; min-width:8px; background:0px center; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; position:static; right:auto; top:auto; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<div class="container" title="Hint: double-click to select code" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>
<div class="line number1 index0 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val
 sqlContext = </code><code class="java keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>new</code> <code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>org.apache.spark.sql.SQLContext(sc)</code></div>
<div class="line number2 index1 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val
 parquetFile = sqlContext.read.parquet(srcFile)</code></div>
<div class="line number3 index2 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>val
 basicRDD = parquetFile.rdd.filter(row =&gt; {</code></div>
<div class="line number4 index3 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="java keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>if</code> <code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>(row.isNullAt(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>1</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)
 &amp;&amp; row.isNullAt(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>2</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)
 &amp;&amp; row.isNullAt(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>3</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)) </code><code class="java keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>false</code></div>
<div class="line number5 index4 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="java keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>else</code> <code class="java keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>true</code></div>
<div class="line number6 index5 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>}).mapPartitions(it
 =&gt; {</code></div>
<div class="line number7 index6 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="java keyword" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>for</code> <code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>(row
 &lt;- it) yield {</code></div>
<div class="line number8 index7 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>basicCounter
 += </code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>1</code></div>
<div class="line number9 index8 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>        </code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>(row.getString(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>0</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>),
 (row.getString(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>1</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>),
 row.getString(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>2</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>),
 row.getString(</code><code class="java value" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>3</code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>)))</code></div>
<div class="line number10 index9 alt1" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java spaces" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>    </code><code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>}</code></div>
<div class="line number11 index10 alt2" style='margin:0px; padding:0px; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; outline:0px; overflow:visible; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit; white-space:pre'>
<code class="java plain" style='font-family:Consolas,"Bitstream Vera Sans Mono","Courier New",Courier,monospace; background:0px center; border:0px; bottom:auto; float:none; height:auto; left:auto; line-height:1.2em; margin:0px; outline:0px; overflow:visible; padding:0px; position:static; right:auto; text-align:left; top:auto; vertical-align:baseline; width:auto; font-weight:normal; font-style:normal; font-size:1em; min-height:inherit'>})</code></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</li></ol>
<h2 id="spark使用入门-使用Spark过程中可能遇到的坑" style="margin:30px 0px 0px; padding:0px; color:rgb(51,51,51); font-size:20px; font-weight:normal; line-height:1.5; text-transform:none; border-bottom-color:rgb(204,204,204)">
使用 Spark 过程中可能遇到的坑</h2>
<ul style="margin:10px 0px 0px; list-style-type:disc">
<li><strong>强烈建议</strong>：首先阅读 <a target="_blank" href="http://wiki.n.miui.com/pages/viewpage.action?pageId=12979577" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">小米 Spark用户 QA</a>，可以避免很多坑，了解如何 kill 任务、查看日志等。</li><li><strong>任务队列</strong>：提交任务要指定队列（–queue），不指定会分配到资源少的 default 队列。另外测试阶段可以提交到development 队列<br>
我们组的队列是 <br>
Hadoop 任务：root.production.miui_group.miuisec <br>
Spark 任务：root.service.miui_group.miuisec<br>
一般情况，MR 任务提交到 Hadoop 队列，Spark 任务提交到 Service 队列，特殊情况也可变通。Spark 任务提交到 Hadoop 任务队列可能会被抢占。</li><li><strong>HBase</strong>：<br>
HBase 作为输入时，region的数量就是任务的数量。当 Regin size 过大时，可以考虑 Split Region，使任务数增多，单个任务处理的数据量降下来。<br>
Scan  HBase 可能会遇到，内存泄漏的问题，可以加入配置  conf.set(<span style="color:#6a8759">"hbase.ipc.client.connection.maxidletime"</span><span style="color:#cc7832">, </span><span style="color:#6a8759">"3600000"</span>)，具体原因未知。。<br>
任务只读取行一次的情况下，关闭 CacheBlocks  scan.setCacheBlocks(false)<br>
合理设置Scan参数可以提高性能，参考 <a target="_blank" class="external-link" href="http://stackoverflow.com/questions/22528859/hbase-scan-performance" rel="nofollow" style="color:rgb(53,114,176); text-decoration:none">http://stackoverflow.com/questions/22528859/hbase-scan-performance</a><br>
需要全表scan之前，可以先指定 startRow 和 stopRow，小范围运行任务，验证结果。</li><li> <strong>使用 Accumulator</strong> ：使用计数器，可以方便的记录次数，并在 Spark UI 上实时查看，比查看 log 文件方便。</li><li>
<p style="margin:0px; padding:0px"><strong>脏数据<br>
</strong>脏数据很难避免，代码要足够兼容。</p>
</li><li><strong>数据倾斜</strong></li><li><strong>合理设置RDD的Cache<br>
</strong></li></ul>
</div>
            </div>
                </div>