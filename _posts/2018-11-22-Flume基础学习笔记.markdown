---
layout:     post
title:      Flume基础学习笔记
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <p style="background-color:rgb(255,255,255);">一、什么是<span style="font-family:Calibri;">flume</span></p><p align="justify" style="background-color:rgb(255,255,255);">Flume<span style="font-family:'宋体';">是一个高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统，</span><span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">支持在日志系统中定制各类数据发送方，用于收集数据；同时，</span><span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">提供对数据进行简单处理，并写到各种数据接受方（可定制）的能力。</span></p><p align="justify" style="background-color:rgb(255,255,255);">二、<span style="font-family:Calibri;">flume</span><span style="font-family:'宋体';">特点</span></p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">的数据流由事件</span><span style="font-family:Calibri;">(Event)</span><span style="font-family:'宋体';">贯穿始终。事件是</span><span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">的基本数据单位，它携带日志数据</span><span style="font-family:Calibri;">(</span><span style="font-family:'宋体';">字节数组形式</span><span style="font-family:Calibri;">)</span><span style="font-family:'宋体';">并且携带有头信息，这些</span><span style="font-family:Calibri;">Event</span><span style="font-family:'宋体';">由</span><span style="font-family:Calibri;">Agent</span><span style="font-family:'宋体';">外部的</span><span style="font-family:Calibri;">Source</span><span style="font-family:'宋体';">生成，当</span><span style="font-family:Calibri;">Source</span><span style="font-family:'宋体';">捕获事件后会进行特定的格式化，然后</span><span style="font-family:Calibri;">Source</span><span style="font-family:'宋体';">会把事件推入</span><span style="font-family:Calibri;">(</span><span style="font-family:'宋体';">单个或多个</span><span style="font-family:Calibri;">)Channel</span><span style="font-family:'宋体';">中。你可以把</span><span style="font-family:Calibri;">Channel</span><span style="font-family:'宋体';">看作是一个缓冲区，它将保存事件直到</span><span style="font-family:Calibri;">Sink</span><span style="font-family:'宋体';">处理完该事件。</span><span style="font-family:Calibri;">Sink</span><span style="font-family:'宋体';">负责持久化日志或者把事件推向另一个</span><span style="font-family:Calibri;">Source</span><span style="font-family:'宋体';">。</span></p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">的可靠性</span></p><p align="justify" style="background-color:rgb(255,255,255);">当节点出现故障时，日志能够被传送到其他节点上而不会丢失。<span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">提供了三种级别的可靠性保障，从强到弱依次分别为：</span><span style="font-family:Calibri;">end-to-end</span><span style="font-family:'宋体';">（收到数据</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">首先将</span><span style="font-family:Calibri;">event</span><span style="font-family:'宋体';">写到磁盘上，当数据传送成功后，再删除；如果数据发送失败，可以重新发送。），</span><span style="font-family:Calibri;">Store on failure</span><span style="font-family:'宋体';">（这也是</span><span style="font-family:Calibri;">scribe</span><span style="font-family:'宋体';">采用的策略，当数据接收方</span><span style="font-family:Calibri;">crash</span><span style="font-family:'宋体';">时，将数据写到本地，待恢复后，继续发送），</span><span style="font-family:Calibri;">Besteffort</span><span style="font-family:'宋体';">（数据发送到接收方后，不会进行确认）。</span></p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">的可恢复性：</span></p><p align="justify" style="background-color:rgb(255,255,255);">还是靠<span style="font-family:Calibri;">Channel</span><span style="font-family:'宋体';">。推荐使用</span><span style="font-family:Calibri;">FileChannel</span><span style="font-family:'宋体';">，事件持久化在本地文件系统里</span><span style="font-family:Calibri;">(</span><span style="font-family:'宋体';">性能较差</span><span style="font-family:Calibri;">)</span><span style="font-family:'宋体';">。 </span></p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">的一些核心概念：</span></p><p align="justify" style="background-color:rgb(255,255,255);">Agent<span style="font-family:'宋体';">使用</span><span style="font-family:Calibri;">JVM </span><span style="font-family:'宋体';">运行</span><span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">。每台机器运行一个</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">，但是可以在一个</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">中包含多个</span><span style="font-family:Calibri;">sources</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">sinks</span><span style="font-family:'宋体';">。</span></p><p align="justify" style="background-color:rgb(255,255,255);">Client<span style="font-family:'宋体';">生产数据，运行在一个独立的线程。</span></p><p align="justify" style="background-color:rgb(255,255,255);">Source<span style="font-family:'宋体';">从</span><span style="font-family:Calibri;">Client</span><span style="font-family:'宋体';">收集数据，传递给</span><span style="font-family:Calibri;">Channel</span><span style="font-family:'宋体';">。</span></p><p align="justify" style="background-color:rgb(255,255,255);">Sink<span style="font-family:'宋体';">从</span><span style="font-family:Calibri;">Channel</span><span style="font-family:'宋体';">收集数据，运行在一个独立线程。</span></p><p align="justify" style="background-color:rgb(255,255,255);">Channel<span style="font-family:'宋体';">连接 </span><span style="font-family:Calibri;">sources </span><span style="font-family:'宋体';">和 </span><span style="font-family:Calibri;">sinks </span><span style="font-family:'宋体';">，这个有点像一个队列。</span></p><p align="justify" style="background-color:rgb(255,255,255);">Events<span style="font-family:'宋体';">可以是日志记录、 </span><span style="font-family:Calibri;">avro </span><span style="font-family:'宋体';">对象等。</span></p><p align="justify" style="background-color:rgb(255,255,255);">值得注意的是，<span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">提供了大量内置的</span><span style="font-family:Calibri;">Source</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Channel</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">Sink</span><span style="font-family:'宋体';">类型。不同类型的</span><span style="font-family:Calibri;">Source,Channel</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">Sink</span><span style="font-family:'宋体';">可以自由组合。组合方式基于用户设置的配置文件，非常灵活。比如：</span><span style="font-family:Calibri;">Channel</span><span style="font-family:'宋体';">可以把事件暂存在内存里，也可以持久化到本地硬盘上。</span><span style="font-family:Calibri;">Sink</span><span style="font-family:'宋体';">可以把日志写入</span><span style="font-family:Calibri;">HDFS, HBase</span><span style="font-family:'宋体';">，甚至是另外一个</span><span style="font-family:Calibri;">Source</span><span style="font-family:'宋体';">等等。</span><span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">支持用户建立多级流，也就是说，多个</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">可以协同工作，并且支持</span><span style="font-family:Calibri;">Fan-in</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Fan-out</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Contextual Routing</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Backup Routes</span></p><p align="justify" style="background-color:rgb(255,255,255);">三、flume<span style="font-family:'宋体';">架构</span></p><p align="justify" style="background-color:rgb(255,255,255);">Agent:</p><p align="justify" style="background-color:rgb(255,255,255);">Flume<span style="font-family:'宋体';">以</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">为最小的独立运行单位</span><span style="font-family:Calibri;">,</span><span style="font-family:'宋体';">一个</span><span style="font-family:Calibri;">Agent</span><span style="font-family:'宋体';">包含多个</span><span style="font-family:Calibri;">source</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">channel</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">sink</span><span style="font-family:'宋体';">和其他组件</span></p><p align="justify" style="background-color:rgb(255,255,255);">source</p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">提供多种</span><span style="font-family:Calibri;">source</span><span style="font-family:'宋体';">供用户进行选择，尽可能多的满足大部分日志采集的需求，常用的</span><span style="font-family:Calibri;">source</span><span style="font-family:'宋体';">的类型包括</span><span style="font-family:Calibri;">avro</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">exec</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">netcat</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">spooling-directory</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">syslog</span><span style="font-family:'宋体';">等。具体的使用范围和配置方法详见</span><span style="font-family:Calibri;">source.</span></p><p align="justify" style="background-color:rgb(255,255,255);">channel</p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">中的</span><span style="font-family:Calibri;">channel</span><span style="font-family:'宋体';">不如</span><span style="font-family:Calibri;">source</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">sink</span><span style="font-family:'宋体';">那么重要，但却是不可忽视的组成部分。常用的</span><span style="font-family:Calibri;">channel</span><span style="font-family:'宋体';">为</span><span style="font-family:Calibri;">memory-channel</span><span style="font-family:'宋体';">，同时也有其他类型的</span><span style="font-family:Calibri;">channel</span><span style="font-family:'宋体';">，如</span><span style="font-family:Calibri;">JDBC</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">file-channel</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">custom-channel</span><span style="font-family:'宋体';">等，详情见</span><span style="font-family:Calibri;">channel.</span></p><p align="justify" style="background-color:rgb(255,255,255);">sink</p><p align="justify" style="background-color:rgb(255,255,255);">flume<span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">sink</span><span style="font-family:'宋体';">也有很多种，常用的包括</span><span style="font-family:Calibri;">avro</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">logger</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">HDFS</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">Hbase</span><span style="font-family:'宋体';">以及</span><span style="font-family:Calibri;">file-roll</span><span style="font-family:'宋体';">等，除此之外还有其他类型的</span><span style="font-family:Calibri;">sink</span><span style="font-family:'宋体';">，如</span><span style="font-family:Calibri;">thrift</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">IRC</span><span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">custom</span><span style="font-family:'宋体';">等。具体的使用范围和使用方法详见</span><span style="font-family:Calibri;">sink.</span></p><p align="justify" style="background-color:rgb(255,255,255);">四、<span style="font-family:Calibri;">flume</span><span style="font-family:'宋体';">使用</span></p><p align="justify" style="background-color:rgb(255,255,255);">创建配置文件（随意位置<span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);">vi agent.conf</p><p align="justify" style="background-color:rgb(255,255,255);">五、配置</p><p align="justify" style="background-color:rgb(255,255,255);">常见的<span style="font-family:Calibri;">source</span></p><p align="justify" style="background-color:rgb(255,255,255);"><span>avro source</span>:avro<span style="font-family:'宋体';">可以监听和收集指定端口的日志，使用</span><span style="font-family:Calibri;">avro</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">source</span><span style="font-family:'宋体';">需要说明被监听的主机</span><span style="font-family:Calibri;">ip</span><span style="font-family:'宋体';">和端口号</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources = r1</p><p align="justify" style="background-color:rgb(255,255,255);">#<span style="font-family:'宋体';">描述</span><span style="font-family:Calibri;">source</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r1.type = avro  (<span style="font-family:'宋体';">类型为</span><span style="font-family:Calibri;">avro source)</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r1.bind = 0.0.0.0 <span style="font-family:'宋体';">（指定监听的主机</span><span style="font-family:Calibri;">ip.</span><span style="font-family:'宋体';">本机是</span><span style="font-family:Calibri;">0.0.0.0.</span><span style="font-family:'宋体';">）</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r1.port = 16667 (<span style="font-family:'宋体';">指定监听的端口号</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);"><span>exec source</span>:<span style="font-family:'宋体';">可以通过指定的操作对日志进行读取，使用</span><span style="font-family:Calibri;">exec</span><span style="font-family:'宋体';">时需要指定</span><span style="font-family:Calibri;">shell</span><span style="font-family:'宋体';">命令，对日志进行读取</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.source = r2</p><p align="justify" style="background-color:rgb(255,255,255);">#<span style="font-family:'宋体';">描述</span><span style="font-family:Calibri;">source</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r2.type = exec </p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r2.command =tail -F /root/flume/log/event.txt (<span style="font-family:'宋体';">监听的文件的路径</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);"><span>Spooling-directory source</span>:<span style="font-family:'宋体';">可以读取文件夹里的日志，使用时指定一个文件夹，可以读取该文件夹中的所有文件，当出现新文件时会读取该文件并获取数据</span><span style="font-family:Calibri;">.</span><span style="font-family:'宋体';">需要注意的是该文件夹中的文件在读取过程中不能修改，同时文件名也不能修改。</span></p><p align="justify" style="background-color:rgb(255,255,255);">1、spoolDirectory<span style="font-family:'宋体';">是监控目录，不能为空，没有默认值。这个</span><span style="font-family:Calibri;">source</span><span style="font-family:'宋体';">不具有监控子目录的功能，也就是不能递归监控。如果需要，这需要自己去实现，</span><span style="font-family:Calibri;">http://blog.csdn.net/yangbutao/article/details/8835563 </span><span style="font-family:'宋体';">这里有递归检测的实现；</span></p><p align="justify" style="background-color:rgb(255,255,255);">2<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">completedSuffix</span><span style="font-family:'宋体';">是文件读取完毕后给完成文件添加的标记后缀，默认是</span><span style="font-family:Calibri;">".COMPLETED"</span><span style="font-family:'宋体';">；</span></p><p align="justify" style="background-color:rgb(255,255,255);">3<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">deletePolicy</span><span style="font-family:'宋体';">这是是否删除读取完毕的文件，默认是</span><span style="font-family:Calibri;">"never"</span><span style="font-family:'宋体';">，就是不删除，目前只支持</span><span style="font-family:Calibri;">"never"</span><span style="font-family:'宋体';">和“</span><span style="font-family:Calibri;">IMMEDIATE</span><span style="font-family:'宋体';">”；</span></p><p align="justify" style="background-color:rgb(255,255,255);">4<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">fileHeader</span><span style="font-family:'宋体';">是否在</span><span style="font-family:Calibri;">event</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">Header</span><span style="font-family:'宋体';">中添加文件名，</span><span style="font-family:Calibri;">boolean</span><span style="font-family:'宋体';">类型</span><span style="font-family:Calibri;">, </span><span style="font-family:'宋体';">默认</span><span style="font-family:Calibri;">false</span></p><p align="justify" style="background-color:rgb(255,255,255);">5<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">fileHeaderKey</span><span style="font-family:'宋体';">这是</span><span style="font-family:Calibri;">event</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">Header</span><span style="font-family:'宋体';">中的</span><span style="font-family:Calibri;">key,value</span><span style="font-family:'宋体';">是文件名</span></p><p align="justify" style="background-color:rgb(255,255,255);">6<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">batchSize</span><span style="font-family:'宋体';">这个是一次处理的记录数，默认是</span><span style="font-family:Calibri;">100</span><span style="font-family:'宋体';">；</span></p><p align="justify" style="background-color:rgb(255,255,255);">7<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">inputCharset</span><span style="font-family:'宋体';">编码方式，默认是</span><span style="font-family:Calibri;">"UTF-8"</span><span style="font-family:'宋体';">；</span></p><p align="justify" style="background-color:rgb(255,255,255);">8<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">ignorePattern</span><span style="font-family:'宋体';">忽略符合条件的文件名</span></p><p align="justify" style="background-color:rgb(255,255,255);">9<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">trackerDirPath</span><span style="font-family:'宋体';">被处理文件元数据的存储目录，默认</span><span style="font-family:Calibri;">".flumespool"</span></p><p align="justify" style="background-color:rgb(255,255,255);">10<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">deserializerType</span><span style="font-family:'宋体';">将文件中的数据序列化成</span><span style="font-family:Calibri;">event</span><span style="font-family:'宋体';">的方式，默认是“</span><span style="font-family:Calibri;">LINE</span><span style="font-family:'宋体';">”</span><span style="font-family:Calibri;">---org.apache.flume.serialization.LineDeserializer</span></p><p align="justify" style="background-color:rgb(255,255,255);">11<span style="font-family:'宋体';">、</span><span style="font-family:Calibri;">deserializerContext</span><span style="font-family:'宋体';">这个主要用在</span><span style="font-family:Calibri;">Deserializer</span><span style="font-family:'宋体';">中设置编码方式</span><span style="font-family:Calibri;">outputCharset</span><span style="font-family:'宋体';">和文件每行最大长度</span><span style="font-family:Calibri;">maxLineLength</span><span style="font-family:'宋体';">。</span></p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p style="background-color:rgb(255,255,255);">例子：</p><p style="background-color:rgb(255,255,255);">agent1.sources = r3</p><p style="background-color:rgb(255,255,255);">#<span style="font-family:'宋体';">描述</span><span style="font-family:Calibri;">source</span></p><p style="background-color:rgb(255,255,255);">agent1.sources.r3.type = spooldir</p><p style="background-color:rgb(255,255,255);">agent1.sources.r3.spoolDir = /root/flume/log  (<span style="font-family:'宋体';">监听的文件目录</span><span style="font-family:Calibri;">)</span></p><p style="background-color:rgb(255,255,255);">agent1.sources.r3.fileHeader = true</p><p align="justify" style="background-color:rgb(255,255,255);">    </p><p align="justify" style="background-color:rgb(255,255,255);"><span>NetCat source</span>:<span style="font-family:'宋体';">用来监听一个指定端口，并将接收到的数据的每一行转换为一个事件。</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources = r4 </p><p align="justify" style="background-color:rgb(255,255,255);">#<span style="font-family:'宋体';">描述</span><span style="font-family:Calibri;">source</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r4.type = netcat  (source<span style="font-family:'宋体';">类型</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r4.bind = 0.0.0.0 (<span style="font-family:'宋体';">指定绑定的</span><span style="font-family:Calibri;">ip</span><span style="font-family:'宋体';">或主机名</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r4.port = 16668   (<span style="font-family:'宋体';">指定绑定的端口号</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);"><span>HTTP source</span>:<span style="font-family:'宋体';">接受</span><span style="font-family:Calibri;">HTTP</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">GET</span><span style="font-family:'宋体';">和</span><span style="font-family:Calibri;">POST</span><span style="font-family:'宋体';">请求作为</span><span style="font-family:Calibri;">Flume</span><span style="font-family:'宋体';">的事件</span><span style="font-family:Calibri;">,</span><span style="font-family:'宋体';">其中</span><span style="font-family:Calibri;">GET</span><span style="font-family:'宋体';">方式应该只用于试验。</span></p><p align="justify" style="background-color:rgb(255,255,255);">！<span style="font-family:Calibri;">type    </span><span style="font-family:'宋体';">类型，必须为</span><span style="font-family:Calibri;">"HTTP"</span></p><p align="justify" style="background-color:rgb(255,255,255);">！<span style="font-family:Calibri;">port</span><span style="font-family:'宋体';">–   监听的端口</span></p><p align="justify" style="background-color:rgb(255,255,255);">bind   0.0.0.0    <span style="font-family:'宋体';">监听的主机名或</span><span style="font-family:Calibri;">ip</span></p><p align="justify" style="background-color:rgb(255,255,255);">handler      org.apache.flume.source.http.JSONHandler<span style="font-family:'宋体';">处理器类，需要实现</span><span style="font-family:Calibri;">HTTPSourceHandler</span><span style="font-family:'宋体';">接口</span></p><p align="justify" style="background-color:rgb(255,255,255);">handler.*  <span style="font-family:'宋体';">–   处理器的配置参数</span></p><p align="justify" style="background-color:rgb(255,255,255);">Selector.type</p><p align="justify" style="background-color:rgb(255,255,255);">selector.*   </p><p align="justify" style="background-color:rgb(255,255,255);">interceptors  <span style="font-family:'宋体';">–  </span></p><p align="justify" style="background-color:rgb(255,255,255);">interceptors.*        </p><p align="justify" style="background-color:rgb(255,255,255);">enableSSL  false  <span style="font-family:'宋体';">是否开启</span><span style="font-family:Calibri;">SSL,</span><span style="font-family:'宋体';">如果需要设置为</span><span style="font-family:Calibri;">true</span><span style="font-family:'宋体';">。注意，</span><span style="font-family:Calibri;">HTTP</span><span style="font-family:'宋体';">不支持</span><span style="font-family:Calibri;">SSLv3</span><span style="font-family:'宋体';">。</span></p><p align="justify" style="background-color:rgb(255,255,255);">excludeProtocols  SSLv3  <span style="font-family:'宋体';">空格分隔的要排除的</span><span style="font-family:Calibri;">SSL/TLS</span><span style="font-family:'宋体';">协议。</span><span style="font-family:Calibri;">SSLv3</span><span style="font-family:'宋体';">总是被排除的。</span></p><p align="justify" style="background-color:rgb(255,255,255);">keystore      <span style="font-family:'宋体';">密钥库文件所在位置</span></p><p align="justify" style="background-color:rgb(255,255,255);">keystorePassword Keystore <span style="font-family:'宋体';">密钥库密码</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r1.type  = http</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sources.r1.port  = 66666</p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);">常见的<span style="font-family:Calibri;">channel</span></p><p align="justify" style="background-color:rgb(255,255,255);"><span>memory channe</span>l:<span style="font-family:'宋体';">内存</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.channels = c1</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.channels.c1.type = memory</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.channels.c1.capacity = 100000</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.channels.c1.transactionCapacity = 100000</p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);">常见的<span style="font-family:Calibri;">sink</span></p><p align="justify" style="background-color:rgb(255,255,255);"><span>logger sink</span>:<span style="font-family:'宋体';">将收集到的日志写到</span><span style="font-family:Calibri;">flume</span><span style="font-family:'宋体';">的</span><span style="font-family:Calibri;">log</span><span style="font-family:'宋体';">中</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks = k1</p><p align="justify" style="background-color:rgb(255,255,255);">agent2.sinks.k1.type = logger</p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);"><span>avro sink</span>:<span style="font-family:'宋体';">可以将接受到的日志发送到指定端口，供级联</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">的下一跳收集和接受日志，使用时需要指定目的</span><span style="font-family:Calibri;">ip</span><span style="font-family:'宋体';">和端口</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks=k1</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k2.type = avro</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k2.channel = c2</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k2.hostname = hadoop03 (<span style="font-family:'宋体';">指定的主机名或</span><span style="font-family:Calibri;">ip)</span></p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k2.port = 16666  (<span style="font-family:'宋体';">指定的端口号</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p align="justify" style="background-color:rgb(255,255,255);"><span>file_roll sink</span>:<span style="font-family:'宋体';">可以将一定时间内收集到的日志写到一个指定的文件中，具体过程为用户指定一个文件夹和一个周期，然后启动</span><span style="font-family:Calibri;">agent</span><span style="font-family:'宋体';">，这时该文件夹会产生一个文件将该周期内收集到的日志全部写进该文件内，直到下一个周期再次产生一个新文件继续写入，以此类推，周而复始。</span></p><p align="justify" style="background-color:rgb(255,255,255);">例子：</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks=k1</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k1.type = file_roll</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k1.channel = c1</p><p align="justify" style="background-color:rgb(255,255,255);">agent1.sinks.k1.sink.directory=/root/flumelog (<span style="font-family:'宋体';">指定文件所在目录的路径</span><span style="font-family:Calibri;">)</span></p><p align="justify" style="background-color:rgb(255,255,255);"> </p><p style="background-color:rgb(255,255,255);">hdfs sink:将收集到的日志写入到新创建的文件中保存起来，存储路径为分布式的文件系统<span style="font-family:Calibri;">hdfs</span><span style="font-family:'宋体';">的路径，同时</span><span style="font-family:Calibri;">hdfs</span><span style="font-family:'宋体';">创建新文件的周期可以是时间，也可以是文件的大小，还可以是采集日志的条数</span></p>            </div>
                </div>