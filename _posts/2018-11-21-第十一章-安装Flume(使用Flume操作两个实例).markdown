---
layout:     post
title:      第十一章-安装Flume(使用Flume操作两个实例)
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                <div><p>一、安装Flume</p></div><p>1.     解压Flume安装包到/usr/local中</p><p>$&gt;sudo tar -zxf apache-flume-1.7.0-bin.tar.gz -C/usr/local</p><p></p><p>2.     给Flume文件夹改名</p><p>$&gt;cd /usr/local</p><p>$&gt;sudo mv apache-flume-1.7.0-bin/ flume</p><p>3.     修改flume文件夹的拥有者</p><p>$&gt; sudo chown -R hadoop:hadoop flume</p><p></p><p>4.     将flume路径添加到环境变量中，并使文件立即生效</p><p>$&gt;vim~/.bashrc</p><p>    $&gt;source~/.bashrc</p><p></p><p> </p><p>添加：</p><p># flumeinstall</p><p>exportFLUME_HOME=/usr/local/flume</p><p>export PATH=$PATH:$FLUME_HOME/bin</p><p>5.     配置flume</p><p>$&gt;cd flume</p><p>$&gt;mv ./conf/flume-env.sh.template ./conf/flume-env.sh</p><p>$&gt; vim ./conf/flume-env.sh</p><p>添加：</p><p>export JAVA_HOME=/usr/locla/jdk</p><p></p><p>6.     验证flume是否安装成功</p><p>$&gt;flume-ng version</p><p></p><p> </p><div><p>二、应用Flume的两个实例</p></div><p>1.     使用Flume接收来自AvroSource的信息</p><p><span style="color:#000000;">案例：</span>AvroSource<span style="color:#000000;">　可以发送一个给定的文件给</span><span style="color:#000000;">Flume</span><span style="color:#000000;">，</span><span style="color:#000000;">Flume</span><span style="color:#000000;">接收到以后可以进行相应的处理，例如显示到屏幕上</span></p><p><span style="color:#000000;">a.   </span><span style="color:#000000;">创建</span><span style="color:#000000;">agent</span><span style="color:#000000;">配置文件</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">在</span><span style="color:#000000;">/usr/local/flume/conf</span><span style="color:#000000;">目录下创建一个新文件</span><span style="color:#000000;">avro.conf</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;cd  </span>/usr/local/flume</p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;gedit./conf/avro.conf</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">并添加以下信息：</span></p><p><span style="color:#000000;">a1.sources= r1</span></p><p><span style="color:#000000;">a1.sinks= k1</span></p><p><span style="color:#000000;">a1.channels= c1</span></p><p><span style="color:#000000;">#Describe/configure the source</span></p><p><span style="color:#000000;">a1.sources.r1.type=avro</span></p><p><span style="color:#000000;">a1.sources.r1.channels= c1</span></p><p><span style="color:#000000;">a1.sources.r1.bind= 0.0.0.0</span></p><p><span style="color:#000000;">a1.sources.r1.port= 4141</span></p><p><span style="color:#000000;">#Describe the sink</span></p><p><span style="color:#000000;">a1.sinks.k1.type=logger</span></p><p><span style="color:#000000;"># Use achannel which buffers events in memory</span></p><p><span style="color:#000000;">a1.channels.c1.type=memory</span></p><p><span style="color:#000000;">a1.channels.c1.capacity= 1000</span></p><p><span style="color:#000000;">a1.channels.c1.transactionCapacity= 100</span></p><p><span style="color:#000000;"># Bindthe source and sink to the channel</span></p><p><span style="color:#000000;">a1.sources.r1.channels= c1</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">a1.sinks.k1.channel= c1</span></p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"><span style="color:#000000;">b.   </span><span style="color:#000000;">启动服务</span><span style="color:#000000;"> flumeagent a1</span></p><p><span style="color:#000000;">$&gt; flume-ngagent -c . -f /usr/local/flume/conf/avro.conf </span>-n a1 -Dflume.root.logger=INFO,console</p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"><span style="color:#000000;">c.   </span><span style="color:#000000;">创建指定文件</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">打开另一个</span><span style="color:#000000;">Linux</span><span style="color:#000000;">终端，使用如下命令在</span><span style="color:#000000;">/usr/local/flume</span><span style="color:#000000;">目录下新建一个文件</span><span style="color:#000000;">log.00</span><span style="color:#000000;">，并在文件中加入一行内容</span><span style="color:#000000;">"hello world" </span><span style="color:#000000;">。</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;sh–c ‘echo “hello world” &gt; /usr/local/flume/log.00’</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">d.   </span><span style="color:#000000;">使用</span><span style="color:#000000;">avro-client</span><span style="color:#000000;">发送文件</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">再打开另一个</span><span style="color:#000000;">Linux</span><span style="color:#000000;">终端，执行如下命令：</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;</span> <span style="color:#000000;">flume-ng avro-client --conf conf -H localhost -p 4141 -F/usr/local/flume/log.00</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">命令：</span></p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"><span style="color:#000000;"> </span></p><p style="background:#FFFFFF;"><span style="color:#000000;">e.   </span><span style="color:#000000;">在</span><span style="color:#000000;">m1</span><span style="color:#000000;">的控制台，可以看到以下信息，注意最后一行：</span><span style="color:#000000;"> hello world</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">结果：</span></p><p style="background:#FFFFFF;"></p><p>2.     使用Flume接收来自NetcatSource的信息</p><p>NetcatSource可以把用户实时输入的信息不断地发送给Flume，Flume接收到以后可以进行相应的处理，例如显示到屏幕上。</p><p style="background:#FFFFFF;"><span style="color:#000000;">a.   </span><span style="color:#000000;">在</span><span style="color:#000000;">/usr/local/flume/conf</span><span style="color:#000000;">目录下创建一个新文件</span><span style="color:#000000;">example.conf</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;cd/usr/local/flume</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;gedit./conf/example.conf</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">配置以下内容：</span></p><p># Name the components on this agent</p><p>a1.sources = r1</p><p>a1.sinks = k1</p><p>a1.channels = c1</p><p># Describe/configure the source</p><p>a1.sources.r1.type = netcat</p><p>a1.sources.r1.bind = localhost</p><p>a1.sources.r1.port = 44444</p><p># Describe the sink</p><p>a1.sinks.k1.type = logger</p><p># Use a channel which buffers events in memory </p><p>a1.channels.c1.type = memory</p><p>a1.channels.c1.capacity = 1000</p><p>a1.channels.c1.transactionCapacity = 100</p><p>#Bind the source and sink to the channel</p><p>a1.sources.r1.channels = c1</p><p>a1.sinks.k1.channel = c1</p><p style="background:#FFFFFF;"><span style="color:#000000;"> </span></p><p style="background:#FFFFFF;"><span style="color:#000000;">b.   </span><span style="color:#000000;">开启两个</span><span style="color:#000000;">linux</span><span style="color:#000000;">终端，在第一个终端中输入</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;/usr/local/flume/bin/flume-ngagent --conf ./conf --conf-file ./conf/example.conf  </span>--name a1 -Dflume.root.logger=INFO,console</p><p style="background:#FFFFFF;"><span style="color:#000000;">命令截图：</span></p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"><span style="color:#000000;">结果截图：</span></p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"><span style="color:#000000;">c.   </span><span style="color:#000000;">在第二个终端中输入</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">$&gt;</span> <span style="color:#000000;">telnet localhost 44444</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">这样，在第二个终端命令行输入的信息，就可以实时显示在第一个终端界面了。</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">结果：</span></p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"></p><p style="background:#FFFFFF;"><span style="color:#000000;"> </span></p><p style="background:#FFFFFF;"><span style="color:#000000;"> </span></p><p style="background:#FFFFFF;"><span style="color:#000000;">总结：</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">遇到的问题：再实例</span><span style="color:#000000;">2</span><span style="color:#000000;">使用</span><span style="color:#000000;">Flume</span><span style="color:#000000;">接收来自</span><span style="color:#000000;">NetcatSource</span><span style="color:#000000;">的信息中，开启服务命令：</span><span style="color:#000000;">$&gt;/usr/local/flume/bin/flume-ngagent --conf ./conf --conf-file ./conf/example.conf  </span>--name a1 -Dflume.root.logger=INFO,console</p><p style="background:#FFFFFF;"><span style="color:#000000;">，最初给的是错误的，给的命令是把</span><span style="color:#000000;">--conf</span><span style="color:#000000;">写成了</span><span style="color:#000000;">—conf,</span><span style="color:#000000;">还有</span><span style="color:#000000;">--name </span><span style="color:#000000;">写成了</span><span style="color:#000000;">—name </span><span style="color:#000000;">这是</span><span style="color:#000000;">word</span><span style="color:#000000;">的原因。</span></p><p style="background:#FFFFFF;"><span style="color:#000000;">提示的错误是：</span><span style="color:#000000;">org.apache.commons.cli.UnrecognizedOptionException:Unrecognized option: -conf</span><span style="color:#000000;">。一般这种错误是，参数写错了。</span></p><p> </p><p><span style="font-size:18px;">由于图片不能复制过来，该博客有很多详细步骤的截图没有，如果需要详细版的Flume安装与使用，可以点击此处下载链接：https://download.csdn.net/download/weixin_42006411/10468879</span></p>            </div>
                </div>