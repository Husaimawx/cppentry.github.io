---
layout:     post
title:      基于MapReduce的HBase开发
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<span style="font-family:Arial;font-size:14px;line-height:26px;">在伪分布式模式和全分布式模式下 HBase 是架构在 HDFS 上的，因此完全可以将MapReduce 编程框架和 HBase 结合起来使用。也就是说，将 HBase 作为底层“存储结构”，MapReduce 调用 HBase 进行特殊的处理，这样能够充分结合 HBase 分布式大型数据库和MapReduce 并行计算的优点。 </span>
<h1 style="font-family:Arial;line-height:26px;"><a name="t0" style="color:rgb(255,153,0);"></a>相对应MapReduce的hbase实现类：</h1>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
  1）InputFormat 类：HBase 实现了 TableInputFormatBase 类，该类提供了对表数据的大部分操作，其子类 TableInputFormat 则提供了完整的实现，用于处理表数据并生成键值对。TableInputFormat 类将数据表按照 Region 分割成 split，既有多少个 Regions 就有多个splits。然后将 Region 按行键分成&lt;key,value&gt;对，key 值对应与行健，value 值为该行所包含的数据。 <br>
  2）Mapper 类和 Reducer 类：HBase 实现了 TableMapper 类和 TableReducer 类，其中TableMapper 类并没有具体的功能，只是将输入的&lt;key,value&gt;对的类型分别限定为 Result 和ImmutableBytesWritable。IdentityTableMapper 类和 IdentityTableReducer 类则是上述两个类的具体实现，其和 Mapper 类和 Reducer 类一样，只是简单地将&lt;key,value&gt;对输出到下一个阶段。 <br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
3）OutputFormat 类：HBase 实现的 TableOutputFormat 将输出的&lt;key,value&gt;对写到指定的 HBase 表中，该类不会对 WAL（Write-Ahead  Log）进行操作，即如果服务器发生<br>
故障将面临丢失数据的风险。可以使用 MultipleTableOutputFormat 类解决这个问题，该类可以对是否写入 WAL 进行设置。<br></p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
代码：</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.io.IOException;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.Iterator;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> java.util.StringTokenizer;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.conf.Configuration;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.fs.Path;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HBaseConfiguration;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HColumnDescriptor;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.HTableDescriptor;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.HBaseAdmin;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.client.Put;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableOutputFormat;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.mapreduce.TableReducer;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.hbase.util.Bytes;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.IntWritable;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.LongWritable;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.Text;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.io.NullWritable;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Job;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.Mapper;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">import</span><span style="border:none;background-color:inherit;"> org.apache.hadoop.mapreduce.lib.input.TextInputFormat;   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> WordCountHBase {   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 实现 Map 类 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> Map </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;">   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      Mapper&lt;LongWritable, Text, Text, IntWritable&gt; {   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">final</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> IntWritable one = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> IntWritable(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">private</span><span style="border:none;background-color:inherit;"> Text word = </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Text();   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> map(LongWritable key, Text value, Context context)   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      StringTokenizer itr = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> StringTokenizer(value.toString());   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (itr.hasMoreTokens()) {   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        word.set(itr.nextToken());   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        context.write(word, one);   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      }   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 实现 Reduce 类 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;"> Reduce </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">extends</span><span style="border:none;background-color:inherit;">   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      TableReducer&lt;Text, IntWritable, NullWritable&gt; {   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> reduce(Text key, Iterable&lt;IntWritable&gt; values,   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        Context context) <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException, InterruptedException {   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">int</span><span style="border:none;background-color:inherit;"> sum = </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      Iterator&lt;IntWritable&gt; iterator = values.iterator();   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">while</span><span style="border:none;background-color:inherit;"> (iterator.hasNext()) {   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">        sum += iterator.next().get();   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      }   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// Put 实例化，每个词存一行 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      Put put = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Put(Bytes.toBytes(key.toString()));   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 列族为 content，列修饰符为 count，列值为数目 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      put.add(Bytes.toBytes(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"content"</span><span style="border:none;background-color:inherit;">), Bytes.toBytes(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"count"</span><span style="border:none;background-color:inherit;">),   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">          Bytes.toBytes(String.valueOf(sum)));   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      context.write(NullWritable.get(), put);   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 创建 HBase 数据表 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> createHBaseTable(String tableName)    </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> IOException {   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 创建表描述 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    HTableDescriptor htd = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HTableDescriptor(tableName);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 创建列族描述 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    HColumnDescriptor col = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HColumnDescriptor(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"content"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    htd.addFamily(col);   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 配置 HBase </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    Configuration conf = HBaseConfiguration.create();   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    conf.set(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"hbase.zookeeper.quorum"</span><span style="border:none;background-color:inherit;">,</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"master"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    conf.set(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"hbase.zookeeper.property.clientPort"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"2181"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    HBaseAdmin hAdmin = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> HBaseAdmin(conf);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">if</span><span style="border:none;background-color:inherit;"> (hAdmin.tableExists(tableName)) {   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      System.out.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"该数据表已经存在，正在重新创建。"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      hAdmin.disableTable(tableName);   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">      hAdmin.deleteTable(tableName);   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    }   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    System.out.println(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"创建表："</span><span style="border:none;background-color:inherit;"> + tableName);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    hAdmin.createTable(htd);   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">public</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">static</span><span style="border:none;background-color:inherit;"> </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">void</span><span style="border:none;background-color:inherit;"> main(String[] args) </span><span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">throws</span><span style="border:none;background-color:inherit;"> Exception {   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    String tableName = <span class="string" style="border:none;color:#0000FF;background-color:inherit;">"wordcount"</span><span style="border:none;background-color:inherit;">;   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 第一步：创建数据库表 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    WordCountHBase.createHBaseTable(tableName);   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 第二步：进行 MapReduce 处理 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 配置 MapReduce </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    Configuration conf = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Configuration();   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 这几句话很关键 </span><span style="border:none;background-color:inherit;">  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    conf.set(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"mapred.job.tracker"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"master:9001"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    conf.set(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"hbase.zookeeper.quorum"</span><span style="border:none;background-color:inherit;">,</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"master"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    conf.set(<span class="string" style="border:none;color:#0000FF;background-color:inherit;">"hbase.zookeeper.property.clientPort"</span><span style="border:none;background-color:inherit;">, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"2181"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    conf.set(TableOutputFormat.OUTPUT_TABLE, tableName);   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    Job job = <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Job(conf, </span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"New Word Count"</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setJarByClass(WordCountHBase.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 设置 Map 和 Reduce 处理类 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setMapperClass(Map.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setReducerClass(Reduce.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 设置输出类型 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setMapOutputKeyClass(Text.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setMapOutputValueClass(IntWritable.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 设置输入和输出格式 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setInputFormatClass(TextInputFormat.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    job.setOutputFormatClass(TableOutputFormat.<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">class</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    <span class="comment" style="border:none;color:rgb(0,130,0);background-color:inherit;">// 设置输入目录 </span><span style="border:none;background-color:inherit;">  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    FileInputFormat.addInputPath(job, <span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">new</span><span style="border:none;background-color:inherit;"> Path(</span><span class="string" style="border:none;color:#0000FF;background-color:inherit;">"hdfs://master:9000/in/"</span><span style="border:none;background-color:inherit;">));   </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    System.exit(job.waitForCompletion(<span class="keyword" style="border:none;color:rgb(0,102,153);background-color:inherit;font-weight:bold;">true</span><span style="border:none;background-color:inherit;">) ? </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;"> : </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">);   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  }   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">}   </span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<h1 style="font-family:Arial;line-height:26px;"><a name="t1" style="color:rgb(255,153,0);"></a>常见错误及解决方法：</h1>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<h2 style="font-family:Arial;line-height:26px;">1、java.lang.RuntimeException: java.lang.ClassNotFoundException: org.apache.hadoop.hbase.mapreduce.TableOutputFormat</h2>
<h3 style="font-family:Arial;line-height:26px;"><a name="t3" style="color:rgb(255,153,0);"></a>错误输出节选：</h3>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">13</span><span style="border:none;background-color:inherit;">/</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">09</span><span style="border:none;background-color:inherit;">/</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">10</span><span style="border:none;background-color:inherit;"> </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">21</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">14</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">01</span><span style="border:none;background-color:inherit;"> INFO mapred.JobClient: Running job: job_201308101437_0016  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">13</span><span style="border:none;background-color:inherit;">/</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">09</span><span style="border:none;background-color:inherit;">/</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">10</span><span style="border:none;background-color:inherit;"> </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">21</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">14</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">02</span><span style="border:none;background-color:inherit;"> INFO mapred.JobClient:  map </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">% reduce </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">%  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">13</span><span style="border:none;background-color:inherit;">/</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">09</span><span style="border:none;background-color:inherit;">/</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">10</span><span style="border:none;background-color:inherit;"> </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">21</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">14</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">16</span><span style="border:none;background-color:inherit;"> INFO mapred.JobClient: Task Id : attempt_201308101437_0016_m_000007_0, Status : FAILED  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">java.lang.RuntimeException: java.lang.ClassNotFoundException: org.apache.hadoop.hbase.mapreduce.TableOutputFormat  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.conf.Configuration.getClass(Configuration.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">849</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.mapreduce.JobContext.getOutputFormatClass(JobContext.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">235</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.mapred.Task.initialize(Task.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">513</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">353</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.mapred.Child$<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">4</span><span style="border:none;background-color:inherit;">.run(Child.java:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">255</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.security.AccessController.doPrivileged(Native Method)  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at javax.security.auth.Subject.doAs(Subject.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">396</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1149</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.mapred.Child.main(Child.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">249</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.hbase.mapreduce.TableOutputFormat  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.net.URLClassLoader$<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">.run(URLClassLoader.java:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">202</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.security.AccessController.doPrivileged(Native Method)  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.net.URLClassLoader.findClass(URLClassLoader.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">190</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">306</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">301</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">247</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.lang.Class.forName0(Native Method)  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.lang.Class.forName(Class.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">249</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.conf.Configuration.getClassByName(Configuration.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">802</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at org.apache.hadoop.conf.Configuration.getClass(Configuration.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">847</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    ... <span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">8</span><span style="border:none;background-color:inherit;"> more  </span></span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<h3 style="font-family:Arial;line-height:26px;"><a name="t4" style="color:rgb(255,153,0);"></a>错误原因：</h3>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
相关的类文件没有引入到 Hadoop 集群上。</p>
<h3 style="font-family:Arial;line-height:26px;"><a name="t5" style="color:rgb(255,153,0);"></a>解决步骤：</h3>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
步骤一、停止HBase数据库：</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">[hadoop</span><span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@master</span><span style="border:none;background-color:inherit;"> bin]$ stop-hbase.sh   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">stopping hbase............  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master: stopping zookeeper.  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">[hadoop<span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@master</span><span style="border:none;background-color:inherit;"> bin]$ jps  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">16186</span><span style="border:none;background-color:inherit;"> Jps  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">26186</span><span style="border:none;background-color:inherit;"> DataNode  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">26443</span><span style="border:none;background-color:inherit;"> TaskTracker  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">26331</span><span style="border:none;background-color:inherit;"> JobTracker  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">26063</span><span style="border:none;background-color:inherit;"> NameNode  </span></span></li></ol></div>
<span style="font-family:Arial;font-size:14px;line-height:26px;">   停止Hadoop集群：</span><br style="font-family:Arial;font-size:14px;line-height:26px;"><p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;">[hadoop</span><span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@master</span><span style="border:none;background-color:inherit;"> bin]$ stop-all.sh   </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">Warning: $HADOOP_HOME is deprecated.  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">stopping jobtracker  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master: Warning: $HADOOP_HOME is deprecated.  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master:   </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master: stopping tasktracker  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1: Warning: $HADOOP_HOME is deprecated.  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1:   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1: stopping tasktracker  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">stopping namenode  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master: Warning: $HADOOP_HOME is deprecated.  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master:   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">master: stopping datanode  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1: Warning: $HADOOP_HOME is deprecated.  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1: stopping datanode  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1:   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1: Warning: $HADOOP_HOME is deprecated.  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1:   </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">node1: stopping secondarynamenode  </span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">[hadoop<span class="annotation" style="border:none;color:rgb(100,100,100);background-color:inherit;">@master</span><span style="border:none;background-color:inherit;"> bin]$ jps  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">16531</span><span style="border:none;background-color:inherit;"> Jps  </span></span></li></ol></div>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
步骤二、<span style="color:rgb(255,0,0);">需要配置 Hadoop 集群中每台机器</span>，在 hadoop 目录的 conf 子目录中，找 hadoop-env.sh文件，并添加如下内容：</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span style="border:none;background-color:inherit;"># set hbase environment  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">export HBASE_HOME=/opt/modules/hadoop/hbase/hbase-<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0.94</span><span style="border:none;background-color:inherit;">.</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">11</span><span style="border:none;background-color:inherit;">-security  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">export HADOOP_CLASSPATH=$HBASE_HOME/hbase-<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0.94</span><span style="border:none;background-color:inherit;">.</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">11</span><span style="border:none;background-color:inherit;">-security.jar:$HBASE_HOME/hbase-</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0.94</span><span style="border:none;background-color:inherit;">.</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">11</span><span style="border:none;background-color:inherit;">-security-tests.jar:$HBASE_HOME/conf:$HBASE_HOME/lib/zookeeper-</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">3.4</span><span style="border:none;background-color:inherit;">.</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">5</span><span style="border:none;background-color:inherit;">.jar  </span></span></li></ol></div>
<span style="font-family:Arial;font-size:14px;line-height:26px;">步骤三、重新启动集群和hbase数据库。</span><br style="font-family:Arial;font-size:14px;line-height:26px;"><h2 style="font-family:Arial;line-height:26px;"><a name="t6" style="color:rgb(255,153,0);"></a>2、Error: java.lang.ClassNotFoundException: com.google.protobuf.Message</h2>
<h3 style="font-family:Arial;line-height:26px;"><a name="t7" style="color:rgb(255,153,0);"></a>错误输出节选：</h3>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<div class="dp-highlighter bg_java" style="font-family:Consolas, 'Courier New', Courier, mono, serif;background-color:rgb(231,229,220);overflow:auto;line-height:26px;">
<div class="bar">
<div class="tools" style="font-size:9px;line-height:normal;font-family:Verdana, Geneva, Arial, Helvetica, sans-serif;color:#C0C0C0;background-color:rgb(248,248,248);border-left-width:3px;border-left-style:solid;border-left-color:rgb(108,226,108);">
<strong>[java]</strong> <a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="ViewSource" title="view plain" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">view
 plain</a><a href="http://blog.csdn.net/hadoop_/article/details/11538201#" rel="nofollow" class="CopyToClipboard" title="copy" style="color:rgb(160,160,160);text-decoration:none;background-color:inherit;border:none;font-size:9px;display:inline-block;width:16px;text-indent:-2000px;">copy</a>
<div style="width:18px;z-index:99;">
</div>
</div>
</div>
<ol start="1" class="dp-j" style="border:none;background-color:rgb(255,255,255);color:rgb(92,92,92);"><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2013</span><span style="border:none;background-color:inherit;">-</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">09</span><span style="border:none;background-color:inherit;">-</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">12</span><span style="border:none;background-color:inherit;"> </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">12</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">38</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">57</span><span style="border:none;background-color:inherit;">,</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">833</span><span style="border:none;background-color:inherit;"> INFO  mapred.JobClient (JobClient.java:monitorAndPrintJob(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1363</span><span style="border:none;background-color:inherit;">)) -  map </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">% reduce </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">0</span><span style="border:none;background-color:inherit;">%  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;"><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">2013</span><span style="border:none;background-color:inherit;">-</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">09</span><span style="border:none;background-color:inherit;">-</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">12</span><span style="border:none;background-color:inherit;"> </span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">12</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">39</span><span style="border:none;background-color:inherit;">:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">12</span><span style="border:none;background-color:inherit;">,</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">490</span><span style="border:none;background-color:inherit;"> INFO  mapred.JobClient (JobClient.java:monitorAndPrintJob(</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1392</span><span style="border:none;background-color:inherit;">)) - Task Id : attempt_201309121232_0001_m_000007_0, Status : FAILED  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">Error: java.lang.ClassNotFoundException: com.google.protobuf.Message  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.net.URLClassLoader$<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">1</span><span style="border:none;background-color:inherit;">.run(URLClassLoader.java:</span><span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">202</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.security.AccessController.doPrivileged(Native Method)  </span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.net.URLClassLoader.findClass(URLClassLoader.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">190</span><span style="border:none;background-color:inherit;">)  </span></span></li><li class="alt" style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;color:inherit;line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">306</span><span style="border:none;background-color:inherit;">)  </span></span></li><li style="border-style:none none none solid;border-left-width:3px;border-left-color:rgb(108,226,108);list-style:outside;background-color:rgb(248,248,248);line-height:18px;">
<span style="border:none;color:#000000;background-color:inherit;">    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:<span class="number" style="border:none;color:rgb(192,0,0);background-color:inherit;">301</span><span style="border:none;background-color:inherit;">)  </span></span></li></ol></div>
<span style="font-family:Arial;font-size:14px;line-height:26px;">错误原因：</span>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
</p>
<p style="font-family:Arial;font-size:14px;line-height:26px;">
明显，没找到protobuf-java-2.4.0a.jar包，将该包路径加入hadoop-env.sh中。</p>
            </div>
                </div>