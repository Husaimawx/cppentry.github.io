---
layout:     post
title:      hive hbase 整合
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								<div class="article-copyright">
					版权声明：本文为博主原创文章，未经博主允许不得转载。					https://blog.csdn.net/linlinv3/article/details/46534109				</div>
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
 </div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;text-align:center;">
<strong><span style="font-size:14pt;">Hadoop Hive与Hbase整合</span></strong></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<br></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-family:'Microsoft YaHei UI';font-size:10.5pt;line-height:1.5;"><span style="font-size:11pt;">    </span></span><span style="font-size:11pt;">为了更好的使用hive 和hbase  这里介绍一下 hive 和hbase 的整合，这样能够在你往hive里面存储数据的时候同时往hbase里面存储数据，形成hbase与hive 的同步； </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:10.5pt;line-height:1.5;"><span style="font-size:12pt;"> wiki ：  </span></span><a href="https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration" rel="nofollow" style="font-size:10.5pt;line-height:1.5;">https://cwiki.apache.org/confluence/display/Hive/HBaseIntegration</a></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
 <span style="font-size:16px;line-height:24px;">wiki </span>：   <a href="https://cwiki.apache.org/confluence/display/Hive/StorageHandlers" rel="nofollow" style="font-size:10.5pt;line-height:1.5;">https://cwiki.apache.org/confluence/display/Hive/StorageHandlers</a> <br></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:10.5pt;line-height:1.5;"><span style="font-size:11pt;"><strong><span style="font-size:12pt;">一、进行hive配置</span></strong></span></span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">1. 拷贝hbase-common-0.98.6-cdh5.2.0.jar和zookeeper-3.4.5-cdh5.2.0.jar到hive/lib下。 </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">    注意：如何hive/lib下已经存在这两个文件的其他版本，建议删除后使用hbase下的相关版本。</span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">   </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">2. 修改hive/conf下hive-site.xml文件，在底部添加如下内容： </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;background-color:rgb(225,225,225);overflow:auto;font-size:.8em;line-height:1.5em;"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;"><span style="font-size:11pt;">&lt;property&gt; </span></div><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">  &lt;name&gt;hive.aux.jars.path&lt;/name&gt;  </div><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">  &lt;value&gt;file:///home/kkzhangtao/hive-0.13.1-cdh5.2.0/lib/hive-hbase-handler-0.8.0.jar,file:///home/kkzhangtao/hive-0.13.1-cdh5.2.0/lib/hbase-common-0.98.6-cdh5.2.0.jar,file:///home/kkzhangtao/hive-0.13.1-cdh5.2.0/lib/zookeeper-3.4.5-cdh5.2.0.jar&lt;/value&gt; </div><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">&lt;/property&gt;</div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">注意：如果hive-site.xml不存在则自行创建，或者把hive-default.xml.template文件改名后使用。</span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;"> </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">3. 拷贝hbase-common-0.98.6-cdh5.2.0.jar到所有hadoop节点(包括master)的hadoop/lib下。</span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;"> </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;">4. 拷贝hbase/conf下的hbase-site.xml文件到所有hadoop节点(包括master)的hadoop/conf下。</span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<span style="font-size:11pt;"><br></span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<strong><span style="font-size:12pt;">二、进入hive，</span><span style="font-size:10.5pt;line-height:1.5;"><span style="font-size:12pt;">创建hive表（与hbase关联）</span></span><span style="font-size:11pt;line-height:1.5;"><span style="font-size:12pt;"> </span></span></strong></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
1、进入hive<strong><span style="font-size:11pt;line-height:1.5;"><span style="font-size:12pt;"><br></span></span></strong></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;background-color:rgb(225,225,225);overflow:auto;font-size:.8em;line-height:1.5em;"><code class="prettyprint" style="font-family:Consolas, Menlo, Monaco, 'Lucida Console', 'Liberation Mono', 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', 'Courier New', monospace, serif;background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">&gt; bin/hive -hive<span style="font-size:10.5pt;line-height:1.5;">  </span></div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
2、创建hive表</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<br></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
1&gt;若hbase里面不存在需要创建的表</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">use hive_hbase_test；   </span></div><div><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:10.5pt;line-height:1.5;">create table hive_hbase(rowkey varchar(64),andx_item_id  char(32)  ,xcount  int ) stored by </span><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:10.5pt;line-height:1.5;">'</span><span style="font-size:10.5pt;font-family:Arial;line-height:26px;background-color:rgb(255,255,255);">org.apache.hadoop.hive.hbase.HBaseStorageHandler</span><span style="font-size:10.5pt;line-height:1.5;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">'  with serdeproperties ("hbase.columns.mapping" = ":key, service_info: id,service_info: xcount  ")   <span style="color:#ff0000;"> tblproperties ("hbase.table.name" = "hive_hbase") ;</span></span></div><div>
</div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
hbase.table.name 不是必写项， 定义在hbase的table名称  <span style="color:rgb(255,0,0);font-size:10.5pt;line-height:1.5;">例如：hive_hbase；</span><span style="font-size:10.5pt;line-height:1.5;">；若是不写的话 默认与hive的表名称相同</span><span style="font-size:10.5pt;line-height:1.5;color:rgb(255,0,0);"> 
 例如：hive_hbase_test.hive_hbase;</span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
hbase.columns.mapping 是必填的，是对用hbase里面的key 和 列族</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<br></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
 2&gt;若hbase里面存在需要创建的表</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">use hive_hbase_test；   </span></div><div><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:10.5pt;line-height:1.5;">create </span><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">EXTERNAL </span><span style="font-size:10.5pt;line-height:1.5;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">table hive_hbase(rowkey varchar(64),andx_item_id  char(32)  ,xcount  int ) stored by </span><span style="font-size:10.5pt;line-height:1.5;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">'</span><span style="font-size:10.5pt;font-family:Arial;line-height:26px;background-color:rgb(255,255,255);">org.apache.hadoop.hive.hbase.HBaseStorageHandler</span><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;"><span style="font-size:10.5pt;line-height:1.5;">'  with serdeproperties ("hbase.columns.mapping" = ":key, service_info: id,service_info: xcount  ")   </span></span><span style="color:#ff0000;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:10.5pt;line-height:1.5;"> </span><span style="color:#282828;"><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;"><span style="font-size:10.5pt;line-height:1.5;">tblproperties ("hbase.table.name" = </span>some_existing_table<span style="font-size:10.5pt;line-height:1.5;">") ;</span></span></span></div><div>
</div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<br></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
3、在hive里面创建数据</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<div>non-native类型的表是不能使用load 的，所以需要建立一个中间表，把文件数据load进去<span style="font-size:10.5pt;line-height:1.5;"><br></span></div>
<span style="font-size:10.5pt;line-height:1.5;"> 建立文件 hive_hbase 内容如下： </span></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">111111111_1           4028800947af3bf00147af4037c30001     23</div><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">111111111_2           4028800947af3bf00147af4037c30001     30      </div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
建立中间表</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">use hive_hbase_test；   </span></div><div><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:10.5pt;line-height:1.5;">create </span><span style="font-size:10.5pt;line-height:1.5;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">table hive_hbase_temp(rowkey varchar(64),andx_item_id  char(32)  ,xcount  int ) </span><span style="color:#282828;"><span style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;"><span style="font-size:10.5pt;line-height:1.5;"> ;</span></span></span></div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
导入文件到中间表 hive_hbase_temp：</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<div>
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;">&gt;LOAD DATA LOCAL INPATH '/home/fulong/Fulong/hive_hbase.txt' OVERWRITE INTO TABLE hive_hbase_temp;</div>
</div>
<div>  </div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
把中间的表数据导入到hive_hbase中</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;"><span style="font-size:10.5pt;line-height:1.5;">INSERT OVERWRITE TABLE hive_hbase select * from hive_hbase_temp;</span><span style="font-size:10.5pt;line-height:1.5;">  </span></div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<br></div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
4、 查看hbase 和 hive 的 数据 </div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;"> hive &gt; <span style="font-size:10.5pt;line-height:1.5;">select * from hive_hbase;</span></div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
<pre class="prettyprint prettyprinted" style="background-color:rgb(225,225,225);overflow:auto;"><code class="prettyprint" style="background-color:rgb(247,247,247);display:block;"></code></pre><div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;"> hbase &gt; <span style="font-size:10.5pt;line-height:1.5;">scan  </span><span style="font-size:10.5pt;line-height:1.5;">hive_hbase_test.</span><span style="font-size:10.5pt;line-height:1.5;">hive_hbase;</span></div>
</div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
 </div>
<div style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', Tahoma, Helvetica, sans-serif, 'Microsoft YaHei', Georgia, Helvetica, Arial, sans-serif, '宋体', PMingLiU, serif;font-size:14px;line-height:21px;">
  </div>
<div>
<div id="footer" style="font-family:Arial;font-size:14px;line-height:26px;">
<br></div>
</div>
            </div>
                </div>