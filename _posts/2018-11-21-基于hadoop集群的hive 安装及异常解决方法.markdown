---
layout:     post
title:      基于hadoop集群的hive 安装及异常解决方法
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<ul style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;"><li><strong><span style="font-size:18px;">第一部分：软件准备与环境规划</span></strong></li></ul><p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">Hadoop环境介绍</span><br><span style="font-size:18px;">•Hadoop安装路径</span><br><span style="font-size:18px;">•/usr/local/hadoop</span><br><span style="font-size:18px;">Hive环境规划</span><br><span style="font-size:18px;">•Hive安装路径</span><br><span style="font-size:18px;">•/usr/local/hive</span><br><span style="font-size:18px;">•Hive数据存放路径</span><br><span style="font-size:18px;">•hdfs</span><br><span style="font-size:18px;">•/user/hive/warehouse</span><br><span style="font-size:18px;">•Hive元数据</span><br><span style="font-size:18px;">•第三方数据库</span><br><span style="font-size:18px;">•derby mysql</span><br><span style="font-size:18px;">软件准备</span><br><span style="font-size:18px;">•OS</span><br><span style="font-size:18px;">•ubuntu</span><br><span style="font-size:18px;">•JDK</span><br><span style="font-size:18px;">•java 1.6.0_27</span><br><span style="font-size:18px;">•Hadoop</span><br><span style="font-size:18px;">•hadoop-1.0.0.tar</span><br><span style="font-size:18px;">•Hive</span><br><span style="font-size:18px;">•hive-0.8.1.tar</span></p>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
 </p>
<div class="O1" style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<div class="O">
<div>
<ul><li><strong><span class="bold" style="font-size:18px;">第二部分：Hive项目介绍</span></strong></li></ul></div>
<div><span class="bold" style="font-size:18px;">项目结构</span></div>
</div>
<img src="http://sishuok.com/forum/upload/2012/10/22/23f69ab026524a28fe86b75835851742__1.JPG" alt="" style="border:0px;"></div>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
 </p>
<div class="O" style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<div class="O"><span class="bold" style="font-size:18px;">Hive配置文件介绍</span></div>
<p>
 </p>
<div><span style="font-size:18px;">•hive-site.xml      hive的配置文件</span></div>
<div><span style="font-size:18px;">•hive-env.sh        hive的运行环境文件</span></div>
<div><span style="font-size:18px;">•hive-default.xml.template  默认模板</span></div>
<div><span style="font-size:18px;">•hive-env.sh.template     hive-env.sh默认配置</span></div>
<div><span style="font-size:18px;">•hive-exec-log4j.properties.template   exec默认配置</span></div>
<div><span style="font-size:18px;">• hive-log4j.properties.template log默认配置</span></div>
<div class="O">
<div class="O">
<div class="O"><span class="bold">hive-site.xml</span></div>
<div class="O">
<div class="dp-highlighter" style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;font-size:12px;background-color:transparent;width:679px;overflow:auto;margin-left:9px;">
<div class="bar">
<div class="tools" style="font-weight:bold;">Xml代码  <a href="" rel="nofollow" title="收藏这段代码" style="color:rgb(16,138,198);"><img class="star" src="http://scau-fly.iteye.com/images/icon_star.png" alt="收藏代码" style="border:0px;"></a></div>
</div>
<ol start="1" class="dp-xml" style="font-size:1em;line-height:1.4em;border:1px solid rgb(209,215,220);color:rgb(43,145,175);"><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"> <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span> <span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionURL<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span> <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>jdbc:mysql://localhost:3306/hive?createData <span class="attribute" style="color:#FF0000;">baseIfNotExist</span>=<span class="attribute-value" style="color:#0000FF;">true</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>JDBC connect string for a JDBC metastore<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">    <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>com.mysql.jdbc.Driver<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>Driver class name for a JDBC metastore<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">    <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>root<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">   <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>username to use against metastore database<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">   <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>test<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">   <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>password to use against metastore database<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li></ol></div>
 <br><span class="bold" style="font-size:18px;">hive-env.sh</span></div>
</div>
</div>
</div>
<div class="O" style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">•配置Hive的配置文件路径</span></div>
<div class="O1" style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">•export HIVE_CONF_DIR= your path</span></div>
<div class="O" style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">•配置Hadoop的安装路径</span></div>
<div class="O1" style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">•HADOOP_HOME=your hadoop home</span></div>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
 </p>
<ul style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;"><li><strong><span style="font-size:18px;">第三部分:安装hive</span></strong></li></ul><p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;"> 下载hive安装包 http://mirrors.tuna.tsinghua.edu.cn/apache/hive/</span><br><span style="font-size:18px;">  tar -xf hive-0.10.0.tar.gz</span><br><span style="font-size:18px;"> 将解压后的hive文件放在系统的/usr/local/hive 中。</span><br><br><span style="font-size:18px;">在/etc/profile中添加：</span><br><span style="font-size:18px;">export HIVE_HOME=/usr/local/hive/hive</span><br><span style="font-size:18px;">export PATH=$HIVE_HOME/bin:$PATH</span><br><br></p>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<br><span style="font-size:18px;">将conf/hive-default.xml.template复制两份，分别命名为hive-default.xml（用于保留默认配置）和hive-site.xml（用于个性化配置，可覆盖默认配置）</span><br><br><span style="font-size:18px;">启动hive：</span><br><span style="font-size:16px;">$ $HIVE_HOME/bin/hive</span><br><br><span style="font-size:16px;">hive&gt; create database test;</span><br><span style="font-size:16px;">OK</span><br><span style="font-size:16px;">Time taken: 0.07 seconds</span><br><span style="font-size:16px;">hive&gt; show databases;</span><br><span style="font-size:16px;">OK</span><br><span style="font-size:16px;">default</span><br><span style="font-size:16px;">test</span><br><span style="font-size:16px;">Time taken: 0.196 seconds</span><br><br><br><span style="font-size:18px;">执行成功。</span><br><br></p>
<ul style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;"><li><span style="font-size:18px;"><strong>第三部分:使用MySQL数据库的安装方式</strong></span></li></ul><p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">但是这样安装的元数据保持在内嵌的数据库Derby中，只能允许一个会话连接，如果要支持多用户多会话，则需要一个独立的元数据库，目前比较流行的是使用MySQL，下面进行配置。</span><br><span style="font-size:18px;"> </span><br><span style="font-size:18px;">1）安装MySQL服务器并启动MySQL服务</span><br><br><span style="font-size:18px;">2）为Hive建立相应的MySQL帐号，并赋予足够的权限</span><br><span style="font-size:18px;">①进入root：mysql -uroot -p；</span><br><span style="font-size:18px;">②创建hive数据库：create database hive；</span><br><span style="font-size:18px;">③创建用户hive，它只能从localhost连接到数据库并可以连接到wordpress数据库：grant all on hive.* to hive@localhost identified by 'hive'。</span><br><br><span style="font-size:18px;">3）在Hive的conf目录下修改配置文件hive-site.xml，配置文件修改如下</span></p>
<div class="dp-highlighter" style="font-family:Monaco, 'DejaVu Sans Mono', 'Bitstream Vera Sans Mono', Consolas, 'Courier New', monospace;width:679px;overflow:auto;margin-left:9px;line-height:25.1875px;">
<div class="bar">
<div class="tools" style="font-weight:bold;">Xml代码  <a href="" rel="nofollow" title="收藏这段代码" style="color:rgb(16,138,198);"><img class="star" src="http://scau-fly.iteye.com/images/icon_star.png" alt="收藏代码" style="border:0px;"></a></div>
</div>
<ol start="1" class="dp-xml" style="font-size:1em;line-height:1.4em;border:1px solid rgb(209,215,220);color:rgb(43,145,175);"><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionURL<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>jdbc:mysql://localhost:3306/hive?<span class="attribute" style="color:#FF0000;">createDatabaseIfNotExist</span>=<span class="attribute-value" style="color:#0000FF;">true</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>JDBC connect string for a JDBC metastore<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>com.mysql.jdbc.Driver<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>Driver class name for a JDBC metastore<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>hive<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>username to use against metastore database<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">name</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>hive<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">value</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;">  <span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>password to use against metastore database<span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">description</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>   </span></li><li style="font-size:1em;border-left-width:1px;border-left-style:solid;border-left-color:rgb(209,215,220);background-color:rgb(250,250,250);line-height:18px;">
<span style="color:#000000;"><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&lt;/</span><span class="tag-name" style="color:rgb(0,102,153);font-weight:bold;">property</span><span class="tag" style="color:rgb(0,102,153);font-weight:bold;">&gt;</span>  </span></li></ol></div>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
 页<br><br><span style="font-size:18px;">4）把MySQL的JDBC驱动包（我使用的是mysql-connector-java-5.0.8-bin.jar，从http://downloads.mysql.com/archives/mysql-connector-java-5.0/mysql-connector-java-5.0.8.tar.gz下载并解压后可以找到）复制到Hive的lib目录下。</span></p>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<br><span style="font-size:18px;">启动Hive shell，执行</span><br><span style="font-size:18px;">show tables;</span><br><span style="font-size:18px;">如果不报错，表明基于独立元数据库的Hive已经安装成功了。 </span><br><br><span style="font-size:18px;">查看一下元数据的效果。 </span><br><span style="font-size:18px;">在Hive上建立数据表：</span><br><span style="font-size:18px;">CREATE TABLE my(id INT,name string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';</span><br><span style="font-size:18px;">show tables;</span><br><span style="font-size:18px;">select name from my;</span><br><br><span style="font-size:18px;">然后我们以刚刚建立的hive帐号登录MySQL查看元数据信息。</span><br><span style="font-size:16px;">mysql&gt; use hive </span><br><span style="font-size:16px;">Reading table information for completion of table and column names </span><br><span style="font-size:16px;">You can turn off this feature to get a quicker startup with -A </span><br><br><span style="font-size:16px;">Database changed </span><br><br><span style="font-size:16px;">mysql&gt; show tables; </span><br><span style="font-size:16px;">+-----------------+ </span><br><span style="font-size:16px;">| Tables_in_hive  | </span><br><span style="font-size:16px;">+-----------------+ </span><br><span style="font-size:16px;">| BUCKETING_COLS  | </span><br><span style="font-size:16px;">| COLUMNS         | </span><br><span style="font-size:16px;">| DATABASE_PARAMS | </span><br><span style="font-size:16px;">| DBS             | </span><br><span style="font-size:16px;">| PARTITION_KEYS  | </span><br><span style="font-size:16px;">| SDS             | </span><br><span style="font-size:16px;">| SD_PARAMS       | </span><br><span style="font-size:16px;">| SEQUENCE_TABLE  | </span><br><span style="font-size:16px;">| SERDES          | </span><br><span style="font-size:16px;">| SERDE_PARAMS    | </span><br><span style="font-size:16px;">| SORT_COLS       | </span><br><span style="font-size:16px;">| TABLE_PARAMS    | </span><br><span style="font-size:16px;">| TBLS            | </span><br><span style="font-size:16px;">+-----------------+ </span><br><span style="font-size:16px;">13 rows in set (0.00 sec) </span><br><br><span style="font-size:16px;">mysql&gt; select * from TBLS; </span><br><span style="font-size:16px;">+--------+-------------+-------+------------------+--------+-----------+-------+----------+---------------+--------------------+--------------------+ </span><br><span style="font-size:16px;">| TBL_ID | CREATE_TIME | DB_ID | LAST_ACCESS_TIME | OWNER  | RETENTION | SD_ID | TBL_NAME | TBL_TYPE      | VIEW_EXPANDED_TEXT | VIEW_ORIGINAL_TEXT | </span><br><span style="font-size:16px;">+--------+-------------+-------+------------------+--------+-----------+-------+----------+---------------+--------------------+--------------------+ </span><br><span style="font-size:16px;">|      1 |  1319445990 |     1 |                0 | hadoop |         0 |     1 | my       | MANAGED_TABLE | NULL               | NULL               | </span><br><span style="font-size:16px;">+--------+-------------+-------+------------------+--------+-----------+-------+----------+---------------+--------------------+--------------------+ </span><br><span style="font-size:16px;">1 row in set (0.00 sec)</span><br><br><span style="font-size:18px;">在TBLS中可以看到Hive表的元数据。</span><br><br><br></p>
<ul style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;"><li><strong><span style="font-size:18px;"><strong><span class="bold">第四部分:</span></strong>安装过程异常处理</span></strong></li></ul><p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">异常描述:</span><br><span style="font-size:16px;">hive&gt; show tables;</span><br><span style="font-size:16px;">FAILED: Error in metadata: java.lang.RuntimeException: Unable to instantiate org.apache.hadoop.hive.metastore.HiveMetaStoreClient</span><br><span style="font-size:16px;">FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask</span><br><br><span style="font-size:18px;">解决方法:</span><br><span style="font-size:18px;">    引起这种异常的可能性较多,这里只是列举了一些相关的注意事项以供参考,详细大家可以通过网络找更多相关的内容.</span><br><span style="font-size:18px;">    1  删除  $HADOOP_HOME/build 目录(如果当时通过下载gz包进行编译安装的话,会残留部分信息,删除这个目录是必须的)</span><br><span style="font-size:18px;">    2  ./hive -hiveconf hive.root.logger=DEBUG,console  进行调试模式，根据问题逐步解决</span><br><span style="font-size:18px;">    3  确认 $HIVE_HOME/lib 下存在 mysql-connector-java-5.1.25-bin.jar  hadoop-core-1.2.0.jar 主包</span><br><span style="font-size:18px;">    4  了解Hive metastore三种存储方式,确认自身配置的模式是否正确</span><br><br><br><span style="font-size:18px;">异常描述:</span><br><span style="font-size:16px;">java.sql.SQLException: Invalid authorization specification,  message from server: "Access denied for user 'root'@'localhost' (using password: YES)"</span><br><span style="font-size:16px;">java.sql.SQLException: Syntax error or access violation,  message from server: "Access denied for user 'hadoop'@'localhost' to database 'metastore_db'"</span><br><span style="font-size:18px;">解决方法：</span><br><span style="font-size:18px;">这是因为mysql远程访问的权限问题，执行 grant all on *.*  to 'hadoop'@'%' identified by 'hadoop'; 即可。</span><br><br><span style="font-size:16px;">INSERT INTO USER(HOST,USER,PASSWORD) VALUES("localhost","hadoop",PASSWORD("hadoop"));</span><br><span style="font-size:16px;">GRANT ALL PRIVILEGES ON * TO 'hadoop'@'localhost' IDENTIFIED BY 'hadoop' WITH GRANT OPTION;</span><br><br><span style="font-size:16px;">FLUSH PRIVILEGES;</span><br><br></p>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
 </p>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<span style="font-size:18px;">异常描述:</span><br><span style="font-size:18px;">java.sql.SQLException: Syntax error or access violation,  message from server: "Specified key was too long; max key length is 767 bytes"</span><br><span style="font-size:18px;">解决方法：</span><br><span style="font-size:18px;">一般是由于mysql的最大索引长度导致，看了一个人的文章颇有感触下面给出链接：</span><br><span style="font-size:18px;">http://blog.csdn.net/cindy9902/article/details/6215769</span></p>
<p style="font-family:Helvetica, Tahoma, Arial, sans-serif;font-size:14px;line-height:25.1875px;">
<br><span style="font-size:18px;">1、数据库的字符集除了system为utf8，其他最好为latin1，否则可能出现如上异常。</span><br><span style="font-size:18px;">2、set global binlog_format='MIXED';READ-COMMITTED需要把bin-log以mixed方式来记录 </span><br><span style="font-size:18px;">改完上述两种方法后，我还是会出现以上问题，我把mysql的metastore_db里面的所有表删除，hadoop重启，然后重新启动hive之后就能够正常删除表了。</span><br><br><span style="font-size:18px;">问题解决。</span></p>
            </div>
                </div>