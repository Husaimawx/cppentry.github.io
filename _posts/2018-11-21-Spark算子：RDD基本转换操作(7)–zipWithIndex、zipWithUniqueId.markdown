---
layout:     post
title:      Spark算子：RDD基本转换操作(7)–zipWithIndex、zipWithUniqueId
---
<div id="article_content" class="article_content clearfix csdn-tracking-statistics" data-pid="blog" data-mod="popu_307" data-dsm="post">
								            <link rel="stylesheet" href="https://csdnimg.cn/release/phoenix/template/css/ck_htmledit_views-f76675cdea.css">
						<div class="htmledit_views" id="content_views">
                
<h1 class="article-title" style="line-height:35px;color:inherit;">
<a href="http://lxw1234.com/archives/2015/07/352.htm" rel="nofollow" style="color:rgb(68,68,68);text-decoration:none;font-weight:normal;font-size:24px;line-height:60px;">Spark算子：RDD基本转换操作(7)–zipWithIndex、zipWithUniqueId</a></h1>
<div class="meta"><span id="mute-category" class="muted" style="color:rgb(153,153,153);"><span class="fa fa-list-alt"></span><a href="http://lxw1234.com/archives/category/spark" rel="nofollow" style="color:rgb(0,166,124);text-decoration:none;"> Spark</a></span>
<span class="muted" style="color:rgb(153,153,153);"><span class="fa fa-user"></span> <a href="http://lxw1234.com/archives/author/lxw1234qq-com" rel="nofollow" style="color:rgb(0,166,124);text-decoration:none;">lxw1234@qq.com</a></span> <span class="fa fa-clock-o"></span> 1年前
 (2015-07-06) <span class="muted" style="color:rgb(153,153,153);"><span class="fa fa-eye"></span> 5714℃</span> <span class="muted" style="color:rgb(153,153,153);"><span class="fa fa-comments-o"></span> <a href="http://lxw1234.com/archives/2015/07/352.htm#comments" rel="nofollow" style="color:rgb(0,166,124);text-decoration:none;">0评论</a></span></div>
<p>关键字：Spark算子、Spark RDD基本转换、zipWithIndex、zipWithUniqueId</p>
<h2 style="line-height:18px;color:inherit;font-size:18px;border-left-width:4px;border-left-style:solid;border-left-color:rgb(0,166,124);background-color:rgb(251,251,251);">
zipWithIndex</h2>
<p>def zipWithIndex(): RDD[(T, Long)]</p>
<p>该函数将RDD中的元素和这个元素在RDD中的ID（索引号）组合成键/值对。</p>
<pre class="prettyprint linenums" style="color:rgb(68,68,68);font-size:14px;line-height:20px;border:1px solid rgb(238,238,238);overflow:hidden;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-color:rgb(248,248,248);"></pre><ol class="linenums" style="list-style:none;"><li class="L0" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">scala</span><span class="pun" style="color:rgb(0,170,0);">&gt;</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="kwd" style="color:rgb(249,38,89);">var</span><span class="pln" style="color:rgb(0,0,255);"> rdd2 </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> sc</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">makeRDD</span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="typ" style="color:rgb(0,170,0);">Seq</span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="str" style="color:rgb(194,143,91);">"A"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"B"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"R"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"D"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"F"</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="lit" style="color:rgb(204,0,204);">2</span><span class="pun" style="color:rgb(0,170,0);">)</span></li><li class="L1" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">rdd2</span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="pln" style="color:rgb(0,0,255);"> org</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">apache</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">spark</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">rdd</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">RDD</span><span class="pun" style="color:rgb(0,170,0);">[</span><span class="typ" style="color:rgb(0,170,0);">String</span><span class="pun" style="color:rgb(0,170,0);">]</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">ParallelCollectionRDD</span><span class="pun" style="color:rgb(0,170,0);">[</span><span class="lit" style="color:rgb(204,0,204);">34</span><span class="pun" style="color:rgb(0,170,0);">]</span><span class="pln" style="color:rgb(0,0,255);"> at makeRDD at </span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="lit" style="color:rgb(204,0,204);">21</span></li><li class="L2" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);"> </span></li><li class="L3" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">scala</span><span class="pun" style="color:rgb(0,170,0);">&gt;</span><span class="pln" style="color:rgb(0,0,255);"> rdd2</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">zipWithIndex</span><span class="pun" style="color:rgb(0,170,0);">().</span><span class="pln" style="color:rgb(0,0,255);">collect</span></li><li class="L4" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">res27</span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Array</span><span class="pun" style="color:rgb(0,170,0);">[(</span><span class="typ" style="color:rgb(0,170,0);">String</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Long</span><span class="pun" style="color:rgb(0,170,0);">)]</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Array</span><span class="pun" style="color:rgb(0,170,0);">((</span><span class="pln" style="color:rgb(0,0,255);">A</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">0</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">B</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">1</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">R</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">2</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">D</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">3</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">F</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">4</span><span class="pun" style="color:rgb(0,170,0);">))</span></li><li class="L5" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);"> </span></li></ol>
<h2 style="line-height:18px;color:inherit;font-size:18px;border-left-width:4px;border-left-style:solid;border-left-color:rgb(0,166,124);background-color:rgb(251,251,251);">
zipWithUniqueId</h2>
<p>def zipWithUniqueId(): RDD[(T, Long)]</p>
<p>该函数将RDD中元素和一个唯一ID组合成键/值对，该唯一ID生成算法如下：</p>
<p>每个分区中第一个元素的唯一ID值为：该分区索引号，</p>
<p>每个分区中第N个元素的唯一ID值为：(前一个元素的唯一ID值) + (该RDD总的分区数)</p>
<p>看下面的例子：</p>
<pre class="prettyprint linenums" style="color:rgb(68,68,68);font-size:14px;line-height:20px;border:1px solid rgb(238,238,238);overflow:hidden;font-family:Consolas, 'Bitstream Vera Sans Mono', 'Courier New', Courier, monospace !important;background-color:rgb(248,248,248);"></pre><ol class="linenums" style="list-style:none;"><li class="L0" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">scala</span><span class="pun" style="color:rgb(0,170,0);">&gt;</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="kwd" style="color:rgb(249,38,89);">var</span><span class="pln" style="color:rgb(0,0,255);"> rdd1 </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> sc</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">makeRDD</span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="typ" style="color:rgb(0,170,0);">Seq</span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="str" style="color:rgb(194,143,91);">"A"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"B"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"C"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"D"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"E"</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="str" style="color:rgb(194,143,91);">"F"</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="lit" style="color:rgb(204,0,204);">2</span><span class="pun" style="color:rgb(0,170,0);">)</span></li><li class="L1" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">rdd1</span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="pln" style="color:rgb(0,0,255);"> org</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">apache</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">spark</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">rdd</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">RDD</span><span class="pun" style="color:rgb(0,170,0);">[</span><span class="typ" style="color:rgb(0,170,0);">String</span><span class="pun" style="color:rgb(0,170,0);">]</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">ParallelCollectionRDD</span><span class="pun" style="color:rgb(0,170,0);">[</span><span class="lit" style="color:rgb(204,0,204);">44</span><span class="pun" style="color:rgb(0,170,0);">]</span><span class="pln" style="color:rgb(0,0,255);"> at makeRDD at </span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="lit" style="color:rgb(204,0,204);">21</span></li><li class="L2" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="com" style="color:rgb(102,102,102);">//rdd1有两个分区，</span></li><li class="L3" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><li class="L4" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">scala</span><span class="pun" style="color:rgb(0,170,0);">&gt;</span><span class="pln" style="color:rgb(0,0,255);"> rdd1</span><span class="pun" style="color:rgb(0,170,0);">.</span><span class="pln" style="color:rgb(0,0,255);">zipWithUniqueId</span><span class="pun" style="color:rgb(0,170,0);">().</span><span class="pln" style="color:rgb(0,0,255);">collect</span></li><li class="L5" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="pln" style="color:rgb(0,0,255);">res32</span><span class="pun" style="color:rgb(0,170,0);">:</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Array</span><span class="pun" style="color:rgb(0,170,0);">[(</span><span class="typ" style="color:rgb(0,170,0);">String</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Long</span><span class="pun" style="color:rgb(0,170,0);">)]</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">=</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="typ" style="color:rgb(0,170,0);">Array</span><span class="pun" style="color:rgb(0,170,0);">((</span><span class="pln" style="color:rgb(0,0,255);">A</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">0</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">B</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">2</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">C</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">4</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">D</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">1</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">E</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">3</span><span class="pun" style="color:rgb(0,170,0);">),</span><span class="pln" style="color:rgb(0,0,255);"> </span><span class="pun" style="color:rgb(0,170,0);">(</span><span class="pln" style="color:rgb(0,0,255);">F</span><span class="pun" style="color:rgb(0,170,0);">,</span><span class="lit" style="color:rgb(204,0,204);">5</span><span class="pun" style="color:rgb(0,170,0);">))</span></li><li class="L6" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="com" style="color:rgb(102,102,102);">//总分区数为2</span></li><li class="L7" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="com" style="color:rgb(102,102,102);">//第一个分区第一个元素ID为0，第二个分区第一个元素ID为1</span></li><li class="L8" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="com" style="color:rgb(102,102,102);">//第一个分区第二个元素ID为0+2=2，第一个分区第三个元素ID为2+2=4</span></li><li class="L9" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"><span class="com" style="color:rgb(102,102,102);">//第二个分区第二个元素ID为1+2=3，第二个分区第三个元素ID为3+2=5</span></li><li class="L0" style="text-indent:0px;color:rgb(190,190,197);margin-left:0px;list-style:decimal;"></ol>
<p>转载请注明：<a href="http://lxw1234.com/" rel="nofollow" title="" style="color:rgb(0,166,124);text-decoration:none;">lxw的大数据田地</a> » <a href="http://lxw1234.com/archives/2015/07/352.htm" rel="nofollow" title="" style="color:rgb(0,166,124);text-decoration:none;">Spark算子：RDD基本转换操作(7)–zipWithIndex、zipWithUniqueId</a></p>
            </div>
                </div>